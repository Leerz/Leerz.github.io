<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PremazingPH Games</title>
  <style>
    html, body {
      margin: 0; padding: 0;
      width: 100%; height: 100%;
      overflow: hidden;
    }
    iframe {
      width: 100vw; height: 100vh;
      border: none;
      display: block;
    }
  </style>
</head>
<body>
  <iframe id="viewer"></iframe>
  <script>
    const base64html = `PCFET0NUWVBFIGh0bWw+DQo8aHRtbCBsYW5nPSJlbiI+DQo8aGVhZD4NCjxtZXRhIGNoYXJzZXQ9InV0Zi04IiAvPg0KPG1ldGEgbmFtZT0idmlld3BvcnQiIGNvbnRlbnQ9IndpZHRoPWRldmljZS13aWR0aCxpbml0aWFsLXNjYWxlPTEiIC8+DQo8dGl0bGU+U3dpdGNoIEdhbWVzIOKAlCBSZXY2PC90aXRsZT4NCjxzdHlsZT4NCjpyb290ey0tYmc6I2Y0ZjZmODstLXBhbmVsOiNmZmY7LS1tdXRlZDojNmI3MjgwOy0tcHJpbWFyeTojMDM2NmQ2Oy0tYWNjZW50OiNmZjhhMDA7LS1kYW5nZXI6I2VmNDQ0NDstLXJhZGl1czoxMHB4fQ0KKntib3gtc2l6aW5nOmJvcmRlci1ib3h9DQpodG1sLGJvZHl7aGVpZ2h0OjEwMCU7bWFyZ2luOjA7Zm9udC1mYW1pbHk6SW50ZXIsU2Vnb2UgVUksQXJpYWwsc2Fucy1zZXJpZjtiYWNrZ3JvdW5kOnZhcigtLWJnKTtjb2xvcjojMTExfQ0KLmhlYWRlcntwb3NpdGlvbjpmaXhlZDt0b3A6MDtyaWdodDowO2xlZnQ6MDtoZWlnaHQ6NzZweDtiYWNrZ3JvdW5kOnZhcigtLXBhbmVsKTtkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2dhcDoxMnB4O3BhZGRpbmc6MTBweCAxNHB4O2JvcmRlci1ib3R0b206MXB4IHNvbGlkICNlNmVlZjY7ei1pbmRleDo2MH0NCi5oZWFkZXIgLnNlYXJjaHtmbGV4OjE7bWluLXdpZHRoOjE2MHB4fQ0KLmhlYWRlciBpbnB1dC5zZWFyY2gsIC5oZWFkZXIgYnV0dG9ue2hlaWdodDo0NHB4O2JvcmRlci1yYWRpdXM6MTBweDtib3JkZXI6MXB4IHNvbGlkICNlNmVlZjY7cGFkZGluZzowIDEycHh9DQouaGVhZGVyIC5hY3Rpb25ze2Rpc3BsYXk6ZmxleDtnYXA6OHB4O2FsaWduLWl0ZW1zOmNlbnRlcn0NCi5oZWFkZXIgLnVwbG9hZHtiYWNrZ3JvdW5kOnZhcigtLWFjY2VudCk7Y29sb3I6I2ZmZjtib3JkZXI6bm9uZTtwYWRkaW5nOjEwcHggMTZweDtib3JkZXItcmFkaXVzOjEwcHg7Zm9udC13ZWlnaHQ6NjAwfQ0KLmNvbnRhaW5lcntkaXNwbGF5OmdyaWQ7Z3JpZC10ZW1wbGF0ZS1jb2x1bW5zOjFmciAzODBweDtnYXA6MTJweDtwYWRkaW5nOmNhbGMoNzZweCArIDEycHgpIDEycHggMTZweDtoZWlnaHQ6Y2FsYygxMDB2aCl9DQoubGVmdFBhbmV7YmFja2dyb3VuZDp2YXIoLS1wYW5lbCk7Ym9yZGVyLXJhZGl1czoxMnB4O3BhZGRpbmc6MTJweDtvdmVyZmxvdzphdXRvO2JveC1zaGFkb3c6MCA2cHggMThweCByZ2JhKDEyLDE4LDMwLDAuMDQpfQ0KLnJpZ2h0UGFuZXtiYWNrZ3JvdW5kOnZhcigtLXBhbmVsKTtib3JkZXItcmFkaXVzOjEycHg7cGFkZGluZzoxMnB4O292ZXJmbG93OmhpZGRlbjtib3gtc2hhZG93OjAgNnB4IDE4cHggcmdiYSgxMiwxOCwzMCwwLjA0KTtkaXNwbGF5OmZsZXg7ZmxleC1kaXJlY3Rpb246Y29sdW1ufQ0KLml0ZW17ZGlzcGxheTpmbGV4O2p1c3RpZnktY29udGVudDpzcGFjZS1iZXR3ZWVuO2FsaWduLWl0ZW1zOmNlbnRlcjtwYWRkaW5nOjEwcHg7Ym9yZGVyLXJhZGl1czo4cHg7Ym9yZGVyOjFweCBzb2xpZCB0cmFuc3BhcmVudDtjdXJzb3I6cG9pbnRlcjttYXJnaW4tYm90dG9tOjhweH0NCi5pdGVtOmhvdmVye2JhY2tncm91bmQ6I2ZiZmRmZn0NCi5pdGVtLnNlbGVjdGVke2JhY2tncm91bmQ6IzBiM2I2Njtjb2xvcjojZmZmfQ0KDQoubWV0YXtmb250LXNpemU6MTJweDtjb2xvcjp2YXIoLS1tdXRlZCl9DQouY29udHJvbHN7ZGlzcGxheTpncmlkO2dyaWQtdGVtcGxhdGUtY29sdW1uczoxZnIgMWZyO2dhcDo4cHg7bWFyZ2luLWJvdHRvbTo4cHh9DQouY29udHJvbHMgLmZ1bGx7Z3JpZC1jb2x1bW46MSAvIC0xfQ0KLmZpbGVuYW1lLXByZXZpZXd7Z3JpZC1jb2x1bW46MSAvIC0xO3BhZGRpbmc6OHB4O2JhY2tncm91bmQ6I2Y5ZmFmYjtib3JkZXI6MXB4IHNvbGlkICNlNWU3ZWI7Ym9yZGVyLXJhZGl1czo4cHg7Zm9udC1mYW1pbHk6bW9ub3NwYWNlO292ZXJmbG93LXg6YXV0bzt3aGl0ZS1zcGFjZTpub3dyYXB9DQouaW5mb1Jvd3tkaXNwbGF5OmZsZXg7anVzdGlmeS1jb250ZW50OnNwYWNlLWJldHdlZW47YWxpZ24taXRlbXM6Y2VudGVyO3BhZGRpbmc6MTBweDtib3JkZXItcmFkaXVzOjhweDtiYWNrZ3JvdW5kOiNmZmY7bWFyZ2luLXRvcDo4cHg7Ym9yZGVyOjFweCBzb2xpZCAjZjFmNWY5fQ0KLmJ0bntwYWRkaW5nOjhweCAxMnB4O2JvcmRlci1yYWRpdXM6OHB4O2JvcmRlcjpub25lO2JhY2tncm91bmQ6dmFyKC0tcHJpbWFyeSk7Y29sb3I6I2ZmZjtjdXJzb3I6cG9pbnRlcn0NCi5idG4uZ2hvc3R7YmFja2dyb3VuZDp0cmFuc3BhcmVudDtjb2xvcjp2YXIoLS1wcmltYXJ5KTtib3JkZXI6MXB4IHNvbGlkICNlNmVlZjZ9DQouc21hbGx7Zm9udC1zaXplOjEzcHg7Y29sb3I6dmFyKC0tbXV0ZWQpfQ0KLm92ZXJsYXl7cG9zaXRpb246Zml4ZWQ7aW5zZXQ6MDtiYWNrZ3JvdW5kOnJnYmEoMjE1LDI0MCwyNTAsLjk1KTtkaXNwbGF5Om5vbmU7ZmxleC1kaXJlY3Rpb246Y29sdW1uO3otaW5kZXg6MTUwfQ0KLm92ZXJsYXkgLmhlYWR7ZGlzcGxheTpmbGV4O2p1c3RpZnktY29udGVudDpzcGFjZS1iZXR3ZWVuO3BhZGRpbmc6MTJweDtiYWNrZ3JvdW5kOnJnYmEoMCwwLDAsMC41NSk7YWxpZ24taXRlbXM6Y2VudGVyfQ0KLm92ZXJsYXkgLmJvZHl7cGFkZGluZzoxMnB4O292ZXJmbG93OmF1dG87ZmxleDoxfQ0KLm92ZXJsYXkgLnJvd3tkaXNwbGF5OmZsZXg7anVzdGlmeS1jb250ZW50OnNwYWNlLWJldHdlZW47YWxpZ24taXRlbXM6Y2VudGVyO3BhZGRpbmc6OHB4O2JvcmRlci1ib3R0b206MXB4IHNvbGlkIHJnYmEoMjU1LDI1NSwyNTUsMC4wNil9DQoNCi8qIEhpZ2hsaWdodCByZWNlbnRseSBtb3ZlZCBpdGVtICovDQoub3ZlcmxheSAucm93LmhpZ2hsaWdodCB7DQogIGJhY2tncm91bmQ6ICNmZmYzY2Q7ICAgLyogc29mdCB5ZWxsb3cgKi8NCiAgdHJhbnNpdGlvbjogYmFja2dyb3VuZCAwLjZzIGVhc2U7DQp9DQojZmlsZXNNb2RhbDo6YmFja2Ryb3Agew0KICBiYWNrZ3JvdW5kOiByZ2JhKDAsMCwwLDAuMyk7DQp9DQovKiBSZWQgd2FybmluZyBmb3Igb3ZlcmZsb3cgKi8NCiN0b3RhbHMuZXhjZWVkZWQgew0KICBjb2xvcjogI2MwMDsNCiAgZm9udC13ZWlnaHQ6IGJvbGQ7DQp9DQouYnRuLmRhbmdlciB7DQogIGJhY2tncm91bmQ6ICNjMDA7DQogIGNvbG9yOiAjZmZmOw0KfQ0KDQoNCi5vdmVybGF5IGJ1dHRvbi5pY29ue3BhZGRpbmc6NnB4IDhweDtib3JkZXItcmFkaXVzOjZweDtib3JkZXI6bm9uZTtjdXJzb3I6cG9pbnRlcjttYXJnaW4tbGVmdDo2cHh9DQoub3ZlcmxheSBidXR0b24udXAsIC5vdmVybGF5IGJ1dHRvbi5kb3due2JhY2tncm91bmQ6I2ZmZjtjb2xvcjojMTExfQ0KLm92ZXJsYXkgYnV0dG9uLnJlbW92ZXtiYWNrZ3JvdW5kOnZhcigtLWRhbmdlcik7Y29sb3I6I2ZmZn0NCi5mb290ZXJDb250cm9sc3tkaXNwbGF5OmZsZXg7Z2FwOjhweDtmbGV4LXdyYXA6d3JhcDthbGlnbi1pdGVtczpjZW50ZXJ9DQpAbWVkaWEgKG1heC13aWR0aDo5MDBweCl7DQogIC5jb250YWluZXJ7Z3JpZC10ZW1wbGF0ZS1jb2x1bW5zOjFmcjsgcGFkZGluZy10b3A6Y2FsYyg3NnB4ICsgOHB4KX0NCiAgLnJpZ2h0UGFuZXtvcmRlcjotMX0NCiAgLmhlYWRlcntwYWRkaW5nOjhweH0NCn0NCg0KLyogRGVza3RvcCBzaWRlLWJ5LXNpZGUgc2VsZWN0ZWQgcGFuZWwgKi8NCi5zZWxlY3RlZC1wYW5lbCB7DQogIG1hcmdpbi10b3A6IDEycHg7DQogIGJhY2tncm91bmQ6IHZhcigtLXBhbmVsKTsNCiAgYm9yZGVyOiAxcHggc29saWQgI2U2ZWVmNjsNCiAgYm9yZGVyLXJhZGl1czogMTBweDsNCiAgYm94LXNoYWRvdzogMCA0cHggMTJweCByZ2JhKDAsMCwwLDAuMDUpOw0KICBkaXNwbGF5OiBmbGV4Ow0KICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOw0KICBoZWlnaHQ6IDEwMCU7DQogIG92ZXJmbG93OiBoaWRkZW47DQp9DQoNCi5zZWxlY3RlZC1wYW5lbCAuaGVhZCB7DQogIGJhY2tncm91bmQ6ICNmOGZhZmM7DQogIHBhZGRpbmc6IDhweCAxMnB4Ow0KICBib3JkZXItYm90dG9tOiAxcHggc29saWQgI2U2ZWVmNjsNCiAgZm9udC13ZWlnaHQ6IDYwMDsNCiAgZm9udC1zaXplOiAxNHB4Ow0KfQ0KDQouc2VsZWN0ZWQtcGFuZWwgLmJvZHkgew0KICBmbGV4OiAxOw0KICBvdmVyZmxvdy15OiBhdXRvOw0KICBmb250LXNpemU6IDEzcHg7DQogIHBhZGRpbmc6IDhweCAxMnB4Ow0KfQ0KDQovKiBIaWRlIG9uIG1vYmlsZSAqLw0KQG1lZGlhIChtYXgtd2lkdGg6IDkwMHB4KSB7DQogIC5zZWxlY3RlZC1wYW5lbCB7DQogICAgZGlzcGxheTogbm9uZSAhaW1wb3J0YW50Ow0KICB9DQp9DQovKiAtLS0gQ29uZmlndXJhdGlvbiBzZWN0aW9uIHZpc2liaWxpdHkgLS0tICovDQouY29uZmlnLXNlY3Rpb24gew0KICB0cmFuc2l0aW9uOiBhbGwgMC4yNXMgZWFzZTsNCn0NCg0KLm1vYmlsZS1vbmx5IHsNCiAgZGlzcGxheTogbm9uZTsNCn0NCg0KLyogTW9iaWxlIGJlaGF2aW9yICovDQpAbWVkaWEgKG1heC13aWR0aDogOTAwcHgpIHsNCiAgLm1vYmlsZS1vbmx5IHsNCiAgICBkaXNwbGF5OiBibG9jazsNCiAgfQ0KDQogIC5jb25maWctc2VjdGlvbiB7DQogICAgZGlzcGxheTogbm9uZTsNCiAgfQ0KDQogIC5jb25maWctc2VjdGlvbi5hY3RpdmUgew0KICAgIGRpc3BsYXk6IGJsb2NrOw0KICB9DQp9DQoNCjwvc3R5bGU+DQo8L2hlYWQ+DQo8Ym9keT4NCiAgPGRpdiBjbGFzcz0iaGVhZGVyIj4NCiAgICA8IS0tPGJ1dHRvbiBpZD0icmVsb2FkQnRuIiBjbGFzcz0iYnRuIGRhbmdlciI+UmVsb2FkPC9idXR0b24+LS0+DQoJPGlucHV0IGlkPSJzZWFyY2giIGNsYXNzPSJzZWFyY2giIHR5cGU9InRleHQiIHBsYWNlaG9sZGVyPSJTZWFyY2ggZ2FtZXMuLi4iPg0KCSAgICA8ZGl2IGNsYXNzPSJhY3Rpb25zIj4NCiAgICAgIDxidXR0b24gaWQ9InVwbG9hZEJ0biIgY2xhc3M9ImJ0biBnaG9zdCI+VXBsb2FkPC9idXR0b24+DQogICAgICA8YnV0dG9uIGlkPSJzaG93U2VsZWN0ZWQiIGNsYXNzPSJidG4gZ2hvc3QiPlNob3c8L2J1dHRvbj4NCgkgIDxidXR0b24gaWQ9InNvcnRMYXRlc3QiIGNsYXNzPSJidG4gZ2hvc3QiPlNvcnQ8L2J1dHRvbj4NCiAgICAgIDxidXR0b24gaWQ9ImNsZWFyU2VhcmNoIiBjbGFzcz0iYnRuIGdob3N0Ij48L2J1dHRvbj4NCiAgICA8L2Rpdj4NCiAgPC9kaXY+DQoNCiAgPGRpdiBjbGFzcz0iY29udGFpbmVyIj4NCiAgICA8c2VjdGlvbiBjbGFzcz0ibGVmdFBhbmUiIGlkPSJsZWZ0UGFuZSIgYXJpYS1sYWJlbD0iR2FtZSBsaXN0Ij4NCiAgICAgIDwhLS0gbGlzdCBpbmplY3RlZCAtLT4NCiAgICA8L3NlY3Rpb24+DQoNCiAgICA8YXNpZGUgY2xhc3M9InJpZ2h0UGFuZSI+DQo8IS0tIENvbmZpZyBzZWN0aW9uIC0tPg0KPGJ1dHRvbiBpZD0idG9nZ2xlQ29uZmlnIiBjbGFzcz0iYnRuIGdob3N0IG1vYmlsZS1vbmx5IiBzdHlsZT0ibWFyZ2luLWJvdHRvbTo4cHg7Ij5IaWRlIENvbmZpZ3VyYXRpb248L2J1dHRvbj4NCg0KPGRpdiBpZD0iY29uZmlnU2VjdGlvbiIgY2xhc3M9ImNvbmZpZy1zZWN0aW9uIj4NCiAgICAgIDxkaXYgY2xhc3M9ImNvbnRyb2xzIj4NCiAgICAgICAgPGlucHV0IGlkPSJjdXN0b21lciIgY2xhc3M9ImZ1bGwiIHR5cGU9InRleHQiIHBsYWNlaG9sZGVyPSJDdXN0b21lciBuYW1lICh1c2UgdW5kZXJzY29yZXMpIj4NCiAgICAgICAgPGRpdiBjbGFzcz0iZmlsZW5hbWUtcHJldmlldyIgaWQ9ImZpbGVuYW1lUHJldmlldyI+RmlsZW5hbWUgcHJldmlldyB3aWxsIGFwcGVhciBoZXJl4oCmPC9kaXY+DQoJCQ0KICAgICAgICA8ZGl2Pg0KICAgICAgICAgIDxsYWJlbCBjbGFzcz0ic21hbGwiPkNvbnNvbGU8L2xhYmVsPg0KICAgICAgICAgIDxzZWxlY3QgaWQ9ImNvbnNvbGUiIGFyaWEtbGFiZWw9IkNvbnNvbGUgdHlwZSI+DQogICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJ2MSI+djE8L29wdGlvbj4NCiAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9InYyIj52Mjwvb3B0aW9uPg0KICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0ibGl0ZSI+bGl0ZTwvb3B0aW9uPg0KICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0ib2xlZCI+b2xlZDwvb3B0aW9uPg0KICAgICAgICAgIDwvc2VsZWN0Pg0KICAgICAgICA8L2Rpdj4NCiAgICAgICAgPGRpdj4NCiAgICAgICAgICA8bGFiZWwgY2xhc3M9InNtYWxsIj5TRCBDYXJkIChHQik8L2xhYmVsPg0KICAgICAgICAgIDxzZWxlY3QgaWQ9InNkIiBhcmlhLWxhYmVsPSJTRCBjYXJkIj4NCiAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9IjEyOCI+MTI4PC9vcHRpb24+DQogICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSIyNTYiPjI1Njwvb3B0aW9uPg0KICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iNTEyIj41MTI8L29wdGlvbj4NCiAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9IjEwMjQiPjEwMjQ8L29wdGlvbj4NCiAgICAgICAgICA8L3NlbGVjdD4NCiAgICAgICAgPC9kaXY+DQoNCiAgICAgICAgPGRpdj4NCiAgICAgICAgICA8bGFiZWwgY2xhc3M9InNtYWxsIj5BbmRyb2lkIChHQik8L2xhYmVsPg0KICAgICAgICAgIDxzZWxlY3QgaWQ9ImFuZHJvaWQiIGFyaWEtbGFiZWw9ImFuZHJvaWQgc2l6ZSI+DQogICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSIwIj4wPC9vcHRpb24+DQogICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSIxNiI+MTY8L29wdGlvbj4NCiAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9IjMyIj4zMjwvb3B0aW9uPg0KICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iNjQiPjY0PC9vcHRpb24+DQogICAgICAgICAgPC9zZWxlY3Q+DQogICAgICAgIDwvZGl2Pg0KICAgICAgICA8ZGl2Pg0KICAgICAgICAgIDxsYWJlbCBjbGFzcz0ic21hbGwiPkxpbnV4IChHQik8L2xhYmVsPg0KICAgICAgICAgIDxzZWxlY3QgaWQ9ImxpbnV4IiBhcmlhLWxhYmVsPSJsaW51eCBzaXplIj4NCiAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9IjAiPjA8L29wdGlvbj4NCiAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9IjE2Ij4xNjwvb3B0aW9uPg0KICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iMzIiPjMyPC9vcHRpb24+DQogICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSI2NCI+NjQ8L29wdGlvbj4NCiAgICAgICAgICA8L3NlbGVjdD4NCiAgICAgICAgPC9kaXY+DQogICAgICA8L2Rpdj4NCg0KICAgICAgPGRpdiBjbGFzcz0iaW5mb1JvdyIgc3R5bGU9Im1hcmdpbi10b3A6OHB4OyI+DQogICAgICAgIDxkaXY+DQogICAgICAgICAgPGRpdiBjbGFzcz0ic21hbGwiPlNwYWNlIGZvciBnYW1lczwvZGl2Pg0KICAgICAgICAgIDxkaXY+PHN0cm9uZyBpZD0ic3BhY2UiPjA8L3N0cm9uZz4gR0I8L2Rpdj4NCiAgICAgICAgPC9kaXY+DQogICAgICAgIDxkaXY+DQogICAgICAgICAgPGRpdiBjbGFzcz0ic21hbGwiPlNlbGVjdGVkIHNpemU8L2Rpdj4NCiAgICAgICAgICA8ZGl2PjxzdHJvbmcgaWQ9InNlbGVjdGVkU2l6ZSI+MC4wMDwvc3Ryb25nPiBHQjwvZGl2Pg0KICAgICAgICA8L2Rpdj4NCiAgICAgIDwvZGl2Pg0KDQogICAgICA8ZGl2IGNsYXNzPSJpbmZvUm93IiBzdHlsZT0ibWFyZ2luLXRvcDo4cHg7Ij4NCiAgICAgICAgPGRpdj4NCiAgICAgICAgICA8ZGl2IGNsYXNzPSJzbWFsbCI+SW5zdGFsbCBlc3RpbWF0ZTwvZGl2Pg0KICAgICAgICAgIDxkaXY+PHNwYW4gaWQ9Imluc3RhbGxFc3RpbWF0ZSI+MGggMG08L3NwYW4+PC9kaXY+DQogICAgICAgIDwvZGl2Pg0KICAgICAgICA8ZGl2Pg0KICAgICAgICAgIDxkaXYgY2xhc3M9InNtYWxsIj5TZWxlY3RlZDwvZGl2Pg0KICAgICAgICAgIDxkaXY+PHNwYW4gaWQ9ImNvdW50Ij4wPC9zcGFuPiBnYW1lczwvZGl2Pg0KICAgICAgICA8L2Rpdj4NCiAgICAgIDwvZGl2Pg0KDQogIDwvZGl2Pg0KICAgICAgPGRpdiBzdHlsZT0ibWFyZ2luLXRvcDoxMnB4O2Rpc3BsYXk6ZmxleDtnYXA6OHB4O2FsaWduLWl0ZW1zOmNlbnRlcjsiPg0KICAgICAgICA8YnV0dG9uIGlkPSJjb3B5TGluayIgY2xhc3M9ImJ0biI+Q29weSBMaW5rPC9idXR0b24+DQoJCTxpbnB1dCBpZD0ic2hhcmVhYmxlIiB0eXBlPSJ0ZXh0IiBwbGFjZWhvbGRlcj0iVXBsb2FkZWQgZmlsZSBsaW5rIiBzdHlsZT0iZmxleDoxO3BhZGRpbmc6OHB4O2JvcmRlci1yYWRpdXM6OHB4O2JvcmRlcjoxcHggc29saWQgI2U2ZWVmNiIgcmVhZG9ubHk+DQogICAgICAgIDxidXR0b24gaWQ9InNhdmVCdG4iIGNsYXNzPSJidG4iPlNhdmU8L2J1dHRvbj48bGFiZWwgZm9yPSJmaWxlSW4iIHN0eWxlPSINCiAgYmFja2dyb3VuZDojM2E2ZGYwOw0KICBjb2xvcjojZmZmOw0KICBwYWRkaW5nOjVweCA1cHg7DQogIGJvcmRlci1yYWRpdXM6M3B4Ow0KICBmb250LXNpemU6MTJweDsNCiAgY3Vyc29yOnBvaW50ZXI7DQogIGZvbnQtZmFtaWx5OnNhbnMtc2VyaWY7DQogIGRpc3BsYXk6aW5saW5lLWJsb2NrOw0KIj4NCiAgT3Blbg0KPC9sYWJlbD4NCjxpbnB1dCBpZD0iZmlsZUluIiB0eXBlPSJmaWxlIiBhY2NlcHQ9Ii5DTElfUFJNWiIgc3R5bGU9ImRpc3BsYXk6bm9uZTsiPg0KICAgICAgPC9kaXY+DQoNCiAgICAgIDxkaXYgc3R5bGU9Im1hcmdpbi10b3A6MTJweDtkaXNwbGF5OmZsZXg7Z2FwOjhweDthbGlnbi1pdGVtczpjZW50ZXI7ZmxleC13cmFwOndyYXAiPg0KICAgICAgICANCg0KICAgICAgICA8YnV0dG9uIGlkPSJhZG1pbkV4cG9ydCIgY2xhc3M9ImJ0biBnaG9zdCI+RXhwb3J0IEFkbWluPC9idXR0b24+DQogICAgICAgIDxidXR0b24gaWQ9ImJpbkxpc3QiIGNsYXNzPSJidG4gZ2hvc3QiPlVwbG9hZHM8L2J1dHRvbj4NCgkJPGRpdiBpZD0iZmlsZUxpc3RDb250YWluZXIiIHN0eWxlPSJkaXNwbGF5Om5vbmU7Ij4NCgkJICA8ZGl2IGlkPSJiaW5GaWxlTGlzdCI+PC9kaXY+DQoJCTwvZGl2Pg0KICAgICAgPC9kaXY+DQoNCiAgICAgIDxkaXYgc3R5bGU9Im1hcmdpbi10b3A6MTJweDtmbGV4OjE7b3ZlcmZsb3c6YXV0bztmb250LXNpemU6MTNweDtjb2xvcjp2YXIoLS1tdXRlZCkiPg0KICAgICAgICA8IS0tIHNtYWxsIGhlbHAgLyBzdGF0dXMgYXJlYSAtLT4NCiAgICAgICAgPGRpdiBpZD0ic3RhdHVzIj5SZWFkeTwvZGl2Pg0KICAgICAgPC9kaXY+DQo8IS0tIEFsd2F5cy12aXNpYmxlIFNlbGVjdGVkIFBhbmVsIChkZXNrdG9wIG9ubHkpIC0tPg0KPGRpdiBpZD0ic2VsZWN0ZWRQYW5lbCIgY2xhc3M9InNlbGVjdGVkLXBhbmVsIj4NCiAgPCEtLTxkaXYgY2xhc3M9ImhlYWQiPg0KICAgIDxzdHJvbmc+U2VsZWN0ZWQgVGl0bGVzICg8c3BhbiBpZD0ic2VsZWN0ZWRQYW5lbENvdW50Ij4wPC9zcGFuPik8L3N0cm9uZz4NCiAgPC9kaXY+LS0+DQogIDxkaXYgY2xhc3M9ImJvZHkiIGlkPSJzZWxlY3RlZFBhbmVsQm9keSI+PC9kaXY+DQo8L2Rpdj4NCiAgICA8L2FzaWRlPg0KICA8L2Rpdj4NCg0KICA8IS0tIFNlbGVjdGVkIG92ZXJsYXkgLS0+DQogIDxkaXYgY2xhc3M9Im92ZXJsYXkiIGlkPSJvdmVybGF5Ij4NCiAgICA8ZGl2IGNsYXNzPSJoZWFkIj48ZGl2PjxzdHJvbmc+U2VsZWN0ZWQgVGl0bGVzPC9zdHJvbmc+IOKAlCA8c3BhbiBpZD0ib3ZlcmxheUNvdW50Ij4wPC9zcGFuPjwvZGl2PjxkaXY+PGJ1dHRvbiBpZD0iY2xvc2VPdmVybGF5IiBjbGFzcz0iYnRuIGdob3N0Ij5DbG9zZTwvYnV0dG9uPjwvZGl2PjwvZGl2Pg0KICAgIDxkaXYgY2xhc3M9ImJvZHkiIGlkPSJvdmVybGF5Qm9keSI+PC9kaXY+DQogIDwvZGl2Pg0KPGRpdiBpZD0iZmlsZXNNb2RhbCIgc3R5bGU9ImRpc3BsYXk6bm9uZTtwb3NpdGlvbjpmaXhlZDt0b3A6NTAlO2xlZnQ6NTAlO3RyYW5zZm9ybTp0cmFuc2xhdGUoLTUwJSwtNTAlKTsNCiAgYmFja2dyb3VuZDojZmZmO3BhZGRpbmc6MTZweDtib3JkZXItcmFkaXVzOjEwcHg7Ym94LXNoYWRvdzowIDZweCAxOHB4IHJnYmEoMCwwLDAsMC4yNSk7ei1pbmRleDoyMDA7DQogIG1heC13aWR0aDo0MjBweDt3aWR0aDo5MCU7bWF4LWhlaWdodDo3MHZoO292ZXJmbG93OmF1dG87Zm9udC1zaXplOjEzcHgiPg0KPC9kaXY+DQo8c2NyaXB0Pg0KLy8gUmV2NiDigJQgbWVyZ2VkIFVJICsgZnVsbCBmZWF0dXJlcw0KY29uc3Qgc3RhdGUgPSB7IGl0ZW1zOiBbXSwgc2VsZWN0ZWQ6IFtdLCB4bWw6IG51bGwsIGxhc3RVcGxvYWQ6MCB9Ow0KY29uc3QgbGVmdFBhbmUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbGVmdFBhbmUnKTsNCmNvbnN0IG92ZXJsYXkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3ZlcmxheScpOw0KY29uc3Qgb3ZlcmxheUJvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3ZlcmxheUJvZHknKTsNCmNvbnN0IGlzTW9iaWxlID0gL01vYml8QW5kcm9pZHxpUGhvbmV8aVBhZHxpUG9kL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KTsNCmNvbnN0IGlzTG9jYWwgPSBmYWxzZTsNCg0KZnVuY3Rpb24gZGV0ZWN0RW52aXJvbm1lbnQoKSB7DQogIGNvbnN0IHVhID0gbmF2aWdhdG9yLnVzZXJBZ2VudCB8fCBuYXZpZ2F0b3IudmVuZG9yIHx8IHdpbmRvdy5vcGVyYTsNCiAgY29uc3QgaXNNZXNzZW5nZXIgPSAvRkJBTnxGQkFWfEZCX0lBQnxNZXNzZW5nZXIvaS50ZXN0KHVhKTsNCiAgY29uc3QgaXNJbnN0YWdyYW0gPSAvSW5zdGFncmFtL2kudGVzdCh1YSk7DQogIGNvbnN0IGlzRmFjZWJvb2tBcHAgPSAvRkJBTnxGQkFWL2kudGVzdCh1YSkgJiYgIWlzTWVzc2VuZ2VyICYmICFpc0luc3RhZ3JhbTsNCiAgY29uc3QgaXNXZWJWaWV3ID0gL1xid3ZcYi8udGVzdCh1YSkgfHwgKHdpbmRvdy5uYXZpZ2F0b3Iuc3RhbmRhbG9uZSA9PT0gZmFsc2UpOw0KDQogIGNvbnN0IGVudiA9IHsNCiAgICBpc01lc3NlbmdlciwNCiAgICBpc0luc3RhZ3JhbSwNCiAgICBpc0ZhY2Vib29rQXBwLA0KICAgIGlzV2ViVmlldw0KICB9Ow0KDQogIGlmIChpc01lc3NlbmdlciB8fCBpc0luc3RhZ3JhbSB8fCBpc1dlYlZpZXcpIHsNCiAgICBzaG93QmFubmVyKCJNZXNzZW5nZXIgb3IgaW4tYXBwIHdlYnZpZXcgZGV0ZWN0ZWQuXG5UaGlzIHBhZ2UgaXMgYmVzdCB1c2VkIG9uIGEgZnVsbCBtb2JpbGUgYnJvd3NlciBvciBkZXNrdG9wIGJyb3dzZXIuIGJ1dCBpdCB3aWxsIHByb2JhYmx5IHdvcmsgYW55d2F5Iik7DQoJc2hvd0Jhbm5lcigiSG93IHRvIHVzZTogXG5cbjEuIEVudGVyIHlvdXIgbmFtZSwgXG4yLiBTZWxlY3QgeW91ciBkZXZpY2UgbW9kZWwgXG4gT2xlZCxMaXRlLFYxXFYyLCBcblxuIDMuIFNlbGVjdCB5b3VyIFNEQ0FSRCBTaXplXG40LiBQcmVzcyBVcGxvYWQgXG4gNS4gQ2hvb3NlIHlvdXIgZ2FtZXNcblxuNi4gUHJlc3MgdXBsb2FkLCBTZW5kIHRoZSBnZW5lcmF0ZWQgTGluayB0byBvdXIgY2hhdCBjb252ZXJzYXRpb24iKTsNCiAgfQ0KCXNob3dCYW5uZXIoIkhvdyB0byB1c2U6IFxuXG4xLiBFbnRlciB5b3VyIG5hbWUsIFxuMi4gU2VsZWN0IHlvdXIgZGV2aWNlIG1vZGVsIFxuIE9sZWQsTGl0ZSxWMVxWMiwgXG5cbiAzLiBTZWxlY3QgeW91ciBTRENBUkQgU2l6ZVxuNC4gUHJlc3MgVXBsb2FkIFxuIDUuIENob29zZSB5b3VyIGdhbWVzXG5cbjYuIFByZXNzIHVwbG9hZCwgU2VuZCB0aGUgZ2VuZXJhdGVkIExpbmsgdG8gb3VyIGNoYXQgY29udmVyc2F0aW9uIik7DQogIHJldHVybiBlbnY7DQp9DQoNCmZ1bmN0aW9uIHNob3dCYW5uZXIobWVzc2FnZSkgew0KICBjb25zdCBiYW5uZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsNCiAgYmFubmVyLmlubmVyVGV4dCA9IG1lc3NhZ2U7DQogIGJhbm5lci5zdHlsZS5wb3NpdGlvbiA9ICJmaXhlZCI7DQogIGJhbm5lci5zdHlsZS50b3AgPSAiMzAlIjsNCiAgYmFubmVyLnN0eWxlLmxlZnQgPSAiNDAlIjsNCiAgYmFubmVyLnN0eWxlLnRyYW5zZm9ybSA9ICJ0cmFuc2xhdGVYKC01MCUpIjsNCiAgYmFubmVyLnN0eWxlLmJhY2tncm91bmQgPSAicmdiYSgwLDAsMCwwLjgpIjsNCiAgYmFubmVyLnN0eWxlLmNvbG9yID0gIiNmZmYiOw0KICBiYW5uZXIuc3R5bGUucGFkZGluZyA9ICIxOHB4IDE4cHgiOw0KICBiYW5uZXIuc3R5bGUuYm9yZGVyUmFkaXVzID0gIjE2cHgiOw0KICBiYW5uZXIuc3R5bGUuZm9udFNpemUgPSAiMjJweCI7DQogIGJhbm5lci5zdHlsZS56SW5kZXggPSAiOTk5OSI7DQogIGJhbm5lci5zdHlsZS5ib3hTaGFkb3cgPSAiMCAycHggNnB4IHJnYmEoMCwwLDAsMC4zKSI7DQogIGJhbm5lci5zdHlsZS50cmFuc2l0aW9uID0gIm9wYWNpdHkgMC41cyBlYXNlIjsNCiAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChiYW5uZXIpOw0KDQogIHNldFRpbWVvdXQoKCkgPT4gYmFubmVyLnN0eWxlLm9wYWNpdHkgPSAiMCIsIDQwMDApOw0KICBzZXRUaW1lb3V0KCgpID0+IGJhbm5lci5yZW1vdmUoKSwgMTAwMDApOw0KfQ0KDQpjb25zdCBNSU5fREVMQVkgPSAxMDAwOw0KbGV0IG5vdyA9IERhdGUubm93KCk7DQpsZXQgbGFzdEV4cG9ydFRpbWUgPSBEYXRlLm5vdygpOw0KLy8gdXRpbHMNCmNvbnN0ICQgPSBpZD0+ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpOw0KZnVuY3Rpb24gZXNjKHMpeyByZXR1cm4gKHN8fCcnKS5yZXBsYWNlKC8mL2csJyZhbXA7JykucmVwbGFjZSgvPC9nLCcmbHQ7JykucmVwbGFjZSgvPi9nLCcmZ3Q7Jyk7IH0NCmZ1bmN0aW9uIHRvYXN0KG1zZyl7ICQoJ3N0YXR1cycpLnRleHRDb250ZW50ID0gbXNnOyBzZXRUaW1lb3V0KCgpPT57IGlmKCQoJ3N0YXR1cycpLnRleHRDb250ZW50ID09PSBtc2cpICQoJ3N0YXR1cycpLnRleHRDb250ZW50ID0gJ1JlYWR5JzsgfSwgMjUwMCk7IH0NCg0KLy8gc2l6ZSBoZWxwZXJzDQpmdW5jdGlvbiBwYXJzZVNpemVUZXh0KHMpeyBpZighcykgcmV0dXJuIDA7IGNvbnN0IG0gPSAoJycrcykubWF0Y2goLyhbXGRcLl0rKVxzKihHaUJ8TWlCfEtpQnxHQnxNQnxLQnxCKS9pKTsgaWYoIW0pIHJldHVybiAwOyBjb25zdCB2PXBhcnNlRmxvYXQobVsxXSk7IGNvbnN0IHU9bVsyXS50b1VwcGVyQ2FzZSgpOyBpZih1PT09J0InKSByZXR1cm4gdjsgaWYodT09PSdLQid8fHU9PT0nS0lCJykgcmV0dXJuIHYqMTAyNDsgaWYodT09PSdNQid8fHU9PT0nTUlCJykgcmV0dXJuIHYqMTAyNCoxMDI0OyByZXR1cm4gdioxMDI0KjEwMjQqMTAyNDsgfQ0KZnVuY3Rpb24gYnl0ZXNUb0dCKGIpeyByZXR1cm4gYi8oMTAyNCoxMDI0KjEwMjQpOyB9DQoNCi8vIGxvYWQgWE1MIChzdXBwb3J0IDxmb2xkZXI+IGFuZCA8Z2FtZT4pDQphc3luYyBmdW5jdGlvbiBsb2FkWE1MKCl7DQogIHRyeXsNCiAgICBjb25zdCB0eHQgPSBhd2FpdCBmZXRjaCgnc3dpdGNoZ2FtZXMueG1sJykudGhlbihyPT5yLnRleHQoKSk7DQogICAgY29uc3QgeG1sID0gbmV3IERPTVBhcnNlcigpLnBhcnNlRnJvbVN0cmluZyh0eHQsJ2FwcGxpY2F0aW9uL3htbCcpOw0KICAgIHN0YXRlLnhtbCA9IHhtbDsNCiAgICAvLyBwcmVmZXIgZm9sZGVyDQpsZXQgaXRlbXMgPSBBcnJheS5mcm9tKHhtbC5xdWVyeVNlbGVjdG9yQWxsKCdmb2xkZXInKSkNCiAgLmZpbHRlcihmID0+IGYuZ2V0QXR0cmlidXRlKCduYW1lJykgIT09ICdOU1AgMjAyMScpICAvLyDwn5GIIHNraXANCiAgLm1hcChmID0+ICh7DQogICAgbmFtZTogZi5nZXRBdHRyaWJ1dGUoJ25hbWUnKSwNCiAgICBzY29yZTogZi5nZXRBdHRyaWJ1dGUoJ3Njb3JlJykgfHwgJzAnLA0KICAgIHNpemU6IGYuZ2V0QXR0cmlidXRlKCdzaXplJykgfHwgJzAgR2lCJywNCiAgICBkYXRlOiBmLmdldEF0dHJpYnV0ZSgnZGF0ZUNyZWF0ZWQnKSB8fCAnJywNCiAgICBmaWxlczogQXJyYXkuZnJvbShmLnF1ZXJ5U2VsZWN0b3JBbGwoJ2ZpbGUnKSkubWFwKHggPT4geC5nZXRBdHRyaWJ1dGUoJ25hbWUnKSkNCiAgfSkpOw0KDQoNCg0KICAgIGlmKGl0ZW1zLmxlbmd0aD09PTApeyAvLyBmYWxsYmFjayB0byBnYW1lIG5vZGVzDQogICAgICBjb25zdCBnYW1lcyA9IEFycmF5LmZyb20oeG1sLmdldEVsZW1lbnRzQnlUYWdOYW1lKCdnYW1lJykpOw0KICAgICAgaXRlbXMgPSBnYW1lcy5tYXAoZz0+KHsgbmFtZTogZy5nZXRFbGVtZW50c0J5VGFnTmFtZSgndGl0bGUnKVswXT8udGV4dENvbnRlbnQgfHwgJ1VudGl0bGVkJywgc2l6ZTogZy5nZXRFbGVtZW50c0J5VGFnTmFtZSgnc2l6ZScpWzBdPy50ZXh0Q29udGVudCB8fCAnMCBNQicsIGZpbGVzOiBbXSB9KSk7DQogICAgfQ0KICAgIHN0YXRlLml0ZW1zID0gaXRlbXM7DQogICAgcmVuZGVyTGlzdChpdGVtcyk7DQogIH1jYXRjaChlKXsgY29uc29sZS5lcnJvcihlKTsgbGVmdFBhbmUuaW5uZXJIVE1MID0gJzxkaXYgc3R5bGU9ImNvbG9yOiNiOTFjMWM7cGFkZGluZzoxMnB4Ij5GYWlsZWQgdG8gbG9hZCBzd2l0Y2hnYW1lcy54bWwg4oCUIGNoZWNrIHBhdGgvQ09SUzwvZGl2Pic7IH0NCn0NCg0KLy8gcmVuZGVyIGxlZnQgbGlzdCBhbmQgcHJlc2VydmUgc2VsZWN0aW9uIGhpZ2hsaWdodHMNCmZ1bmN0aW9uIHJlbmRlckxpc3QobGlzdCl7IGxlZnRQYW5lLmlubmVySFRNTCA9ICcnOyBpZighbGlzdHx8IWxpc3QubGVuZ3RoKXsgbGVmdFBhbmUuaW5uZXJIVE1MID0gJzxkaXYgY2xhc3M9Im1ldGEiPk5vIGl0ZW1zIGZvdW5kPC9kaXY+JzsgcmV0dXJuOyB9DQogIGxpc3QuZm9yRWFjaChpdGVtPT57DQogICAgY29uc3Qgcm93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7IHJvdy5jbGFzc05hbWU9J2l0ZW0nOyByb3cuZGF0YXNldC5uYW1lID0gaXRlbS5uYW1lOyByb3cuZGF0YXNldC5zaXplID0gaXRlbS5zaXplOw0KICAgIHJvdy5pbm5lckhUTUwgPSBgICA8ZGl2Pg0KICAgIDxidXR0b24gY2xhc3M9ImJ0biBnaG9zdCIgc3R5bGU9InBhZGRpbmc6MnB4IDZweDtmb250LXNpemU6MTFweCINCiAgICAgIG9uY2xpY2s9ImFsZXJ0KCdjbGlja2VkJyk7IGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpOyBzaG93RmlsZXMoJyR7ZXNjKGl0ZW0ubmFtZSl9JywgJHtKU09OLnN0cmluZ2lmeShpdGVtLmZpbGVzKX0sICcke2VzYyhpdGVtLnNpemUpfScpIj4/PC9idXR0b24+DQogICAgPHN0cm9uZz4ke2VzYyhpdGVtLm5hbWUpfTwvc3Ryb25nPg0KICAgIDxkaXYgY2xhc3M9J21ldGEnPiR7aXRlbS5zY29yZSA/ICdTY29yZTogJytlc2MoaXRlbS5zY29yZSkgOiAnJ30gOyAke2l0ZW0uZGF0ZSA/ICdNb2RpZmllZDogJytlc2MoaXRlbS5kYXRlKSA6ICcnfTwvZGl2Pg0KICA8L2Rpdj4NCiAgPGRpdiBjbGFzcz0nbWV0YSc+JHtlc2MoaXRlbS5zaXplKX08L2Rpdj5gOw0KDQogICAgaWYoc3RhdGUuc2VsZWN0ZWQuc29tZShzPT5zLm5hbWU9PT1pdGVtLm5hbWUpKSByb3cuY2xhc3NMaXN0LmFkZCgnc2VsZWN0ZWQnKTsNCiAgICAvLyBhbHQtY2xpY2sgc2hvd3MgZmlsZXMNCiAgICByb3cuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXYpPT57IGlmKGV2LmFsdEtleSl7IHNob3dGaWxlcyhpdGVtLm5hbWUsIGl0ZW0uZmlsZXMgfHwgW10sIGl0ZW0uc2l6ZSk7IHJldHVybjsgfSB0b2dnbGVTZWxlY3QoaXRlbSwgcm93KTsgfSk7DQogICAgcm93LmFkZEV2ZW50TGlzdGVuZXIoJ2RibGNsaWNrJywgKCk9PiBzaG93RmlsZXMoaXRlbS5uYW1lLCBpdGVtLmZpbGVzfHxbXSwgaXRlbS5zaXplKSk7DQogICAgbGVmdFBhbmUuYXBwZW5kQ2hpbGQocm93KTsNCiAgfSk7DQp9DQoNCmZ1bmN0aW9uIHRvZ2dsZVNlbGVjdChpdGVtLCByb3dFbCl7IGNvbnN0IGlkeCA9IHN0YXRlLnNlbGVjdGVkLmZpbmRJbmRleChzPT5zLm5hbWU9PT1pdGVtLm5hbWUpOyBpZihpZHg+PTApeyBzdGF0ZS5zZWxlY3RlZC5zcGxpY2UoaWR4LDEpOyBpZihyb3dFbCkgcm93RWwuY2xhc3NMaXN0LnJlbW92ZSgnc2VsZWN0ZWQnKTsgZWxzZSB7IGNvbnN0IHIgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5pdGVtJykpLmZpbmQoeD0+eC5kYXRhc2V0Lm5hbWU9PT1pdGVtLm5hbWUpOyBpZihyKSByLmNsYXNzTGlzdC5yZW1vdmUoJ3NlbGVjdGVkJyk7IH0gfSBlbHNlIHsgc3RhdGUuc2VsZWN0ZWQucHVzaCh7IG5hbWU6aXRlbS5uYW1lLCBzaXplOml0ZW0uc2l6ZSB9KTsgaWYocm93RWwpIHJvd0VsLmNsYXNzTGlzdC5hZGQoJ3NlbGVjdGVkJyk7IH0NCiAgdXBkYXRlVG90YWxzKCk7IHJlbmRlck92ZXJsYXkoKTsgfQ0KDQpmdW5jdGlvbiByZW5kZXJPdmVybGF5KCkgew0KICBvdmVybGF5Qm9keS5pbm5lckhUTUwgPSAnJzsNCiAgc3RhdGUuc2VsZWN0ZWQuZm9yRWFjaCgocyxpKT0+ew0KICAgIGNvbnN0IHJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOw0KICAgIHJvdy5jbGFzc05hbWU9J3Jvdyc7DQogICAgcm93LmlubmVySFRNTCA9IGANCiAgICAgIDxkaXY+DQogICAgICAgIDxzdHJvbmc+JHtpKzF9LiAke2VzYyhzLm5hbWUpfTwvc3Ryb25nPg0KICAgICAgICA8ZGl2IGNsYXNzPSdtZXRhJz4ke2VzYyhzLnNpemUpfTwvZGl2Pg0KICAgICAgPC9kaXY+DQogICAgICA8ZGl2Pg0KICAgICAgICA8YnV0dG9uIGNsYXNzPSdpY29uIHVwJz51PC9idXR0b24+DQogICAgICAgIDxidXR0b24gY2xhc3M9J2ljb24gZG93bic+ZDwvYnV0dG9uPg0KICAgICAgICA8YnV0dG9uIGNsYXNzPSdpY29uIHJlbW92ZSc+eDwvYnV0dG9uPg0KICAgICAgPC9kaXY+YDsNCg0KICAgIC8vIFVwDQogICAgcm93LnF1ZXJ5U2VsZWN0b3IoJy51cCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCk9PnsNCiAgICAgIGlmKGk+MCl7DQogICAgICAgIFtzdGF0ZS5zZWxlY3RlZFtpLTFdLCBzdGF0ZS5zZWxlY3RlZFtpXV0gPSBbc3RhdGUuc2VsZWN0ZWRbaV0sIHN0YXRlLnNlbGVjdGVkW2ktMV1dOw0KICAgICAgICByZW5kZXJPdmVybGF5KCk7DQogICAgICAgIHJlbmRlckxpc3Qoc3RhdGUuaXRlbXMpOw0KICAgICAgICB1cGRhdGVUb3RhbHMoKTsNCiAgICAgICAgLy8gaGlnaGxpZ2h0IG5ldyBwb3NpdGlvbg0KICAgICAgICBvdmVybGF5Qm9keS5jaGlsZHJlbltpLTFdLmNsYXNzTGlzdC5hZGQoJ2hpZ2hsaWdodCcpOw0KICAgICAgfQ0KICAgIH0pOw0KDQogICAgLy8gRG93bg0KICAgIHJvdy5xdWVyeVNlbGVjdG9yKCcuZG93bicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCk9PnsNCiAgICAgIGlmKGk8c3RhdGUuc2VsZWN0ZWQubGVuZ3RoLTEpew0KICAgICAgICBbc3RhdGUuc2VsZWN0ZWRbaSsxXSwgc3RhdGUuc2VsZWN0ZWRbaV1dID0gW3N0YXRlLnNlbGVjdGVkW2ldLCBzdGF0ZS5zZWxlY3RlZFtpKzFdXTsNCiAgICAgICAgcmVuZGVyT3ZlcmxheSgpOw0KICAgICAgICByZW5kZXJMaXN0KHN0YXRlLml0ZW1zKTsNCiAgICAgICAgdXBkYXRlVG90YWxzKCk7DQogICAgICAgIC8vIGhpZ2hsaWdodCBuZXcgcG9zaXRpb24NCiAgICAgICAgb3ZlcmxheUJvZHkuY2hpbGRyZW5baSsxXS5jbGFzc0xpc3QuYWRkKCdoaWdobGlnaHQnKTsNCiAgICAgIH0NCiAgICB9KTsNCg0KICAgIC8vIFJlbW92ZQ0KICAgIHJvdy5xdWVyeVNlbGVjdG9yKCcucmVtb3ZlJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKT0+ew0KICAgICAgY29uc3QgcmVtb3ZlZCA9IHN0YXRlLnNlbGVjdGVkLnNwbGljZShpLDEpWzBdOw0KICAgICAgY29uc3QgbGVmdFJvdyA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLml0ZW0nKSkNCiAgICAgICAgLmZpbmQoeD0+eC5kYXRhc2V0Lm5hbWU9PT1yZW1vdmVkLm5hbWUpOw0KICAgICAgaWYobGVmdFJvdykgbGVmdFJvdy5jbGFzc0xpc3QucmVtb3ZlKCdzZWxlY3RlZCcpOw0KICAgICAgcmVuZGVyT3ZlcmxheSgpOw0KICAgICAgcmVuZGVyTGlzdChzdGF0ZS5pdGVtcyk7DQogICAgICB1cGRhdGVUb3RhbHMoKTsNCiAgICB9KTsNCg0KICAgIG92ZXJsYXlCb2R5LmFwcGVuZENoaWxkKHJvdyk7DQogIH0pOw0KICAkKCdvdmVybGF5Q291bnQnKS50ZXh0Q29udGVudCA9IHN0YXRlLnNlbGVjdGVkLmxlbmd0aDsNCg0KcmVuZGVyU2VsZWN0ZWRQYW5lbCgpOw0KDQp9DQoNCg0KLy8gc2hvdy9oaWRlIG92ZXJsYXkNCiQoJ3Nob3dTZWxlY3RlZCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCk9Pnsgb3ZlcmxheS5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnOyByZW5kZXJPdmVybGF5KCk7IH0pOw0KJCgnY2xvc2VPdmVybGF5JykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKT0+IG92ZXJsYXkuc3R5bGUuZGlzcGxheSA9ICdub25lJyk7DQoNCi8vIGZpbGVzIG1vZGFsDQpsZXQgY3VycmVudE1vZGFsID0gbnVsbDsgLy8gdHJhY2sgb3BlbiBtb2RhbA0KZnVuY3Rpb24gc2hvd0ZpbGVzKG5hbWUsIGZpbGVzLCBzaXplKSB7DQogIGlmICghZmlsZXMgfHwgIWZpbGVzLmxlbmd0aCkgew0KICAgIGFsZXJ0KGBObyBmaWxlcyBmb3IgJHtuYW1lfWApOw0KICAgIHJldHVybjsNCiAgfQ0KDQoNCiAgLy8gY2xvc2UgZXhpc3RpbmcgbW9kYWwgaWYgYW55DQogIGNvbnN0IG1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpbGVzTW9kYWwnKTsNCiAgbW9kYWwuaW5uZXJIVE1MID0gJyc7IA0KICBtb2RhbC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCiAgDQogIC8vIGhlYWRlcg0KICBjb25zdCBoZWFkZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsNCiAgaGVhZGVyLmlubmVySFRNTCA9IGA8c3Ryb25nPiR7ZXNjKG5hbWUpfTwvc3Ryb25nPjxicj48c3BhbiBjbGFzcz0ibWV0YSI+U2l6ZTogJHtlc2Moc2l6ZSl9IOKAlCAke2ZpbGVzLmxlbmd0aH0gZmlsZXM8L3NwYW4+YDsNCiAgbW9kYWwuYXBwZW5kQ2hpbGQoaGVhZGVyKTsNCg0KICAvLyBmaWxlIGxpc3Qgd2l0aCBwYWdpbmcNCiAgY29uc3QgbGlzdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOw0KICBsaXN0LnN0eWxlLm1hcmdpblRvcCA9ICc4cHgnOw0KICBtb2RhbC5hcHBlbmRDaGlsZChsaXN0KTsNCg0KICBsZXQgaW5kZXggPSAwOw0KICBjb25zdCBiYXRjaCA9IDIwOyAvLyBzaG93IDIwIGF0IGEgdGltZQ0KICBmdW5jdGlvbiBsb2FkTW9yZSgpIHsNCiAgICBjb25zdCBuZXh0ID0gZmlsZXMuc2xpY2UoaW5kZXgsIGluZGV4K2JhdGNoKTsNCiAgICBsaXN0LmlubmVySFRNTCArPSBuZXh0Lm1hcChmPT5lc2MoZikpLmpvaW4oJzxicj4nKTsNCiAgICBpbmRleCArPSBiYXRjaDsNCiAgICBpZiAoaW5kZXggPj0gZmlsZXMubGVuZ3RoKSB7DQogICAgICBtb3JlQnRuLnJlbW92ZSgpOw0KICAgIH0NCiAgfQ0KICANCg0KICAvLyBNb3JlIGJ1dHRvbg0KICBjb25zdCBtb3JlQnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7DQogIG1vcmVCdG4udGV4dENvbnRlbnQgPSAnTW9yZSc7DQogIG1vcmVCdG4uY2xhc3NOYW1lID0gJ2J0biBnaG9zdCc7DQogIG1vcmVCdG4uc3R5bGUubWFyZ2luVG9wID0gJzEwcHgnOw0KICBtb3JlQnRuLm9uY2xpY2sgPSBsb2FkTW9yZTsNCiAgbW9kYWwuYXBwZW5kQ2hpbGQobW9yZUJ0bik7DQoNCiAgLy8gQ2xvc2UgYnV0dG9uDQogIGNvbnN0IGNsb3NlQnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7DQogIGNsb3NlQnRuLnRleHRDb250ZW50ID0gJ0Nsb3NlJzsNCiAgY2xvc2VCdG4uY2xhc3NOYW1lID0gJ2J0bic7DQogIGNsb3NlQnRuLnN0eWxlLm1hcmdpblRvcCA9ICcxMHB4JzsNCiAgY2xvc2VCdG4ub25jbGljayA9ICgpPT57IG1vZGFsLnN0eWxlLmRpc3BsYXk9J25vbmUnOyBtb2RhbC5pbm5lckhUTUw9Jyc7IH07DQogIG1vZGFsLmFwcGVuZENoaWxkKGNsb3NlQnRuKTsNCmxvYWRNb3JlKCk7DQp9DQoNCg0KLy8gdG90YWxzLCBpbnN0YWxsIGVzdGltYXRlLCBmaWxlbmFtZSBwcmV2aWV3DQpmdW5jdGlvbiB1cGRhdGVUb3RhbHMoKSB7DQogIGNvbnN0IHRvdGFsQnl0ZXMgPSBzdGF0ZS5zZWxlY3RlZC5yZWR1Y2UoKHN1bSwgcykgPT4gc3VtICsgcGFyc2VTaXplVGV4dChzLnNpemUpLCAwKTsNCiAgY29uc3QgZ2IgPSBieXRlc1RvR0IodG90YWxCeXRlcyk7DQogICQoJ3NlbGVjdGVkU2l6ZScpLnRleHRDb250ZW50ID0gZ2IudG9GaXhlZCgyKTsNCg0KICBjb25zdCBibG9hdGVkID0gdG90YWxCeXRlcyAqIDEuMjsNCiAgY29uc3Qgc3BlZWQgPSAxNCAqIDEwMjQgKiAxMDI0Ow0KICBjb25zdCBzZWNzID0gTWF0aC5jZWlsKGJsb2F0ZWQgLyBzcGVlZCk7DQogICQoJ2luc3RhbGxFc3RpbWF0ZScpLnRleHRDb250ZW50ID0gYCR7TWF0aC5mbG9vcihzZWNzLzM2MDApfWggJHtNYXRoLmZsb29yKChzZWNzJTM2MDApLzYwKX1tYDsNCg0KICAkKCdjb3VudCcpLnRleHRDb250ZW50ID0gc3RhdGUuc2VsZWN0ZWQubGVuZ3RoOw0KDQogIC8vIHNwYWNlIGNhbGN1bGF0aW9uDQogIGNvbnN0IGNvbnNvbGVWYWwgPSAkKCdjb25zb2xlJykudmFsdWU7DQogIGNvbnN0IHNkVmFsID0gTnVtYmVyKCQoJ3NkJykudmFsdWUpOw0KICBjb25zdCBhbmRyb2lkID0gTnVtYmVyKCQoJ2FuZHJvaWQnKS52YWx1ZSk7DQogIGNvbnN0IGxpbnV4ID0gTnVtYmVyKCQoJ2xpbnV4JykudmFsdWUpOw0KICBjb25zdCBqdmZpbGUgPSAxOw0KICBjb25zdCBlbXUgPSBjb25zb2xlVmFsID09PSAnb2xlZCcgPyA2NCA6IDMyOw0KICBjb25zdCBidWZmYSA9IE1hdGguZmxvb3IoZW11IC8gMyk7DQogIGNvbnN0IHRvdGFsUmVzZXJ2ZWQgPSBlbXUgKyBhbmRyb2lkICsgbGludXggKyBqdmZpbGUgKyBidWZmYTsNCiAgY29uc3QgZXh0cmEgPSBNYXRoLmZsb29yKGVtdSAvIDIpOw0KICBjb25zdCBzcGFjZUZvckdhbWVzID0gKHNkVmFsIC0gdG90YWxSZXNlcnZlZCkgKyBleHRyYTsNCg0KICAkKCdzcGFjZScpLnRleHRDb250ZW50ID0gaXNGaW5pdGUoc3BhY2VGb3JHYW1lcykgPyBzcGFjZUZvckdhbWVzIDogMDsNCg0KICAvLyBoaWdobGlnaHQgd2FybmluZyBpZiBleGNlZWRlZA0KICBpZiAoZ2IgPiBzcGFjZUZvckdhbWVzKSB7DQogICAgJCgnc2VsZWN0ZWRTaXplJykuc3R5bGUuY29sb3IgPSAnI2MwMCc7DQogICAgJCgnc2VsZWN0ZWRTaXplJykuc3R5bGUuZm9udFdlaWdodCA9ICdib2xkJzsNCiAgfSBlbHNlIHsNCiAgICAkKCdzZWxlY3RlZFNpemUnKS5zdHlsZS5jb2xvciA9ICcnOw0KICAgICQoJ3NlbGVjdGVkU2l6ZScpLnN0eWxlLmZvbnRXZWlnaHQgPSAnJzsNCiAgfQ0KDQogIC8vIGZpbGVuYW1lIHByZXZpZXcNCiAgdXBkYXRlRmlsZW5hbWVQcmV2aWV3KCk7DQp9DQoNCg0KDQoNCg0KZnVuY3Rpb24gdXBkYXRlRmlsZW5hbWVQcmV2aWV3KCl7IGNvbnN0IGN1c3RvbWVyID0gKCAkKCdjdXN0b21lcicpLnZhbHVlIHx8ICdjdXN0b21lcicpLnRyaW0oKS5yZXBsYWNlKC9bXmEtekEtWjAtOV0vZywnXycpLnRvTG93ZXJDYXNlKCk7IGNvbnN0IGNvbnNvbGVUb2tlbiA9ICQoJ2NvbnNvbGUnKS52YWx1ZSB8fCAndjEnOyBjb25zdCBzZFRva2VuID0gJ3NkJyArICgkKCdzZCcpLnZhbHVlIHx8ICcwJyk7IGNvbnN0IGRyb2lkID0gJ2Ryb2lkJyArICgkKCdhbmRyb2lkJykudmFsdWUgfHwgJzAnKTsgY29uc3QgbGluID0gJ2xpbicgKyAoJCgnbGludXgnKS52YWx1ZSB8fCAnMCcpOyBjb25zdCBub3cgPSBuZXcgRGF0ZSgpOyBjb25zdCBzdGFtcCA9IG5vdy5nZXRGdWxsWWVhcigpLnRvU3RyaW5nKCkgKyBTdHJpbmcobm93LmdldE1vbnRoKCkrMSkucGFkU3RhcnQoMiwnMCcpICsgU3RyaW5nKG5vdy5nZXREYXRlKCkpLnBhZFN0YXJ0KDIsJzAnKSArIFN0cmluZyhub3cuZ2V0SG91cnMoKSkucGFkU3RhcnQoMiwnMCcpICsgU3RyaW5nKG5vdy5nZXRNaW51dGVzKCkpLnBhZFN0YXJ0KDIsJzAnKSArIFN0cmluZyhub3cuZ2V0U2Vjb25kcygpKS5wYWRTdGFydCgyLCcwJyk7ICQoJ2ZpbGVuYW1lUHJldmlldycpLnRleHRDb250ZW50ID0gYCR7Y3VzdG9tZXJ9XyR7Y29uc29sZVRva2VufV8ke3NkVG9rZW59XyR7ZHJvaWR9XyR7bGlufV8ke3N0YW1wfS5DTElfUFJNWmA7IH0NCg0KLy8gcGFyc2Ugc2l6ZSBzdHJpbmdzIHVzZWQgYnkgb3JpZ2luYWwgeG1sIChlLmcuICIxLjIgR2lCIiBvciAiNjIwIE1CIikNCmZ1bmN0aW9uIHBhcnNlU2l6ZVRleHQodHh0KXsgaWYoIXR4dCkgcmV0dXJuIDA7IGNvbnN0IG0gPSAoJycrdHh0KS5tYXRjaCgvKFtcZFwuXSspXHMqKEdpQnxNaUJ8S2lCfEdCfE1CfEtCfEIpL2kpOyBpZighbSkgcmV0dXJuIDA7IGNvbnN0IHYgPSBwYXJzZUZsb2F0KG1bMV0pOyBjb25zdCB1ID0gbVsyXS50b1VwcGVyQ2FzZSgpOyBpZih1PT09J0InKSByZXR1cm4gdjsgaWYodT09PSdLQid8fHU9PT0nS0lCJykgcmV0dXJuIHYqMTAyNDsgaWYodT09PSdNQid8fHU9PT0nTUlCJykgcmV0dXJuIHYqMTAyNCoxMDI0OyByZXR1cm4gdioxMDI0KjEwMjQqMTAyNDsgfQ0KDQovLyB3aXJlIGNvbnRyb2xzDQokKCdzZWFyY2gnKS5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIGRlYm91bmNlKChlKT0+eyBjb25zdCBxPShlLnRhcmdldC52YWx1ZXx8JycpLnRvTG93ZXJDYXNlKCk7IHJlbmRlckxpc3Qoc3RhdGUuaXRlbXMuZmlsdGVyKGl0PT4gKGl0Lm5hbWV8fCcnKS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHEpKSk7IH0sMTgwKSk7DQokKCdjbGVhclNlYXJjaCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCk9PnsgJCgnc2VhcmNoJykudmFsdWU9Jyc7IHJlbmRlckxpc3Qoc3RhdGUuaXRlbXMpOyAkKCdzZWFyY2gnKS5mb2N1cygpOyB9KTsNClsnY3VzdG9tZXInLCdjb25zb2xlJywnc2QnLCdhbmRyb2lkJywnbGludXgnXS5mb3JFYWNoKGlkPT57IGNvbnN0IGVsPSQoaWQpOyBpZihlbCl7IGVsLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKCk9PiB1cGRhdGVGaWxlbmFtZVByZXZpZXcoKSk7IGVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsICgpPT4gdXBkYXRlVG90YWxzKCkpOyB9fSk7DQoNCi8vIGltcG9ydCAuQ0xJX1BSTVogKHJlc3RvcmUgc2VsZWN0aW9ucyArIHBhcnNlIGZpbGVuYW1lKQ0KJCgnZmlsZUluJykuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgKGV2KT0+ew0KICBjb25zdCBmID0gZXYudGFyZ2V0LmZpbGVzWzBdOyBpZighZikgcmV0dXJuOyBjb25zdCBjZmcgPSBwYXJzZUZpbGVuYW1lVG9Db25maWcoZi5uYW1lKTsgaWYoY2ZnKXsgJCgnY3VzdG9tZXInKS52YWx1ZSA9IGNmZy5jdXN0b21lcjsgLy8gc2V0IGNvbnNvbGUgaWYgYXZhaWxhYmxlDQogICAgQXJyYXkuZnJvbSgkKCdjb25zb2xlJykub3B0aW9ucykuZm9yRWFjaChvPT57IGlmKG8udmFsdWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhjZmcuY29uc29sZVRva2VuKSkgby5zZWxlY3RlZCA9IHRydWU7IH0pOyBpZigvXnNkXGQrJC8udGVzdChjZmcuc2RUb2tlbikpICQoJ3NkJykudmFsdWUgPSBOdW1iZXIoY2ZnLnNkVG9rZW4ucmVwbGFjZSgvXEQvZywnJykpOyBpZigvXmRyb2lkXGQrJC8udGVzdChjZmcuZHJvaWRUb2tlbikpICQoJ2FuZHJvaWQnKS52YWx1ZSA9IE51bWJlcihjZmcuZHJvaWRUb2tlbi5yZXBsYWNlKC9cRC9nLCcnKSk7IGlmKC9ebGluXGQrJC8udGVzdChjZmcubGluVG9rZW4pKSAkKCdsaW51eCcpLnZhbHVlID0gTnVtYmVyKGNmZy5saW5Ub2tlbi5yZXBsYWNlKC9cRC9nLCcnKSk7IHVwZGF0ZUZpbGVuYW1lUHJldmlldygpOyB1cGRhdGVUb3RhbHMoKTsgfQ0KICBjb25zdCByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpOyByZWFkZXIub25sb2FkID0gKGUpPT57IGNvbnN0IGxpbmVzID0gZS50YXJnZXQucmVzdWx0LnNwbGl0KCdcbicpLm1hcChzPT5zLnRyaW0oKSkuZmlsdGVyKEJvb2xlYW4pOyAvLyBjbGVhciBleGlzdGluZyBzZWxlY3Rpb24NCiAgICBzdGF0ZS5zZWxlY3RlZD1bXTsgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLml0ZW0nKS5mb3JFYWNoKGk9PmkuY2xhc3NMaXN0LnJlbW92ZSgnc2VsZWN0ZWQnKSk7DQogICAgbGluZXMuZm9yRWFjaCh0aXRsZT0+eyBjb25zdCBsZWZ0ID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuaXRlbScpKS5maW5kKGk9PmkuZGF0YXNldC5uYW1lPT09dGl0bGUpOyBpZihsZWZ0KXsgbGVmdC5jbGFzc0xpc3QuYWRkKCdzZWxlY3RlZCcpOyBzdGF0ZS5zZWxlY3RlZC5wdXNoKHsgbmFtZTpsZWZ0LmRhdGFzZXQubmFtZSwgc2l6ZTpsZWZ0LmRhdGFzZXQuc2l6ZSB9KTsgfSBlbHNlIHsgY29uc3QgbWF5YmUgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5pdGVtJykpLmZpbmQoaT0+aS5kYXRhc2V0Lm5hbWUgJiYgaS5kYXRhc2V0Lm5hbWUudG9Mb3dlckNhc2UoKT09PXRpdGxlLnRvTG93ZXJDYXNlKCkpOyBpZihtYXliZSl7IG1heWJlLmNsYXNzTGlzdC5hZGQoJ3NlbGVjdGVkJyk7IHN0YXRlLnNlbGVjdGVkLnB1c2goeyBuYW1lOm1heWJlLmRhdGFzZXQubmFtZSwgc2l6ZTptYXliZS5kYXRhc2V0LnNpemUgfSk7IH0gfSB9KTsgdXBkYXRlVG90YWxzKCk7IHJlbmRlck92ZXJsYXkoKTsgfTsNCiAgcmVhZGVyLnJlYWRBc1RleHQoZik7DQp9KTsNCg0KLy8gZXhwb3J0IGNsaWVudCAoZG93bmxvYWQgbGlzdCkNCiQoJ3NhdmVCdG4nKT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKT0+ew0KDQogIG5vdyA9IERhdGUubm93KCk7DQogIGlmIChub3cgLSBsYXN0RXhwb3J0VGltZSA8IE1JTl9ERUxBWSkgew0KICAgIHRvYXN0KCdQbGVhc2Ugd2FpdCBiZWZvcmUgZXhwb3J0aW5nIGFnYWluJyk7DQogICAgYWxlcnQoJ1BsZWFzZSB3YWl0IGJlZm9yZSBleHBvcnRpbmcgYWdhaW4nKTsNCiAgICByZXR1cm47DQogIH0NCiAgbGFzdEV4cG9ydFRpbWUgPSBub3c7DQoNCiAgaWYoc3RhdGUuc2VsZWN0ZWQubGVuZ3RoPT09MCl7IGFsZXJ0KCdObyBpdGVtcyBzZWxlY3RlZCcpOyByZXR1cm47IH0NCiAgY29uc3QgY3VzdCA9ICgkKCdjdXN0b21lcicpLnZhbHVlfHwnJykudHJpbSgpOyBpZighY3VzdCl7IGFsZXJ0KCdDdXN0b21lciBuYW1lIHJlcXVpcmVkJyk7IHJldHVybjsgfQ0KICBjb25zdCBmaWxlbmFtZSA9ICQoJ2ZpbGVuYW1lUHJldmlldycpLnRleHRDb250ZW50IHx8ICdsaXN0LkNMSV9QUk1aJzsNCiAgY29uc3QgYmxvYiA9IG5ldyBCbG9iKFtzdGF0ZS5zZWxlY3RlZC5tYXAocz0+cy5uYW1lKS5qb2luKCdcbicpXSwgeyB0eXBlOid0ZXh0L3BsYWluJyB9KTsgY29uc3QgYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTsgYS5ocmVmID0gVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTsgYS5kb3dubG9hZCA9IGZpbGVuYW1lOyBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGEpOyBhLmNsaWNrKCk7IGEucmVtb3ZlKCk7IFVSTC5yZXZva2VPYmplY3RVUkwoYS5ocmVmKTsgdG9hc3QoJ1NhdmVkIGNsaWVudCBmaWxlJyk7DQp9KTsNCg0KLy8gYWRtaW4gZXhwb3J0IChmdWxsIHBhdGhzKQ0KJCgnYWRtaW5FeHBvcnQnKT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoKT0+ew0KDQogIG5vdyA9IERhdGUubm93KCk7DQogIGlmIChub3cgLSBsYXN0RXhwb3J0VGltZSA8IE1JTl9ERUxBWSkgew0KICAgIHRvYXN0KCdQbGVhc2Ugd2FpdCBiZWZvcmUgZXhwb3J0aW5nIGFnYWluJyk7DQogICAgYWxlcnQoJ1BsZWFzZSB3YWl0IGJlZm9yZSBleHBvcnRpbmcgYWdhaW4nKTsNCiAgICByZXR1cm47DQogIH0NCiAgbGFzdEV4cG9ydFRpbWUgPSBub3c7DQoNCiAgaWYoc3RhdGUuc2VsZWN0ZWQubGVuZ3RoPT09MCl7IGFsZXJ0KCdObyBpdGVtcyBzZWxlY3RlZCcpOyByZXR1cm47IH0NCiAgY29uc3QgY3VzdCA9ICgkKCdjdXN0b21lcicpLnZhbHVlfHwnJykudHJpbSgpOyBpZighY3VzdCl7IGFsZXJ0KCdDJyk7IHJldHVybjsgfQ0KICB0cnl7IGNvbnN0IHhtbHR4dCA9IGF3YWl0IGZldGNoKCdzd2l0Y2hnYW1lcy54bWwnKS50aGVuKHI9PnIudGV4dCgpKTsgY29uc3QgeG1sID0gbmV3IERPTVBhcnNlcigpLnBhcnNlRnJvbVN0cmluZyh4bWx0eHQsJ2FwcGxpY2F0aW9uL3htbCcpOyBsZXQgY29udGVudD0nJzsgc3RhdGUuc2VsZWN0ZWQuZm9yRWFjaChzZWw9PnsgY29uc3QgZm9sZGVyID0gQXJyYXkuZnJvbSh4bWwucXVlcnlTZWxlY3RvckFsbCgnZm9sZGVyJykpLmZpbmQoZj0+Zi5nZXRBdHRyaWJ1dGUoJ25hbWUnKT09PXNlbC5uYW1lKTsgaWYoZm9sZGVyKXsgY29uc3QgYmFzZSA9ICdLOlxcTlNQIDIwMjFcXCc7IGZvbGRlci5xdWVyeVNlbGVjdG9yQWxsKCdmaWxlJykuZm9yRWFjaChmaWxlPT4gY29udGVudCArPSBgJHtiYXNlfSR7Zm9sZGVyLmdldEF0dHJpYnV0ZSgnbmFtZScpfVxcJHtmaWxlLmdldEF0dHJpYnV0ZSgnbmFtZScpfVxuYCk7IH0gfSk7IGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7IGNvbnN0IHN0YW1wID0gYCR7bm93LmdldEZ1bGxZZWFyKCl9JHtTdHJpbmcobm93LmdldE1vbnRoKCkrMSkucGFkU3RhcnQoMiwnMCcpfSR7U3RyaW5nKG5vdy5nZXREYXRlKCkpLnBhZFN0YXJ0KDIsJzAnKX1fJHtTdHJpbmcobm93LmdldEhvdXJzKCkpLnBhZFN0YXJ0KDIsJzAnKX0ke1N0cmluZyhub3cuZ2V0TWludXRlcygpKS5wYWRTdGFydCgyLCcwJyl9YDsgY29uc3QgZm5hbWUgPSBgJHsoY3VzdHx8J2N1c3RvbWVyJykucmVwbGFjZSgvW15hLXpBLVowLTldL2csJ18nKX1fJHtzdGFtcH0uUFJNWmA7IGNvbnN0IGJsb2IgPSBuZXcgQmxvYihbY29udGVudF0sIHsgdHlwZTondGV4dC9wbGFpbicgfSk7IGNvbnN0IGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7IGEuaHJlZiA9IFVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYik7IGEuZG93bmxvYWQgPSBmbmFtZTsgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChhKTsgYS5jbGljaygpOyBhLnJlbW92ZSgpOyBVUkwucmV2b2tlT2JqZWN0VVJMKGEuaHJlZik7IHRvYXN0KCdBZG1pbiBleHBvcnQgcmVhZHknKTsgfWNhdGNoKGUpeyBjb25zb2xlLmVycm9yKGUpOyB0b2FzdCgnQWRtaW4gZXhwb3J0IGZhaWxlZCcpOyB9DQp9KTsNCg0KLy8gdXBsb2FkIGxvZ2ljIChmaWxlYmluIHRoZW4gZ29maWxlKQ0KJCgndXBsb2FkQnRuJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoKT0+ew0KDQogIGlmKHN0YXRlLnNlbGVjdGVkLmxlbmd0aD09PTApeyBhbGVydCgnTm8gaXRlbXMgc2VsZWN0ZWQnKTsgcmV0dXJuOyB9DQogIGNvbnN0IGN1c3QgPSAoJCgnY3VzdG9tZXInKS52YWx1ZXx8JycpLnRyaW0oKTsgaWYoIWN1c3QpeyBhbGVydCgnQ3VzdG9tZXIgcmVxdWlyZWQnKTsgcmV0dXJuOyB9DQogIGlmKCFjb25maXJtKGBVcGxvYWQgbGlzdCBmb3IgJHtjdXN0fT9gKSkgcmV0dXJuOyBjb25zdCBmaWxlbmFtZSA9ICQoJ2ZpbGVuYW1lUHJldmlldycpLnRleHRDb250ZW50IHx8ICdsaXN0LkNMSV9QUk1aJzsgY29uc3QgYmxvYiA9IG5ldyBCbG9iKFtzdGF0ZS5zZWxlY3RlZC5tYXAocz0+cy5uYW1lKS5qb2luKCdcbicpXSwgeyB0eXBlOid0ZXh0L3BsYWluJyB9KTsgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTsgaWYobm93IC0gc3RhdGUubGFzdFVwbG9hZCA8IDE1MDAwKXsgYWxlcnQoJ1BsZWFzZSB3YWl0IDE1IHNlY29uZHMgYmV0d2VlbiB1cGxvYWRzJyk7IHJldHVybjsgfQ0KICB0cnl7IGNvbnN0IGJpbiA9ICd4bGc0a2dnb3piZGdzbnc0JzsgY29uc3QgdXJsID0gYGh0dHBzOi8vZmlsZWJpbi5uZXQvJHtiaW59LyR7ZmlsZW5hbWV9YDsgY29uc3QgciA9IGF3YWl0IGZldGNoKHVybCx7IG1ldGhvZDonUE9TVCcsIGhlYWRlcnM6eyAnQ29udGVudC1UeXBlJzondGV4dC9wbGFpbicgfSwgYm9keTogYmxvYiB9KTsgDQoNCmlmKHIub2sgfHwgci5zdGF0dXM9PT0yMDEpeyBzdGF0ZS5sYXN0VXBsb2FkID0gbm93OyAkKCdzaGFyZWFibGUnKS52YWx1ZSA9IGBodHRwczovL2ZpbGViaW4ubmV0LyR7YmlufS8ke2ZpbGVuYW1lfWA7IHRvYXN0KCdVcGxvYWRlZCB0byBmaWxlYmluJyk7IA0KICAgICAgLy8gIEF1dG8taGlkZSBjb25maWcgYWZ0ZXIgc3VjY2Vzcw0KICAgICAgaWYgKGNvbmZpZ1NlY3Rpb24gJiYgdG9nZ2xlQnRuICYmIGNvbmZpZ1NlY3Rpb24uY2xhc3NMaXN0LmNvbnRhaW5zKCdhY3RpdmUnKSkgew0KICAgICAgICBjb25maWdTZWN0aW9uLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpOw0KICAgICAgICB0b2dnbGVCdG4udGV4dENvbnRlbnQgPSAnU2hvdyBDb25maWd1cmF0aW9uJzsNCiAgICAgIH0NCnJldHVybjsgDQp9IH1jYXRjaChlKXsgY29uc29sZS53YXJuKCdmaWxlYmluIGVycm9yJywgZSk7IH0NCiAgdHJ5eyBjb25zdCBmb3JtID0gbmV3IEZvcm1EYXRhKCk7IGZvcm0uYXBwZW5kKCdmaWxlJywgYmxvYiwgZmlsZW5hbWUpOyBjb25zdCByZXMgPSBhd2FpdCBmZXRjaCgnaHR0cHM6Ly91cGxvYWQuZ29maWxlLmlvL3VwbG9hZEZpbGUnLCB7IG1ldGhvZDonUE9TVCcsIGJvZHk6IGZvcm0gfSk7IGNvbnN0IGogPSBhd2FpdCByZXMuanNvbigpOyBpZihqLnN0YXR1cyA9PT0gJ29rJyl7IHN0YXRlLmxhc3RVcGxvYWQgPSBub3c7ICQoJ3NoYXJlYWJsZScpLnZhbHVlID0gai5kYXRhLmRvd25sb2FkUGFnZTsgdG9hc3QoJ1VwbG9hZGVkIHRvIEdvRmlsZScpOyByZXR1cm47IH0gdG9hc3QoJ1VwbG9hZCBmYWlsZWQnKTsgfWNhdGNoKGUpeyBjb25zb2xlLmVycm9yKGUpOyB0b2FzdCgnVXBsb2FkIGVycm9yJyk7IH0NCn0pOw0KDQovLyBiaW4gbGlzdA0KJCgnYmluTGlzdCcpPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jICgpID0+IHsNCiAgdHJ5IHsNCiAgICBjb25zdCBiaW4gPSAneGxnNGtnZ296YmRnc253NCc7DQogICAgY29uc3QgciA9IGF3YWl0IGZldGNoKGBodHRwczovL2ZpbGViaW4ubmV0LyR7YmlufT9qc29uYCwgew0KICAgICAgaGVhZGVyczogeyAiQWNjZXB0IjogImFwcGxpY2F0aW9uL2pzb24iIH0NCiAgICB9KTsNCiAgICBpZiAoIXIub2spIHsgdG9hc3QoYEZhaWxlZCB0byBmZXRjaCB1cGxvYWRzOiAke3Iuc3RhdHVzVGV4dH1gKTsgcmV0dXJuOyB9DQoNCiAgICBsZXQgajsNCiAgICB0cnkgew0KICAgICAgaiA9IGF3YWl0IHIuanNvbigpOw0KICAgIH0gY2F0Y2ggKGVycikgew0KICAgICAgdG9hc3QoIkZhaWxlZCB0byBwYXJzZSBzZXJ2ZXIgcmVzcG9uc2UiKTsNCiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTsNCiAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICBpZiAoIWouZmlsZXMgfHwgIWouZmlsZXMubGVuZ3RoKSB7IHRvYXN0KCdObyBmaWxlcyBmb3VuZCcpOyByZXR1cm47IH0NCg0KICAgIC8vIHNvcnQgYW5kIHRyaW0NCiAgICBjb25zdCBzb3J0ZWQgPSBqLmZpbGVzLnNvcnQoKGEsYik9PiBuZXcgRGF0ZShiLnVwZGF0ZWRfYXQpIC0gbmV3IERhdGUoYS51cGRhdGVkX2F0KSk7DQogICAgY29uc3QgcmVjZW50ID0gc29ydGVkLnNsaWNlKDAsMTApOw0KDQogICAgbGV0IGh0bWwgPSAnPGJ1dHRvbiBpZD0iY2xvc2VCaW4iPkNsb3NlPC9idXR0b24+PHVsPic7DQogICAgcmVjZW50LmZvckVhY2goZmlsZSA9PiB7DQogICAgICBjb25zdCBmaWxlVXJsID0gYGh0dHBzOi8vZmlsZWJpbi5uZXQvJHtiaW59LyR7ZW5jb2RlVVJJQ29tcG9uZW50KGZpbGUuZmlsZW5hbWUpfWA7DQogICAgICBjb25zdCBhZGRlZERhdGUgPSBuZXcgRGF0ZShmaWxlLnVwZGF0ZWRfYXQpOw0KICAgICAgY29uc3QgZm9ybWF0dGVkRGF0ZSA9IGFkZGVkRGF0ZS50b0lTT1N0cmluZygpLnNsaWNlKDAsMTApLnJlcGxhY2UoLy0vZywnJyk7DQogICAgICBjb25zdCBob3VycyA9IGFkZGVkRGF0ZS5nZXRIb3VycygpOw0KICAgICAgY29uc3QgbWludXRlcyA9IGFkZGVkRGF0ZS5nZXRNaW51dGVzKCkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCcwJyk7DQogICAgICBjb25zdCBhbXBtID0gaG91cnMgPj0gMTIgPyAnUE0nOidBTSc7DQogICAgICBjb25zdCBmb3JtYXR0ZWRUaW1lID0gYCR7aG91cnMgJSAxMiB8fCAxMn06JHttaW51dGVzfSAke2FtcG19YDsNCiAgICAgIGNvbnN0IHN0cmlwcGVkTmFtZSA9IGZpbGUuZmlsZW5hbWUuc3BsaXQoJy4nKS5zbGljZSgwLC0xKS5qb2luKCcuJyk7DQogICAgICBjb25zdCBmaWxlU2l6ZSA9IGZpbGUuYnl0ZXNfcmVhZGFibGUgfHwgJyc7DQogICAgICBodG1sICs9IGA8bGk+PGEgaHJlZj0iJHtmaWxlVXJsfSIgdGFyZ2V0PSJfYmxhbmsiPiR7Zm9ybWF0dGVkRGF0ZX0gJHtmb3JtYXR0ZWRUaW1lfSB8ICR7c3RyaXBwZWROYW1lfSB8ICR7ZmlsZVNpemV9PC9hPjwvbGk+YDsNCiAgICB9KTsNCiAgICBodG1sICs9ICc8L3VsPic7DQoNCiAgICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsZUxpc3RDb250YWluZXInKTsNCiAgICBjb250YWluZXIuaW5uZXJIVE1MID0gaHRtbDsNCiAgICBjb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQoNCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2xvc2VCaW4nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IGNvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnKTsNCiAgfSBjYXRjaCAoZSkgew0KICAgIGNvbnNvbGUuZXJyb3IoZSk7DQogICAgdG9hc3QoJ0Vycm9yIGZldGNoaW5nIHVwbG9hZHMnKTsNCiAgfQ0KfSk7DQoNCg0KLy8gQnVsayBzZWxlY3QgYWxsIHZpc2libGUgc2VhcmNoIHJlc3VsdHMgd2hlbiBwcmVzc2luZyBFbnRlciBpbiBzZWFyY2gNCiQoJ3NlYXJjaCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCAoZXYpID0+IHsNCiAgaWYgKGV2LmtleSA9PT0gJ0VudGVyJykgew0KICAgIGV2LnByZXZlbnREZWZhdWx0KCk7DQogICAgY29uc3QgdmlzaWJsZUl0ZW1zID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuaXRlbScpKQ0KICAgICAgLmZpbHRlcihlbCA9PiBlbC5zdHlsZS5kaXNwbGF5ICE9PSAnbm9uZScpOw0KICAgIGxldCBhZGRlZCA9IDA7DQogICAgdmlzaWJsZUl0ZW1zLmZvckVhY2goZWwgPT4gew0KICAgICAgY29uc3QgbmFtZSA9IGVsLmRhdGFzZXQubmFtZTsNCiAgICAgIGNvbnN0IHNpemUgPSBlbC5kYXRhc2V0LnNpemU7DQogICAgICBpZiAoIXN0YXRlLnNlbGVjdGVkLnNvbWUocyA9PiBzLm5hbWUgPT09IG5hbWUpKSB7DQogICAgICAgIHN0YXRlLnNlbGVjdGVkLnB1c2goeyBuYW1lLCBzaXplIH0pOw0KICAgICAgICBlbC5jbGFzc0xpc3QuYWRkKCdzZWxlY3RlZCcpOw0KICAgICAgICBhZGRlZCsrOw0KICAgICAgfQ0KICAgIH0pOw0KICAgIGlmIChhZGRlZCA+IDApIHsNCiAgICAgIHVwZGF0ZVRvdGFscygpOw0KICAgICAgcmVuZGVyT3ZlcmxheSgpOw0KICAgICAgdG9hc3QoYEFkZGVkICR7YWRkZWR9IGl0ZW1zIGZyb20gc2VhcmNoIHJlc3VsdHNgKTsNCiAgICB9IGVsc2Ugew0KICAgICAgdG9hc3QoJ05vIG5ldyBpdGVtcyB0byBhZGQnKTsNCiAgICB9DQogIH0NCn0pOw0KDQokKCdjb3B5TGluaycpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gew0KICBjb25zdCBsaW5rID0gJCgnc2hhcmVhYmxlJykudmFsdWU7DQogIGlmICghbGluaykgew0KICAgIHRvYXN0KCdOb3RoaW5nIHRvIGNvcHknKTsNCiAgICByZXR1cm47DQogIH0NCiAgbmF2aWdhdG9yLmNsaXBib2FyZC53cml0ZVRleHQobGluaykudGhlbigoKSA9PiB7DQogICAgdG9hc3QoJ0xpbmsgY29waWVkIHRvIGNsaXBib2FyZCcpOw0KICB9KS5jYXRjaCgoKSA9PiB7DQogICAgYWxlcnQoJ0NvcHkgZmFpbGVkLCBwbGVhc2UgY29weSBtYW51YWxseScpOw0KICB9KTsNCn0pOw0KDQovKiQoJ3JlbG9hZEJ0bicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gew0KICBpZiAoY29uZmlybSgnUmVsb2FkIHRoZSBwYWdlPyBBbGwgdW5zYXZlZCBzZWxlY3Rpb25zIHdpbGwgYmUgbG9zdC4nKSkgew0KICAgIGxvY2F0aW9uLnJlbG9hZCgpOw0KICB9DQp9KTsqLw0KDQovLyBmaWxlbmFtZSBwYXJzZSB1c2VkIGluIGltcG9ydA0KZnVuY3Rpb24gcGFyc2VGaWxlbmFtZVRvQ29uZmlnKGZuKXsgY29uc3QgYmFzZSA9IGZuLnJlcGxhY2UoL1wuKENMSV9QUk1afFBSTVp8dHh0KSQvaSwnJyk7IGNvbnN0IHBhcnRzID0gYmFzZS5zcGxpdCgnXycpOyBpZihwYXJ0cy5sZW5ndGggPCA1KSByZXR1cm4gbnVsbDsgY29uc3QgdG9rZW5zID0gcGFydHMuc2xpY2UoMCwtMSk7IGxldCBjb25zb2xlVG9rZW49J3YxJywgc2RUb2tlbj0nc2QwJywgZHJvaWRUb2tlbj0nZHJvaWQwJywgbGluVG9rZW49J2xpbjAnOyBmb3IobGV0IGk9dG9rZW5zLmxlbmd0aC0xO2k+PTA7aS0tKXsgY29uc3QgdCA9IHRva2Vuc1tpXS50b0xvd2VyQ2FzZSgpOyBpZigvXmxpblxkKyQvLnRlc3QodCkgJiYgbGluVG9rZW49PT0nbGluMCcpeyBsaW5Ub2tlbiA9IHQ7IHRva2Vucy5zcGxpY2UoaSwxKTsgfSBlbHNlIGlmKC9eZHJvaWRcZCskLy50ZXN0KHQpICYmIGRyb2lkVG9rZW49PT0nZHJvaWQwJyl7IGRyb2lkVG9rZW4gPSB0OyB0b2tlbnMuc3BsaWNlKGksMSk7IH0gZWxzZSBpZigvXnNkXGQrJC8udGVzdCh0KSAmJiBzZFRva2VuPT09J3NkMCcpeyBzZFRva2VuID0gdDsgdG9rZW5zLnNwbGljZShpLDEpOyB9IGVsc2UgaWYoL14odjF8djJ8bGl0ZXxvbGVkKSQvLnRlc3QodCkgJiYgY29uc29sZVRva2VuPT09J3YxJyl7IGNvbnNvbGVUb2tlbiA9IHQ7IHRva2Vucy5zcGxpY2UoaSwxKTsgfSB9IGNvbnN0IGN1c3RvbWVyID0gdG9rZW5zLmpvaW4oJ18nKXx8J2N1c3RvbWVyJzsgcmV0dXJuIHsgY3VzdG9tZXIsIGNvbnNvbGVUb2tlbiwgc2RUb2tlbiwgZHJvaWRUb2tlbiwgbGluVG9rZW4gfSB9DQoNCi8vIHdpcmUgZmlsZSBpbnB1dCBmb3IgaW1wb3J0DQokKCdmaWxlSW4nKT8uYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgKGV2KT0+eyBjb25zdCBmID0gZXYudGFyZ2V0LmZpbGVzWzBdOyBpZighZikgcmV0dXJuOyBjb25zdCBjZmcgPSBwYXJzZUZpbGVuYW1lVG9Db25maWcoZi5uYW1lKTsgaWYoY2ZnKXsgJCgnY3VzdG9tZXInKS52YWx1ZSA9IGNmZy5jdXN0b21lcjsgQXJyYXkuZnJvbSgkKCdjb25zb2xlJykub3B0aW9ucykuZm9yRWFjaChvPT57IGlmKG8udmFsdWU9PT1jZmcuY29uc29sZVRva2VuKSBvLnNlbGVjdGVkPXRydWU7IH0pOyBpZigvXnNkXGQrJC8udGVzdChjZmcuc2RUb2tlbikpICQoJ3NkJykudmFsdWUgPSBOdW1iZXIoY2ZnLnNkVG9rZW4ucmVwbGFjZSgvXEQvZywnJykpOyBpZigvXmRyb2lkXGQrJC8udGVzdChjZmcuZHJvaWRUb2tlbikpICQoJ2FuZHJvaWQnKS52YWx1ZSA9IE51bWJlcihjZmcuZHJvaWRUb2tlbi5yZXBsYWNlKC9cRC9nLCcnKSk7IGlmKC9ebGluXGQrJC8udGVzdChjZmcubGluVG9rZW4pKSAkKCdsaW51eCcpLnZhbHVlID0gTnVtYmVyKGNmZy5saW5Ub2tlbi5yZXBsYWNlKC9cRC9nLCcnKSk7IHVwZGF0ZUZpbGVuYW1lUHJldmlldygpOyB1cGRhdGVUb3RhbHMoKTsgfQ0KICBjb25zdCByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpOyByZWFkZXIub25sb2FkID0gKGUpPT57IGNvbnN0IGxpbmVzID0gZS50YXJnZXQucmVzdWx0LnNwbGl0KCdcbicpLm1hcChzPT5zLnRyaW0oKSkuZmlsdGVyKEJvb2xlYW4pOyBzdGF0ZS5zZWxlY3RlZD1bXTsgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLml0ZW0nKS5mb3JFYWNoKGk9PmkuY2xhc3NMaXN0LnJlbW92ZSgnc2VsZWN0ZWQnKSk7IGxpbmVzLmZvckVhY2godGl0bGU9PnsgY29uc3Qgcm93ID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuaXRlbScpKS5maW5kKGl0PT4gaXQuZGF0YXNldC5uYW1lPT09dGl0bGUpOyBpZihyb3cpeyByb3cuY2xhc3NMaXN0LmFkZCgnc2VsZWN0ZWQnKTsgc3RhdGUuc2VsZWN0ZWQucHVzaCh7IG5hbWU6IHJvdy5kYXRhc2V0Lm5hbWUsIHNpemU6IHJvdy5kYXRhc2V0LnNpemUgfSk7IH0gZWxzZSB7IGNvbnN0IG1heWJlID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuaXRlbScpKS5maW5kKGl0PT4gaXQuZGF0YXNldC5uYW1lICYmIGl0LmRhdGFzZXQubmFtZS50b0xvd2VyQ2FzZSgpPT09dGl0bGUudG9Mb3dlckNhc2UoKSk7IGlmKG1heWJlKXsgbWF5YmUuY2xhc3NMaXN0LmFkZCgnc2VsZWN0ZWQnKTsgc3RhdGUuc2VsZWN0ZWQucHVzaCh7IG5hbWU6bWF5YmUuZGF0YXNldC5uYW1lLCBzaXplOm1heWJlLmRhdGFzZXQuc2l6ZSB9KTsgfSB9IH0pOyB1cGRhdGVUb3RhbHMoKTsgcmVuZGVyT3ZlcmxheSgpOyB9OyByZWFkZXIucmVhZEFzVGV4dChmKTsgfSk7DQoNCi8vIGhlbHBlcnMNCmZ1bmN0aW9uIGRlYm91bmNlKGZuLG1zPTIwMCl7IGxldCBoOyByZXR1cm4gKC4uLmEpPT57IGNsZWFyVGltZW91dChoKTsgaD1zZXRUaW1lb3V0KCgpPT5mbiguLi5hKSxtcyk7IH07IH0NCg0KLy8gaW5pdGlhbCBsb2FkDQooYXN5bmMgZnVuY3Rpb24gaW5pdCgpeyBhd2FpdCBsb2FkWE1MKCk7IHVwZGF0ZVRvdGFscygpOyB1cGRhdGVGaWxlbmFtZVByZXZpZXcoKTsgfSkoKTsNCg0KDQoNCg0KZnVuY3Rpb24gcmVuZGVyU2VsZWN0ZWRQYW5lbCgpIHsNCiAgY29uc3QgYm9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZWxlY3RlZFBhbmVsQm9keScpOw0KICAvL2NvbnN0IGNvdW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NlbGVjdGVkUGFuZWxDb3VudCcpOw0KICBpZiAoIWJvZHkgfHwgIWNvdW50KSByZXR1cm47DQoNCiAgYm9keS5pbm5lckhUTUwgPSAnJzsNCiAgc3RhdGUuc2VsZWN0ZWQuZm9yRWFjaCgocywgaSkgPT4gew0KICAgIGNvbnN0IHJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOw0KICAgIHJvdy5jbGFzc05hbWUgPSAncm93JzsNCiAgICByb3cuc3R5bGUuZGlzcGxheSA9ICdmbGV4JzsNCiAgICByb3cuc3R5bGUuanVzdGlmeUNvbnRlbnQgPSAnc3BhY2UtYmV0d2Vlbic7DQogICAgcm93LnN0eWxlLmFsaWduSXRlbXMgPSAnY2VudGVyJzsNCiAgICByb3cuc3R5bGUucGFkZGluZyA9ICc2cHggMCc7DQogICAgcm93LmlubmVySFRNTCA9IGANCiAgICAgIDxkaXY+DQogICAgICAgIDxzdHJvbmc+JHtpICsgMX0uICR7ZXNjKHMubmFtZSl9PC9zdHJvbmc+DQogICAgICAgIDxkaXYgY2xhc3M9Im1ldGEiPiR7ZXNjKHMuc2l6ZSl9PC9kaXY+DQogICAgICA8L2Rpdj4NCiAgICAgIDxkaXYgc3R5bGU9ImRpc3BsYXk6ZmxleDtnYXA6NHB4OyI+DQogICAgICAgIDxidXR0b24gY2xhc3M9Imljb24gdXAiPnU8L2J1dHRvbj4NCiAgICAgICAgPGJ1dHRvbiBjbGFzcz0iaWNvbiBkb3duIj5kPC9idXR0b24+DQogICAgICAgIDxidXR0b24gY2xhc3M9Imljb24gcmVtb3ZlIj54PC9idXR0b24+DQogICAgICA8L2Rpdj4NCiAgICBgOw0KDQogICAgLy8gTW92ZSB1cA0KICAgIHJvdy5xdWVyeVNlbGVjdG9yKCcudXAnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsNCiAgICAgIGlmIChpID4gMCkgew0KICAgICAgICBbc3RhdGUuc2VsZWN0ZWRbaSAtIDFdLCBzdGF0ZS5zZWxlY3RlZFtpXV0gPSBbc3RhdGUuc2VsZWN0ZWRbaV0sIHN0YXRlLnNlbGVjdGVkW2kgLSAxXV07DQogICAgICAgIHJlbmRlck92ZXJsYXkoKTsNCiAgICAgICAgcmVuZGVyTGlzdChzdGF0ZS5pdGVtcyk7DQogICAgICAgIHVwZGF0ZVRvdGFscygpOw0KICAgICAgfQ0KICAgIH0pOw0KDQogICAgLy8gTW92ZSBkb3duDQogICAgcm93LnF1ZXJ5U2VsZWN0b3IoJy5kb3duJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7DQogICAgICBpZiAoaSA8IHN0YXRlLnNlbGVjdGVkLmxlbmd0aCAtIDEpIHsNCiAgICAgICAgW3N0YXRlLnNlbGVjdGVkW2kgKyAxXSwgc3RhdGUuc2VsZWN0ZWRbaV1dID0gW3N0YXRlLnNlbGVjdGVkW2ldLCBzdGF0ZS5zZWxlY3RlZFtpICsgMV1dOw0KICAgICAgICByZW5kZXJPdmVybGF5KCk7DQogICAgICAgIHJlbmRlckxpc3Qoc3RhdGUuaXRlbXMpOw0KICAgICAgICB1cGRhdGVUb3RhbHMoKTsNCiAgICAgIH0NCiAgICB9KTsNCg0KICAgIC8vIFJlbW92ZQ0KICAgIHJvdy5xdWVyeVNlbGVjdG9yKCcucmVtb3ZlJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7DQogICAgICBzdGF0ZS5zZWxlY3RlZC5zcGxpY2UoaSwgMSk7DQogICAgICByZW5kZXJPdmVybGF5KCk7DQogICAgICByZW5kZXJMaXN0KHN0YXRlLml0ZW1zKTsNCiAgICAgIHVwZGF0ZVRvdGFscygpOw0KICAgIH0pOw0KDQogICAgYm9keS5hcHBlbmRDaGlsZChyb3cpOw0KICB9KTsNCg0KICBjb3VudC50ZXh0Q29udGVudCA9IHN0YXRlLnNlbGVjdGVkLmxlbmd0aDsNCn0NCg0KY29uc3QgdG9nZ2xlQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RvZ2dsZUNvbmZpZycpOw0KY29uc3QgY29uZmlnU2VjdGlvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb25maWdTZWN0aW9uJyk7DQoNCg0KaWYgKGlzTW9iaWxlICYmIHRvZ2dsZUJ0biAmJiBjb25maWdTZWN0aW9uKSB7DQogIC8vIFNob3cgY29uZmlnIG9uY2Ugb24gZmlyc3QgbG9hZA0KICBjb25maWdTZWN0aW9uLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpOw0KICB0b2dnbGVCdG4udGV4dENvbnRlbnQgPSAnSGlkZSBDb25maWd1cmF0aW9uJzsNCg0KICB0b2dnbGVCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7DQogICAgY29uc3QgaXNWaXNpYmxlID0gY29uZmlnU2VjdGlvbi5jbGFzc0xpc3QudG9nZ2xlKCdhY3RpdmUnKTsNCiAgICB0b2dnbGVCdG4udGV4dENvbnRlbnQgPSBpc1Zpc2libGUgPyAnSGlkZSBDb25maWd1cmF0aW9uJyA6ICdTaG93IENvbmZpZ3VyYXRpb24nOw0KICB9KTsNCn0NCg0KLy8gLS0tLS0tLS0tLSBSb2J1c3QgTGF0ZXN0LXNvcnQgcGF0Y2ggLS0tLS0tLS0tLQ0KZnVuY3Rpb24gcGFyc2VEYXRlRmxleGlibGUocykgew0KICBpZiAoIXMpIHJldHVybiBudWxsOw0KICAvLyBUcnkgZGlyZWN0IERhdGUgcGFyc2UgKElTTyArIG1hbnkgZm9ybWF0cykNCiAgbGV0IGQgPSBuZXcgRGF0ZShzKTsNCiAgaWYgKCFpc05hTihkLmdldFRpbWUoKSkpIHJldHVybiBkOw0KDQogIC8vIFRyeSBjb21tb24gWS1NLUQgb3IgWU1EIChsaWtlIDIwMjUxMDIwIG9yIDIwMjUtMTAtMjApDQogIGNvbnN0IHltZCA9ICgnJytzKS5tYXRjaCgvKFxkezR9KVxEPyhcZHsxLDJ9KVxEPyhcZHsxLDJ9KS8pOw0KICBpZiAoeW1kKSB7DQogICAgZCA9IG5ldyBEYXRlKE51bWJlcih5bWRbMV0pLCBOdW1iZXIoeW1kWzJdKSAtIDEsIE51bWJlcih5bWRbM10pKTsNCiAgICBpZiAoIWlzTmFOKGQuZ2V0VGltZSgpKSkgcmV0dXJuIGQ7DQogIH0NCg0KICAvLyBUcnkgRC9NL1kgb3IgRC1NLVkgKGUuZy4sIDIwLzEwLzIwMjUpDQogIGNvbnN0IGRteSA9ICgnJytzKS5tYXRjaCgvKFxkezEsMn0pXEQoXGR7MSwyfSlcRChcZHs0fSkvKTsNCiAgaWYgKGRteSkgew0KICAgIGQgPSBuZXcgRGF0ZShOdW1iZXIoZG15WzNdKSwgTnVtYmVyKGRteVsyXSkgLSAxLCBOdW1iZXIoZG15WzFdKSk7DQogICAgaWYgKCFpc05hTihkLmdldFRpbWUoKSkpIHJldHVybiBkOw0KICB9DQoNCiAgLy8gQXMgbGFzdCByZXNvcnQsIHRyeSBleHRyYWN0aW5nIFlZWVlNTUREIGluc2lkZSBzdHJpbmcNCiAgY29uc3QgeW1kMiA9ICgnJytzKS5tYXRjaCgvKDE5fDIwKVxkezJ9XGR7Mn1cZHsyfS8pOw0KICBpZiAoeW1kMikgew0KICAgIGNvbnN0IHN0ciA9IHltZDJbMF07DQogICAgZCA9IG5ldyBEYXRlKE51bWJlcihzdHIuc2xpY2UoMCw0KSksIE51bWJlcihzdHIuc2xpY2UoNCw2KSkgLSAxLCBOdW1iZXIoc3RyLnNsaWNlKDYsOCkpKTsNCiAgICBpZiAoIWlzTmFOKGQuZ2V0VGltZSgpKSkgcmV0dXJuIGQ7DQogIH0NCg0KICByZXR1cm4gbnVsbDsNCn0NCg0KZnVuY3Rpb24gc29ydEJ5TGF0ZXN0QW5kUmVuZGVyKCkgew0KICBpZiAoIXN0YXRlLml0ZW1zIHx8IHN0YXRlLml0ZW1zLmxlbmd0aCA9PT0gMCkgew0KICAgIHRvYXN0KCdObyBsaXN0IGxvYWRlZCB5ZXQnKTsNCiAgICAkKCdzdGF0dXMnKS50ZXh0Q29udGVudCA9ICdObyBsaXN0IGxvYWRlZCB5ZXQnOw0KICAgIHJldHVybjsNCiAgfQ0KDQogIC8vIGF0dGFjaCBhIG5vcm1hbGl6ZWQgcGFyc2VkRGF0ZSBvbiBlYWNoIGl0ZW0gZm9yIHN0YWJsZSBzb3J0aW5nDQogIHN0YXRlLml0ZW1zLmZvckVhY2goaXQgPT4gew0KICAgIC8vIHRyeSBpdGVtLmRhdGUgZmlyc3QsIGZhbGxiYWNrIHRvIG90aGVyIHBvc3NpYmxlIGtleXMNCiAgICBjb25zdCByYXcgPSBpdC5kYXRlIHx8IGl0LmRhdGVNb2RpZmllZCB8fCBpdC5tb2RpZmllZCB8fCBpdC5sYXN0TW9kaWZpZWQgfHwgJyc7DQogICAgY29uc3QgcGQgPSBwYXJzZURhdGVGbGV4aWJsZShyYXcpOw0KICAgIGl0Ll9wYXJzZWREYXRlID0gcGQgPyBwZC5nZXRUaW1lKCkgOiAwOyAvLyAwIHNvcnRzIHRvIHRoZSBlbmQgKG9sZCkNCiAgfSk7DQoNCiAgLy8gc29ydCBpbi1wbGFjZSBkZXNjZW5kaW5nIGJ5IHBhcnNlZCB0aW1lc3RhbXANCiAgc3RhdGUuaXRlbXMuc29ydCgoYSwgYikgPT4gYi5fcGFyc2VkRGF0ZSAtIGEuX3BhcnNlZERhdGUpOw0KDQogIC8vIHJlLXJlbmRlciB1c2luZyB0aGUgbm93LXNvcnRlZCBzdGF0ZS5pdGVtcw0KICByZW5kZXJMaXN0KHN0YXRlLml0ZW1zKTsNCg0KICAvLyB2aXNpYmxlIGZlZWRiYWNrDQogIHRvYXN0KCdTb3J0ZWQgYnkgbGF0ZXN0IG1vZGlmaWVkJyk7DQogICQoJ3N0YXR1cycpLnRleHRDb250ZW50ID0gJ1NvcnRlZCBieSBsYXRlc3QgbW9kaWZpZWQnOw0KfQ0KbGV0IHNvcnRNb2RlID0gJ25vcm1hbCc7IC8vIGN5Y2xlczogbm9ybWFsIOKGkiBsYXRlc3Qg4oaSIHNjb3JlDQoNCmZ1bmN0aW9uIHNvcnRDeWNsZSgpIHsNCiAgaWYgKCFzdGF0ZS5pdGVtcyB8fCBzdGF0ZS5pdGVtcy5sZW5ndGggPT09IDApIHsNCiAgICB0b2FzdCgnTm8gbGlzdCBsb2FkZWQgeWV0Jyk7DQogICAgcmV0dXJuOw0KICB9DQoNCiAgaWYgKHNvcnRNb2RlID09PSAnbm9ybWFsJykgew0KICAgIHNvcnRNb2RlID0gJ2xhdGVzdCc7DQogICAgLy8gU29ydCBieSBkYXRlDQogICAgc3RhdGUuaXRlbXMuZm9yRWFjaChpdCA9PiB7DQogICAgICBjb25zdCByYXcgPSBpdC5kYXRlIHx8IGl0LmRhdGVNb2RpZmllZCB8fCBpdC5tb2RpZmllZCB8fCAnJzsNCiAgICAgIGNvbnN0IGQgPSBwYXJzZURhdGVGbGV4aWJsZShyYXcpOw0KICAgICAgaXQuX3BhcnNlZERhdGUgPSBkID8gZC5nZXRUaW1lKCkgOiAwOw0KICAgIH0pOw0KICAgIGNvbnN0IHNvcnRlZCA9IFsuLi5zdGF0ZS5pdGVtc10uc29ydCgoYSwgYikgPT4gYi5fcGFyc2VkRGF0ZSAtIGEuX3BhcnNlZERhdGUpOw0KICAgIHJlbmRlckxpc3Qoc29ydGVkKTsNCiAgICB0b2FzdCgnU29ydGVkIGJ5IExhdGVzdCBNb2RpZmllZCcpOw0KICAgICQoJ3NvcnRMYXRlc3QnKS50ZXh0Q29udGVudCA9ICdMYXRlc3QnOw0KDQogIH0gZWxzZSBpZiAoc29ydE1vZGUgPT09ICdsYXRlc3QnKSB7DQogICAgc29ydE1vZGUgPSAnc2NvcmUnOw0KICAgIC8vIFNvcnQgYnkgc2NvcmUNCiAgICBjb25zdCBzb3J0ZWQgPSBbLi4uc3RhdGUuaXRlbXNdLnNvcnQoKGEsIGIpID0+IChwYXJzZUludChiLnNjb3JlIHx8IDApIC0gcGFyc2VJbnQoYS5zY29yZSB8fCAwKSkpOw0KICAgIHJlbmRlckxpc3Qoc29ydGVkKTsNCiAgICB0b2FzdCgnU29ydGVkIGJ5IFNjb3JlJyk7DQogICAgJCgnc29ydExhdGVzdCcpLnRleHRDb250ZW50ID0gJ1RvcCc7DQoNCiAgfSBlbHNlIHsNCiAgICBzb3J0TW9kZSA9ICdub3JtYWwnOw0KICAgIC8vIE5vcm1hbCBvcmRlciAob3JpZ2luYWwgWE1MIG9yZGVyKQ0KICAgIHJlbmRlckxpc3Qoc3RhdGUuaXRlbXMpOw0KICAgIHRvYXN0KCdTb3J0ZWQgYnkgTmFtZSAoTm9ybWFsKScpOw0KICAgICQoJ3NvcnRMYXRlc3QnKS50ZXh0Q29udGVudCA9ICdTb3J0JzsNCiAgfQ0KfQ0KDQovLyBCaW5kIChzYWZlIGV2ZW4gaWYgY2FsbGVkIGJlZm9yZSBsb2FkOyB3aWxsIGNoZWNrIGZvciBpdGVtcyBpbnNpZGUpDQpjb25zdCBzb3J0QnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NvcnRMYXRlc3QnKTsNCmlmIChzb3J0QnRuKSB7DQogIHNvcnRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBzb3J0Q3ljbGUpOw0KfQ0KDQovLyBBbHNvIHN1cHBvcnQgdHlwaW5nICJsYXRlc3QiIGluIHNlYXJjaA0KY29uc3Qgb3JpZ1NlYXJjaEhhbmRsZXIgPSAoZSkgPT4gew0KICBjb25zdCBxID0gKGUudGFyZ2V0LnZhbHVlIHx8ICcnKS50b0xvd2VyQ2FzZSgpLnRyaW0oKTsNCiAgaWYgKHEgPT09ICdsYXRlc3QnKSB7DQogICAgc29ydEJ5TGF0ZXN0QW5kUmVuZGVyKCk7DQogICAgcmV0dXJuOw0KICB9DQogIHJlbmRlckxpc3Qoc3RhdGUuaXRlbXMuZmlsdGVyKGl0ID0+IChpdC5uYW1lIHx8ICcnKS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHEpKSk7DQp9Ow0KJCgnc2VhcmNoJykucmVtb3ZlRXZlbnRMaXN0ZW5lciAmJiAkKCdzZWFyY2gnKS5yZW1vdmVFdmVudExpc3RlbmVyKCdpbnB1dCcsIG9yaWdTZWFyY2hIYW5kbGVyKTsgLy8gc2FmZSBndWFyZA0KJCgnc2VhcmNoJykuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBkZWJvdW5jZShvcmlnU2VhcmNoSGFuZGxlciwgMTgwKSk7DQoNCg0KDQpkZXRlY3RFbnZpcm9ubWVudCgpOw0KaWYgKCFpc0xvY2FsKSB7DQoJDQogIGNvbnN0IGFkbWluID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FkbWluRXhwb3J0Jyk7DQogIGlmIChhZG1pbikgYWRtaW4uc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCg0KICBjb25zdCBiaW4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYmluTGlzdCcpOw0KICBpZiAoYmluKSBiaW4uc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCg0KICAvL2NvbnN0IHVwbG9hZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd1cGxvYWRCdG4nKTsNCiAgLy9pZiAodXBsb2FkKSB1cGxvYWQuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCg0KfQ0KDQoNCjwhLS0gS2VlcCBTZWFyY2ggQmFyIEZvY3VzZWQgKERlc2t0b3AgT25seSwgU2FmZSBmb3IgQ3VzdG9tZXIgSW5wdXQpIC0tPg0KDQpjb25zdCBzZWFyY2hJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZWFyY2gnKTsNCg0KDQppZiAoIWlzTW9iaWxlKSB7DQogIGZ1bmN0aW9uIHJlZm9jdXNTZWFyY2goKSB7DQogICAgY29uc3QgYWN0aXZlID0gZG9jdW1lbnQuYWN0aXZlRWxlbWVudDsNCiAgICBpZiAoDQogICAgICBhY3RpdmUgJiYNCiAgICAgIChhY3RpdmUuaWQgPT09ICdjdXN0b21lcicgfHwNCiAgICAgICBhY3RpdmUudGFnTmFtZSA9PT0gJ1NFTEVDVCcgfHwNCiAgICAgICBhY3RpdmUudGFnTmFtZSA9PT0gJ1RFWFRBUkVBJykNCiAgICApIHJldHVybjsNCiAgICBzZWFyY2hJbnB1dC5mb2N1cygpOw0KICAgIHNlYXJjaElucHV0LnNlbGVjdCgpOw0KICB9DQoNCiAgLy8gRm9jdXMgYXQgbG9hZA0KICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIHJlZm9jdXNTZWFyY2gpOw0KDQogIC8vIFJlZm9jdXMgYWZ0ZXIgbm9ybWFsIGNsaWNrcyAobm90IHdoZW4gbW9kYWwvb3ZlcmxheSBvciB0eXBpbmcgZWxzZXdoZXJlKQ0KICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7DQogICAgY29uc3QgbW9kYWxPcGVuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpbGVzTW9kYWwnKS5zdHlsZS5kaXNwbGF5ID09PSAnYmxvY2snOw0KICAgIA0KICAgIGNvbnN0IG92ZXJsYXlPcGVuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ292ZXJsYXknKS5zdHlsZS5kaXNwbGF5ID09PSAnZmxleCc7DQogICAgaWYgKA0KICAgICAgIW1vZGFsT3BlbiAmJg0KICAgICAgIW92ZXJsYXlPcGVuICYmDQogICAgICBlLnRhcmdldC5pZCAhPT0gJ3NlYXJjaCcgJiYNCiAgICAgIGUudGFyZ2V0LmlkICE9PSAnY3VzdG9tZXInICYmDQogICAgICAhZS50YXJnZXQuY2xvc2VzdCgnc2VsZWN0JykNCiAgICApIHsNCiAgICAgIHJlZm9jdXNTZWFyY2goKTsNCiAgICB9DQogIH0pOw0KDQogIC8vIFJlZm9jdXMgYWZ0ZXIgVUkgYnV0dG9uIGFjdGlvbnMNCiAgWydjbGVhclNlYXJjaCcsICdzaG93U2VsZWN0ZWQnLCAnc2F2ZUJ0bicsICd1cGxvYWRCdG4nXS5mb3JFYWNoKGlkID0+IHsNCiAgICBjb25zdCBidG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7DQogICAgaWYgKGJ0bikgYnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgcmVmb2N1c1NlYXJjaCk7DQogIH0pOw0KDQogIC8vIFJlZm9jdXMgYWZ0ZXIgc2VsZWN0aW5nIGFuIGl0ZW0NCiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gew0KICAgIGlmIChlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2l0ZW0nKSkgew0KICAgICAgc2V0VGltZW91dChyZWZvY3VzU2VhcmNoLCAxMjApOw0KICAgIH0NCiAgfSk7DQoNCiAgLy8gUmVmb2N1cyBhZnRlciBjbG9zaW5nIG92ZXJsYXkgb3IgZmlsZSBtb2RhbA0KICBbJ2Nsb3NlT3ZlcmxheSddLmZvckVhY2goaWQgPT4gew0KICAgIGNvbnN0IGJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTsNCiAgICBpZiAoYnRuKSBidG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiBzZXRUaW1lb3V0KHJlZm9jdXNTZWFyY2gsIDIwMCkpOw0KICB9KTsNCg0KICAvLyBSZWZvY3VzIGFmdGVyIHByZXNzaW5nIEVudGVyIGluIHNlYXJjaCAoYWRkLXRvLWxpc3QgZXZlbnQpDQogIHNlYXJjaElucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCAoZXYpID0+IHsNCiAgICBpZiAoZXYua2V5ID09PSAnRW50ZXInKSB7DQogICAgICAvLyBXYWl0IGZvciB5b3VyIGFkZC10by1saXN0IGxvZ2ljIHRvIGZpbmlzaA0KICAgICAgc2V0VGltZW91dChyZWZvY3VzU2VhcmNoLCAxNTApOw0KICAgIH0NCiAgfSk7DQogIC8vcm93LmFkZEV2ZW50TGlzdGVuZXIoJ2RibGNsaWNrJywgKCkgPT4gc2hvd0ZpbGVzKGl0ZW0ubmFtZSwgaXRlbS5maWxlcyB8fCBbXSwgaXRlbS5zaXplKSk7DQoNCn0NCjwvc2NyaXB0Pg0KDQo8L2JvZHk+DQo8L2h0bWw+DQo=`;
    const decoded = atob(base64html);
    const iframe = document.getElementById('viewer');
    const doc = iframe.contentWindow.document;
    doc.open();
    doc.write(decoded);
    doc.close();
  </script>
</body>
</html>