<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PremazingPH Games</title>
  <style>
    html, body {
      margin: 0; padding: 0;
      width: 100%; height: 100%;
      overflow: hidden;
    }
    iframe {
      width: 100vw; height: 100vh;
      border: none;
      display: block;
    }
  </style>
</head>
<body>
  <iframe id="viewer"></iframe>
  <script>
    const base64html = `PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9ImVuIj4KPGhlYWQ+CjxtZXRhIGNoYXJzZXQ9InV0Zi04IiAvPgo8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLGluaXRpYWwtc2NhbGU9MSIgLz4KPHRpdGxlIGlkPSJwYWdlVGl0bGUiPkdhbWUgU2VsZWN0b3I8L3RpdGxlPgo8c3R5bGU+Cjpyb290ewogIC0tYmc6IzBhMGUxYTsKICAtLWJnLXNlY29uZGFyeTojMTExODI3OwogIC0tcGFuZWw6IzFlMjkzYjsKICAtLXBhbmVsLWhvdmVyOiMyNzM0NDk7CiAgLS1jYXJkOiMxZTI5M2I7CiAgLS1jYXJkLXNlbGVjdGVkOiMxZTNhNWY7CiAgLS1ib3JkZXI6IzMzNDE1NTsKICAtLXRleHQ6I2YxZjVmOTsKICAtLXRleHQtc2Vjb25kYXJ5OiM5NGEzYjg7CiAgLS1tdXRlZDojNjQ3NDhiOwogIC0tcHJpbWFyeTojM2I4MmY2OwogIC0tcHJpbWFyeS1ob3ZlcjojMjU2M2ViOwogIC0tYWNjZW50OiNmNTllMGI7CiAgLS1zdWNjZXNzOiMyMmM1NWU7CiAgLS1kYW5nZXI6I2VmNDQ0NDsKICAtLXJhZGl1czoxMnB4OwogIC0tcmFkaXVzLWxnOjE2cHg7Cn0KKntib3gtc2l6aW5nOmJvcmRlci1ib3g7LXdlYmtpdC10YXAtaGlnaGxpZ2h0LWNvbG9yOnRyYW5zcGFyZW50fQpodG1sLGJvZHl7aGVpZ2h0OjEwMCU7bWFyZ2luOjA7Zm9udC1mYW1pbHk6J0ludGVyJywtYXBwbGUtc3lzdGVtLEJsaW5rTWFjU3lzdGVtRm9udCwnU2Vnb2UgVUknLFJvYm90byxzYW5zLXNlcmlmO2JhY2tncm91bmQ6dmFyKC0tYmcpO2NvbG9yOnZhcigtLXRleHQpfQoKLyogSGVhZGVyICovCi5oZWFkZXJ7cG9zaXRpb246Zml4ZWQ7dG9wOjA7cmlnaHQ6MDtsZWZ0OjA7aGVpZ2h0OjcwcHg7YmFja2dyb3VuZDpsaW5lYXItZ3JhZGllbnQoMTgwZGVnLCMzYjgyZjYgMCUsIzI1NjNlYiAxMDAlKTtkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2dhcDoxMnB4O3BhZGRpbmc6MTJweCAxNnB4O3otaW5kZXg6NjA7Ym94LXNoYWRvdzowIDRweCAyMHB4IHJnYmEoMCwwLDAsMC4zKX0KLmhlYWRlciAuc2VhcmNoe2ZsZXg6MTttaW4td2lkdGg6MTQwcHh9Ci5oZWFkZXIgaW5wdXQuc2VhcmNoe2hlaWdodDo0MnB4O2JvcmRlci1yYWRpdXM6dmFyKC0tcmFkaXVzKTtib3JkZXI6bm9uZTtwYWRkaW5nOjAgMTZweDtiYWNrZ3JvdW5kOnJnYmEoMjU1LDI1NSwyNTUsMC4xNSk7Y29sb3I6I2ZmZjtmb250LXNpemU6MTVweDtiYWNrZHJvcC1maWx0ZXI6Ymx1cigxMHB4KX0KLmhlYWRlciBpbnB1dC5zZWFyY2g6OnBsYWNlaG9sZGVye2NvbG9yOnJnYmEoMjU1LDI1NSwyNTUsMC43KX0KLmhlYWRlciBpbnB1dC5zZWFyY2g6Zm9jdXN7b3V0bGluZTpub25lO2JhY2tncm91bmQ6cmdiYSgyNTUsMjU1LDI1NSwwLjI1KTtib3gtc2hhZG93OjAgMCAwIDNweCByZ2JhKDI1NSwyNTUsMjU1LDAuMil9Ci5oZWFkZXIgLmFjdGlvbnN7ZGlzcGxheTpmbGV4O2dhcDo2cHg7YWxpZ24taXRlbXM6Y2VudGVyfQouaGVhZGVyIGJ1dHRvbntoZWlnaHQ6NDJweDtib3JkZXItcmFkaXVzOnZhcigtLXJhZGl1cyk7Ym9yZGVyOm5vbmU7cGFkZGluZzowIDE0cHg7YmFja2dyb3VuZDpyZ2JhKDI1NSwyNTUsMjU1LDAuMTUpO2NvbG9yOiNmZmY7Zm9udC1zaXplOjE0cHg7Zm9udC13ZWlnaHQ6NTAwO2N1cnNvcjpwb2ludGVyO3RyYW5zaXRpb246YWxsIDAuMnN9Ci5oZWFkZXIgYnV0dG9uOmhvdmVye2JhY2tncm91bmQ6cmdiYSgyNTUsMjU1LDI1NSwwLjI1KX0KCi8qIEZpbHRlciBUYWJzICovCi5maWx0ZXItdGFic3tkaXNwbGF5OmZsZXg7Z2FwOjhweDtwYWRkaW5nOjEycHggMTZweDtiYWNrZ3JvdW5kOnZhcigtLWJnLXNlY29uZGFyeSk7Ym9yZGVyLWJvdHRvbToxcHggc29saWQgdmFyKC0tYm9yZGVyKX0KLmZpbHRlci10YWJ7cGFkZGluZzo4cHggMTZweDtib3JkZXItcmFkaXVzOjIwcHg7Ym9yZGVyOjFweCBzb2xpZCB2YXIoLS1ib3JkZXIpO2JhY2tncm91bmQ6dHJhbnNwYXJlbnQ7Y29sb3I6dmFyKC0tdGV4dC1zZWNvbmRhcnkpO2ZvbnQtc2l6ZToxM3B4O2ZvbnQtd2VpZ2h0OjUwMDtjdXJzb3I6cG9pbnRlcjt0cmFuc2l0aW9uOmFsbCAwLjJzfQouZmlsdGVyLXRhYjpob3ZlcntiYWNrZ3JvdW5kOnZhcigtLXBhbmVsKTtjb2xvcjp2YXIoLS10ZXh0KX0KLmZpbHRlci10YWIuYWN0aXZle2JhY2tncm91bmQ6dmFyKC0tcHJpbWFyeSk7Ym9yZGVyLWNvbG9yOnZhcigtLXByaW1hcnkpO2NvbG9yOiNmZmZ9CgovKiBDb250YWluZXIgKi8KLmNvbnRhaW5lcntkaXNwbGF5OmdyaWQ7Z3JpZC10ZW1wbGF0ZS1jb2x1bW5zOjFmciA0MDBweDtnYXA6MTZweDtwYWRkaW5nOmNhbGMoNzBweCArIDE2cHgpIDE2cHggMTAwcHg7bWluLWhlaWdodDoxMDB2aH0KCi8qIExlZnQgUGFuZSAtIEdhbWUgTGlzdCAqLwoubGVmdFBhbmV7YmFja2dyb3VuZDp2YXIoLS1iZy1zZWNvbmRhcnkpO2JvcmRlci1yYWRpdXM6dmFyKC0tcmFkaXVzLWxnKTtwYWRkaW5nOjA7b3ZlcmZsb3c6aGlkZGVuO2JvcmRlcjoxcHggc29saWQgdmFyKC0tYm9yZGVyKX0KLmxlZnRQYW5lLWlubmVye3BhZGRpbmc6MTJweDtvdmVyZmxvdy15OmF1dG87bWF4LWhlaWdodDpjYWxjKDEwMHZoIC0gMjAwcHgpfQoKLyogR2FtZSBJdGVtIENhcmQgKi8KLml0ZW17ZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtnYXA6MTJweDtwYWRkaW5nOjEycHg7Ym9yZGVyLXJhZGl1czp2YXIoLS1yYWRpdXMpO2JhY2tncm91bmQ6dmFyKC0tY2FyZCk7Ym9yZGVyOjFweCBzb2xpZCB2YXIoLS1ib3JkZXIpO2N1cnNvcjpwb2ludGVyO21hcmdpbi1ib3R0b206MTBweDt0cmFuc2l0aW9uOmFsbCAwLjJzfQouaXRlbTpob3ZlcntiYWNrZ3JvdW5kOnZhcigtLXBhbmVsLWhvdmVyKTtib3JkZXItY29sb3I6IzQ3NTU2OTt0cmFuc2Zvcm06dHJhbnNsYXRlWSgtMXB4KX0KLml0ZW0uc2VsZWN0ZWR7YmFja2dyb3VuZDp2YXIoLS1jYXJkLXNlbGVjdGVkKTtib3JkZXItY29sb3I6dmFyKC0tcHJpbWFyeSl9Ci5pdGVtLnNlbGVjdGVkIC5pdGVtLWNoZWNrYm94e2JhY2tncm91bmQ6dmFyKC0tcHJpbWFyeSk7Ym9yZGVyLWNvbG9yOnZhcigtLXByaW1hcnkpfQouaXRlbS5zZWxlY3RlZCAuaXRlbS1jaGVja2JveDo6YWZ0ZXJ7Y29udGVudDon4pyTJztjb2xvcjojZmZmO2ZvbnQtc2l6ZToxMnB4O2ZvbnQtd2VpZ2h0OmJvbGR9CgovKiBHYW1lIFRodW1ibmFpbCAqLwouaXRlbS10aHVtYnt3aWR0aDo1NnB4O2hlaWdodDo1NnB4O2JvcmRlci1yYWRpdXM6OHB4O2JhY2tncm91bmQ6bGluZWFyLWdyYWRpZW50KDEzNWRlZywjMzc0MTUxIDAlLCMxZjI5MzcgMTAwJSk7ZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO2ZsZXgtc2hyaW5rOjA7b3ZlcmZsb3c6aGlkZGVuO3Bvc2l0aW9uOnJlbGF0aXZlfQouaXRlbS10aHVtYiBpbWd7d2lkdGg6MTAwJTtoZWlnaHQ6MTAwJTtvYmplY3QtZml0OmNvdmVyfQouaXRlbS10aHVtYi1wbGFjZWhvbGRlcntmb250LXNpemU6MjBweDtjb2xvcjp2YXIoLS1tdXRlZCl9CgovKiBGb3JtYXQgQmFkZ2UgKi8KLmZvcm1hdC1iYWRnZXtwb3NpdGlvbjphYnNvbHV0ZTtib3R0b206NHB4O2xlZnQ6NHB4O3BhZGRpbmc6MnB4IDZweDtib3JkZXItcmFkaXVzOjRweDtmb250LXNpemU6OXB4O2ZvbnQtd2VpZ2h0OjcwMDt0ZXh0LXRyYW5zZm9ybTp1cHBlcmNhc2U7bGV0dGVyLXNwYWNpbmc6MC41cHh9Ci5mb3JtYXQtYmFkZ2UubnNwe2JhY2tncm91bmQ6IzIyYzU1ZTtjb2xvcjojZmZmfQouZm9ybWF0LWJhZGdlLm5zentiYWNrZ3JvdW5kOiMzYjgyZjY7Y29sb3I6I2ZmZn0KLmZvcm1hdC1iYWRnZS54Y2l7YmFja2dyb3VuZDojYTg1NWY3O2NvbG9yOiNmZmZ9CgovKiBJdGVtIENvbnRlbnQgKi8KLml0ZW0tY29udGVudHtmbGV4OjE7bWluLXdpZHRoOjB9Ci5pdGVtLXRpdGxle2ZvbnQtc2l6ZToxNHB4O2ZvbnQtd2VpZ2h0OjYwMDtjb2xvcjp2YXIoLS10ZXh0KTttYXJnaW4tYm90dG9tOjRweDt3aGl0ZS1zcGFjZTpub3dyYXA7b3ZlcmZsb3c6aGlkZGVuO3RleHQtb3ZlcmZsb3c6ZWxsaXBzaXN9Ci5pdGVtLXNpemV7Zm9udC1zaXplOjEzcHg7Y29sb3I6dmFyKC0tdGV4dC1zZWNvbmRhcnkpfQouaXRlbS1tZXRhe2ZvbnQtc2l6ZToxMXB4O2NvbG9yOnZhcigtLW11dGVkKTttYXJnaW4tdG9wOjJweH0KCi8qIENpcmN1bGFyIENoZWNrYm94ICovCi5pdGVtLWNoZWNrYm94e3dpZHRoOjI2cHg7aGVpZ2h0OjI2cHg7Ym9yZGVyLXJhZGl1czo1MCU7Ym9yZGVyOjJweCBzb2xpZCB2YXIoLS1ib3JkZXIpO2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OmNlbnRlcjtmbGV4LXNocmluazowO3RyYW5zaXRpb246YWxsIDAuMnN9CgovKiBSaWdodCBQYW5lICovCi5yaWdodFBhbmV7YmFja2dyb3VuZDp2YXIoLS1iZy1zZWNvbmRhcnkpO2JvcmRlci1yYWRpdXM6dmFyKC0tcmFkaXVzLWxnKTtwYWRkaW5nOjE2cHg7b3ZlcmZsb3cteTphdXRvO2JvcmRlcjoxcHggc29saWQgdmFyKC0tYm9yZGVyKTtkaXNwbGF5OmZsZXg7ZmxleC1kaXJlY3Rpb246Y29sdW1uO2dhcDoxNnB4fQoKLyogU3RvcmFnZSBDYXJkICovCi5zdG9yYWdlLWNhcmR7YmFja2dyb3VuZDp2YXIoLS1jYXJkKTtib3JkZXItcmFkaXVzOnZhcigtLXJhZGl1cyk7cGFkZGluZzoxNnB4O2JvcmRlcjoxcHggc29saWQgdmFyKC0tYm9yZGVyKX0KLnN0b3JhZ2UtaGVhZGVye2Rpc3BsYXk6ZmxleDtqdXN0aWZ5LWNvbnRlbnQ6c3BhY2UtYmV0d2VlbjthbGlnbi1pdGVtczpjZW50ZXI7bWFyZ2luLWJvdHRvbToxMnB4fQouc3RvcmFnZS10aXRsZXtkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2dhcDo4cHg7Zm9udC1zaXplOjE0cHg7Zm9udC13ZWlnaHQ6NjAwO2NvbG9yOnZhcigtLXRleHQpfQouc3RvcmFnZS10aXRsZSBzdmd7d2lkdGg6MjBweDtoZWlnaHQ6MjBweDtjb2xvcjp2YXIoLS1wcmltYXJ5KX0KLnN0b3JhZ2UtY2FwYWNpdHl7Zm9udC1zaXplOjEzcHg7Y29sb3I6dmFyKC0tdGV4dC1zZWNvbmRhcnkpfQoKLyogUHJvZ3Jlc3MgQmFyICovCi5zdG9yYWdlLXByb2dyZXNze2hlaWdodDoxMHB4O2JhY2tncm91bmQ6dmFyKC0tYmcpO2JvcmRlci1yYWRpdXM6NXB4O292ZXJmbG93OmhpZGRlbjtkaXNwbGF5OmZsZXh9Ci5wcm9ncmVzcy11c2Vke2JhY2tncm91bmQ6IzQ3NTU2OTt0cmFuc2l0aW9uOndpZHRoIDAuM3N9Ci5wcm9ncmVzcy1zZWxlY3RlZHtiYWNrZ3JvdW5kOnZhcigtLXByaW1hcnkpO3RyYW5zaXRpb246d2lkdGggMC4zc30KLnByb2dyZXNzLWZyZWV7YmFja2dyb3VuZDp0cmFuc3BhcmVudH0KLnN0b3JhZ2UtbGVnZW5ke2Rpc3BsYXk6ZmxleDtnYXA6MTZweDttYXJnaW4tdG9wOjEwcHg7Zm9udC1zaXplOjEycHh9Ci5sZWdlbmQtaXRlbXtkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2dhcDo2cHg7Y29sb3I6dmFyKC0tdGV4dC1zZWNvbmRhcnkpfQoubGVnZW5kLWRvdHt3aWR0aDo4cHg7aGVpZ2h0OjhweDtib3JkZXItcmFkaXVzOjUwJX0KLmxlZ2VuZC1kb3QudXNlZHtiYWNrZ3JvdW5kOiM0NzU1Njl9Ci5sZWdlbmQtZG90LnNlbGVjdGVke2JhY2tncm91bmQ6dmFyKC0tcHJpbWFyeSl9Ci5sZWdlbmQtZG90LmZyZWV7YmFja2dyb3VuZDp2YXIoLS1iZyk7Ym9yZGVyOjFweCBzb2xpZCB2YXIoLS1ib3JkZXIpfQoKLyogU3RhdHMgR3JpZCAqLwouc3RhdHMtZ3JpZHtkaXNwbGF5OmdyaWQ7Z3JpZC10ZW1wbGF0ZS1jb2x1bW5zOnJlcGVhdCgzLDFmcik7Z2FwOjhweH0KLnN0YXQtY2FyZHtiYWNrZ3JvdW5kOnZhcigtLWNhcmQpO2JvcmRlci1yYWRpdXM6dmFyKC0tcmFkaXVzKTtwYWRkaW5nOjE0cHg7dGV4dC1hbGlnbjpjZW50ZXI7Ym9yZGVyOjFweCBzb2xpZCB2YXIoLS1ib3JkZXIpfQouc3RhdC1jYXJkLmhpZ2hsaWdodHtib3JkZXItY29sb3I6dmFyKC0tcHJpbWFyeSk7YmFja2dyb3VuZDpsaW5lYXItZ3JhZGllbnQoMTgwZGVnLHJnYmEoNTksMTMwLDI0NiwwLjEpIDAlLHZhcigtLWNhcmQpIDEwMCUpfQouc3RhdC12YWx1ZXtmb250LXNpemU6MjJweDtmb250LXdlaWdodDo3MDA7Y29sb3I6dmFyKC0tdGV4dCl9Ci5zdGF0LWNhcmQuaGlnaGxpZ2h0IC5zdGF0LXZhbHVle2NvbG9yOnZhcigtLXByaW1hcnkpfQouc3RhdC1sYWJlbHtmb250LXNpemU6MTBweDtmb250LXdlaWdodDo2MDA7dGV4dC10cmFuc2Zvcm06dXBwZXJjYXNlO2xldHRlci1zcGFjaW5nOjAuNXB4O2NvbG9yOnZhcigtLW11dGVkKTttYXJnaW4tdG9wOjRweH0KLnN0YXQtbm90ZXtmb250LXNpemU6MTFweDtjb2xvcjp2YXIoLS1tdXRlZCk7dGV4dC1hbGlnbjpjZW50ZXI7ZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO2dhcDo0cHh9CgovKiBDb250cm9scyAqLwouY29udHJvbHN7ZGlzcGxheTpncmlkO2dyaWQtdGVtcGxhdGUtY29sdW1uczoxZnIgMWZyO2dhcDo4cHh9Ci5jb250cm9scyAuZnVsbHtncmlkLWNvbHVtbjoxIC8gLTF9Ci5jb250cm9scyBpbnB1dCwuY29udHJvbHMgc2VsZWN0e2hlaWdodDo0NHB4O2JvcmRlci1yYWRpdXM6dmFyKC0tcmFkaXVzKTtib3JkZXI6MXB4IHNvbGlkIHZhcigtLWJvcmRlcik7cGFkZGluZzowIDEycHg7YmFja2dyb3VuZDp2YXIoLS1jYXJkKTtjb2xvcjp2YXIoLS10ZXh0KTtmb250LXNpemU6MTRweDt3aWR0aDoxMDAlfQouY29udHJvbHMgaW5wdXQ6Zm9jdXMsLmNvbnRyb2xzIHNlbGVjdDpmb2N1c3tvdXRsaW5lOm5vbmU7Ym9yZGVyLWNvbG9yOnZhcigtLXByaW1hcnkpO2JveC1zaGFkb3c6MCAwIDAgM3B4IHJnYmEoNTksMTMwLDI0NiwwLjIpfQouY29udHJvbHMgc2VsZWN0e2N1cnNvcjpwb2ludGVyO2FwcGVhcmFuY2U6bm9uZTtiYWNrZ3JvdW5kLWltYWdlOnVybCgiZGF0YTppbWFnZS9zdmcreG1sLCUzQ3N2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScxMicgaGVpZ2h0PScxMicgdmlld0JveD0nMCAwIDEyIDEyJyUzRSUzQ3BhdGggZmlsbD0nJTIzOTRhM2I4JyBkPSdNNiA4TDEgM2gxMHonLyUzRSUzQy9zdmclM0UiKTtiYWNrZ3JvdW5kLXJlcGVhdDpuby1yZXBlYXQ7YmFja2dyb3VuZC1wb3NpdGlvbjpyaWdodCAxMnB4IGNlbnRlcjtwYWRkaW5nLXJpZ2h0OjM2cHh9Ci5jb250cm9scyBsYWJlbHtmb250LXNpemU6MTJweDtjb2xvcjp2YXIoLS1tdXRlZCk7bWFyZ2luLWJvdHRvbTo0cHg7ZGlzcGxheTpibG9ja30KCi8qIER5bmFtaWMgQ29udHJvbHMgR3JpZCAqLwojZHluYW1pY0NvbnRyb2xze2Rpc3BsYXk6Y29udGVudHN9CiNkeW5hbWljQ29udHJvbHMgPiBkaXZ7ZGlzcGxheTpmbGV4O2ZsZXgtZGlyZWN0aW9uOmNvbHVtbn0KCi5maWxlbmFtZS1wcmV2aWV3e2dyaWQtY29sdW1uOjEgLyAtMTtwYWRkaW5nOjEwcHggMTJweDtiYWNrZ3JvdW5kOnZhcigtLWJnKTtib3JkZXI6MXB4IHNvbGlkIHZhcigtLWJvcmRlcik7Ym9yZGVyLXJhZGl1czp2YXIoLS1yYWRpdXMpO2ZvbnQtZmFtaWx5OidTRiBNb25vJyxNb25hY28sbW9ub3NwYWNlO2ZvbnQtc2l6ZToxMnB4O2NvbG9yOnZhcigtLXRleHQtc2Vjb25kYXJ5KTtvdmVyZmxvdy14OmF1dG87d2hpdGUtc3BhY2U6bm93cmFwfQoKLyogQnV0dG9ucyAqLwouYnRue3BhZGRpbmc6MTBweCAxNnB4O2JvcmRlci1yYWRpdXM6dmFyKC0tcmFkaXVzKTtib3JkZXI6bm9uZTtmb250LXNpemU6MTRweDtmb250LXdlaWdodDo2MDA7Y3Vyc29yOnBvaW50ZXI7dHJhbnNpdGlvbjphbGwgMC4ycztkaXNwbGF5OmlubGluZS1mbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO2dhcDo2cHh9Ci5idG4tcHJpbWFyeXtiYWNrZ3JvdW5kOnZhcigtLXByaW1hcnkpO2NvbG9yOiNmZmZ9Ci5idG4tcHJpbWFyeTpob3ZlcntiYWNrZ3JvdW5kOnZhcigtLXByaW1hcnktaG92ZXIpO3RyYW5zZm9ybTp0cmFuc2xhdGVZKC0xcHgpfQouYnRuLmdob3N0e2JhY2tncm91bmQ6dHJhbnNwYXJlbnQ7Y29sb3I6dmFyKC0tdGV4dC1zZWNvbmRhcnkpO2JvcmRlcjoxcHggc29saWQgdmFyKC0tYm9yZGVyKX0KLmJ0bi5naG9zdDpob3ZlcntiYWNrZ3JvdW5kOnZhcigtLXBhbmVsKTtjb2xvcjp2YXIoLS10ZXh0KTtib3JkZXItY29sb3I6IzQ3NTU2OX0KLmJ0bi5kYW5nZXJ7YmFja2dyb3VuZDp2YXIoLS1kYW5nZXIpO2NvbG9yOiNmZmZ9Ci5idG4uZGFuZ2VyOmhvdmVye2JhY2tncm91bmQ6I2RjMjYyNn0KCi8qIEFjdGlvbiBCdXR0b25zIFJvdyAqLwouYWN0aW9uLXJvd3tkaXNwbGF5OmZsZXg7Z2FwOjhweDtmbGV4LXdyYXA6d3JhcH0KLmFjdGlvbi1yb3cgLmJ0bntmbGV4OjE7bWluLXdpZHRoOmZpdC1jb250ZW50fQoKLyogU2hhcmUgSW5wdXQgKi8KLnNoYXJlLXJvd3tkaXNwbGF5OmZsZXg7Z2FwOjhweDthbGlnbi1pdGVtczpjZW50ZXJ9Ci5zaGFyZS1yb3cgaW5wdXR7ZmxleDoxO2hlaWdodDo0NHB4O2JvcmRlci1yYWRpdXM6dmFyKC0tcmFkaXVzKTtib3JkZXI6MXB4IHNvbGlkIHZhcigtLWJvcmRlcik7cGFkZGluZzowIDEycHg7YmFja2dyb3VuZDp2YXIoLS1jYXJkKTtjb2xvcjp2YXIoLS10ZXh0KTtmb250LXNpemU6MTNweH0KCi8qIFNlbGVjdGVkIFBhbmVsICovCi5zZWxlY3RlZC1wYW5lbHtiYWNrZ3JvdW5kOnZhcigtLWNhcmQpO2JvcmRlci1yYWRpdXM6dmFyKC0tcmFkaXVzKTtib3JkZXI6MXB4IHNvbGlkIHZhcigtLWJvcmRlcik7ZmxleDoxO2Rpc3BsYXk6ZmxleDtmbGV4LWRpcmVjdGlvbjpjb2x1bW47b3ZlcmZsb3c6aGlkZGVuO21pbi1oZWlnaHQ6MjAwcHh9Ci5zZWxlY3RlZC1wYW5lbCAuaGVhZHtwYWRkaW5nOjEycHggMTZweDtib3JkZXItYm90dG9tOjFweCBzb2xpZCB2YXIoLS1ib3JkZXIpO2ZvbnQtd2VpZ2h0OjYwMDtmb250LXNpemU6MTRweDtjb2xvcjp2YXIoLS10ZXh0KTtkaXNwbGF5OmZsZXg7anVzdGlmeS1jb250ZW50OnNwYWNlLWJldHdlZW47YWxpZ24taXRlbXM6Y2VudGVyfQouc2VsZWN0ZWQtcGFuZWwgLmJvZHl7ZmxleDoxO292ZXJmbG93LXk6YXV0bztwYWRkaW5nOjhweH0KCi8qIFNlbGVjdGVkIEl0ZW0gKi8KLnNlbGVjdGVkLWl0ZW17ZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtnYXA6MTBweDtwYWRkaW5nOjEwcHg7YmFja2dyb3VuZDp2YXIoLS1iZyk7Ym9yZGVyLXJhZGl1czp2YXIoLS1yYWRpdXMpO21hcmdpbi1ib3R0b206OHB4O2JvcmRlcjoxcHggc29saWQgdmFyKC0tYm9yZGVyKX0KLnNlbGVjdGVkLWl0ZW0tdGh1bWJ7d2lkdGg6NDRweDtoZWlnaHQ6NDRweDtib3JkZXItcmFkaXVzOjhweDtiYWNrZ3JvdW5kOnZhcigtLXBhbmVsKTtkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2p1c3RpZnktY29udGVudDpjZW50ZXI7ZmxleC1zaHJpbms6MH0KLnNlbGVjdGVkLWl0ZW0tY29udGVudHtmbGV4OjE7bWluLXdpZHRoOjB9Ci5zZWxlY3RlZC1pdGVtLXRpdGxle2ZvbnQtc2l6ZToxM3B4O2ZvbnQtd2VpZ2h0OjYwMDtjb2xvcjp2YXIoLS10ZXh0KTt3aGl0ZS1zcGFjZTpub3dyYXA7b3ZlcmZsb3c6aGlkZGVuO3RleHQtb3ZlcmZsb3c6ZWxsaXBzaXN9Ci5zZWxlY3RlZC1pdGVtLW1ldGF7Zm9udC1zaXplOjExcHg7Y29sb3I6dmFyKC0tbXV0ZWQpO2Rpc3BsYXk6ZmxleDtnYXA6OHB4O2FsaWduLWl0ZW1zOmNlbnRlcjttYXJnaW4tdG9wOjJweH0KLnNlbGVjdGVkLWl0ZW0tdmVyc2lvbntwYWRkaW5nOjJweCA2cHg7YmFja2dyb3VuZDp2YXIoLS1wYW5lbCk7Ym9yZGVyLXJhZGl1czo0cHg7Zm9udC1zaXplOjEwcHg7Y29sb3I6dmFyKC0tdGV4dC1zZWNvbmRhcnkpfQouc2VsZWN0ZWQtaXRlbS1zaXple2ZvbnQtc2l6ZToxM3B4O2ZvbnQtd2VpZ2h0OjYwMDtjb2xvcjp2YXIoLS10ZXh0KTt3aGl0ZS1zcGFjZTpub3dyYXB9Ci5zZWxlY3RlZC1pdGVtLWNoZWNre2NvbG9yOnZhcigtLXN1Y2Nlc3MpO2ZvbnQtc2l6ZToxNnB4fQouc2VsZWN0ZWQtaXRlbS1hY3Rpb25ze2Rpc3BsYXk6ZmxleDtnYXA6NHB4fQouc2VsZWN0ZWQtaXRlbS1hY3Rpb25zIGJ1dHRvbnt3aWR0aDoyOHB4O2hlaWdodDoyOHB4O2JvcmRlci1yYWRpdXM6NnB4O2JvcmRlcjpub25lO2N1cnNvcjpwb2ludGVyO2ZvbnQtc2l6ZToxMnB4O2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OmNlbnRlcn0KLnNlbGVjdGVkLWl0ZW0tYWN0aW9ucyAudXAsLnNlbGVjdGVkLWl0ZW0tYWN0aW9ucyAuZG93bntiYWNrZ3JvdW5kOnZhcigtLXBhbmVsKTtjb2xvcjp2YXIoLS10ZXh0KX0KLnNlbGVjdGVkLWl0ZW0tYWN0aW9ucyAucmVtb3Zle2JhY2tncm91bmQ6cmdiYSgyMzksNjgsNjgsMC4yKTtjb2xvcjp2YXIoLS1kYW5nZXIpfQoKLyogQm90dG9tIENUQSAqLwouYm90dG9tLWN0YXtwb3NpdGlvbjpmaXhlZDtib3R0b206MDtsZWZ0OjA7cmlnaHQ6MDtwYWRkaW5nOjEycHggMTZweDtiYWNrZ3JvdW5kOmxpbmVhci1ncmFkaWVudCgxODBkZWcsdHJhbnNwYXJlbnQgMCUsdmFyKC0tYmcpIDMwJSk7ei1pbmRleDo1MDtwb2ludGVyLWV2ZW50czpub25lfQouYm90dG9tLWN0YS1pbm5lcntkaXNwbGF5OmZsZXg7Z2FwOjEwcHg7bWF4LXdpZHRoOjUwMHB4O21hcmdpbjowIGF1dG87cG9pbnRlci1ldmVudHM6YXV0b30KLmN0YS1idXR0b257ZmxleDoxO2Rpc3BsYXk6ZmxleDtoZWlnaHQ6NTBweDtib3JkZXItcmFkaXVzOnZhcigtLXJhZGl1cyk7YmFja2dyb3VuZDp2YXIoLS1wcmltYXJ5KTtjb2xvcjojZmZmO2JvcmRlcjpub25lO2ZvbnQtc2l6ZToxNXB4O2ZvbnQtd2VpZ2h0OjYwMDtjdXJzb3I6cG9pbnRlcjthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OmNlbnRlcjtnYXA6NnB4O3RyYW5zaXRpb246YWxsIDAuMnM7Ym94LXNoYWRvdzowIDRweCAyMHB4IHJnYmEoNTksMTMwLDI0NiwwLjQpfQouY3RhLWJ1dHRvbjpob3ZlcntiYWNrZ3JvdW5kOnZhcigtLXByaW1hcnktaG92ZXIpO3RyYW5zZm9ybTp0cmFuc2xhdGVZKC0ycHgpO2JveC1zaGFkb3c6MCA2cHggMjVweCByZ2JhKDU5LDEzMCwyNDYsMC41KX0KLmN0YS1idXR0b246YWN0aXZle3RyYW5zZm9ybTp0cmFuc2xhdGVZKDApfQouY3RhLWJ1dHRvbiBzdmd7d2lkdGg6MThweDtoZWlnaHQ6MThweH0KLmN0YS1idXR0b24uZGlzYWJsZWR7b3BhY2l0eTowLjU7Y3Vyc29yOm5vdC1hbGxvd2VkO3BvaW50ZXItZXZlbnRzOm5vbmV9Ci5jdGEtc2hvd3t3aWR0aDo1MHB4O2ZsZXgtc2hyaW5rOjA7ZGlzcGxheTpmbGV4O2hlaWdodDo1MHB4O2JvcmRlci1yYWRpdXM6dmFyKC0tcmFkaXVzKTtiYWNrZ3JvdW5kOnZhcigtLXBhbmVsKTtjb2xvcjp2YXIoLS10ZXh0KTtib3JkZXI6MXB4IHNvbGlkIHZhcigtLWJvcmRlcik7Zm9udC1zaXplOjE0cHg7Zm9udC13ZWlnaHQ6NjAwO2N1cnNvcjpwb2ludGVyO2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO3RyYW5zaXRpb246YWxsIDAuMnM7cG9zaXRpb246cmVsYXRpdmV9Ci5jdGEtc2hvdzpob3ZlcntiYWNrZ3JvdW5kOnZhcigtLXBhbmVsLWhvdmVyKTtib3JkZXItY29sb3I6IzQ3NTU2OX0KLmN0YS1zaG93IC5iYWRnZXtwb3NpdGlvbjphYnNvbHV0ZTt0b3A6LTZweDtyaWdodDotNnB4O21pbi13aWR0aDoyMHB4O2hlaWdodDoyMHB4O2JvcmRlci1yYWRpdXM6MTBweDtiYWNrZ3JvdW5kOnZhcigtLWFjY2VudCk7Y29sb3I6IzAwMDtmb250LXNpemU6MTFweDtmb250LXdlaWdodDo3MDA7ZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO3BhZGRpbmc6MCA1cHh9Ci5jdGEtYnV0dG9uLndhcm5pbmd7YmFja2dyb3VuZDp2YXIoLS1kYW5nZXIpO2JveC1zaGFkb3c6MCA0cHggMjBweCByZ2JhKDIzOSw2OCw2OCwwLjQpfQouY3RhLWJ1dHRvbi53YXJuaW5nOmhvdmVye2JhY2tncm91bmQ6I2RjMjYyNjtib3gtc2hhZG93OjAgNnB4IDI1cHggcmdiYSgyMzksNjgsNjgsMC41KX0KLmN0YS1idXR0b24gLndhcm5pbmctaWNvbntkaXNwbGF5Om5vbmV9Ci5jdGEtYnV0dG9uLndhcm5pbmcgLndhcm5pbmctaWNvbntkaXNwbGF5OmlubGluZX0KLmN0YS1idXR0b24ud2FybmluZyAudXBsb2FkLWljb257ZGlzcGxheTpub25lfQoKLyogQW5pbWF0aW9ucyAqLwpAa2V5ZnJhbWVzIGZhZGVJbntmcm9te29wYWNpdHk6MDt0cmFuc2Zvcm06dHJhbnNsYXRlWSgxMHB4KX10b3tvcGFjaXR5OjE7dHJhbnNmb3JtOnRyYW5zbGF0ZVkoMCl9fQouaXRlbXthbmltYXRpb246ZmFkZUluIDAuMnMgZWFzZS1vdXR9Ci5zZWxlY3RlZC1pdGVte2FuaW1hdGlvbjpmYWRlSW4gMC4xNXMgZWFzZS1vdXR9CgovKiBTdGF0dXMgKi8KLnN0YXR1c3tmb250LXNpemU6MTJweDtjb2xvcjp2YXIoLS1tdXRlZCk7cGFkZGluZzo4cHggMH0KCi8qIE92ZXJsYXkgKi8KLm92ZXJsYXl7cG9zaXRpb246Zml4ZWQ7aW5zZXQ6MDtiYWNrZ3JvdW5kOnJnYmEoMTAsMTQsMjYsMC45NSk7ZGlzcGxheTpub25lO2ZsZXgtZGlyZWN0aW9uOmNvbHVtbjt6LWluZGV4OjE1MDtiYWNrZHJvcC1maWx0ZXI6Ymx1cigxMHB4KX0KLm92ZXJsYXkgLmhlYWR7ZGlzcGxheTpmbGV4O2p1c3RpZnktY29udGVudDpzcGFjZS1iZXR3ZWVuO3BhZGRpbmc6MTZweDtiYWNrZ3JvdW5kOnZhcigtLXBhbmVsKTthbGlnbi1pdGVtczpjZW50ZXI7Ym9yZGVyLWJvdHRvbToxcHggc29saWQgdmFyKC0tYm9yZGVyKX0KLm92ZXJsYXkgLmhlYWQgc3Ryb25ne2NvbG9yOnZhcigtLXRleHQpfQoub3ZlcmxheSAuYm9keXtwYWRkaW5nOjE2cHg7b3ZlcmZsb3c6YXV0bztmbGV4OjE7cGFkZGluZy1ib3R0b206ODBweH0KLm92ZXJsYXkgLnJvd3tkaXNwbGF5OmZsZXg7Z2FwOjEycHg7YWxpZ24taXRlbXM6Y2VudGVyO3BhZGRpbmc6MTJweDtiYWNrZ3JvdW5kOnZhcigtLWNhcmQpO2JvcmRlci1yYWRpdXM6dmFyKC0tcmFkaXVzKTttYXJnaW4tYm90dG9tOjhweDtib3JkZXI6MXB4IHNvbGlkIHZhcigtLWJvcmRlcil9Ci5vdmVybGF5IC5yb3cuaGlnaGxpZ2h0e2JhY2tncm91bmQ6dmFyKC0tY2FyZC1zZWxlY3RlZCk7Ym9yZGVyLWNvbG9yOnZhcigtLXByaW1hcnkpfQoub3ZlcmxheSAucm93LWluZm97ZmxleDoxO21pbi13aWR0aDowfQoub3ZlcmxheSAucm93LWluZm8gc3Ryb25ne2Rpc3BsYXk6YmxvY2s7d2hpdGUtc3BhY2U6bm93cmFwO292ZXJmbG93OmhpZGRlbjt0ZXh0LW92ZXJmbG93OmVsbGlwc2lzfQoub3ZlcmxheSAucm93LWFjdGlvbnN7ZGlzcGxheTpmbGV4O2dhcDo2cHg7ZmxleC1zaHJpbms6MH0KLm92ZXJsYXkgYnV0dG9uLmljb257d2lkdGg6MzZweDtoZWlnaHQ6MzZweDtib3JkZXItcmFkaXVzOjhweDtib3JkZXI6bm9uZTtjdXJzb3I6cG9pbnRlcjtmb250LXdlaWdodDo2MDA7Zm9udC1zaXplOjE0cHg7ZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyfQoub3ZlcmxheSBidXR0b24udXAsLm92ZXJsYXkgYnV0dG9uLmRvd257YmFja2dyb3VuZDp2YXIoLS1wYW5lbCk7Y29sb3I6dmFyKC0tdGV4dCl9Ci5vdmVybGF5IGJ1dHRvbi51cDpob3Zlciwub3ZlcmxheSBidXR0b24uZG93bjpob3ZlcntiYWNrZ3JvdW5kOnZhcigtLXBhbmVsLWhvdmVyKX0KLm92ZXJsYXkgYnV0dG9uLnJlbW92ZXtiYWNrZ3JvdW5kOnZhcigtLWRhbmdlcik7Y29sb3I6I2ZmZn0KLm92ZXJsYXkgYnV0dG9uLnJlbW92ZTpob3ZlcntiYWNrZ3JvdW5kOiNkYzI2MjZ9CgovKiBNb2RhbCAqLwojZmlsZXNNb2RhbHtiYWNrZ3JvdW5kOnZhcigtLXBhbmVsKTtib3JkZXI6MXB4IHNvbGlkIHZhcigtLWJvcmRlcik7Y29sb3I6dmFyKC0tdGV4dCl9CgoubWV0YXtmb250LXNpemU6MTJweDtjb2xvcjp2YXIoLS1tdXRlZCl9Ci5zbWFsbHtmb250LXNpemU6MTNweDtjb2xvcjp2YXIoLS1tdXRlZCl9CgojdG90YWxzLmV4Y2VlZGVke2NvbG9yOnZhcigtLWRhbmdlcik7Zm9udC13ZWlnaHQ6Ym9sZH0KCi8qIEZpbGUgTGlzdCBDb250YWluZXIgKi8KI2ZpbGVMaXN0Q29udGFpbmVye2JhY2tncm91bmQ6dmFyKC0tY2FyZCk7Ym9yZGVyOjFweCBzb2xpZCB2YXIoLS1ib3JkZXIpO2JvcmRlci1yYWRpdXM6dmFyKC0tcmFkaXVzKTtjb2xvcjp2YXIoLS10ZXh0KX0KI2ZpbGVMaXN0Q29udGFpbmVyIGF7Y29sb3I6dmFyKC0tcHJpbWFyeSl9CgovKiBNb2JpbGUgUmVzcG9uc2l2ZSAqLwpAbWVkaWEgKG1heC13aWR0aDo5MDBweCl7CiAgLmNvbnRhaW5lcntncmlkLXRlbXBsYXRlLWNvbHVtbnM6MWZyO3BhZGRpbmctdG9wOmNhbGMoNzBweCArIDhweCk7cGFkZGluZy1ib3R0b206MTAwcHg7Z2FwOjEycHh9CiAgLnJpZ2h0UGFuZXtvcmRlcjotMTtwYWRkaW5nOjEycHg7Z2FwOjEycHh9CiAgLmhlYWRlcntwYWRkaW5nOjEwcHggMTJweH0KICAuaGVhZGVyIGJ1dHRvbiBzcGFue2Rpc3BsYXk6bm9uZX0KICAuc3RhdHMtZ3JpZHtncmlkLXRlbXBsYXRlLWNvbHVtbnM6cmVwZWF0KDMsMWZyKX0KICAuc3RhdC1jYXJke3BhZGRpbmc6MTBweH0KICAuc3RhdC12YWx1ZXtmb250LXNpemU6MThweH0KICAuc2VsZWN0ZWQtcGFuZWx7ZGlzcGxheTpub25lICFpbXBvcnRhbnR9CiAgLmZpbHRlci10YWJze292ZXJmbG93LXg6YXV0bztmbGV4LXdyYXA6bm93cmFwO3BhZGRpbmc6MTBweCAxMnB4Oy13ZWJraXQtb3ZlcmZsb3ctc2Nyb2xsaW5nOnRvdWNofQogIC5maWx0ZXItdGFiczo6LXdlYmtpdC1zY3JvbGxiYXJ7ZGlzcGxheTpub25lfQogIC5sZWZ0UGFuZXtib3JkZXItcmFkaXVzOnZhcigtLXJhZGl1cyl9CiAgLmxlZnRQYW5lLWlubmVye21heC1oZWlnaHQ6bm9uZTtwYWRkaW5nOjEwcHh9CiAgLnN0b3JhZ2UtY2FyZHtwYWRkaW5nOjEycHh9CiAgLnN0b3JhZ2UtbGVnZW5ke2ZsZXgtd3JhcDp3cmFwO2dhcDo4cHh9CiAgLmFjdGlvbi1yb3d7ZmxleC13cmFwOm5vd3JhcH0KICAuYWN0aW9uLXJvdyAuYnRue2ZvbnQtc2l6ZToxMnB4O3BhZGRpbmc6OHB4IDEwcHh9CiAgLnNoYXJlLXJvdyBpbnB1dHtmb250LXNpemU6MTJweH0KICAuYm90dG9tLWN0YXtwYWRkaW5nOjEycHh9CiAgLmN0YS1idXR0b257aGVpZ2h0OjUwcHg7Zm9udC1zaXplOjE1cHh9Cn0KCkBtZWRpYSAobWF4LXdpZHRoOjYwMHB4KXsKICAuaGVhZGVye2hlaWdodDo2MHB4O2dhcDo4cHh9CiAgLmhlYWRlciAuc2VhcmNoe2hlaWdodDozOHB4O2ZvbnQtc2l6ZToxNHB4fQogIC5oZWFkZXIgLmFjdGlvbnN7Z2FwOjRweH0KICAuaGVhZGVyIGJ1dHRvbntoZWlnaHQ6MzhweDtwYWRkaW5nOjAgMTBweDtmb250LXNpemU6MTJweH0KICAuaXRlbXtwYWRkaW5nOjEwcHg7Z2FwOjEwcHh9CiAgLml0ZW0tdGh1bWJ7d2lkdGg6NDhweDtoZWlnaHQ6NDhweH0KICAuaXRlbS10aXRsZXtmb250LXNpemU6MTNweH0KICAuaXRlbS1zaXple2ZvbnQtc2l6ZToxMnB4fQogIC5pdGVtLWNoZWNrYm94e3dpZHRoOjIycHg7aGVpZ2h0OjIycHh9CiAgLmZvcm1hdC1iYWRnZXtmb250LXNpemU6OHB4O3BhZGRpbmc6MXB4IDRweH0KICAuZmlsdGVyLXRhYntwYWRkaW5nOjZweCAxMnB4O2ZvbnQtc2l6ZToxMnB4fQogIC5jb250YWluZXJ7cGFkZGluZy10b3A6Y2FsYyg2MHB4ICsgOHB4KX0KICAuY29udHJvbHN7Z2FwOjZweH0KICAuY29udHJvbHMgaW5wdXQsLmNvbnRyb2xzIHNlbGVjdHtoZWlnaHQ6NDBweDtmb250LXNpemU6MTNweH0KICAuc3RhdC1jYXJke3BhZGRpbmc6OHB4fQogIC5zdGF0LXZhbHVle2ZvbnQtc2l6ZToxNnB4fQogIC5zdGF0LWxhYmVse2ZvbnQtc2l6ZTo5cHh9Cn0KCkBtZWRpYSAobWF4LXdpZHRoOjQwMHB4KXsKICAuaGVhZGVye3BhZGRpbmc6OHB4fQogIC5oZWFkZXIgYnV0dG9ue3BhZGRpbmc6MCA4cHh9CiAgLml0ZW0tdGh1bWJ7d2lkdGg6NDJweDtoZWlnaHQ6NDJweH0KICAuc3RhdHMtZ3JpZHtnYXA6NnB4fQp9CgouY29uZmlnLXNlY3Rpb257dHJhbnNpdGlvbjphbGwgMC4yNXMgZWFzZX0KLm1vYmlsZS1vbmx5e2Rpc3BsYXk6bm9uZX0KQG1lZGlhIChtYXgtd2lkdGg6OTAwcHgpewogIC5tb2JpbGUtb25seXtkaXNwbGF5OmJsb2NrfQogIC5jb25maWctc2VjdGlvbntkaXNwbGF5Om5vbmV9CiAgLmNvbmZpZy1zZWN0aW9uLmFjdGl2ZXtkaXNwbGF5OmJsb2NrfQp9CgovKiBGaWxlIGJ1dHRvbiBpbiBpdGVtcyAqLwouZmlsZS1idG57YmFja2dyb3VuZDp2YXIoLS1wYW5lbCkgIWltcG9ydGFudDtjb2xvcjp2YXIoLS10ZXh0KSAhaW1wb3J0YW50O2JvcmRlcjoxcHggc29saWQgdmFyKC0tYm9yZGVyKSAhaW1wb3J0YW50fQoKLyogTG9uZyBwcmVzcyB2aXN1YWwgZmVlZGJhY2sgKi8KLml0ZW0ubG9uZy1wcmVzcy1hY3RpdmV7YmFja2dyb3VuZDp2YXIoLS1wcmltYXJ5KSAhaW1wb3J0YW50O3RyYW5zZm9ybTpzY2FsZSgwLjk4KX0KLml0ZW17dXNlci1zZWxlY3Q6bm9uZTstd2Via2l0LXVzZXItc2VsZWN0Om5vbmV9CgovKiBJY29uIGltYWdlIGluIHRodW1ibmFpbCAqLwouaXRlbS10aHVtYiBpbWd7d2lkdGg6MTAwJTtoZWlnaHQ6MTAwJTtvYmplY3QtZml0OmNvdmVyO2JvcmRlci1yYWRpdXM6NnB4fQoKLyogR2FtZSBJbmZvIE1vZGFsICovCiNnYW1lSW5mb01vZGFse2Rpc3BsYXk6bm9uZTtwb3NpdGlvbjpmaXhlZDtpbnNldDowO2JhY2tncm91bmQ6cmdiYSgxMCwxNCwyNiwwLjk1KTt6LWluZGV4OjIwMDtvdmVyZmxvdy15OmF1dG87YmFja2Ryb3AtZmlsdGVyOmJsdXIoMTBweCl9Ci5nYW1lLWluZm97bWF4LXdpZHRoOjYwMHB4O21hcmdpbjowIGF1dG87cGFkZGluZzoxNnB4O3BhZGRpbmctYm90dG9tOjEwMHB4fQouZ2FtZS1pbmZvLWhlYWRlcntwb3NpdGlvbjpyZWxhdGl2ZTttYXJnaW4tYm90dG9tOjE2cHh9Ci5nYW1lLWluZm8tYmFubmVye3dpZHRoOjEwMCU7aGVpZ2h0OjIwMHB4O29iamVjdC1maXQ6Y292ZXI7Ym9yZGVyLXJhZGl1czp2YXIoLS1yYWRpdXMtbGcpO2JhY2tncm91bmQ6dmFyKC0tcGFuZWwpfQouZ2FtZS1pbmZvLWljb257cG9zaXRpb246YWJzb2x1dGU7Ym90dG9tOi0zMHB4O2xlZnQ6MTZweDt3aWR0aDo4MHB4O2hlaWdodDo4MHB4O2JvcmRlci1yYWRpdXM6dmFyKC0tcmFkaXVzKTtib3JkZXI6M3B4IHNvbGlkIHZhcigtLWJnKTtib3gtc2hhZG93OjAgNHB4IDEycHggcmdiYSgwLDAsMCwwLjMpfQouZ2FtZS1pbmZvLWNsb3Nle3Bvc2l0aW9uOmFic29sdXRlO3RvcDoxMnB4O3JpZ2h0OjEycHg7d2lkdGg6MzZweDtoZWlnaHQ6MzZweDtib3JkZXItcmFkaXVzOjUwJTtiYWNrZ3JvdW5kOnJnYmEoMCwwLDAsMC42KTtib3JkZXI6bm9uZTtjb2xvcjojZmZmO2ZvbnQtc2l6ZToyMHB4O2N1cnNvcjpwb2ludGVyO2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OmNlbnRlcn0KLmdhbWUtaW5mby10aXRsZXtmb250LXNpemU6MjBweDtmb250LXdlaWdodDo3MDA7Y29sb3I6dmFyKC0tdGV4dCk7bWFyZ2luLXRvcDo0MHB4O21hcmdpbi1ib3R0b206NHB4fQouZ2FtZS1pbmZvLXB1Ymxpc2hlcntmb250LXNpemU6MTRweDtjb2xvcjp2YXIoLS1tdXRlZCk7bWFyZ2luLWJvdHRvbToxMnB4fQouZ2FtZS1pbmZvLW1ldGF7ZGlzcGxheTpmbGV4O2ZsZXgtd3JhcDp3cmFwO2dhcDo4cHg7bWFyZ2luLWJvdHRvbToxNnB4fQouZ2FtZS1pbmZvLXRhZ3twYWRkaW5nOjRweCAxMHB4O2JhY2tncm91bmQ6dmFyKC0tcGFuZWwpO2JvcmRlci1yYWRpdXM6MjBweDtmb250LXNpemU6MTJweDtjb2xvcjp2YXIoLS10ZXh0LXNlY29uZGFyeSk7Ym9yZGVyOjFweCBzb2xpZCB2YXIoLS1ib3JkZXIpfQouZ2FtZS1pbmZvLXRhZy5nZW5yZXtiYWNrZ3JvdW5kOnZhcigtLXByaW1hcnkpO2NvbG9yOiNmZmY7Ym9yZGVyLWNvbG9yOnZhcigtLXByaW1hcnkpfQouZ2FtZS1pbmZvLXNlY3Rpb257YmFja2dyb3VuZDp2YXIoLS1wYW5lbCk7Ym9yZGVyLXJhZGl1czp2YXIoLS1yYWRpdXMpO3BhZGRpbmc6MTZweDttYXJnaW4tYm90dG9tOjEycHg7Ym9yZGVyOjFweCBzb2xpZCB2YXIoLS1ib3JkZXIpfQouZ2FtZS1pbmZvLXNlY3Rpb24tdGl0bGV7Zm9udC1zaXplOjEycHg7Zm9udC13ZWlnaHQ6NjAwO3RleHQtdHJhbnNmb3JtOnVwcGVyY2FzZTtsZXR0ZXItc3BhY2luZzowLjVweDtjb2xvcjp2YXIoLS1tdXRlZCk7bWFyZ2luLWJvdHRvbTo4cHh9Ci5nYW1lLWluZm8tZGVzY3JpcHRpb257Zm9udC1zaXplOjE0cHg7bGluZS1oZWlnaHQ6MS42O2NvbG9yOnZhcigtLXRleHQtc2Vjb25kYXJ5KTt3aGl0ZS1zcGFjZTpwcmUtbGluZX0KLmdhbWUtaW5mby1pbnRyb3tmb250LXNpemU6MTVweDtmb250LXdlaWdodDo1MDA7Y29sb3I6dmFyKC0tdGV4dCk7bWFyZ2luLWJvdHRvbTo4cHg7Zm9udC1zdHlsZTppdGFsaWN9Ci5nYW1lLWluZm8tc2NyZWVuc2hvdHN7ZGlzcGxheTpncmlkO2dyaWQtdGVtcGxhdGUtY29sdW1uczpyZXBlYXQoMiwxZnIpO2dhcDo4cHh9Ci5nYW1lLWluZm8tc2NyZWVuc2hvdHMgaW1ne3dpZHRoOjEwMCU7Ym9yZGVyLXJhZGl1czo4cHg7Y3Vyc29yOnBvaW50ZXI7dHJhbnNpdGlvbjp0cmFuc2Zvcm0gMC4yc30KLmdhbWUtaW5mby1zY3JlZW5zaG90cyBpbWc6aG92ZXJ7dHJhbnNmb3JtOnNjYWxlKDEuMDIpfQouZ2FtZS1pbmZvLWFjdGlvbnN7cG9zaXRpb246Zml4ZWQ7Ym90dG9tOjA7bGVmdDowO3JpZ2h0OjA7cGFkZGluZzoxNnB4O2JhY2tncm91bmQ6bGluZWFyLWdyYWRpZW50KHRyYW5zcGFyZW50LHZhcigtLWJnKSk7ZGlzcGxheTpmbGV4O2dhcDo4cHg7anVzdGlmeS1jb250ZW50OmNlbnRlcn0KLmdhbWUtaW5mby1hY3Rpb25zIC5idG57bWluLXdpZHRoOjE0MHB4fQoKLyogR2VucmUgRmlsdGVyICovCi5nZW5yZS1maWx0ZXJ7ZGlzcGxheTpmbGV4O2dhcDo4cHg7cGFkZGluZzoxMnB4O2JhY2tncm91bmQ6dmFyKC0tYmctc2Vjb25kYXJ5KTtvdmVyZmxvdy14OmF1dG87LXdlYmtpdC1vdmVyZmxvdy1zY3JvbGxpbmc6dG91Y2h9Ci5nZW5yZS1maWx0ZXI6Oi13ZWJraXQtc2Nyb2xsYmFye2Rpc3BsYXk6bm9uZX0KLmdlbnJlLWNoaXB7cGFkZGluZzo2cHggMTRweDtib3JkZXItcmFkaXVzOjIwcHg7Ym9yZGVyOjFweCBzb2xpZCB2YXIoLS1ib3JkZXIpO2JhY2tncm91bmQ6dHJhbnNwYXJlbnQ7Y29sb3I6dmFyKC0tdGV4dC1zZWNvbmRhcnkpO2ZvbnQtc2l6ZToxM3B4O2ZvbnQtd2VpZ2h0OjUwMDtjdXJzb3I6cG9pbnRlcjt0cmFuc2l0aW9uOmFsbCAwLjJzO3doaXRlLXNwYWNlOm5vd3JhcDtmbGV4LXNocmluazowfQouZ2VucmUtY2hpcDpob3ZlcntiYWNrZ3JvdW5kOnZhcigtLXBhbmVsKTtjb2xvcjp2YXIoLS10ZXh0KX0KLmdlbnJlLWNoaXAuYWN0aXZle2JhY2tncm91bmQ6dmFyKC0tcHJpbWFyeSk7Ym9yZGVyLWNvbG9yOnZhcigtLXByaW1hcnkpO2NvbG9yOiNmZmZ9Ci5nZW5yZS1maWx0ZXIgLmRpdmlkZXJ7d2lkdGg6MXB4O2JhY2tncm91bmQ6dmFyKC0tYm9yZGVyKTttYXJnaW46MCA0cHg7ZmxleC1zaHJpbms6MH0KLnNvcnQtY2hpcHtwYWRkaW5nOjZweCAxNHB4O2JvcmRlci1yYWRpdXM6MjBweDtib3JkZXI6MXB4IHNvbGlkIHZhcigtLWFjY2VudCk7YmFja2dyb3VuZDp0cmFuc3BhcmVudDtjb2xvcjp2YXIoLS1hY2NlbnQpO2ZvbnQtc2l6ZToxM3B4O2ZvbnQtd2VpZ2h0OjUwMDtjdXJzb3I6cG9pbnRlcjt0cmFuc2l0aW9uOmFsbCAwLjJzO3doaXRlLXNwYWNlOm5vd3JhcDtmbGV4LXNocmluazowfQouc29ydC1jaGlwOmhvdmVye2JhY2tncm91bmQ6dmFyKC0tYWNjZW50KTtjb2xvcjojMDAwfQouc29ydC1jaGlwLmFjdGl2ZXtiYWNrZ3JvdW5kOnZhcigtLWFjY2VudCk7Y29sb3I6IzAwMH0KCi8qIFNjcmVlbnNob3QgZnVsbHNjcmVlbiAqLwouc2NyZWVuc2hvdC1mdWxsc2NyZWVue2Rpc3BsYXk6bm9uZTtwb3NpdGlvbjpmaXhlZDtpbnNldDowO2JhY2tncm91bmQ6cmdiYSgwLDAsMCwwLjk1KTt6LWluZGV4OjI1MDthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OmNlbnRlcjtjdXJzb3I6cG9pbnRlcjtmbGV4LWRpcmVjdGlvbjpjb2x1bW47Z2FwOjE2cHh9Ci5zY3JlZW5zaG90LWZ1bGxzY3JlZW4uYWN0aXZle2Rpc3BsYXk6ZmxleH0KLnNjcmVlbnNob3QtZnVsbHNjcmVlbiBpbWd7bWF4LXdpZHRoOjk1JTttYXgtaGVpZ2h0Ojg1JTtvYmplY3QtZml0OmNvbnRhaW47Ym9yZGVyLXJhZGl1czo4cHh9Ci5zY3JlZW5zaG90LWZ1bGxzY3JlZW4gLmNsb3NlLWhpbnR7Y29sb3I6cmdiYSgyNTUsMjU1LDI1NSwwLjYpO2ZvbnQtc2l6ZToxNHB4O3BhZGRpbmc6OHB4IDE2cHg7YmFja2dyb3VuZDpyZ2JhKDAsMCwwLDAuNSk7Ym9yZGVyLXJhZGl1czoyMHB4fQoKLyogVG9hc3Qgbm90aWZpY2F0aW9uICovCi50b2FzdHtwb3NpdGlvbjpmaXhlZDt0b3A6NTAlO2xlZnQ6NTAlO3RyYW5zZm9ybTp0cmFuc2xhdGUoLTUwJSwtNTAlKSBzY2FsZSgwLjgpO2JhY2tncm91bmQ6dmFyKC0tc3VjY2Vzcyk7Y29sb3I6I2ZmZjtwYWRkaW5nOjI0cHggNDhweDtib3JkZXItcmFkaXVzOnZhcigtLXJhZGl1cy1sZyk7Zm9udC1zaXplOjIwcHg7Zm9udC13ZWlnaHQ6NjAwO3otaW5kZXg6MzAwO29wYWNpdHk6MDt0cmFuc2l0aW9uOmFsbCAwLjNzO3BvaW50ZXItZXZlbnRzOm5vbmU7Ym94LXNoYWRvdzowIDEwcHggNDBweCByZ2JhKDAsMCwwLDAuNCl9Ci50b2FzdC5zaG93e29wYWNpdHk6MTt0cmFuc2Zvcm06dHJhbnNsYXRlKC01MCUsLTUwJSkgc2NhbGUoMSl9Cjwvc3R5bGU+CjwvaGVhZD4KPGJvZHk+CiAgPGRpdiBjbGFzcz0iaGVhZGVyIj4KICAgIDxpbnB1dCBpZD0ic2VhcmNoIiBjbGFzcz0ic2VhcmNoIiB0eXBlPSJ0ZXh0IiBwbGFjZWhvbGRlcj0iU2VhcmNoIGdhbWVzLi4uIj4KICAgIDxkaXYgY2xhc3M9ImFjdGlvbnMiPgogICAgICA8YnV0dG9uIGlkPSJjbGVhclNlYXJjaCI+w5c8L2J1dHRvbj4KICAgIDwvZGl2PgogIDwvZGl2PgoKICA8ZGl2IGNsYXNzPSJjb250YWluZXIiPgogICAgPHNlY3Rpb24gY2xhc3M9ImxlZnRQYW5lIiBpZD0ibGVmdFBhbmUiIGFyaWEtbGFiZWw9IkdhbWUgbGlzdCI+CiAgICAgIDxkaXYgY2xhc3M9ImdlbnJlLWZpbHRlciIgaWQ9ImdlbnJlRmlsdGVyIj48L2Rpdj4KICAgICAgPGRpdiBjbGFzcz0ibGVmdFBhbmUtaW5uZXIiIGlkPSJsZWZ0UGFuZUlubmVyIj48L2Rpdj4KICAgIDwvc2VjdGlvbj4KCiAgICA8YXNpZGUgY2xhc3M9InJpZ2h0UGFuZSI+CiAgICAgIDxidXR0b24gaWQ9InRvZ2dsZUNvbmZpZyIgY2xhc3M9ImJ0biBnaG9zdCBtb2JpbGUtb25seSI+SGlkZSBDb25maWd1cmF0aW9uPC9idXR0b24+CgogICAgICA8ZGl2IGlkPSJjb25maWdTZWN0aW9uIiBjbGFzcz0iY29uZmlnLXNlY3Rpb24iPgogICAgICAgIDwhLS0gU3RvcmFnZSBDYXJkIC0tPgogICAgICAgIDxkaXYgY2xhc3M9InN0b3JhZ2UtY2FyZCI+CiAgICAgICAgICA8ZGl2IGNsYXNzPSJzdG9yYWdlLWhlYWRlciI+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9InN0b3JhZ2UtdGl0bGUiPgogICAgICAgICAgICAgIDxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJub25lIiB2aWV3Qm94PSIwIDAgMjQgMjQiIHN0cm9rZT0iY3VycmVudENvbG9yIj48cGF0aCBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMiIgZD0iTTE5IDExSDVtMTQgMGEyIDIgMCAwMTIgMnY2YTIgMiAwIDAxLTIgMkg1YTIgMiAwIDAxLTItMnYtNmEyIDIgMCAwMTItMm0xNCAwVjlhMiAyIDAgMDAtMi0yTTUgMTFWOWEyIDIgMCAwMTItMm0wIDBWNWEyIDIgMCAwMTItMmg2YTIgMiAwIDAxMiAydjJNNyA3aDEwIi8+PC9zdmc+CiAgICAgICAgICAgICAgU0QgQ2FyZCBTdG9yYWdlCiAgICAgICAgICAgIDwvZGl2PgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJzdG9yYWdlLWNhcGFjaXR5Ij48c3BhbiBpZD0ic3BhY2UiPjA8L3NwYW4+R0IgQ2FwYWNpdHk8L2Rpdj4KICAgICAgICAgIDwvZGl2PgogICAgICAgICAgPGRpdiBjbGFzcz0ic3RvcmFnZS1wcm9ncmVzcyI+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9InByb2dyZXNzLXVzZWQiIGlkPSJwcm9ncmVzc1VzZWQiIHN0eWxlPSJ3aWR0aDowJSI+PC9kaXY+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9InByb2dyZXNzLXNlbGVjdGVkIiBpZD0icHJvZ3Jlc3NTZWxlY3RlZCIgc3R5bGU9IndpZHRoOjAlIj48L2Rpdj4KICAgICAgICAgIDwvZGl2PgogICAgICAgICAgPGRpdiBjbGFzcz0ic3RvcmFnZS1sZWdlbmQiPgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJsZWdlbmQtaXRlbSI+PGRpdiBjbGFzcz0ibGVnZW5kLWRvdCB1c2VkIj48L2Rpdj5Vc2VkOiA8c3BhbiBpZD0idXNlZFNwYWNlIj4wPC9zcGFuPiBHQjwvZGl2PgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJsZWdlbmQtaXRlbSI+PGRpdiBjbGFzcz0ibGVnZW5kLWRvdCBzZWxlY3RlZCI+PC9kaXY+U2VsZWN0ZWQ6IDxzcGFuIGlkPSJzZWxlY3RlZFNpemUiPjAuMDA8L3NwYW4+IEdCPC9kaXY+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9ImxlZ2VuZC1pdGVtIj48ZGl2IGNsYXNzPSJsZWdlbmQtZG90IGZyZWUiPjwvZGl2PkZyZWU6IDxzcGFuIGlkPSJmcmVlU3BhY2UiPjA8L3NwYW4+IEdCPC9kaXY+CiAgICAgICAgICA8L2Rpdj4KICAgICAgICA8L2Rpdj4KCiAgICAgICAgPCEtLSBTdGF0cyBHcmlkIC0tPgogICAgICAgIDxkaXYgY2xhc3M9InN0YXRzLWdyaWQiPgogICAgICAgICAgPGRpdiBjbGFzcz0ic3RhdC1jYXJkIj4KICAgICAgICAgICAgPGRpdiBjbGFzcz0ic3RhdC12YWx1ZSIgaWQ9ImNvdW50Ij4wPC9kaXY+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9InN0YXQtbGFiZWwiPlRpdGxlczwvZGl2PgogICAgICAgICAgPC9kaXY+CiAgICAgICAgICA8ZGl2IGNsYXNzPSJzdGF0LWNhcmQgaGlnaGxpZ2h0Ij4KICAgICAgICAgICAgPGRpdiBjbGFzcz0ic3RhdC12YWx1ZSI+PHNwYW4gaWQ9InNlbGVjdGVkU2l6ZURpc3BsYXkiPjAuMDwvc3Bhbj48c21hbGwgc3R5bGU9ImZvbnQtc2l6ZToxNHB4Ij5HQjwvc21hbGw+PC9kaXY+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9InN0YXQtbGFiZWwiPlRvdGFsIFNpemU8L2Rpdj4KICAgICAgICAgIDwvZGl2PgogICAgICAgICAgPGRpdiBjbGFzcz0ic3RhdC1jYXJkIj4KICAgICAgICAgICAgPGRpdiBjbGFzcz0ic3RhdC12YWx1ZSIgaWQ9Imluc3RhbGxFc3RpbWF0ZSI+fjBtPC9kaXY+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9InN0YXQtbGFiZWwiPkVzdC4gVGltZTwvZGl2PgogICAgICAgICAgPC9kaXY+CiAgICAgICAgPC9kaXY+CiAgICAgICAgPGRpdiBjbGFzcz0ic3RhdC1ub3RlIj4KICAgICAgICAgIDxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTQiIGhlaWdodD0iMTQiIGZpbGw9Im5vbmUiIHZpZXdCb3g9IjAgMCAyNCAyNCIgc3Ryb2tlPSJjdXJyZW50Q29sb3IiPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjEwIiBzdHJva2Utd2lkdGg9IjIiLz48cGF0aCBzdHJva2Utd2lkdGg9IjIiIGQ9Ik0xMiAxNnYtNG0wLTRoLjAxIi8+PC9zdmc+CiAgICAgICAgICBFc3QuIGJhc2VkIG9uIDE0TUIvcyB0cmFuc2ZlciByYXRlCiAgICAgICAgPC9kaXY+CgogICAgICAgIDwhLS0gQ29udHJvbHMgLS0+CiAgICAgICAgPGRpdiBjbGFzcz0iY29udHJvbHMiPgogICAgICAgICAgPGRpdiBjbGFzcz0iZnVsbCI+CiAgICAgICAgICAgIDxsYWJlbD5DdXN0b21lciBOYW1lPC9sYWJlbD4KICAgICAgICAgICAgPGlucHV0IGlkPSJjdXN0b21lciIgdHlwZT0idGV4dCIgcGxhY2Vob2xkZXI9IkVudGVyIG5hbWUgKHVzZSB1bmRlcnNjb3JlcykiPgogICAgICAgICAgPC9kaXY+CiAgICAgICAgICA8ZGl2IGNsYXNzPSJmaWxlbmFtZS1wcmV2aWV3IiBpZD0iZmlsZW5hbWVQcmV2aWV3Ij5GaWxlbmFtZSBwcmV2aWV3IHdpbGwgYXBwZWFyIGhlcmXigKY8L2Rpdj4KICAgICAgICAgIDxkaXYgaWQ9ImR5bmFtaWNDb250cm9scyI+PC9kaXY+CiAgICAgICAgPC9kaXY+CiAgICAgIDwvZGl2PgoKICAgICAgPCEtLSBTaGFyZSBSb3cgLS0+CiAgICAgIDxkaXYgY2xhc3M9InNoYXJlLXJvdyI+CiAgICAgICAgPGlucHV0IGlkPSJzaGFyZWFibGUiIHR5cGU9InRleHQiIHBsYWNlaG9sZGVyPSJVcGxvYWQgbGluayB3aWxsIGFwcGVhciBoZXJlLi4uIiByZWFkb25seT4KICAgICAgICA8YnV0dG9uIGlkPSJjb3B5TGluayIgY2xhc3M9ImJ0biBidG4tcHJpbWFyeSI+Q29weTwvYnV0dG9uPgogICAgICA8L2Rpdj4KCiAgICAgIDwhLS0gQWN0aW9uIEJ1dHRvbnMgLS0+CiAgICAgIDxkaXYgY2xhc3M9ImFjdGlvbi1yb3ciPgogICAgICAgIDxidXR0b24gaWQ9InNhdmVCdG4iIGNsYXNzPSJidG4gZ2hvc3QiPlNhdmU8L2J1dHRvbj4KICAgICAgICA8bGFiZWwgZm9yPSJmaWxlSW4iIGNsYXNzPSJidG4gZ2hvc3QiIHN0eWxlPSJjdXJzb3I6cG9pbnRlciI+T3BlbjwvbGFiZWw+CiAgICAgICAgPGlucHV0IGlkPSJmaWxlSW4iIHR5cGU9ImZpbGUiIHN0eWxlPSJkaXNwbGF5Om5vbmU7Ij4KICAgICAgPC9kaXY+CgogICAgICA8ZGl2IGNsYXNzPSJhY3Rpb24tcm93Ij4KICAgICAgICA8YnV0dG9uIGlkPSJhZG1pbkV4cG9ydCIgY2xhc3M9ImJ0biBnaG9zdCI+RXhwb3J0IEFkbWluPC9idXR0b24+CiAgICAgICAgPGJ1dHRvbiBpZD0ibWF0Y2hMaXN0IiBjbGFzcz0iYnRuIGdob3N0Ij5NYXRjaCBMaXN0PC9idXR0b24+CiAgICAgICAgPGJ1dHRvbiBpZD0iYmluTGlzdCIgY2xhc3M9ImJ0biBnaG9zdCI+VXBsb2FkczwvYnV0dG9uPgogICAgICA8L2Rpdj4KCiAgICAgIDxkaXYgaWQ9ImZpbGVMaXN0Q29udGFpbmVyIiBzdHlsZT0iZGlzcGxheTpub25lOyI+CiAgICAgICAgPGRpdiBpZD0iYmluRmlsZUxpc3QiPjwvZGl2PgogICAgICA8L2Rpdj4KCiAgICAgIDxkaXYgY2xhc3M9InN0YXR1cyIgaWQ9InN0YXR1cyI+UmVhZHk8L2Rpdj4KCiAgICAgIDwhLS0gU2VsZWN0ZWQgUGFuZWwgLS0+CiAgICAgIDxkaXYgaWQ9InNlbGVjdGVkUGFuZWwiIGNsYXNzPSJzZWxlY3RlZC1wYW5lbCI+CiAgICAgICAgPGRpdiBjbGFzcz0iaGVhZCI+CiAgICAgICAgICA8c3Bhbj5TZWxlY3RlZCBTb2Z0d2FyZTwvc3Bhbj4KICAgICAgICAgIDxzcGFuIGlkPSJzZWxlY3RlZFBhbmVsQ291bnQiPjAgaXRlbXM8L3NwYW4+CiAgICAgICAgPC9kaXY+CiAgICAgICAgPGRpdiBjbGFzcz0iYm9keSIgaWQ9InNlbGVjdGVkUGFuZWxCb2R5Ij48L2Rpdj4KICAgICAgPC9kaXY+CiAgICA8L2FzaWRlPgogIDwvZGl2PgoKICA8IS0tIEJvdHRvbSBDVEEgQnV0dG9uIC0tPgogIDxkaXYgY2xhc3M9ImJvdHRvbS1jdGEiIGlkPSJib3R0b21DdGEiPgogICAgPGRpdiBjbGFzcz0iYm90dG9tLWN0YS1pbm5lciI+CiAgICAgIDxidXR0b24gY2xhc3M9ImN0YS1zaG93IiBpZD0iY3RhU2hvdyI+CiAgICAgICAgPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0ibm9uZSIgdmlld0JveD0iMCAwIDI0IDI0IiBzdHJva2U9ImN1cnJlbnRDb2xvciI+PHBhdGggc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiIGQ9Ik00IDZoMTZNNCAxMGgxNk00IDE0aDE2TTQgMThoMTYiLz48L3N2Zz4KICAgICAgICA8c3BhbiBjbGFzcz0iYmFkZ2UiIGlkPSJjdGFCYWRnZSI+MDwvc3Bhbj4KICAgICAgPC9idXR0b24+CiAgICAgIDxidXR0b24gY2xhc3M9ImN0YS1idXR0b24iIGlkPSJjdGFVcGxvYWQiPgogICAgICAgIDxzcGFuIGNsYXNzPSJ3YXJuaW5nLWljb24iPuKaoO+4jzwvc3Bhbj4KICAgICAgICA8c3ZnIGNsYXNzPSJ1cGxvYWQtaWNvbiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBmaWxsPSJub25lIiB2aWV3Qm94PSIwIDAgMjQgMjQiIHN0cm9rZT0iY3VycmVudENvbG9yIj48cGF0aCBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMiIgZD0iTTcgMTZhNCA0IDAgMDEtLjg4LTcuOTAzQTUgNSAwIDExMTUuOSA2TDE2IDZhNSA1IDAgMDExIDkuOU0xNSAxM2wtMy0zbTAgMGwtMyAzbTMtM3YxMiIvPjwvc3ZnPgogICAgICAgIDxzcGFuIGlkPSJjdGFUZXh0Ij5VcGxvYWQ8L3NwYW4+CiAgICAgIDwvYnV0dG9uPgogICAgPC9kaXY+CiAgPC9kaXY+CgogIDxkaXYgY2xhc3M9Im92ZXJsYXkiIGlkPSJvdmVybGF5Ij4KICAgIDxkaXYgY2xhc3M9ImhlYWQiPjxkaXY+PHN0cm9uZz5TZWxlY3RlZCBUaXRsZXM8L3N0cm9uZz4g4oCTIDxzcGFuIGlkPSJvdmVybGF5Q291bnQiPjA8L3NwYW4+PC9kaXY+PGRpdj48YnV0dG9uIGlkPSJjbG9zZU92ZXJsYXkiIGNsYXNzPSJidG4gZ2hvc3QiPkNsb3NlPC9idXR0b24+PC9kaXY+PC9kaXY+CiAgICA8ZGl2IGNsYXNzPSJib2R5IiBpZD0ib3ZlcmxheUJvZHkiPjwvZGl2PgogIDwvZGl2Pgo8ZGl2IGlkPSJmaWxlc01vZGFsIiBzdHlsZT0iZGlzcGxheTpub25lO3Bvc2l0aW9uOmZpeGVkO3RvcDo1MCU7bGVmdDo1MCU7dHJhbnNmb3JtOnRyYW5zbGF0ZSgtNTAlLC01MCUpOwogIGJhY2tncm91bmQ6dmFyKC0tcGFuZWwpO3BhZGRpbmc6MjBweDtib3JkZXItcmFkaXVzOnZhcigtLXJhZGl1cy1sZyk7Ym94LXNoYWRvdzowIDIwcHggNTBweCByZ2JhKDAsMCwwLDAuNSk7ei1pbmRleDoyMDA7CiAgbWF4LXdpZHRoOjUwMHB4O3dpZHRoOjkwJTttYXgtaGVpZ2h0Ojcwdmg7b3ZlcmZsb3c6YXV0bztmb250LXNpemU6MTNweDtib3JkZXI6MXB4IHNvbGlkIHZhcigtLWJvcmRlcik7Y29sb3I6dmFyKC0tdGV4dCkiPgo8L2Rpdj4KCjwhLS0gR2FtZSBJbmZvIE1vZGFsIC0tPgo8ZGl2IGlkPSJnYW1lSW5mb01vZGFsIj4KICA8ZGl2IGNsYXNzPSJnYW1lLWluZm8iIGlkPSJnYW1lSW5mb0NvbnRlbnQiPjwvZGl2Pgo8L2Rpdj4KCjwhLS0gU2NyZWVuc2hvdCBGdWxsc2NyZWVuIFZpZXdlciAtLT4KPGRpdiBjbGFzcz0ic2NyZWVuc2hvdC1mdWxsc2NyZWVuIiBpZD0ic2NyZWVuc2hvdFZpZXdlciI+CiAgPGltZyBzcmM9IiIgYWx0PSJTY3JlZW5zaG90IiBpZD0ic2NyZWVuc2hvdEltYWdlIj4KICA8c3BhbiBjbGFzcz0iY2xvc2UtaGludCI+VGFwIGFueXdoZXJlIHRvIGNsb3NlPC9zcGFuPgo8L2Rpdj4KCjwhLS0gVG9hc3Qgbm90aWZpY2F0aW9uIC0tPgo8ZGl2IGNsYXNzPSJ0b2FzdCIgaWQ9InRvYXN0Ij48L2Rpdj4KCjxzY3JpcHQgdHlwZT0idGV4dC9qYXZhc2NyaXB0Ij5jb25zdCBDT05GSUcgPSB7DQogIHhtbEZpbGU6ICdzd2l0Y2hnYW1lcy54bWwnLCAgLy8gQ2hhbmdlIHRoaXMgdG8geW91ciBwbGF0Zm9ybSBYTUwNCiAgY2xpZW50RmlsZUV4dDogJy5DTElfUFJNWicsDQogIGFkbWluRmlsZUV4dDogJy5QUk1aJywNCiAgZmlsZWJpbkJ1Y2tldDogJ3hsZzRrZ2dvemJkZ3NudzQnLA0KICANCiAgLy8gQXV0by1kZXRlY3RlZCBmcm9tIFhNTA0KICBwbGF0Zm9ybTogbnVsbCwNCiAgc3RydWN0dXJlVHlwZTogbnVsbCwgIC8vICdmb2xkZXJzJyBvciAnZmlsZXMnDQogIGFkbWluQmFzZVBhdGg6ICdLOlxcTlNQIDIwMjFcXCcsDQogIA0KICBzdG9yYWdlQ29udHJvbHM6IFsNCiAgICB7DQogICAgICBpZDogJ2NvbnNvbGUnLA0KICAgICAgbGFiZWw6ICdDb25zb2xlJywNCiAgICAgIHR5cGU6ICdzZWxlY3QnLA0KICAgICAgb3B0aW9uczogWw0KICAgICAgICB7IHZhbHVlOiAndjEnLCBsYWJlbDogJ3YxJyB9LA0KICAgICAgICB7IHZhbHVlOiAndjInLCBsYWJlbDogJ3YyJyB9LA0KICAgICAgICB7IHZhbHVlOiAnbGl0ZScsIGxhYmVsOiAnbGl0ZScgfSwNCiAgICAgICAgeyB2YWx1ZTogJ29sZWQnLCBsYWJlbDogJ29sZWQnIH0NCiAgICAgIF0sDQogICAgICBkZWZhdWx0OiAndjEnLA0KICAgICAgZmlsZW5hbWVUb2tlbjogdHJ1ZQ0KICAgIH0sDQogICAgew0KICAgICAgaWQ6ICdzZCcsDQogICAgICBsYWJlbDogJ1NEIENhcmQgKEdCKScsDQogICAgICB0eXBlOiAnc2VsZWN0JywNCiAgICAgIG9wdGlvbnM6IFsNCiAgICAgICAgeyB2YWx1ZTogJzEyOCcsIGxhYmVsOiAnMTI4JyB9LA0KICAgICAgICB7IHZhbHVlOiAnMjU2JywgbGFiZWw6ICcyNTYnIH0sDQogICAgICAgIHsgdmFsdWU6ICc1MTInLCBsYWJlbDogJzUxMicgfSwNCiAgICAgICAgeyB2YWx1ZTogJzEwMjQnLCBsYWJlbDogJzEwMjQnIH0NCiAgICAgIF0sDQogICAgICBkZWZhdWx0OiAnMTI4JywNCiAgICAgIGZpbGVuYW1lVG9rZW46ICdzZCcsDQogICAgICBzdG9yYWdlQ2FsYzogdHJ1ZQ0KICAgIH0sDQogICAgew0KICAgICAgaWQ6ICdhbmRyb2lkJywNCiAgICAgIGxhYmVsOiAnQW5kcm9pZCAoR0IpJywNCiAgICAgIHR5cGU6ICdzZWxlY3QnLA0KICAgICAgb3B0aW9uczogWw0KICAgICAgICB7IHZhbHVlOiAnMCcsIGxhYmVsOiAnMCcgfSwNCiAgICAgICAgeyB2YWx1ZTogJzE2JywgbGFiZWw6ICcxNicgfSwNCiAgICAgICAgeyB2YWx1ZTogJzMyJywgbGFiZWw6ICczMicgfSwNCiAgICAgICAgeyB2YWx1ZTogJzY0JywgbGFiZWw6ICc2NCcgfQ0KICAgICAgXSwNCiAgICAgIGRlZmF1bHQ6ICcwJywNCiAgICAgIGZpbGVuYW1lVG9rZW46ICdkcm9pZCcsDQogICAgICBzdG9yYWdlQ2FsYzogdHJ1ZQ0KICAgIH0sDQogICAgew0KICAgICAgaWQ6ICdsaW51eCcsDQogICAgICBsYWJlbDogJ0xpbnV4IChHQiknLA0KICAgICAgdHlwZTogJ3NlbGVjdCcsDQogICAgICBvcHRpb25zOiBbDQogICAgICAgIHsgdmFsdWU6ICcwJywgbGFiZWw6ICcwJyB9LA0KICAgICAgICB7IHZhbHVlOiAnMTYnLCBsYWJlbDogJzE2JyB9LA0KICAgICAgICB7IHZhbHVlOiAnMzInLCBsYWJlbDogJzMyJyB9LA0KICAgICAgICB7IHZhbHVlOiAnNjQnLCBsYWJlbDogJzY0JyB9DQogICAgICBdLA0KICAgICAgZGVmYXVsdDogJzAnLA0KICAgICAgZmlsZW5hbWVUb2tlbjogJ2xpbicsDQogICAgICBzdG9yYWdlQ2FsYzogdHJ1ZQ0KICAgIH0NCiAgXSwNCiAgDQogIGNhbGN1bGF0ZVN0b3JhZ2U6IGZ1bmN0aW9uKHZhbHVlcykgew0KICAgIGNvbnN0IGNvbnNvbGVWYWwgPSB2YWx1ZXMuY29uc29sZSB8fCAndjEnOw0KICAgIGNvbnN0IHNkVmFsID0gTnVtYmVyKHZhbHVlcy5zZCB8fCAxMjgpOw0KICAgIGNvbnN0IGFuZHJvaWQgPSBOdW1iZXIodmFsdWVzLmFuZHJvaWQgfHwgMCk7DQogICAgY29uc3QgbGludXggPSBOdW1iZXIodmFsdWVzLmxpbnV4IHx8IDApOw0KICAgIGNvbnN0IGp2ZmlsZSA9IDE7DQogICAgY29uc3QgZW11ID0gY29uc29sZVZhbCA9PT0gJ29sZWQnID8gNjQgOiAzMjsNCiAgICBjb25zdCBidWZmYSA9IE1hdGguZmxvb3IoZW11IC8gMyk7DQogICAgY29uc3QgdG90YWxSZXNlcnZlZCA9IGVtdSArIGFuZHJvaWQgKyBsaW51eCArIGp2ZmlsZSArIGJ1ZmZhOw0KICAgIGNvbnN0IGV4dHJhID0gTWF0aC5mbG9vcihlbXUgLyA2KTsNCiAgICByZXR1cm4gKHNkVmFsIC0gdG90YWxSZXNlcnZlZCkgKyBleHRyYTsNCiAgfQ0KfTs8L3NjcmlwdD4KPHNjcmlwdD4KLy8gPT09PT09PT09PT09PT09PT09PT0gQ09ORklHVVJBVElPTiBCTE9DSyA9PT09PT09PT09PT09PT09PT09PQoKLy8gPT09PT09PT09PT09PT09PT09PT0gRU5EIENPTkZJR1VSQVRJT04gPT09PT09PT09PT09PT09PT09PT0KCmNvbnN0IHN0YXRlID0geyBpdGVtczogW10sIHNlbGVjdGVkOiBbXSwgeG1sOiBudWxsLCBsYXN0VXBsb2FkOjAsIGljb25DYWNoZToge30sIGN1cnJlbnRHZW5yZTogJ2FsbCcsIGN1cnJlbnRTb3J0OiAnbmFtZScsIGdlbnJlczogbmV3IFNldCgpIH07CmNvbnN0IGxlZnRQYW5lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xlZnRQYW5lSW5uZXInKTsKY29uc3Qgb3ZlcmxheSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvdmVybGF5Jyk7CmNvbnN0IG92ZXJsYXlCb2R5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ292ZXJsYXlCb2R5Jyk7CmNvbnN0IGlzTW9iaWxlID0gL01vYml8QW5kcm9pZHxpUGhvbmV8aVBhZHxpUG9kL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KTsKY29uc3QgaXNMb2NhbCA9IGZhbHNlOwoKLy8gTG9uZyBwcmVzcyBkZXRlY3Rpb24KY29uc3QgTE9OR19QUkVTU19EVVJBVElPTiA9IDUwMDsgLy8gbXMKbGV0IGxvbmdQcmVzc1RpbWVyID0gbnVsbDsKbGV0IGxvbmdQcmVzc1RyaWdnZXJlZCA9IGZhbHNlOwoKLy8gTG9hZCBpY29uIGNhY2hlCmFzeW5jIGZ1bmN0aW9uIGxvYWRJY29uQ2FjaGUoKSB7CiAgdHJ5IHsKICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goJ2ljb25fY2FjaGUuanNvbicpOwogICAgaWYgKHJlc3BvbnNlLm9rKSB7CiAgICAgIHN0YXRlLmljb25DYWNoZSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTsKICAgICAgY29uc29sZS5sb2coYExvYWRlZCAke09iamVjdC5rZXlzKHN0YXRlLmljb25DYWNoZSkubGVuZ3RofSBpY29ucyBmcm9tIGNhY2hlYCk7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQogIH0gY2F0Y2ggKGUpIHsKICAgIGNvbnNvbGUubG9nKCdObyBpY29uIGNhY2hlIGZvdW5kIChydW4gYnVpbGRfaWNvbl9jYWNoZS5weSB0byBnZW5lcmF0ZSknKTsKICB9CiAgcmV0dXJuIGZhbHNlOwp9CgpmdW5jdGlvbiBnZXRJY29uVXJsKGdhbWVOYW1lKSB7CiAgY29uc3QgY2FjaGVkID0gc3RhdGUuaWNvbkNhY2hlW2dhbWVOYW1lXTsKICByZXR1cm4gY2FjaGVkID8gY2FjaGVkLmljb25VcmwgOiBudWxsOwp9CgpmdW5jdGlvbiBnZXRHYW1lSW5mbyhnYW1lTmFtZSkgewogIHJldHVybiBzdGF0ZS5pY29uQ2FjaGVbZ2FtZU5hbWVdIHx8IG51bGw7Cn0KCmZ1bmN0aW9uIGJ1aWxkR2VucmVGaWx0ZXIoKSB7CiAgc3RhdGUuZ2VucmVzLmNsZWFyKCk7CiAgc3RhdGUuZ2VucmVzLmFkZCgnYWxsJyk7CgogIC8vIENvbGxlY3QgYWxsIGdlbnJlcyBmcm9tIGNhY2hlCiAgT2JqZWN0LnZhbHVlcyhzdGF0ZS5pY29uQ2FjaGUpLmZvckVhY2goaW5mbyA9PiB7CiAgICBpZiAoaW5mby5jYXRlZ29yeSAmJiBBcnJheS5pc0FycmF5KGluZm8uY2F0ZWdvcnkpKSB7CiAgICAgIGluZm8uY2F0ZWdvcnkuZm9yRWFjaChjYXQgPT4gc3RhdGUuZ2VucmVzLmFkZChjYXQpKTsKICAgIH0KICB9KTsKCiAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2dlbnJlRmlsdGVyJyk7CiAgaWYgKCFjb250YWluZXIpIHJldHVybjsKCiAgLy8gU29ydCBnZW5yZXMgYWxwaGFiZXRpY2FsbHksIGJ1dCBrZWVwICdhbGwnIGZpcnN0CiAgY29uc3Qgc29ydGVkR2VucmVzID0gWydhbGwnLCAuLi5BcnJheS5mcm9tKHN0YXRlLmdlbnJlcykuZmlsdGVyKGcgPT4gZyAhPT0gJ2FsbCcpLnNvcnQoKV07CgogIC8vIEJ1aWxkIHNvcnQgY2hpcHMgKGxlZnRtb3N0KSArIGdlbnJlIGNoaXBzCiAgY29uc3Qgc29ydENoaXBzID0gYAogICAgPGJ1dHRvbiBjbGFzcz0ic29ydC1jaGlwICR7c3RhdGUuY3VycmVudFNvcnQgPT09ICduYW1lJyA/ICdhY3RpdmUnIDogJyd9IiBkYXRhLXNvcnQ9Im5hbWUiPkEtWjwvYnV0dG9uPgogICAgPGJ1dHRvbiBjbGFzcz0ic29ydC1jaGlwICR7c3RhdGUuY3VycmVudFNvcnQgPT09ICdsYXRlc3QnID8gJ2FjdGl2ZScgOiAnJ30iIGRhdGEtc29ydD0ibGF0ZXN0Ij5MYXRlc3Q8L2J1dHRvbj4KICAgIDxidXR0b24gY2xhc3M9InNvcnQtY2hpcCAke3N0YXRlLmN1cnJlbnRTb3J0ID09PSAndG9wJyA/ICdhY3RpdmUnIDogJyd9IiBkYXRhLXNvcnQ9InRvcCI+VG9wPC9idXR0b24+CiAgICA8ZGl2IGNsYXNzPSJkaXZpZGVyIj48L2Rpdj4KICBgOwoKICBjb25zdCBnZW5yZUNoaXBzID0gc29ydGVkR2VucmVzLm1hcChnZW5yZSA9PiBgCiAgICA8YnV0dG9uIGNsYXNzPSJnZW5yZS1jaGlwICR7Z2VucmUgPT09IHN0YXRlLmN1cnJlbnRHZW5yZSA/ICdhY3RpdmUnIDogJyd9IiBkYXRhLWdlbnJlPSIke2dlbnJlfSI+CiAgICAgICR7Z2VucmUgPT09ICdhbGwnID8gJ0FsbCBHYW1lcycgOiBnZW5yZX0KICAgIDwvYnV0dG9uPgogIGApLmpvaW4oJycpOwoKICBjb250YWluZXIuaW5uZXJIVE1MID0gc29ydENoaXBzICsgZ2VucmVDaGlwczsKCiAgY29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHsKICAgIGlmIChlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2dlbnJlLWNoaXAnKSkgewogICAgICBzdGF0ZS5jdXJyZW50R2VucmUgPSBlLnRhcmdldC5kYXRhc2V0LmdlbnJlOwogICAgICBjb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnLmdlbnJlLWNoaXAnKS5mb3JFYWNoKGMgPT4gYy5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKSk7CiAgICAgIGUudGFyZ2V0LmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpOwogICAgICByZW5kZXJMaXN0KHN0YXRlLml0ZW1zKTsKICAgIH0KICAgIGlmIChlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ3NvcnQtY2hpcCcpKSB7CiAgICAgIHN0YXRlLmN1cnJlbnRTb3J0ID0gZS50YXJnZXQuZGF0YXNldC5zb3J0OwogICAgICBjb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnLnNvcnQtY2hpcCcpLmZvckVhY2goYyA9PiBjLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpKTsKICAgICAgZS50YXJnZXQuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7CiAgICAgIGFwcGx5U29ydEFuZFJlbmRlcigpOwogICAgfQogIH0pOwp9CgpmdW5jdGlvbiBhcHBseVNvcnRBbmRSZW5kZXIoKSB7CiAgaWYgKCFzdGF0ZS5pdGVtcyB8fCBzdGF0ZS5pdGVtcy5sZW5ndGggPT09IDApIHsKICAgIHRvYXN0KCdObyBsaXN0IGxvYWRlZCB5ZXQnKTsKICAgIHJldHVybjsKICB9CgogIGlmIChzdGF0ZS5jdXJyZW50U29ydCA9PT0gJ2xhdGVzdCcpIHsKICAgIHN0YXRlLml0ZW1zLmZvckVhY2goaXQgPT4gewogICAgICBjb25zdCByYXcgPSBpdC5kYXRlIHx8IGl0LmRhdGVNb2RpZmllZCB8fCBpdC5tb2RpZmllZCB8fCAnJzsKICAgICAgY29uc3QgZCA9IHBhcnNlRGF0ZUZsZXhpYmxlKHJhdyk7CiAgICAgIGl0Ll9wYXJzZWREYXRlID0gZCA/IGQuZ2V0VGltZSgpIDogMDsKICAgIH0pOwogICAgc3RhdGUuaXRlbXMuc29ydCgoYSwgYikgPT4gYi5fcGFyc2VkRGF0ZSAtIGEuX3BhcnNlZERhdGUpOwogIH0gZWxzZSBpZiAoc3RhdGUuY3VycmVudFNvcnQgPT09ICd0b3AnKSB7CiAgICBzdGF0ZS5pdGVtcy5zb3J0KChhLCBiKSA9PiAocGFyc2VJbnQoYi5zY29yZSB8fCAwKSAtIHBhcnNlSW50KGEuc2NvcmUgfHwgMCkpKTsKICB9IGVsc2UgewogICAgLy8gQS1aIHNvcnQgYnkgbmFtZQogICAgc3RhdGUuaXRlbXMuc29ydCgoYSwgYikgPT4gKGEubmFtZSB8fCAnJykubG9jYWxlQ29tcGFyZShiLm5hbWUgfHwgJycpKTsKICB9CgogIHJlbmRlckxpc3Qoc3RhdGUuaXRlbXMpOwp9CgpmdW5jdGlvbiBmaWx0ZXJCeUdlbnJlKGxpc3QpIHsKICBpZiAoc3RhdGUuY3VycmVudEdlbnJlID09PSAnYWxsJykgcmV0dXJuIGxpc3Q7CgogIHJldHVybiBsaXN0LmZpbHRlcihpdGVtID0+IHsKICAgIGNvbnN0IGluZm8gPSBnZXRHYW1lSW5mbyhpdGVtLm5hbWUpOwogICAgaWYgKCFpbmZvIHx8ICFpbmZvLmNhdGVnb3J5KSByZXR1cm4gZmFsc2U7CiAgICByZXR1cm4gaW5mby5jYXRlZ29yeS5pbmNsdWRlcyhzdGF0ZS5jdXJyZW50R2VucmUpOwogIH0pOwp9CgpmdW5jdGlvbiBmb3JtYXRSZWxlYXNlRGF0ZShkYXRlTnVtKSB7CiAgaWYgKCFkYXRlTnVtKSByZXR1cm4gbnVsbDsKICBjb25zdCBzdHIgPSBTdHJpbmcoZGF0ZU51bSk7CiAgaWYgKHN0ci5sZW5ndGggIT09IDgpIHJldHVybiBudWxsOwogIGNvbnN0IHllYXIgPSBzdHIuc2xpY2UoMCwgNCk7CiAgY29uc3QgbW9udGggPSBzdHIuc2xpY2UoNCwgNik7CiAgY29uc3QgZGF5ID0gc3RyLnNsaWNlKDYsIDgpOwogIHJldHVybiBgJHt5ZWFyfS0ke21vbnRofS0ke2RheX1gOwp9CgpmdW5jdGlvbiBzaG93R2FtZUluZm8oaXRlbSkgewogIGNvbnN0IGluZm8gPSBnZXRHYW1lSW5mbyhpdGVtLm5hbWUpOwogIGNvbnN0IG1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2dhbWVJbmZvTW9kYWwnKTsKICBjb25zdCBjb250ZW50ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2dhbWVJbmZvQ29udGVudCcpOwoKICBjb25zdCBiYW5uZXJVcmwgPSBpbmZvPy5iYW5uZXJVcmwgfHwgaW5mbz8uaWNvblVybCB8fCAnJzsKICBjb25zdCBpY29uVXJsID0gaW5mbz8uaWNvblVybCB8fCAnJzsKICBjb25zdCB0aXRsZSA9IGluZm8/Lm1hdGNoZWROYW1lIHx8IGl0ZW0ubmFtZTsKICBjb25zdCBwdWJsaXNoZXIgPSBpbmZvPy5wdWJsaXNoZXIgfHwgJ1Vua25vd24gUHVibGlzaGVyJzsKICBjb25zdCBjYXRlZ29yaWVzID0gaW5mbz8uY2F0ZWdvcnkgfHwgW107CiAgY29uc3QgZGVzY3JpcHRpb24gPSBpbmZvPy5kZXNjcmlwdGlvbiB8fCAnJzsKICBjb25zdCBpbnRybyA9IGluZm8/LmludHJvIHx8ICcnOwogIGNvbnN0IHNjcmVlbnNob3RzID0gaW5mbz8uc2NyZWVuc2hvdHMgfHwgW107CiAgY29uc3QgcmVsZWFzZURhdGUgPSBmb3JtYXRSZWxlYXNlRGF0ZShpbmZvPy5yZWxlYXNlRGF0ZSk7CiAgY29uc3QgcGxheWVycyA9IGluZm8/Lm51bWJlck9mUGxheWVyczsKCiAgY29uc3QgaXNTZWxlY3RlZCA9IHN0YXRlLnNlbGVjdGVkLnNvbWUocyA9PiBzLm5hbWUgPT09IGl0ZW0ubmFtZSk7CgogIGNvbnRlbnQuaW5uZXJIVE1MID0gYAogICAgPGRpdiBjbGFzcz0iZ2FtZS1pbmZvLWhlYWRlciI+CiAgICAgICR7YmFubmVyVXJsID8gYDxpbWcgY2xhc3M9ImdhbWUtaW5mby1iYW5uZXIiIHNyYz0iJHtiYW5uZXJVcmx9IiBhbHQ9IiIgb25lcnJvcj0idGhpcy5zdHlsZS5kaXNwbGF5PSdub25lJyI+YCA6ICc8ZGl2IGNsYXNzPSJnYW1lLWluZm8tYmFubmVyIj48L2Rpdj4nfQogICAgICAke2ljb25VcmwgPyBgPGltZyBjbGFzcz0iZ2FtZS1pbmZvLWljb24iIHNyYz0iJHtpY29uVXJsfSIgYWx0PSIiPmAgOiAnJ30KICAgICAgPGJ1dHRvbiBjbGFzcz0iZ2FtZS1pbmZvLWNsb3NlIiBvbmNsaWNrPSJjbG9zZUdhbWVJbmZvKCkiPsOXPC9idXR0b24+CiAgICA8L2Rpdj4KCiAgICA8ZGl2IGNsYXNzPSJnYW1lLWluZm8tdGl0bGUiPiR7ZXNjKHRpdGxlKX08L2Rpdj4KICAgIDxkaXYgY2xhc3M9ImdhbWUtaW5mby1wdWJsaXNoZXIiPiR7ZXNjKHB1Ymxpc2hlcil9PC9kaXY+CgogICAgPGRpdiBjbGFzcz0iZ2FtZS1pbmZvLW1ldGEiPgogICAgICAke2NhdGVnb3JpZXMubWFwKGMgPT4gYDxzcGFuIGNsYXNzPSJnYW1lLWluZm8tdGFnIGdlbnJlIj4ke2VzYyhjKX08L3NwYW4+YCkuam9pbignJyl9CiAgICAgICR7cmVsZWFzZURhdGUgPyBgPHNwYW4gY2xhc3M9ImdhbWUtaW5mby10YWciPiR7cmVsZWFzZURhdGV9PC9zcGFuPmAgOiAnJ30KICAgICAgJHtwbGF5ZXJzID8gYDxzcGFuIGNsYXNzPSJnYW1lLWluZm8tdGFnIj4ke3BsYXllcnN9IFBsYXllciR7cGxheWVycyA+IDEgPyAncycgOiAnJ308L3NwYW4+YCA6ICcnfQogICAgICA8c3BhbiBjbGFzcz0iZ2FtZS1pbmZvLXRhZyI+JHtpdGVtLnNpemV9PC9zcGFuPgogICAgPC9kaXY+CgogICAgJHtpbnRybyB8fCBkZXNjcmlwdGlvbiA/IGAKICAgICAgPGRpdiBjbGFzcz0iZ2FtZS1pbmZvLXNlY3Rpb24iPgogICAgICAgIDxkaXYgY2xhc3M9ImdhbWUtaW5mby1zZWN0aW9uLXRpdGxlIj5BYm91dDwvZGl2PgogICAgICAgICR7aW50cm8gPyBgPGRpdiBjbGFzcz0iZ2FtZS1pbmZvLWludHJvIj4iJHtlc2MoaW50cm8pfSI8L2Rpdj5gIDogJyd9CiAgICAgICAgJHtkZXNjcmlwdGlvbiA/IGA8ZGl2IGNsYXNzPSJnYW1lLWluZm8tZGVzY3JpcHRpb24iPiR7ZXNjKGRlc2NyaXB0aW9uLnNsaWNlKDAsIDUwMCkpfSR7ZGVzY3JpcHRpb24ubGVuZ3RoID4gNTAwID8gJy4uLicgOiAnJ308L2Rpdj5gIDogJyd9CiAgICAgIDwvZGl2PgogICAgYCA6ICcnfQoKICAgICR7c2NyZWVuc2hvdHMubGVuZ3RoID4gMCA/IGAKICAgICAgPGRpdiBjbGFzcz0iZ2FtZS1pbmZvLXNlY3Rpb24iPgogICAgICAgIDxkaXYgY2xhc3M9ImdhbWUtaW5mby1zZWN0aW9uLXRpdGxlIj5TY3JlZW5zaG90czwvZGl2PgogICAgICAgIDxkaXYgY2xhc3M9ImdhbWUtaW5mby1zY3JlZW5zaG90cyI+CiAgICAgICAgICAke3NjcmVlbnNob3RzLm1hcCh1cmwgPT4gYDxpbWcgc3JjPSIke3VybH0iIGFsdD0iU2NyZWVuc2hvdCIgb25jbGljaz0ic2hvd1NjcmVlbnNob3QoJyR7dXJsfScpIiBsb2FkaW5nPSJsYXp5Ij5gKS5qb2luKCcnKX0KICAgICAgICA8L2Rpdj4KICAgICAgPC9kaXY+CiAgICBgIDogJyd9CgogICAgPGRpdiBjbGFzcz0iZ2FtZS1pbmZvLWFjdGlvbnMiPgogICAgICA8YnV0dG9uIGNsYXNzPSJidG4gJHtpc1NlbGVjdGVkID8gJ2RhbmdlcicgOiAnYnRuLXByaW1hcnknfSIgb25jbGljaz0idG9nZ2xlRnJvbUluZm8oJyR7ZXNjKGl0ZW0ubmFtZSkucmVwbGFjZSgvJy9nLCAiXFwnIil9JykiPgogICAgICAgICR7aXNTZWxlY3RlZCA/ICdSZW1vdmUgZnJvbSBMaXN0JyA6ICdBZGQgdG8gTGlzdCd9CiAgICAgIDwvYnV0dG9uPgogICAgICA8YnV0dG9uIGNsYXNzPSJidG4gZ2hvc3QiIG9uY2xpY2s9ImNsb3NlR2FtZUluZm8oKSI+Q2xvc2U8L2J1dHRvbj4KICAgIDwvZGl2PgogIGA7CgogIG1vZGFsLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOwogIGRvY3VtZW50LmJvZHkuc3R5bGUub3ZlcmZsb3cgPSAnaGlkZGVuJzsKfQoKZnVuY3Rpb24gY2xvc2VHYW1lSW5mbygpIHsKICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZ2FtZUluZm9Nb2RhbCcpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdyA9ICcnOwp9CgpmdW5jdGlvbiBzaG93VG9hc3QobWVzc2FnZSkgewogIGNvbnN0IHRvYXN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RvYXN0Jyk7CiAgdG9hc3QudGV4dENvbnRlbnQgPSBtZXNzYWdlOwogIHRvYXN0LmNsYXNzTGlzdC5hZGQoJ3Nob3cnKTsKICBzZXRUaW1lb3V0KCgpID0+IHRvYXN0LmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3cnKSwgMjAwMCk7Cn0KCmZ1bmN0aW9uIHRvZ2dsZUZyb21JbmZvKGdhbWVOYW1lKSB7CiAgY29uc3QgaXRlbSA9IHN0YXRlLml0ZW1zLmZpbmQoaSA9PiBpLm5hbWUgPT09IGdhbWVOYW1lKTsKICBpZiAoaXRlbSkgewogICAgY29uc3QgaWR4ID0gc3RhdGUuc2VsZWN0ZWQuZmluZEluZGV4KHMgPT4gcy5uYW1lID09PSBnYW1lTmFtZSk7CiAgICBpZiAoaWR4ID49IDApIHsKICAgICAgc3RhdGUuc2VsZWN0ZWQuc3BsaWNlKGlkeCwgMSk7CiAgICAgIHNob3dUb2FzdCgnUmVtb3ZlZCBmcm9tIGxpc3QnKTsKICAgIH0gZWxzZSB7CiAgICAgIHN0YXRlLnNlbGVjdGVkLnB1c2goaXRlbSk7CiAgICAgIHNob3dUb2FzdCgnQWRkZWQgdG8gbGlzdCcpOwogICAgfQogICAgcmVuZGVyTGlzdChzdGF0ZS5pdGVtcyk7CiAgICByZW5kZXJPdmVybGF5KCk7CiAgICB1cGRhdGVUb3RhbHMoKTsKICAgIC8vIFNob3cgdG9hc3QgZmlyc3QsIHRoZW4gY2xvc2UgYWZ0ZXIgZGVsYXkKICAgIHNldFRpbWVvdXQoKCkgPT4gY2xvc2VHYW1lSW5mbygpLCA4MDApOwogIH0KfQoKZnVuY3Rpb24gc2hvd1NjcmVlbnNob3QodXJsKSB7CiAgY29uc3Qgdmlld2VyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NjcmVlbnNob3RWaWV3ZXInKTsKICBjb25zdCBpbWcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2NyZWVuc2hvdEltYWdlJyk7CiAgaW1nLnNyYyA9IHVybDsKICB2aWV3ZXIuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7Cn0KCmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzY3JlZW5zaG90Vmlld2VyJyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewogIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzY3JlZW5zaG90Vmlld2VyJykuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7Cn0pOwoKZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2dhbWVJbmZvTW9kYWwnKT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gewogIGlmIChlLnRhcmdldC5pZCA9PT0gJ2dhbWVJbmZvTW9kYWwnKSBjbG9zZUdhbWVJbmZvKCk7Cn0pOwoKY29uc3QgTUlOX0RFTEFZID0gMTAwMDsKbGV0IG5vdyA9IERhdGUubm93KCk7CmxldCBsYXN0RXhwb3J0VGltZSA9IERhdGUubm93KCk7Cgpjb25zdCAkID0gaWQ9PmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTsKZnVuY3Rpb24gZXNjKHMpeyByZXR1cm4gKHN8fCcnKS5yZXBsYWNlKC8mL2csJyZhbXA7JykucmVwbGFjZSgvPC9nLCcmbHQ7JykucmVwbGFjZSgvPi9nLCcmZ3Q7JykucmVwbGFjZSgvJy9nLCcmIzM5OycpLnJlcGxhY2UoLyIvZywnJnF1b3Q7Jyk7IH0KZnVuY3Rpb24gdG9hc3QobXNnKXsgJCgnc3RhdHVzJykudGV4dENvbnRlbnQgPSBtc2c7IHNldFRpbWVvdXQoKCk9PnsgaWYoJCgnc3RhdHVzJykudGV4dENvbnRlbnQgPT09IG1zZykgJCgnc3RhdHVzJykudGV4dENvbnRlbnQgPSAnUmVhZHknOyB9LCAyNTAwKTsgfQoKZnVuY3Rpb24gcGFyc2VTaXplVGV4dChzKXsgaWYoIXMpIHJldHVybiAwOyBjb25zdCBtID0gKCcnK3MpLm1hdGNoKC8oW1xkXC5dKylccyooR2lCfE1pQnxLaUJ8R0J8TUJ8S0J8QikvaSk7IGlmKCFtKSByZXR1cm4gMDsgY29uc3Qgdj1wYXJzZUZsb2F0KG1bMV0pOyBjb25zdCB1PW1bMl0udG9VcHBlckNhc2UoKTsgaWYodT09PSdCJykgcmV0dXJuIHY7IGlmKHU9PT0nS0InfHx1PT09J0tJQicpIHJldHVybiB2KjEwMjQ7IGlmKHU9PT0nTUInfHx1PT09J01JQicpIHJldHVybiB2KjEwMjQqMTAyNDsgcmV0dXJuIHYqMTAyNCoxMDI0KjEwMjQ7IH0KZnVuY3Rpb24gYnl0ZXNUb0dCKGIpeyByZXR1cm4gYi8oMTAyNCoxMDI0KjEwMjQpOyB9CgovLyBGb3JtYXQgc2l6ZSBzdHJpbmcgdG8gR0IgZGlzcGxheSAoaGFuZGxlcyBNQiBwcm9wZXJseSkKZnVuY3Rpb24gZm9ybWF0U2l6ZVRvR0Ioc2l6ZVN0cikgewogIGNvbnN0IGJ5dGVzID0gcGFyc2VTaXplVGV4dChzaXplU3RyKTsKICBjb25zdCBnYiA9IGJ5dGVzVG9HQihieXRlcyk7CiAgaWYgKGdiIDwgMC4xKSByZXR1cm4gKGdiICogMTAyNCkudG9GaXhlZCgwKSArICcgTUInOwogIHJldHVybiBnYi50b0ZpeGVkKDEpICsgJyBHQic7Cn0KCmZ1bmN0aW9uIGJ1aWxkRHluYW1pY0NvbnRyb2xzKCkgewogIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkeW5hbWljQ29udHJvbHMnKTsKICBjb250YWluZXIuaW5uZXJIVE1MID0gJyc7CiAgY29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnZ3JpZCc7CiAgY29udGFpbmVyLnN0eWxlLmdyaWRUZW1wbGF0ZUNvbHVtbnMgPSAnMWZyIDFmcic7CiAgY29udGFpbmVyLnN0eWxlLmdhcCA9ICc4cHgnOwogIAogIENPTkZJRy5zdG9yYWdlQ29udHJvbHMuZm9yRWFjaChjdHJsID0+IHsKICAgIGNvbnN0IGRpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgY29uc3QgbGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsYWJlbCcpOwogICAgbGFiZWwuY2xhc3NOYW1lID0gJ3NtYWxsJzsKICAgIGxhYmVsLnRleHRDb250ZW50ID0gY3RybC5sYWJlbDsKICAgIGRpdi5hcHBlbmRDaGlsZChsYWJlbCk7CiAgICBpZiAoY3RybC50eXBlID09PSAnc2VsZWN0JykgewogICAgICBjb25zdCBzZWxlY3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzZWxlY3QnKTsKICAgICAgc2VsZWN0LmlkID0gY3RybC5pZDsKICAgICAgc2VsZWN0LnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsIGN0cmwubGFiZWwpOwogICAgICBjdHJsLm9wdGlvbnMuZm9yRWFjaChvcHQgPT4gewogICAgICAgIGNvbnN0IG9wdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGlvbicpOwogICAgICAgIG9wdGlvbi52YWx1ZSA9IG9wdC52YWx1ZTsKICAgICAgICBvcHRpb24udGV4dENvbnRlbnQgPSBvcHQubGFiZWw7CiAgICAgICAgaWYgKG9wdC52YWx1ZSA9PT0gY3RybC5kZWZhdWx0KSBvcHRpb24uc2VsZWN0ZWQgPSB0cnVlOwogICAgICAgIHNlbGVjdC5hcHBlbmRDaGlsZChvcHRpb24pOwogICAgICB9KTsKICAgICAgZGl2LmFwcGVuZENoaWxkKHNlbGVjdCk7CiAgICAgIHNlbGVjdC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsICgpID0+IHVwZGF0ZUZpbGVuYW1lUHJldmlldygpKTsKICAgICAgc2VsZWN0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsICgpID0+IHVwZGF0ZVRvdGFscygpKTsKICAgIH0KICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChkaXYpOwogIH0pOwp9Cgphc3luYyBmdW5jdGlvbiBsb2FkWE1MKCl7CiAgdHJ5ewogICAgY29uc3QgdHh0ID0gYXdhaXQgZmV0Y2goQ09ORklHLnhtbEZpbGUpLnRoZW4ocj0+ci50ZXh0KCkpOwogICAgY29uc3QgeG1sID0gbmV3IERPTVBhcnNlcigpLnBhcnNlRnJvbVN0cmluZyh0eHQsJ2FwcGxpY2F0aW9uL3htbCcpOwogICAgc3RhdGUueG1sID0geG1sOwogICAgCiAgICBjb25zdCByb290ID0geG1sLmRvY3VtZW50RWxlbWVudDsKICAgIENPTkZJRy5wbGF0Zm9ybSA9IHJvb3QuZ2V0QXR0cmlidXRlKCdwbGF0Zm9ybScpIHx8ICdVbmtub3duJzsKICAgIENPTkZJRy5zdHJ1Y3R1cmVUeXBlID0gcm9vdC5nZXRBdHRyaWJ1dGUoJ3N0cnVjdHVyZVR5cGUnKSB8fCAnZm9sZGVycyc7CiAgICAKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYWdlVGl0bGUnKS50ZXh0Q29udGVudCA9IGAke0NPTkZJRy5wbGF0Zm9ybX0gR2FtZXNgOwogICAgCiAgICBsZXQgaXRlbXMgPSBbXTsKICAgIAogICAgaWYgKENPTkZJRy5zdHJ1Y3R1cmVUeXBlID09PSAnZm9sZGVycycpIHsKICAgICAgaXRlbXMgPSBBcnJheS5mcm9tKHhtbC5xdWVyeVNlbGVjdG9yQWxsKCdmb2xkZXInKSkKICAgICAgICAubWFwKGYgPT4gKHsKICAgICAgICAgIG5hbWU6IGYuZ2V0QXR0cmlidXRlKCduYW1lJyksCiAgICAgICAgICBzY29yZTogZi5nZXRBdHRyaWJ1dGUoJ3Njb3JlJykgfHwgJzAnLAogICAgICAgICAgc2l6ZTogZi5nZXRBdHRyaWJ1dGUoJ3NpemUnKSB8fCAnMCBHaUInLAogICAgICAgICAgZGF0ZTogZi5nZXRBdHRyaWJ1dGUoJ2RhdGVDcmVhdGVkJykgfHwgJycsCiAgICAgICAgICBmaWxlQ291bnQ6IGYuZ2V0QXR0cmlidXRlKCdmaWxlQ291bnQnKSB8fCAnMCcsCiAgICAgICAgICBmaWxlczogQXJyYXkuZnJvbShmLnF1ZXJ5U2VsZWN0b3JBbGwoJ2ZpbGUnKSkubWFwKHggPT4geC5nZXRBdHRyaWJ1dGUoJ25hbWUnKSkKICAgICAgICB9KSk7CiAgICB9IGVsc2UgewogICAgICBpdGVtcyA9IEFycmF5LmZyb20oeG1sLnF1ZXJ5U2VsZWN0b3JBbGwoJ2ZpbGUnKSkKICAgICAgICAubWFwKGYgPT4gKHsKICAgICAgICAgIG5hbWU6IGYuZ2V0QXR0cmlidXRlKCduYW1lJyksCiAgICAgICAgICBmaWxlbmFtZTogZi5nZXRBdHRyaWJ1dGUoJ2ZpbGVuYW1lJykgfHwgZi5nZXRBdHRyaWJ1dGUoJ25hbWUnKSwKICAgICAgICAgIHNpemU6IGYuZ2V0QXR0cmlidXRlKCdzaXplJykgfHwgJzAgR2lCJywKICAgICAgICAgIGRhdGU6IGYuZ2V0QXR0cmlidXRlKCdkYXRlQ3JlYXRlZCcpIHx8ICcnCiAgICAgICAgfSkpOwogICAgfQogICAgCiAgICBzdGF0ZS5pdGVtcyA9IGl0ZW1zOwogICAgcmVuZGVyTGlzdChpdGVtcyk7CiAgICB0b2FzdChgTG9hZGVkICR7aXRlbXMubGVuZ3RofSAke0NPTkZJRy5wbGF0Zm9ybX0gZ2FtZXNgKTsKICB9Y2F0Y2goZSl7IAogICAgY29uc29sZS5lcnJvcihlKTsgCiAgICBsZWZ0UGFuZS5pbm5lckhUTUwgPSBgPGRpdiBzdHlsZT0iY29sb3I6I2I5MWMxYztwYWRkaW5nOjEycHgiPkZhaWxlZCB0byBsb2FkICR7Q09ORklHLnhtbEZpbGV9PC9kaXY+YDsgCiAgfQp9CgoKZnVuY3Rpb24gcmVuZGVyTGlzdChsaXN0KXsKICBsZWZ0UGFuZS5pbm5lckhUTUwgPSAnJzsKCiAgLy8gQXBwbHkgZ2VucmUgZmlsdGVyCiAgY29uc3QgZmlsdGVyZWRMaXN0ID0gZmlsdGVyQnlHZW5yZShsaXN0KTsKCiAgaWYoIWZpbHRlcmVkTGlzdHx8IWZpbHRlcmVkTGlzdC5sZW5ndGgpewogICAgbGVmdFBhbmUuaW5uZXJIVE1MID0gJzxkaXYgc3R5bGU9InBhZGRpbmc6NDBweDt0ZXh0LWFsaWduOmNlbnRlcjtjb2xvcjp2YXIoLS1tdXRlZCkiPk5vIGdhbWVzIGZvdW5kPC9kaXY+JzsKICAgIHJldHVybjsKICB9CgogIGZpbHRlcmVkTGlzdC5mb3JFYWNoKGl0ZW09PnsKICAgIGNvbnN0IHJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgcm93LmNsYXNzTmFtZT0naXRlbSc7CiAgICByb3cuZGF0YXNldC5uYW1lID0gaXRlbS5uYW1lOwogICAgcm93LmRhdGFzZXQuc2l6ZSA9IGl0ZW0uc2l6ZTsKICAgIGlmIChpdGVtLmZpbGVuYW1lKSByb3cuZGF0YXNldC5maWxlbmFtZSA9IGl0ZW0uZmlsZW5hbWU7CgogICAgY29uc3QgaGFzRmlsZXMgPSBDT05GSUcuc3RydWN0dXJlVHlwZSA9PT0gJ2ZvbGRlcnMnICYmIGl0ZW0uZmlsZXMgJiYgaXRlbS5maWxlcy5sZW5ndGggPiAwOwogICAgY29uc3QgaXNTZWxlY3RlZCA9IHN0YXRlLnNlbGVjdGVkLnNvbWUocz0+cy5uYW1lPT09aXRlbS5uYW1lKTsKCiAgICAvLyBQYXJzZSBzaXplIGZvciBkaXNwbGF5CiAgICBjb25zdCBzaXplRGlzcGxheSA9IGZvcm1hdFNpemVUb0dCKGl0ZW0uc2l6ZSk7CgogICAgLy8gU2NvcmUgaW5mbwogICAgY29uc3Qgc2NvcmVWYWwgPSBpdGVtLnNjb3JlID8gcGFyc2VJbnQoaXRlbS5zY29yZSkgOiAwOwoKICAgIC8vIEdldCBpY29uIGZyb20gY2FjaGUKICAgIGNvbnN0IGljb25VcmwgPSBnZXRJY29uVXJsKGl0ZW0ubmFtZSk7CiAgICBjb25zdCB0aHVtYkNvbnRlbnQgPSBpY29uVXJsCiAgICAgID8gYDxpbWcgc3JjPSIke2ljb25Vcmx9IiBhbHQ9IiIgbG9hZGluZz0ibGF6eSIgb25lcnJvcj0idGhpcy5zdHlsZS5kaXNwbGF5PSdub25lJzt0aGlzLm5leHRFbGVtZW50U2libGluZy5zdHlsZS5kaXNwbGF5PSdibG9jayciPmAKICAgICAgOiAnJzsKICAgIGNvbnN0IHBsYWNlaG9sZGVyU3R5bGUgPSBpY29uVXJsID8gJ2Rpc3BsYXk6bm9uZScgOiAnJzsKCiAgICByb3cuaW5uZXJIVE1MID0gYAogICAgICA8ZGl2IGNsYXNzPSJpdGVtLXRodW1iIj4KICAgICAgICAke3RodW1iQ29udGVudH0KICAgICAgICA8c3BhbiBjbGFzcz0iaXRlbS10aHVtYi1wbGFjZWhvbGRlciIgc3R5bGU9IiR7cGxhY2Vob2xkZXJTdHlsZX0iPvCfjq48L3NwYW4+CiAgICAgIDwvZGl2PgogICAgICA8ZGl2IGNsYXNzPSJpdGVtLWNvbnRlbnQiPgogICAgICAgIDxkaXYgY2xhc3M9Iml0ZW0tdGl0bGUiPiR7ZXNjKGl0ZW0ubmFtZSl9PC9kaXY+CiAgICAgICAgPGRpdiBjbGFzcz0iaXRlbS1zaXplIj4ke3NpemVEaXNwbGF5fTwvZGl2PgogICAgICAgICR7c2NvcmVWYWwgPiAwID8gYDxkaXYgY2xhc3M9Iml0ZW0tbWV0YSI+U2NvcmU6ICR7c2NvcmVWYWx9PC9kaXY+YCA6ICcnfQogICAgICA8L2Rpdj4KICAgICAgPGRpdiBjbGFzcz0iaXRlbS1jaGVja2JveCI+PC9kaXY+CiAgICBgOwoKICAgIGlmKGlzU2VsZWN0ZWQpIHJvdy5jbGFzc0xpc3QuYWRkKCdzZWxlY3RlZCcpOwoKICAgIC8vIExvbmcgcHJlc3MgdG8gc2hvdyBnYW1lIGluZm8KICAgIGxldCBwcmVzc1RpbWVyID0gbnVsbDsKICAgIGxldCBwcmVzc1RyaWdnZXJlZCA9IGZhbHNlOwoKICAgIGNvbnN0IHN0YXJ0UHJlc3MgPSAoZSkgPT4gewogICAgICBwcmVzc1RyaWdnZXJlZCA9IGZhbHNlOwogICAgICBwcmVzc1RpbWVyID0gc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgcHJlc3NUcmlnZ2VyZWQgPSB0cnVlOwogICAgICAgIHJvdy5jbGFzc0xpc3QuYWRkKCdsb25nLXByZXNzLWFjdGl2ZScpOwogICAgICAgIHNob3dHYW1lSW5mbyhpdGVtKTsKICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHJvdy5jbGFzc0xpc3QucmVtb3ZlKCdsb25nLXByZXNzLWFjdGl2ZScpLCAyMDApOwogICAgICB9LCBMT05HX1BSRVNTX0RVUkFUSU9OKTsKICAgIH07CgogICAgY29uc3QgZW5kUHJlc3MgPSAoZSkgPT4gewogICAgICBjbGVhclRpbWVvdXQocHJlc3NUaW1lcik7CiAgICAgIGlmIChwcmVzc1RyaWdnZXJlZCkgewogICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwogICAgICB9CiAgICB9OwoKICAgIGNvbnN0IGNhbmNlbFByZXNzID0gKCkgPT4gewogICAgICBjbGVhclRpbWVvdXQocHJlc3NUaW1lcik7CiAgICB9OwoKICAgIC8vIFRvdWNoIGV2ZW50cwogICAgcm93LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCBzdGFydFByZXNzLCB7IHBhc3NpdmU6IHRydWUgfSk7CiAgICByb3cuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCBlbmRQcmVzcyk7CiAgICByb3cuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hjYW5jZWwnLCBjYW5jZWxQcmVzcyk7CiAgICByb3cuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2htb3ZlJywgY2FuY2VsUHJlc3MpOwoKICAgIC8vIE1vdXNlIGxvbmcgcHJlc3MgKGRlc2t0b3ApCiAgICByb3cuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgKGUpID0+IHsKICAgICAgaWYgKGUuYnV0dG9uID09PSAwKSBzdGFydFByZXNzKGUpOwogICAgfSk7CiAgICByb3cuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIGVuZFByZXNzKTsKICAgIHJvdy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgY2FuY2VsUHJlc3MpOwoKICAgIHJvdy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChldik9PnsKICAgICAgLy8gU2tpcCBpZiBsb25nIHByZXNzIHdhcyB0cmlnZ2VyZWQKICAgICAgaWYgKGV2LnRhcmdldC5jbG9zZXN0KCcuaXRlbScpPy5jbGFzc0xpc3QuY29udGFpbnMoJ2xvbmctcHJlc3MtYWN0aXZlJykpIHJldHVybjsKCiAgICAgIGlmKGV2LmFsdEtleSl7CiAgICAgICAgc2hvd0dhbWVJbmZvKGl0ZW0pOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICB0b2dnbGVTZWxlY3QoaXRlbSwgcm93KTsKICAgIH0pOwoKICAgIGxlZnRQYW5lLmFwcGVuZENoaWxkKHJvdyk7CiAgfSk7CgogIHVwZGF0ZUNUQUJ1dHRvbigpOwp9CgpmdW5jdGlvbiB1cGRhdGVDVEFCdXR0b24oKSB7CiAgY29uc3QgY3RhVGV4dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjdGFUZXh0Jyk7CiAgY29uc3QgY291bnQgPSBzdGF0ZS5zZWxlY3RlZC5sZW5ndGg7CiAgY29uc3QgdG90YWxCeXRlcyA9IHN0YXRlLnNlbGVjdGVkLnJlZHVjZSgoc3VtLCBzKSA9PiBzdW0gKyBwYXJzZVNpemVUZXh0KHMuc2l6ZSksIDApOwogIGNvbnN0IGdiID0gYnl0ZXNUb0dCKHRvdGFsQnl0ZXMpLnRvRml4ZWQoMSk7CgogIGlmIChjb3VudCA+IDApIHsKICAgIGN0YVRleHQudGV4dENvbnRlbnQgPSBgVXBsb2FkICR7Y291bnR9IEdhbWUke2NvdW50ICE9PSAxID8gJ3MnIDogJyd9ICgke2difSBHQilgOwogIH0gZWxzZSB7CiAgICBjdGFUZXh0LnRleHRDb250ZW50ID0gJ1VwbG9hZCBTZWxlY3Rpb24nOwogIH0KfQoKZnVuY3Rpb24gdG9nZ2xlU2VsZWN0KGl0ZW0sIHJvd0VsKXsgCiAgY29uc3QgaWR4ID0gc3RhdGUuc2VsZWN0ZWQuZmluZEluZGV4KHM9PnMubmFtZT09PWl0ZW0ubmFtZSk7IAogIGlmKGlkeD49MCl7IAogICAgc3RhdGUuc2VsZWN0ZWQuc3BsaWNlKGlkeCwxKTsgCiAgICBpZihyb3dFbCkgcm93RWwuY2xhc3NMaXN0LnJlbW92ZSgnc2VsZWN0ZWQnKTsgCiAgfSBlbHNlIHsgCiAgICBzdGF0ZS5zZWxlY3RlZC5wdXNoKHsgCiAgICAgIG5hbWU6aXRlbS5uYW1lLCAKICAgICAgZmlsZW5hbWU6IGl0ZW0uZmlsZW5hbWUgfHwgaXRlbS5uYW1lLAogICAgICBzaXplOml0ZW0uc2l6ZSAKICAgIH0pOyAKICAgIGlmKHJvd0VsKSByb3dFbC5jbGFzc0xpc3QuYWRkKCdzZWxlY3RlZCcpOyAKICB9CiAgdXBkYXRlVG90YWxzKCk7IAogIHJlbmRlck92ZXJsYXkoKTsgCn0KCmZ1bmN0aW9uIHJlbmRlck92ZXJsYXkoKSB7CiAgb3ZlcmxheUJvZHkuaW5uZXJIVE1MID0gJyc7CiAgc3RhdGUuc2VsZWN0ZWQuZm9yRWFjaCgocyxpKT0+ewogICAgY29uc3Qgcm93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICByb3cuY2xhc3NOYW1lPSdyb3cnOwogICAgY29uc3QgaWNvblVybCA9IGdldEljb25Vcmwocy5uYW1lKTsKICAgIGNvbnN0IHNpemVEaXNwbGF5ID0gZm9ybWF0U2l6ZVRvR0Iocy5zaXplKTsKICAgIHJvdy5pbm5lckhUTUwgPSBgCiAgICAgIDxkaXYgY2xhc3M9Iml0ZW0tdGh1bWIiIHN0eWxlPSJ3aWR0aDo0NHB4O2hlaWdodDo0NHB4O2ZsZXgtc2hyaW5rOjAiPgogICAgICAgICR7aWNvblVybCA/IGA8aW1nIHNyYz0iJHtpY29uVXJsfSIgYWx0PSIiIHN0eWxlPSJ3aWR0aDoxMDAlO2hlaWdodDoxMDAlO29iamVjdC1maXQ6Y292ZXI7Ym9yZGVyLXJhZGl1czo2cHgiPmAgOiAnPHNwYW4gc3R5bGU9ImZvbnQtc2l6ZToxOHB4Ij7wn46uPC9zcGFuPid9CiAgICAgIDwvZGl2PgogICAgICA8ZGl2IGNsYXNzPSJyb3ctaW5mbyI+CiAgICAgICAgPHN0cm9uZz4ke2krMX0uICR7ZXNjKHMubmFtZSl9PC9zdHJvbmc+CiAgICAgICAgPGRpdiBjbGFzcz0nbWV0YSc+JHtzaXplRGlzcGxheX08L2Rpdj4KICAgICAgPC9kaXY+CiAgICAgIDxkaXYgY2xhc3M9InJvdy1hY3Rpb25zIj4KICAgICAgICA8YnV0dG9uIGNsYXNzPSdpY29uIHVwJz7ihpE8L2J1dHRvbj4KICAgICAgICA8YnV0dG9uIGNsYXNzPSdpY29uIGRvd24nPuKGkzwvYnV0dG9uPgogICAgICAgIDxidXR0b24gY2xhc3M9J2ljb24gcmVtb3ZlJz7DlzwvYnV0dG9uPgogICAgICA8L2Rpdj5gOwoKICAgIHJvdy5xdWVyeVNlbGVjdG9yKCcudXAnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpPT57CiAgICAgIGlmKGk+MCl7CiAgICAgICAgW3N0YXRlLnNlbGVjdGVkW2ktMV0sIHN0YXRlLnNlbGVjdGVkW2ldXSA9IFtzdGF0ZS5zZWxlY3RlZFtpXSwgc3RhdGUuc2VsZWN0ZWRbaS0xXV07CiAgICAgICAgcmVuZGVyT3ZlcmxheSgpOwogICAgICAgIHJlbmRlckxpc3Qoc3RhdGUuaXRlbXMpOwogICAgICAgIHVwZGF0ZVRvdGFscygpOwogICAgICAgIG92ZXJsYXlCb2R5LmNoaWxkcmVuW2ktMV0uY2xhc3NMaXN0LmFkZCgnaGlnaGxpZ2h0Jyk7CiAgICAgIH0KICAgIH0pOwoKICAgIHJvdy5xdWVyeVNlbGVjdG9yKCcuZG93bicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCk9PnsKICAgICAgaWYoaTxzdGF0ZS5zZWxlY3RlZC5sZW5ndGgtMSl7CiAgICAgICAgW3N0YXRlLnNlbGVjdGVkW2krMV0sIHN0YXRlLnNlbGVjdGVkW2ldXSA9IFtzdGF0ZS5zZWxlY3RlZFtpXSwgc3RhdGUuc2VsZWN0ZWRbaSsxXV07CiAgICAgICAgcmVuZGVyT3ZlcmxheSgpOwogICAgICAgIHJlbmRlckxpc3Qoc3RhdGUuaXRlbXMpOwogICAgICAgIHVwZGF0ZVRvdGFscygpOwogICAgICAgIG92ZXJsYXlCb2R5LmNoaWxkcmVuW2krMV0uY2xhc3NMaXN0LmFkZCgnaGlnaGxpZ2h0Jyk7CiAgICAgIH0KICAgIH0pOwoKICAgIHJvdy5xdWVyeVNlbGVjdG9yKCcucmVtb3ZlJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKT0+ewogICAgICBjb25zdCByZW1vdmVkID0gc3RhdGUuc2VsZWN0ZWQuc3BsaWNlKGksMSlbMF07CiAgICAgIGNvbnN0IGxlZnRSb3cgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5pdGVtJykpCiAgICAgICAgLmZpbmQoeD0+eC5kYXRhc2V0Lm5hbWU9PT1yZW1vdmVkLm5hbWUpOwogICAgICBpZihsZWZ0Um93KSBsZWZ0Um93LmNsYXNzTGlzdC5yZW1vdmUoJ3NlbGVjdGVkJyk7CiAgICAgIHJlbmRlck92ZXJsYXkoKTsKICAgICAgcmVuZGVyTGlzdChzdGF0ZS5pdGVtcyk7CiAgICAgIHVwZGF0ZVRvdGFscygpOwogICAgfSk7CgogICAgb3ZlcmxheUJvZHkuYXBwZW5kQ2hpbGQocm93KTsKICB9KTsKICAkKCdvdmVybGF5Q291bnQnKS50ZXh0Q29udGVudCA9IHN0YXRlLnNlbGVjdGVkLmxlbmd0aDsKICByZW5kZXJTZWxlY3RlZFBhbmVsKCk7Cn0KCiQoJ3Nob3dTZWxlY3RlZCcpPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpPT57IG92ZXJsYXkuc3R5bGUuZGlzcGxheSA9ICdmbGV4JzsgcmVuZGVyT3ZlcmxheSgpOyB9KTsKJCgnY2xvc2VPdmVybGF5JykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKT0+IG92ZXJsYXkuc3R5bGUuZGlzcGxheSA9ICdub25lJyk7CgovLyBDVEEgU2hvdyBidXR0b24KJCgnY3RhU2hvdycpPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICBvdmVybGF5LnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7CiAgcmVuZGVyT3ZlcmxheSgpOwp9KTsKCi8vIENUQSBVcGxvYWQgYnV0dG9uCiQoJ2N0YVVwbG9hZCcpPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICBkb1VwbG9hZCgpOwp9KTsKCi8vIFByZXZlbnQgYWNjaWRlbnRhbCBwYWdlIHJlZnJlc2gvY2xvc2Ugd2hlbiB1c2VyIGhhcyBzZWxlY3Rpb25zCndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdiZWZvcmV1bmxvYWQnLCAoZSkgPT4gewogIGlmIChzdGF0ZS5zZWxlY3RlZC5sZW5ndGggPiAwKSB7CiAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICBlLnJldHVyblZhbHVlID0gJyc7CiAgICByZXR1cm4gJyc7CiAgfQp9KTsKCmZ1bmN0aW9uIHNob3dGaWxlcyhuYW1lLCBmaWxlcywgc2l6ZSkgewogIGlmICghZmlsZXMgfHwgIWZpbGVzLmxlbmd0aCkgewogICAgYWxlcnQoYE5vIGZpbGVzIGZvciAke25hbWV9YCk7CiAgICByZXR1cm47CiAgfQoKICBjb25zdCBtb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmaWxlc01vZGFsJyk7CiAgbW9kYWwuaW5uZXJIVE1MID0gJyc7IAogIG1vZGFsLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOwogIAogIGNvbnN0IGhlYWRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogIGhlYWRlci5pbm5lckhUTUwgPSBgPHN0cm9uZz4ke2VzYyhuYW1lKX08L3N0cm9uZz48YnI+PHNwYW4gY2xhc3M9Im1ldGEiPlNpemU6ICR7ZXNjKHNpemUpfSDigJMgJHtmaWxlcy5sZW5ndGh9IGZpbGVzPC9zcGFuPmA7CiAgbW9kYWwuYXBwZW5kQ2hpbGQoaGVhZGVyKTsKCiAgY29uc3QgbGlzdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogIGxpc3Quc3R5bGUubWFyZ2luVG9wID0gJzhweCc7CiAgbW9kYWwuYXBwZW5kQ2hpbGQobGlzdCk7CgogIGxldCBpbmRleCA9IDA7CiAgY29uc3QgYmF0Y2ggPSAyMDsKICBmdW5jdGlvbiBsb2FkTW9yZSgpIHsKICAgIGNvbnN0IG5leHQgPSBmaWxlcy5zbGljZShpbmRleCwgaW5kZXgrYmF0Y2gpOwogICAgbGlzdC5pbm5lckhUTUwgKz0gbmV4dC5tYXAoZj0+ZXNjKGYpKS5qb2luKCc8YnI+Jyk7CiAgICBpbmRleCArPSBiYXRjaDsKICAgIGlmIChpbmRleCA+PSBmaWxlcy5sZW5ndGgpIHsKICAgICAgbW9yZUJ0bi5yZW1vdmUoKTsKICAgIH0KICB9CgogIGNvbnN0IG1vcmVCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTsKICBtb3JlQnRuLnRleHRDb250ZW50ID0gJ01vcmUnOwogIG1vcmVCdG4uY2xhc3NOYW1lID0gJ2J0biBnaG9zdCc7CiAgbW9yZUJ0bi5zdHlsZS5tYXJnaW5Ub3AgPSAnMTBweCc7CiAgbW9yZUJ0bi5vbmNsaWNrID0gbG9hZE1vcmU7CiAgbW9kYWwuYXBwZW5kQ2hpbGQobW9yZUJ0bik7CgogIGNvbnN0IGNsb3NlQnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7CiAgY2xvc2VCdG4udGV4dENvbnRlbnQgPSAnQ2xvc2UnOwogIGNsb3NlQnRuLmNsYXNzTmFtZSA9ICdidG4nOwogIGNsb3NlQnRuLnN0eWxlLm1hcmdpblRvcCA9ICcxMHB4JzsKICBjbG9zZUJ0bi5vbmNsaWNrID0gKCk9PnsgbW9kYWwuc3R5bGUuZGlzcGxheT0nbm9uZSc7IG1vZGFsLmlubmVySFRNTD0nJzsgfTsKICBtb2RhbC5hcHBlbmRDaGlsZChjbG9zZUJ0bik7CiAgbG9hZE1vcmUoKTsKfQoKZnVuY3Rpb24gZ2V0Q29udHJvbFZhbHVlcygpIHsKICBjb25zdCB2YWx1ZXMgPSB7fTsKICBDT05GSUcuc3RvcmFnZUNvbnRyb2xzLmZvckVhY2goY3RybCA9PiB7CiAgICBjb25zdCBlbCA9ICQoY3RybC5pZCk7CiAgICBpZiAoZWwpIHZhbHVlc1tjdHJsLmlkXSA9IGVsLnZhbHVlOwogIH0pOwogIHJldHVybiB2YWx1ZXM7Cn0KCmZ1bmN0aW9uIHVwZGF0ZVRvdGFscygpIHsKICBjb25zdCB0b3RhbEJ5dGVzID0gc3RhdGUuc2VsZWN0ZWQucmVkdWNlKChzdW0sIHMpID0+IHN1bSArIHBhcnNlU2l6ZVRleHQocy5zaXplKSwgMCk7CiAgY29uc3QgZ2IgPSBieXRlc1RvR0IodG90YWxCeXRlcyk7CgogIC8vIFVwZGF0ZSBtYWluIHNlbGVjdGVkIHNpemUgZGlzcGxheQogIGNvbnN0IHNlbGVjdGVkU2l6ZUVsID0gJCgnc2VsZWN0ZWRTaXplJyk7CiAgaWYgKHNlbGVjdGVkU2l6ZUVsKSBzZWxlY3RlZFNpemVFbC50ZXh0Q29udGVudCA9IGdiLnRvRml4ZWQoMik7CgogIC8vIFVwZGF0ZSB0aGUgc3RhdCBjYXJkIGRpc3BsYXkKICBjb25zdCBzZWxlY3RlZFNpemVEaXNwbGF5ID0gJCgnc2VsZWN0ZWRTaXplRGlzcGxheScpOwogIGlmIChzZWxlY3RlZFNpemVEaXNwbGF5KSBzZWxlY3RlZFNpemVEaXNwbGF5LnRleHRDb250ZW50ID0gZ2IudG9GaXhlZCgxKTsKCiAgLy8gQ2FsY3VsYXRlIHRpbWUgZXN0aW1hdGUKICBjb25zdCBibG9hdGVkID0gdG90YWxCeXRlcyAqIDEuMjsKICBjb25zdCBzcGVlZCA9IDE0ICogMTAyNCAqIDEwMjQ7CiAgY29uc3Qgc2VjcyA9IE1hdGguY2VpbChibG9hdGVkIC8gc3BlZWQpOwogIGNvbnN0IGhvdXJzID0gTWF0aC5mbG9vcihzZWNzLzM2MDApOwogIGNvbnN0IG1pbnMgPSBNYXRoLmZsb29yKChzZWNzJTM2MDApLzYwKTsKCiAgY29uc3QgaW5zdGFsbEVsID0gJCgnaW5zdGFsbEVzdGltYXRlJyk7CiAgaWYgKGluc3RhbGxFbCkgewogICAgaWYgKGhvdXJzID4gMCkgewogICAgICBpbnN0YWxsRWwudGV4dENvbnRlbnQgPSBgfiR7aG91cnN9aCAke21pbnN9bWA7CiAgICB9IGVsc2UgewogICAgICBpbnN0YWxsRWwudGV4dENvbnRlbnQgPSBgfiR7bWluc31tYDsKICAgIH0KICB9CgogIC8vIFVwZGF0ZSBjb3VudAogIGNvbnN0IGNvdW50RWwgPSAkKCdjb3VudCcpOwogIGlmIChjb3VudEVsKSBjb3VudEVsLnRleHRDb250ZW50ID0gc3RhdGUuc2VsZWN0ZWQubGVuZ3RoOwoKICAvLyBVcGRhdGUgc2VsZWN0ZWQgcGFuZWwgY291bnQKICBjb25zdCBwYW5lbENvdW50ID0gJCgnc2VsZWN0ZWRQYW5lbENvdW50Jyk7CiAgaWYgKHBhbmVsQ291bnQpIHBhbmVsQ291bnQudGV4dENvbnRlbnQgPSBgJHtzdGF0ZS5zZWxlY3RlZC5sZW5ndGh9IGl0ZW0ke3N0YXRlLnNlbGVjdGVkLmxlbmd0aCAhPT0gMSA/ICdzJyA6ICcnfWA7CgogIC8vIFVwZGF0ZSBDVEEgYmFkZ2UKICBjb25zdCBjdGFCYWRnZSA9ICQoJ2N0YUJhZGdlJyk7CiAgaWYgKGN0YUJhZGdlKSBjdGFCYWRnZS50ZXh0Q29udGVudCA9IHN0YXRlLnNlbGVjdGVkLmxlbmd0aDsKCiAgLy8gR2V0IHN0b3JhZ2UgdmFsdWVzCiAgY29uc3QgdmFsdWVzID0gZ2V0Q29udHJvbFZhbHVlcygpOwogIGNvbnN0IHNwYWNlRm9yR2FtZXMgPSBDT05GSUcuY2FsY3VsYXRlU3RvcmFnZSh2YWx1ZXMpOwogIGNvbnN0IHRvdGFsQ2FwYWNpdHkgPSBpc0Zpbml0ZShzcGFjZUZvckdhbWVzKSA/IHNwYWNlRm9yR2FtZXMgOiAwOwoKICAvLyBVcGRhdGUgQ1RBIHdhcm5pbmcgaWYgZXhjZWVkcyBjYXBhY2l0eQogIGNvbnN0IGN0YVVwbG9hZCA9ICQoJ2N0YVVwbG9hZCcpOwogIGlmIChjdGFVcGxvYWQpIHsKICAgIGlmICh0b3RhbENhcGFjaXR5ID4gMCAmJiBnYiA+IHRvdGFsQ2FwYWNpdHkpIHsKICAgICAgY3RhVXBsb2FkLmNsYXNzTGlzdC5hZGQoJ3dhcm5pbmcnKTsKICAgICAgJCgnY3RhVGV4dCcpLnRleHRDb250ZW50ID0gJ0V4Y2VlZHMgTGltaXQhJzsKICAgIH0gZWxzZSB7CiAgICAgIGN0YVVwbG9hZC5jbGFzc0xpc3QucmVtb3ZlKCd3YXJuaW5nJyk7CiAgICAgICQoJ2N0YVRleHQnKS50ZXh0Q29udGVudCA9ICdVcGxvYWQnOwogICAgfQogIH0KCiAgLy8gVXBkYXRlIHNwYWNlIGRpc3BsYXkKICBjb25zdCBzcGFjZUVsID0gJCgnc3BhY2UnKTsKICBpZiAoc3BhY2VFbCkgc3BhY2VFbC50ZXh0Q29udGVudCA9IHRvdGFsQ2FwYWNpdHk7CgogIC8vIENhbGN1bGF0ZSBzdG9yYWdlIGJyZWFrZG93bgogIGNvbnN0IHVzZWRTcGFjZSA9IDA7IC8vIENvdWxkIGJlIGNhbGN1bGF0ZWQgZnJvbSBleGlzdGluZyBzZWxlY3Rpb25zIG9yIGNvbmZpZwogIGNvbnN0IHNlbGVjdGVkU3BhY2UgPSBnYjsKICBjb25zdCBmcmVlU3BhY2UgPSBNYXRoLm1heCgwLCB0b3RhbENhcGFjaXR5IC0gc2VsZWN0ZWRTcGFjZSAtIHVzZWRTcGFjZSk7CgogIC8vIFVwZGF0ZSBsZWdlbmQgdmFsdWVzCiAgY29uc3QgdXNlZFNwYWNlRWwgPSAkKCd1c2VkU3BhY2UnKTsKICBpZiAodXNlZFNwYWNlRWwpIHVzZWRTcGFjZUVsLnRleHRDb250ZW50ID0gdXNlZFNwYWNlLnRvRml4ZWQoMCk7CgogIGNvbnN0IGZyZWVTcGFjZUVsID0gJCgnZnJlZVNwYWNlJyk7CiAgaWYgKGZyZWVTcGFjZUVsKSBmcmVlU3BhY2VFbC50ZXh0Q29udGVudCA9IGZyZWVTcGFjZS50b0ZpeGVkKDEpOwoKICAvLyBVcGRhdGUgcHJvZ3Jlc3MgYmFyCiAgY29uc3QgcHJvZ3Jlc3NVc2VkID0gJCgncHJvZ3Jlc3NVc2VkJyk7CiAgY29uc3QgcHJvZ3Jlc3NTZWxlY3RlZCA9ICQoJ3Byb2dyZXNzU2VsZWN0ZWQnKTsKCiAgaWYgKHRvdGFsQ2FwYWNpdHkgPiAwKSB7CiAgICBjb25zdCB1c2VkUGVyY2VudCA9ICh1c2VkU3BhY2UgLyB0b3RhbENhcGFjaXR5KSAqIDEwMDsKICAgIGNvbnN0IHNlbGVjdGVkUGVyY2VudCA9IE1hdGgubWluKChzZWxlY3RlZFNwYWNlIC8gdG90YWxDYXBhY2l0eSkgKiAxMDAsIDEwMCAtIHVzZWRQZXJjZW50KTsKCiAgICBpZiAocHJvZ3Jlc3NVc2VkKSBwcm9ncmVzc1VzZWQuc3R5bGUud2lkdGggPSBgJHt1c2VkUGVyY2VudH0lYDsKICAgIGlmIChwcm9ncmVzc1NlbGVjdGVkKSBwcm9ncmVzc1NlbGVjdGVkLnN0eWxlLndpZHRoID0gYCR7c2VsZWN0ZWRQZXJjZW50fSVgOwogIH0gZWxzZSB7CiAgICBpZiAocHJvZ3Jlc3NVc2VkKSBwcm9ncmVzc1VzZWQuc3R5bGUud2lkdGggPSAnMCUnOwogICAgaWYgKHByb2dyZXNzU2VsZWN0ZWQpIHByb2dyZXNzU2VsZWN0ZWQuc3R5bGUud2lkdGggPSAnMCUnOwogIH0KCiAgLy8gSGlnaGxpZ2h0IGlmIG92ZXIgY2FwYWNpdHkKICBpZiAoZ2IgPiB0b3RhbENhcGFjaXR5ICYmIHRvdGFsQ2FwYWNpdHkgPiAwKSB7CiAgICBpZiAoc2VsZWN0ZWRTaXplRWwpIHsKICAgICAgc2VsZWN0ZWRTaXplRWwuc3R5bGUuY29sb3IgPSAndmFyKC0tZGFuZ2VyKSc7CiAgICAgIHNlbGVjdGVkU2l6ZUVsLnN0eWxlLmZvbnRXZWlnaHQgPSAnYm9sZCc7CiAgICB9CiAgICBpZiAoc2VsZWN0ZWRTaXplRGlzcGxheSkgewogICAgICBzZWxlY3RlZFNpemVEaXNwbGF5LnN0eWxlLmNvbG9yID0gJ3ZhcigtLWRhbmdlciknOwogICAgfQogIH0gZWxzZSB7CiAgICBpZiAoc2VsZWN0ZWRTaXplRWwpIHsKICAgICAgc2VsZWN0ZWRTaXplRWwuc3R5bGUuY29sb3IgPSAnJzsKICAgICAgc2VsZWN0ZWRTaXplRWwuc3R5bGUuZm9udFdlaWdodCA9ICcnOwogICAgfQogICAgaWYgKHNlbGVjdGVkU2l6ZURpc3BsYXkpIHsKICAgICAgc2VsZWN0ZWRTaXplRGlzcGxheS5zdHlsZS5jb2xvciA9ICcnOwogICAgfQogIH0KCiAgdXBkYXRlRmlsZW5hbWVQcmV2aWV3KCk7CiAgdXBkYXRlQ1RBQnV0dG9uKCk7Cn0KCmZ1bmN0aW9uIHVwZGF0ZUZpbGVuYW1lUHJldmlldygpIHsKICBjb25zdCBjdXN0b21lciA9ICgkKCdjdXN0b21lcicpLnZhbHVlIHx8ICdjdXN0b21lcicpLnRyaW0oKS5yZXBsYWNlKC9bXmEtekEtWjAtOV0vZywnXycpLnRvTG93ZXJDYXNlKCk7CiAgY29uc3QgdmFsdWVzID0gZ2V0Q29udHJvbFZhbHVlcygpOwogIGNvbnN0IHRva2VucyA9IFtjdXN0b21lcl07CiAgCiAgQ09ORklHLnN0b3JhZ2VDb250cm9scy5mb3JFYWNoKGN0cmwgPT4gewogICAgaWYgKGN0cmwuZmlsZW5hbWVUb2tlbikgewogICAgICBjb25zdCB2YWwgPSB2YWx1ZXNbY3RybC5pZF0gfHwgY3RybC5kZWZhdWx0OwogICAgICBjb25zdCB0b2tlbiA9IGN0cmwuZmlsZW5hbWVUb2tlbiA9PT0gdHJ1ZSA/IHZhbCA6IChjdHJsLmZpbGVuYW1lVG9rZW4gKyB2YWwpOwogICAgICB0b2tlbnMucHVzaCh0b2tlbik7CiAgICB9CiAgfSk7CiAgCiAgY29uc3Qgbm93ID0gbmV3IERhdGUoKTsKICBjb25zdCBzdGFtcCA9IG5vdy5nZXRGdWxsWWVhcigpLnRvU3RyaW5nKCkgKwogICAgU3RyaW5nKG5vdy5nZXRNb250aCgpICsgMSkucGFkU3RhcnQoMiwgJzAnKSArCiAgICBTdHJpbmcobm93LmdldERhdGUoKSkucGFkU3RhcnQoMiwgJzAnKSArCiAgICBTdHJpbmcobm93LmdldEhvdXJzKCkpLnBhZFN0YXJ0KDIsICcwJykgKwogICAgU3RyaW5nKG5vdy5nZXRNaW51dGVzKCkpLnBhZFN0YXJ0KDIsICcwJykgKwogICAgU3RyaW5nKG5vdy5nZXRTZWNvbmRzKCkpLnBhZFN0YXJ0KDIsICcwJyk7CiAgdG9rZW5zLnB1c2goc3RhbXApOwogIAogICQoJ2ZpbGVuYW1lUHJldmlldycpLnRleHRDb250ZW50ID0gdG9rZW5zLmpvaW4oJ18nKSArIENPTkZJRy5jbGllbnRGaWxlRXh0Owp9CgpmdW5jdGlvbiBkZWJvdW5jZShmbixtcz0yMDApeyBsZXQgaDsgcmV0dXJuICguLi5hKT0+eyBjbGVhclRpbWVvdXQoaCk7IGg9c2V0VGltZW91dCgoKT0+Zm4oLi4uYSksbXMpOyB9OyB9CgpmdW5jdGlvbiBzbWFydFNlYXJjaChpdGVtcywgcXVlcnkpIHsKICBpZiAoIXF1ZXJ5IHx8ICFxdWVyeS50cmltKCkpIHJldHVybiBpdGVtczsKICAKICBjb25zdCBxID0gcXVlcnkudG9Mb3dlckNhc2UoKS50cmltKCk7CiAgCiAgLy8gUGFyc2Ugc2VhcmNoIHRlcm1zOiBzdXBwb3J0IHF1b3RlcyBmb3IgZXhhY3QgcGhyYXNlcwogIGNvbnN0IHRlcm1zID0gW107CiAgY29uc3QgcXVvdGVSZWdleCA9IC8iKFteIl0rKSJ8JyhbXiddKyknfChcUyspL2c7CiAgbGV0IG1hdGNoOwogIAogIHdoaWxlICgobWF0Y2ggPSBxdW90ZVJlZ2V4LmV4ZWMocSkpICE9PSBudWxsKSB7CiAgICBjb25zdCB0ZXJtID0gKG1hdGNoWzFdIHx8IG1hdGNoWzJdIHx8IG1hdGNoWzNdKS50b0xvd2VyQ2FzZSgpOwogICAgdGVybXMucHVzaCh0ZXJtKTsKICB9CiAgCiAgaWYgKHRlcm1zLmxlbmd0aCA9PT0gMCkgcmV0dXJuIGl0ZW1zOwogIAogIC8vIEZpbHRlciBpdGVtczogQUxMIHRlcm1zIG11c3QgbWF0Y2ggKEFORCBsb2dpYykKICByZXR1cm4gaXRlbXMuZmlsdGVyKGl0ZW0gPT4gewogICAgY29uc3Qgc2VhcmNoVGV4dCA9IChpdGVtLm5hbWUgfHwgJycpLnRvTG93ZXJDYXNlKCkKICAgICAgLnJlcGxhY2UoL1teXHdcc10vZywgJyAnKTsgLy8gUmVtb3ZlIHB1bmN0dWF0aW9uIGZvciBtYXRjaGluZwogICAgCiAgICByZXR1cm4gdGVybXMuZXZlcnkodGVybSA9PiBzZWFyY2hUZXh0LmluY2x1ZGVzKHRlcm0pKTsKICB9KTsKfQoKLy8gQXV0by1ibHVyIHNlYXJjaCBvbiBtb2JpbGUgYWZ0ZXIgdHlwaW5nIHN0b3BzCmxldCBzZWFyY2hCbHVyVGltZXIgPSBudWxsOwokKCdzZWFyY2gnKS5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIGRlYm91bmNlKChlKT0+ewogIGNvbnN0IHEgPSBlLnRhcmdldC52YWx1ZSB8fCAnJzsKICBjb25zdCBmaWx0ZXJlZCA9IHNtYXJ0U2VhcmNoKHN0YXRlLml0ZW1zLCBxKTsKICByZW5kZXJMaXN0KGZpbHRlcmVkKTsKCiAgLy8gT24gbW9iaWxlLCBhdXRvLWhpZGUga2V5Ym9hcmQgYWZ0ZXIgMiBzZWNvbmRzIG9mIG5vIHR5cGluZwogIGlmIChpc01vYmlsZSkgewogICAgY2xlYXJUaW1lb3V0KHNlYXJjaEJsdXJUaW1lcik7CiAgICBzZWFyY2hCbHVyVGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgaWYgKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgPT09ICQoJ3NlYXJjaCcpKSB7CiAgICAgICAgJCgnc2VhcmNoJykuYmx1cigpOwogICAgICB9CiAgICB9LCAyMDAwKTsKICB9Cn0sIDE4MCkpOwoKLy8gU3RvcmUgc2VhcmNoIHF1ZXJ5IGZvciB1c2UgaW4gcmVuZGVyaW5nCmxldCBjdXJyZW50U2VhcmNoUXVlcnkgPSAnJzsKCiQoJ2NsZWFyU2VhcmNoJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKT0+eyAkKCdzZWFyY2gnKS52YWx1ZT0nJzsgcmVuZGVyTGlzdChzdGF0ZS5pdGVtcyk7IH0pOwoKQ09ORklHLnN0b3JhZ2VDb250cm9scy5mb3JFYWNoKGN0cmwgPT4gewogIGNvbnN0IGlkID0gY3RybC5pZDsKICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsICgpID0+IHsKICAgIGNvbnN0IGVsID0gJChpZCk7CiAgICBpZihlbCl7CiAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKCkgPT4gdXBkYXRlRmlsZW5hbWVQcmV2aWV3KCkpOwogICAgICBlbC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoKSA9PiB1cGRhdGVUb3RhbHMoKSk7CiAgICB9CiAgfSk7Cn0pOwoKJCgnY3VzdG9tZXInKS5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsICgpID0+IHVwZGF0ZUZpbGVuYW1lUHJldmlldygpKTsKCmZ1bmN0aW9uIHBhcnNlRmlsZW5hbWVUb0NvbmZpZyhmbikgewogIGNvbnN0IGJhc2UgPSBmbi5yZXBsYWNlKG5ldyBSZWdFeHAoYFxcJHtDT05GSUcuY2xpZW50RmlsZUV4dH18XFwke0NPTkZJRy5hZG1pbkZpbGVFeHR9fFxcLih0eHQpJGAsICdpJyksICcnKTsKICBjb25zdCBwYXJ0cyA9IGJhc2Uuc3BsaXQoJ18nKTsKICBpZiAocGFydHMubGVuZ3RoIDwgMikgcmV0dXJuIG51bGw7CiAgCiAgY29uc3QgY29uZmlnID0geyBjdXN0b21lcjogcGFydHNbMF0gfTsKICAKICBDT05GSUcuc3RvcmFnZUNvbnRyb2xzLmZvckVhY2goY3RybCA9PiB7CiAgICBpZiAoY3RybC5maWxlbmFtZVRva2VuKSB7CiAgICAgIGNvbnN0IHBhdHRlcm4gPSBjdHJsLmZpbGVuYW1lVG9rZW4gPT09IHRydWUgCiAgICAgICAgPyBgXigke2N0cmwub3B0aW9ucy5tYXAobyA9PiBvLnZhbHVlKS5qb2luKCd8Jyl9KSRgCiAgICAgICAgOiBgXiR7Y3RybC5maWxlbmFtZVRva2VufVxcZCskYDsKICAgICAgY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKHBhdHRlcm4pOwogICAgICAKICAgICAgcGFydHMuZm9yRWFjaChwID0+IHsKICAgICAgICBpZiAocmVnZXgudGVzdChwKSkgewogICAgICAgICAgY29uZmlnW2N0cmwuaWRdID0gY3RybC5maWxlbmFtZVRva2VuID09PSB0cnVlID8gcCA6IHAucmVwbGFjZShjdHJsLmZpbGVuYW1lVG9rZW4sICcnKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0pOwogIAogIHJldHVybiBjb25maWc7Cn0KCiQoJ2ZpbGVJbicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIChldik9PnsKICBjb25zdCBmID0gZXYudGFyZ2V0LmZpbGVzWzBdOyAKICBpZighZikgcmV0dXJuOyAKICAKICBjb25zdCBjZmcgPSBwYXJzZUZpbGVuYW1lVG9Db25maWcoZi5uYW1lKTsgCiAgaWYoY2ZnKXsgCiAgICAkKCdjdXN0b21lcicpLnZhbHVlID0gY2ZnLmN1c3RvbWVyIHx8ICcnOwogICAgQ09ORklHLnN0b3JhZ2VDb250cm9scy5mb3JFYWNoKGN0cmwgPT4gewogICAgICBjb25zdCBlbCA9ICQoY3RybC5pZCk7CiAgICAgIGlmIChlbCAmJiBjZmdbY3RybC5pZF0pIHsKICAgICAgICBpZiAoY3RybC50eXBlID09PSAnc2VsZWN0JykgewogICAgICAgICAgQXJyYXkuZnJvbShlbC5vcHRpb25zKS5mb3JFYWNoKG8gPT4gewogICAgICAgICAgICBpZiAoby52YWx1ZSA9PT0gY2ZnW2N0cmwuaWRdKSBvLnNlbGVjdGVkID0gdHJ1ZTsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfQogICAgfSk7CiAgICB1cGRhdGVGaWxlbmFtZVByZXZpZXcoKTsgCiAgICB1cGRhdGVUb3RhbHMoKTsKICB9CiAgCiAgY29uc3QgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsgCiAgcmVhZGVyLm9ubG9hZCA9IChlKT0+eyAKICAgIGNvbnN0IGxpbmVzID0gZS50YXJnZXQucmVzdWx0LnNwbGl0KCdcbicpLm1hcChzPT5zLnRyaW0oKSkuZmlsdGVyKEJvb2xlYW4pOyAKICAgIHN0YXRlLnNlbGVjdGVkPVtdOyAKICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5pdGVtJykuZm9yRWFjaChpPT5pLmNsYXNzTGlzdC5yZW1vdmUoJ3NlbGVjdGVkJykpOwogICAgCiAgICBsaW5lcy5mb3JFYWNoKHRpdGxlPT57IAogICAgICBjb25zdCBsZWZ0ID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuaXRlbScpKS5maW5kKGk9PmkuZGF0YXNldC5uYW1lPT09dGl0bGUpOyAKICAgICAgaWYobGVmdCl7IAogICAgICAgIGxlZnQuY2xhc3NMaXN0LmFkZCgnc2VsZWN0ZWQnKTsgCiAgICAgICAgc3RhdGUuc2VsZWN0ZWQucHVzaCh7IG5hbWU6bGVmdC5kYXRhc2V0Lm5hbWUsIGZpbGVuYW1lOiBsZWZ0LmRhdGFzZXQuZmlsZW5hbWUgfHwgbGVmdC5kYXRhc2V0Lm5hbWUsIHNpemU6bGVmdC5kYXRhc2V0LnNpemUgfSk7IAogICAgICB9IGVsc2UgeyAKICAgICAgICBjb25zdCBtYXliZSA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLml0ZW0nKSkuZmluZChpPT5pLmRhdGFzZXQubmFtZSAmJiBpLmRhdGFzZXQubmFtZS50b0xvd2VyQ2FzZSgpPT09dGl0bGUudG9Mb3dlckNhc2UoKSk7IAogICAgICAgIGlmKG1heWJlKXsgCiAgICAgICAgICBtYXliZS5jbGFzc0xpc3QuYWRkKCdzZWxlY3RlZCcpOyAKICAgICAgICAgIHN0YXRlLnNlbGVjdGVkLnB1c2goeyBuYW1lOm1heWJlLmRhdGFzZXQubmFtZSwgZmlsZW5hbWU6IG1heWJlLmRhdGFzZXQuZmlsZW5hbWUgfHwgbWF5YmUuZGF0YXNldC5uYW1lLCBzaXplOm1heWJlLmRhdGFzZXQuc2l6ZSB9KTsgCiAgICAgICAgfSAKICAgICAgfSAKICAgIH0pOyAKICAgIHVwZGF0ZVRvdGFscygpOyAKICAgIHJlbmRlck92ZXJsYXkoKTsgCiAgfTsKICByZWFkZXIucmVhZEFzVGV4dChmKTsKfSk7CgokKCdzYXZlQnRuJyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCk9PnsKICBub3cgPSBEYXRlLm5vdygpOwogIGlmIChub3cgLSBsYXN0RXhwb3J0VGltZSA8IE1JTl9ERUxBWSkgewogICAgdG9hc3QoJ1BsZWFzZSB3YWl0IGJlZm9yZSBleHBvcnRpbmcgYWdhaW4nKTsKICAgIGFsZXJ0KCdQbGVhc2Ugd2FpdCBiZWZvcmUgZXhwb3J0aW5nIGFnYWluJyk7CiAgICByZXR1cm47CiAgfQogIGxhc3RFeHBvcnRUaW1lID0gbm93OwoKICBpZihzdGF0ZS5zZWxlY3RlZC5sZW5ndGg9PT0wKXsgYWxlcnQoJ05vIGl0ZW1zIHNlbGVjdGVkJyk7IHJldHVybjsgfQogIGNvbnN0IGN1c3QgPSAoJCgnY3VzdG9tZXInKS52YWx1ZXx8JycpLnRyaW0oKTsgCiAgaWYoIWN1c3QpeyBhbGVydCgnQ3VzdG9tZXIgbmFtZSByZXF1aXJlZCcpOyByZXR1cm47IH0KICBjb25zdCBmaWxlbmFtZSA9ICQoJ2ZpbGVuYW1lUHJldmlldycpLnRleHRDb250ZW50IHx8IGBsaXN0JHtDT05GSUcuY2xpZW50RmlsZUV4dH1gOwogIGNvbnN0IGJsb2IgPSBuZXcgQmxvYihbc3RhdGUuc2VsZWN0ZWQubWFwKHM9PnMubmFtZSkuam9pbignXG4nKV0sIHsgdHlwZTondGV4dC9wbGFpbicgfSk7IAogIGNvbnN0IGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7IAogIGEuaHJlZiA9IFVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYik7IAogIGEuZG93bmxvYWQgPSBmaWxlbmFtZTsgCiAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChhKTsgCiAgYS5jbGljaygpOyAKICBhLnJlbW92ZSgpOyAKICBVUkwucmV2b2tlT2JqZWN0VVJMKGEuaHJlZik7IAogIHRvYXN0KCdTYXZlZCBjbGllbnQgZmlsZScpOwp9KTsKCiQoJ2FkbWluRXhwb3J0Jyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgKCk9PnsKICBub3cgPSBEYXRlLm5vdygpOwogIGlmIChub3cgLSBsYXN0RXhwb3J0VGltZSA8IE1JTl9ERUxBWSkgewogICAgdG9hc3QoJ1BsZWFzZSB3YWl0IGJlZm9yZSBleHBvcnRpbmcgYWdhaW4nKTsKICAgIGFsZXJ0KCdQbGVhc2Ugd2FpdCBiZWZvcmUgZXhwb3J0aW5nIGFnYWluJyk7CiAgICByZXR1cm47CiAgfQogIGxhc3RFeHBvcnRUaW1lID0gbm93OwoKICBpZihzdGF0ZS5zZWxlY3RlZC5sZW5ndGg9PT0wKXsgYWxlcnQoJ05vIGl0ZW1zIHNlbGVjdGVkJyk7IHJldHVybjsgfQogIGNvbnN0IGN1c3QgPSAoJCgnY3VzdG9tZXInKS52YWx1ZXx8JycpLnRyaW0oKTsgCiAgaWYoIWN1c3QpeyBhbGVydCgnQ3VzdG9tZXIgbmFtZSByZXF1aXJlZCcpOyByZXR1cm47IH0KICAKICB0cnl7IAogICAgY29uc3QgeG1sdHh0ID0gYXdhaXQgZmV0Y2goQ09ORklHLnhtbEZpbGUpLnRoZW4ocj0+ci50ZXh0KCkpOyAKICAgIGNvbnN0IHhtbCA9IG5ldyBET01QYXJzZXIoKS5wYXJzZUZyb21TdHJpbmcoeG1sdHh0LCdhcHBsaWNhdGlvbi94bWwnKTsgCiAgICBsZXQgY29udGVudD0nJzsgCiAgICAKICAgIGlmIChDT05GSUcuc3RydWN0dXJlVHlwZSA9PT0gJ2ZvbGRlcnMnKSB7CiAgICAgIHN0YXRlLnNlbGVjdGVkLmZvckVhY2goc2VsPT57IAogICAgICAgIGNvbnN0IGZvbGRlciA9IEFycmF5LmZyb20oeG1sLnF1ZXJ5U2VsZWN0b3JBbGwoJ2ZvbGRlcicpKS5maW5kKGY9PmYuZ2V0QXR0cmlidXRlKCduYW1lJyk9PT1zZWwubmFtZSk7IAogICAgICAgIGlmKGZvbGRlcil7IAogICAgICAgICAgZm9sZGVyLnF1ZXJ5U2VsZWN0b3JBbGwoJ2ZpbGUnKS5mb3JFYWNoKGZpbGU9PiAKICAgICAgICAgICAgY29udGVudCArPSBgJHtDT05GSUcuYWRtaW5CYXNlUGF0aH0ke2ZvbGRlci5nZXRBdHRyaWJ1dGUoJ25hbWUnKX1cXCR7ZmlsZS5nZXRBdHRyaWJ1dGUoJ25hbWUnKX1cbmAKICAgICAgICAgICk7IAogICAgICAgIH0gCiAgICAgIH0pOwogICAgfSBlbHNlIHsKICAgICAgc3RhdGUuc2VsZWN0ZWQuZm9yRWFjaChzZWw9PnsgCiAgICAgICAgY29uc3QgZmlsZW5hbWUgPSBzZWwuZmlsZW5hbWUgfHwgc2VsLm5hbWU7CiAgICAgICAgY29udGVudCArPSBgJHtDT05GSUcuYWRtaW5CYXNlUGF0aH0ke2ZpbGVuYW1lfVxuYDsKICAgICAgfSk7CiAgICB9CiAgICAKICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7IAogICAgY29uc3Qgc3RhbXAgPSBgJHtub3cuZ2V0RnVsbFllYXIoKX0ke1N0cmluZyhub3cuZ2V0TW9udGgoKSsxKS5wYWRTdGFydCgyLCcwJyl9JHtTdHJpbmcobm93LmdldERhdGUoKSkucGFkU3RhcnQoMiwnMCcpfV8ke1N0cmluZyhub3cuZ2V0SG91cnMoKSkucGFkU3RhcnQoMiwnMCcpfSR7U3RyaW5nKG5vdy5nZXRNaW51dGVzKCkpLnBhZFN0YXJ0KDIsJzAnKX1gOyAKICAgIGNvbnN0IGZuYW1lID0gYCR7KGN1c3R8fCdjdXN0b21lcicpLnJlcGxhY2UoL1teYS16QS1aMC05XS9nLCdfJyl9XyR7c3RhbXB9JHtDT05GSUcuYWRtaW5GaWxlRXh0fWA7IAogICAgY29uc3QgYmxvYiA9IG5ldyBCbG9iKFtjb250ZW50XSwgeyB0eXBlOid0ZXh0L3BsYWluJyB9KTsgCiAgICBjb25zdCBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpOyAKICAgIGEuaHJlZiA9IFVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYik7IAogICAgYS5kb3dubG9hZCA9IGZuYW1lOyAKICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoYSk7IAogICAgYS5jbGljaygpOyAKICAgIGEucmVtb3ZlKCk7IAogICAgVVJMLnJldm9rZU9iamVjdFVSTChhLmhyZWYpOyAKICAgIHRvYXN0KCdBZG1pbiBleHBvcnQgcmVhZHknKTsgCiAgfWNhdGNoKGUpeyAKICAgIGNvbnNvbGUuZXJyb3IoZSk7IAogICAgdG9hc3QoJ0FkbWluIGV4cG9ydCBmYWlsZWQnKTsgCiAgfQp9KTsKCmFzeW5jIGZ1bmN0aW9uIGRvVXBsb2FkKCkgewogIGlmKHN0YXRlLnNlbGVjdGVkLmxlbmd0aD09PTApeyBhbGVydCgnTm8gaXRlbXMgc2VsZWN0ZWQnKTsgcmV0dXJuOyB9CiAgY29uc3QgY3VzdCA9ICgkKCdjdXN0b21lcicpLnZhbHVlfHwnJykudHJpbSgpOwogIGlmKCFjdXN0KXsgYWxlcnQoJ0N1c3RvbWVyIHJlcXVpcmVkJyk7IHJldHVybjsgfQogIGlmKCFjb25maXJtKGBVcGxvYWQgbGlzdCBmb3IgJHtjdXN0fT9gKSkgcmV0dXJuOwoKICBjb25zdCBmaWxlbmFtZSA9ICQoJ2ZpbGVuYW1lUHJldmlldycpLnRleHRDb250ZW50IHx8IGBsaXN0JHtDT05GSUcuY2xpZW50RmlsZUV4dH1gOwogIGNvbnN0IGJsb2IgPSBuZXcgQmxvYihbc3RhdGUuc2VsZWN0ZWQubWFwKHM9PnMubmFtZSkuam9pbignXG4nKV0sIHsgdHlwZTondGV4dC9wbGFpbicgfSk7CiAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTsKICBpZihub3cgLSBzdGF0ZS5sYXN0VXBsb2FkIDwgMTUwMDApeyBhbGVydCgnUGxlYXNlIHdhaXQgMTUgc2Vjb25kcyBiZXR3ZWVuIHVwbG9hZHMnKTsgcmV0dXJuOyB9CgogIHRyeXsKICAgIGNvbnN0IHVybCA9IGBodHRwczovL2ZpbGViaW4ubmV0LyR7Q09ORklHLmZpbGViaW5CdWNrZXR9LyR7ZmlsZW5hbWV9YDsKICAgIGNvbnN0IHIgPSBhd2FpdCBmZXRjaCh1cmwseyBtZXRob2Q6J1BPU1QnLCBoZWFkZXJzOnsgJ0NvbnRlbnQtVHlwZSc6J3RleHQvcGxhaW4nIH0sIGJvZHk6IGJsb2IgfSk7CgogICAgaWYoci5vayB8fCByLnN0YXR1cz09PTIwMSl7CiAgICAgIHN0YXRlLmxhc3RVcGxvYWQgPSBub3c7CiAgICAgICQoJ3NoYXJlYWJsZScpLnZhbHVlID0gYGh0dHBzOi8vZmlsZWJpbi5uZXQvJHtDT05GSUcuZmlsZWJpbkJ1Y2tldH0vJHtmaWxlbmFtZX1gOwogICAgICB0b2FzdCgnVXBsb2FkZWQgdG8gZmlsZWJpbicpOwogICAgICBzaG93QmFubmVyKCJVcGxvYWQgQ29tcGxldGUgLSBQcmVzcyBDb3B5IExpbmsgYW5kIHNlbmQgaXQgdG8gb3VyIGNoYXQiKTsKCiAgICAgIGNvbnN0IGNvbmZpZ1NlY3Rpb24gPSAkKCdjb25maWdTZWN0aW9uJyk7CiAgICAgIGNvbnN0IHRvZ2dsZUJ0biA9ICQoJ3RvZ2dsZUNvbmZpZycpOwogICAgICBpZiAoY29uZmlnU2VjdGlvbiAmJiB0b2dnbGVCdG4gJiYgY29uZmlnU2VjdGlvbi5jbGFzc0xpc3QuY29udGFpbnMoJ2FjdGl2ZScpKSB7CiAgICAgICAgY29uZmlnU2VjdGlvbi5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTsKICAgICAgICB0b2dnbGVCdG4udGV4dENvbnRlbnQgPSAnU2hvdyBDb25maWd1cmF0aW9uJzsKICAgICAgfQogICAgICByZXR1cm47CiAgICB9CiAgfWNhdGNoKGUpewogICAgY29uc29sZS53YXJuKCdmaWxlYmluIGVycm9yJywgZSk7CiAgfQoKICB0cnl7CiAgICBjb25zdCBmb3JtID0gbmV3IEZvcm1EYXRhKCk7CiAgICBmb3JtLmFwcGVuZCgnZmlsZScsIGJsb2IsIGZpbGVuYW1lKTsKICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKCdodHRwczovL3VwbG9hZC5nb2ZpbGUuaW8vdXBsb2FkRmlsZScsIHsgbWV0aG9kOidQT1NUJywgYm9keTogZm9ybSB9KTsKICAgIGNvbnN0IGogPSBhd2FpdCByZXMuanNvbigpOwogICAgaWYoai5zdGF0dXMgPT09ICdvaycpewogICAgICBzdGF0ZS5sYXN0VXBsb2FkID0gbm93OwogICAgICAkKCdzaGFyZWFibGUnKS52YWx1ZSA9IGouZGF0YS5kb3dubG9hZFBhZ2U7CiAgICAgIHRvYXN0KCdVcGxvYWRlZCB0byBHb0ZpbGUnKTsKICAgICAgcmV0dXJuOwogICAgfQogICAgdG9hc3QoJ1VwbG9hZCBmYWlsZWQnKTsKICB9Y2F0Y2goZSl7CiAgICBjb25zb2xlLmVycm9yKGUpOwogICAgdG9hc3QoJ1VwbG9hZCBlcnJvcicpOwogIH0KfQoKJCgndXBsb2FkQnRuJyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZG9VcGxvYWQpOwoKbGV0IGJpbkxpc3RQYWdlID0gMDsKY29uc3QgYmluTGlzdFBhZ2VTaXplID0gMTA7CmxldCBjYWNoZWRCaW5GaWxlcyA9IG51bGw7CgokKCdiaW5MaXN0Jyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgKCkgPT4gewogIHRyeSB7CiAgICBjb25zdCByID0gYXdhaXQgZmV0Y2goYGh0dHBzOi8vZmlsZWJpbi5uZXQvJHtDT05GSUcuZmlsZWJpbkJ1Y2tldH0/anNvbmAsIHsKICAgICAgaGVhZGVyczogeyAiQWNjZXB0IjogImFwcGxpY2F0aW9uL2pzb24iIH0KICAgIH0pOwogICAgaWYgKCFyLm9rKSB7IHRvYXN0KGBGYWlsZWQgdG8gZmV0Y2ggdXBsb2FkczogJHtyLnN0YXR1c1RleHR9YCk7IHJldHVybjsgfQoKICAgIGxldCBqOwogICAgdHJ5IHsKICAgICAgaiA9IGF3YWl0IHIuanNvbigpOwogICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgIHRvYXN0KCJGYWlsZWQgdG8gcGFyc2Ugc2VydmVyIHJlc3BvbnNlIik7CiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGlmICghai5maWxlcyB8fCAhai5maWxlcy5sZW5ndGgpIHsgdG9hc3QoJ05vIGZpbGVzIGZvdW5kJyk7IHJldHVybjsgfQoKICAgIC8vID09PT09PT09PT0gQUREIFRIRVNFIDMgTElORVMgPT09PT09PT09PQogICAgY29uc3QgcGxhdGZvcm1GaWxlcyA9IGouZmlsZXMuZmlsdGVyKGZpbGUgPT4gCiAgICAgIGZpbGUuZmlsZW5hbWUuZW5kc1dpdGgoQ09ORklHLmNsaWVudEZpbGVFeHQpCiAgICApOwogICAgCiAgICBpZiAocGxhdGZvcm1GaWxlcy5sZW5ndGggPT09IDApIHsKICAgICAgdG9hc3QoYE5vICR7Q09ORklHLnBsYXRmb3JtIHx8ICdwbGF0Zm9ybSd9IGZpbGVzIGZvdW5kYCk7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBjb25zdCBzb3J0ZWQgPSBwbGF0Zm9ybUZpbGVzLnNvcnQoKGEsYik9PiBuZXcgRGF0ZShiLnVwZGF0ZWRfYXQpIC0gbmV3IERhdGUoYS51cGRhdGVkX2F0KSk7CiAgICAvLyA9PT09PT09PT09IENIQU5HRSBUSElTIExJTkUgPT09PT09PT09PQogICAgLy8gT0xEOiBjb25zdCBzb3J0ZWQgPSBqLmZpbGVzLnNvcnQoLi4uKQogICAgLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQogICAgCiAgICBjYWNoZWRCaW5GaWxlcyA9IHNvcnRlZDsKICAgIGJpbkxpc3RQYWdlID0gMDsKICAgIHJlbmRlckJpbkxpc3QoKTsKICB9IGNhdGNoIChlKSB7CiAgICBjb25zb2xlLmVycm9yKGUpOwogICAgdG9hc3QoJ0Vycm9yIGZldGNoaW5nIHVwbG9hZHMnKTsKICB9Cn0pOwoKZnVuY3Rpb24gcmVuZGVyQmluTGlzdCgpIHsKICBpZiAoIWNhY2hlZEJpbkZpbGVzKSByZXR1cm47CiAgCiAgY29uc3Qgc3RhcnQgPSBiaW5MaXN0UGFnZSAqIGJpbkxpc3RQYWdlU2l6ZTsKICBjb25zdCBlbmQgPSBzdGFydCArIGJpbkxpc3RQYWdlU2l6ZTsKICBjb25zdCBwYWdlRmlsZXMgPSBjYWNoZWRCaW5GaWxlcy5zbGljZShzdGFydCwgZW5kKTsKICBjb25zdCBoYXNNb3JlID0gZW5kIDwgY2FjaGVkQmluRmlsZXMubGVuZ3RoOwogIAogIGxldCBodG1sID0gJzxkaXYgc3R5bGU9ImRpc3BsYXk6ZmxleDtqdXN0aWZ5LWNvbnRlbnQ6c3BhY2UtYmV0d2VlbjthbGlnbi1pdGVtczpsZWZ0O21hcmdpbi1ib3R0b206OHB4OyI+JzsKICBodG1sICs9ICc8YnV0dG9uIGlkPSJjbG9zZUJpbiIgY2xhc3M9ImJ0biBnaG9zdCIgc3R5bGU9InBhZGRpbmc6NHB4IDhweDsiPkNsb3NlPC9idXR0b24+JzsKICBodG1sICs9IGA8c3Ryb25nPlJlY2VudCBVcGxvYWRzPC9zdHJvbmc+YDsKICBodG1sICs9ICc8L2Rpdj4nOwogIAogIGh0bWwgKz0gJzxkaXYgc3R5bGU9ImRpc3BsYXk6ZmxleDtnYXA6OHB4O21hcmdpbi1ib3R0b206OHB4OyI+JzsKICBodG1sICs9IGA8YnV0dG9uIGlkPSJwcmV2UGFnZSIgY2xhc3M9ImJ0biBnaG9zdCIgc3R5bGU9InBhZGRpbmc6NHB4IDhweDtmbGV4OjE7IiAke2Jpbkxpc3RQYWdlID09PSAwID8gJ2Rpc2FibGVkJyA6ICcnfT5QcmV2PC9idXR0b24+YDsKICBodG1sICs9IGA8c3BhbiBzdHlsZT0iZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtmb250LXNpemU6MTJweDtjb2xvcjojNmI3MjgwOyI+UGFnZSAke2Jpbkxpc3RQYWdlICsgMX08L3NwYW4+YDsKICBodG1sICs9IGA8YnV0dG9uIGlkPSJuZXh0UGFnZSIgY2xhc3M9ImJ0biBnaG9zdCIgc3R5bGU9InBhZGRpbmc6NHB4IDhweDtmbGV4OjE7IiAkeyFoYXNNb3JlID8gJ2Rpc2FibGVkJyA6ICcnfT5OZXh0PC9idXR0b24+YDsKICBodG1sICs9ICc8L2Rpdj4nOwogIAogIGh0bWwgKz0gJzx1bCBzdHlsZT0ibWFyZ2luOjA7cGFkZGluZy1sZWZ0OjIwcHg7Ij4nOwogIHBhZ2VGaWxlcy5mb3JFYWNoKGZpbGUgPT4gewogICAgY29uc3QgZmlsZVVybCA9IGBodHRwczovL2ZpbGViaW4ubmV0LyR7Q09ORklHLmZpbGViaW5CdWNrZXR9LyR7ZW5jb2RlVVJJQ29tcG9uZW50KGZpbGUuZmlsZW5hbWUpfWA7CiAgICBjb25zdCBhZGRlZERhdGUgPSBuZXcgRGF0ZShmaWxlLnVwZGF0ZWRfYXQpOwogICAgY29uc3QgZm9ybWF0dGVkRGF0ZSA9IGFkZGVkRGF0ZS50b0lTT1N0cmluZygpLnNsaWNlKDAsMTApLnJlcGxhY2UoLy0vZywnJyk7CiAgICBjb25zdCBob3VycyA9IGFkZGVkRGF0ZS5nZXRIb3VycygpOwogICAgY29uc3QgbWludXRlcyA9IGFkZGVkRGF0ZS5nZXRNaW51dGVzKCkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCcwJyk7CiAgICBjb25zdCBhbXBtID0gaG91cnMgPj0gMTIgPyAnUE0nOidBTSc7CiAgICBjb25zdCBmb3JtYXR0ZWRUaW1lID0gYCR7aG91cnMgJSAxMiB8fCAxMn06JHttaW51dGVzfSAke2FtcG19YDsKICAgIGNvbnN0IHN0cmlwcGVkTmFtZSA9IGZpbGUuZmlsZW5hbWUuc3BsaXQoJy4nKS5zbGljZSgwLC0xKS5qb2luKCcuJyk7CiAgICBjb25zdCBmaWxlU2l6ZSA9IGZpbGUuYnl0ZXNfcmVhZGFibGUgfHwgJyc7CiAgICBodG1sICs9IGA8bGkgc3R5bGU9Im1hcmdpbi1ib3R0b206NHB4OyBmb250LXNpemU6IDEycHg7Ij48YSBocmVmPSIke2ZpbGVVcmx9IiB0YXJnZXQ9Il9ibGFuayIgc3R5bGU9InRleHQtZGVjb3JhdGlvbjpub25lO2NvbG9yOiMwMzY2ZDY7Ij4ke2Zvcm1hdHRlZERhdGV9ICR7Zm9ybWF0dGVkVGltZX0gfCAke3N0cmlwcGVkTmFtZX0gfCAke2ZpbGVTaXplfTwvYT48L2xpPmA7CiAgfSk7CiAgaHRtbCArPSAnPC91bD4nOwoKICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsZUxpc3RDb250YWluZXInKTsKICBjb250YWluZXIuaW5uZXJIVE1MID0gaHRtbDsKICBjb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7CiAgY29udGFpbmVyLnN0eWxlLmJhY2tncm91bmQgPSAnI2Y5ZmFmYic7CiAgY29udGFpbmVyLnN0eWxlLnBhZGRpbmcgPSAnMTJweCc7CiAgY29udGFpbmVyLnN0eWxlLmJvcmRlclJhZGl1cyA9ICc4cHgnOwogIGNvbnRhaW5lci5zdHlsZS5ib3JkZXIgPSAnMXB4IHNvbGlkICNlNWU3ZWInOwogIGNvbnRhaW5lci5zdHlsZS5tYXJnaW5Ub3AgPSAnOHB4JzsKICAgIGNvbnRhaW5lci5zdHlsZS5vdmVyZmxvd1kgPSAnYXV0byc7CmNvbnRhaW5lci5zdHlsZS5vdmVyZmxvd1ggPSAnaGlkZGVuJzsgICAvLyBvciAnYXV0bycgaWYgeW91IHByZWZlciBob3Jpem9udGFsIHNjcm9sbApjb250YWluZXIuc3R5bGUubWF4SGVpZ2h0ID0gJzMwMHB4JzsgICAgLy8gc2V0IHdoYXRldmVyIGZpeGVkIGhlaWdodCB5b3Ugd2FudAoKICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2xvc2VCaW4nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICAgIGNvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgYmluTGlzdFBhZ2UgPSAwOwogICAgY2FjaGVkQmluRmlsZXMgPSBudWxsOwogIH0pOwogIAogIGNvbnN0IHByZXZCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncHJldlBhZ2UnKTsKICBpZiAocHJldkJ0biAmJiBiaW5MaXN0UGFnZSA+IDApIHsKICAgIHByZXZCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7CiAgICAgIGJpbkxpc3RQYWdlLS07CiAgICAgIHJlbmRlckJpbkxpc3QoKTsKICAgIH0pOwogIH0KICAKICBjb25zdCBuZXh0QnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25leHRQYWdlJyk7CiAgaWYgKG5leHRCdG4gJiYgaGFzTW9yZSkgewogICAgbmV4dEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICAgICAgYmluTGlzdFBhZ2UrKzsKICAgICAgcmVuZGVyQmluTGlzdCgpOwogICAgfSk7CiAgfQp9CgokKCdzZWFyY2gnKS5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgKGV2KSA9PiB7CiAgaWYgKGV2LmtleSA9PT0gJ0VudGVyJykgewogICAgZXYucHJldmVudERlZmF1bHQoKTsKICAgIAogICAgY29uc3QgdmlzaWJsZUl0ZW1zID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuaXRlbScpKQogICAgICAuZmlsdGVyKGVsID0+IGVsLm9mZnNldFBhcmVudCAhPT0gbnVsbCk7IC8vIE9ubHkgdmlzaWJsZSBpdGVtcwogICAgCiAgICAvLyBDYWxjdWxhdGUgd2hhdCB3b3VsZCBiZSBhZGRlZAogICAgY29uc3QgdG9BZGQgPSB2aXNpYmxlSXRlbXMuZmlsdGVyKGVsID0+IHsKICAgICAgY29uc3QgbmFtZSA9IGVsLmRhdGFzZXQubmFtZTsKICAgICAgcmV0dXJuICFzdGF0ZS5zZWxlY3RlZC5zb21lKHMgPT4gcy5uYW1lID09PSBuYW1lKTsKICAgIH0pOwogICAgCiAgICBpZiAodG9BZGQubGVuZ3RoID09PSAwKSB7CiAgICAgIHRvYXN0KCdBbGwgdmlzaWJsZSBpdGVtcyBhbHJlYWR5IHNlbGVjdGVkJyk7CiAgICAgIHJldHVybjsKICAgIH0KICAgIAogICAgLy8gQ2FsY3VsYXRlIHRvdGFsIHNpemUgb2YgaXRlbXMgdG8gYmUgYWRkZWQKICAgIGxldCB0b3RhbEJ5dGVzID0gMDsKICAgIHRvQWRkLmZvckVhY2goZWwgPT4gewogICAgICB0b3RhbEJ5dGVzICs9IHBhcnNlU2l6ZVRleHQoZWwuZGF0YXNldC5zaXplKTsKICAgIH0pOwogICAgY29uc3QgdG90YWxHQiA9IGJ5dGVzVG9HQih0b3RhbEJ5dGVzKS50b0ZpeGVkKDIpOwogICAgCiAgICAvLyBDb25maXJtYXRpb24gZGlhbG9nCiAgICBjb25zdCBjb25maXJtZWQgPSBjb25maXJtKAogICAgICBgQWRkICR7dG9BZGQubGVuZ3RofSBnYW1lJHt0b0FkZC5sZW5ndGggIT09IDEgPyAncycgOiAnJ30gZnJvbSBzZWFyY2ggcmVzdWx0cz9cblxuYCArCiAgICAgIGBUb3RhbCBzaXplOiAke3RvdGFsR0J9IEdCXG5cbmAgKwogICAgICBgUHJlc3MgT0sgdG8gYWRkIHRoZXNlIGl0ZW1zLmAKICAgICk7CiAgICAKICAgIGlmICghY29uZmlybWVkKSB7CiAgICAgIHRvYXN0KCdBZGQgY2FuY2VsbGVkJyk7CiAgICAgIHJldHVybjsKICAgIH0KICAgIAogICAgLy8gQWRkIHRoZSBpdGVtcwogICAgbGV0IGFkZGVkID0gMDsKICAgIHRvQWRkLmZvckVhY2goZWwgPT4gewogICAgICBjb25zdCBuYW1lID0gZWwuZGF0YXNldC5uYW1lOwogICAgICBjb25zdCBzaXplID0gZWwuZGF0YXNldC5zaXplOwogICAgICBjb25zdCBmaWxlbmFtZSA9IGVsLmRhdGFzZXQuZmlsZW5hbWUgfHwgbmFtZTsKICAgICAgc3RhdGUuc2VsZWN0ZWQucHVzaCh7IG5hbWUsIGZpbGVuYW1lLCBzaXplIH0pOwogICAgICBlbC5jbGFzc0xpc3QuYWRkKCdzZWxlY3RlZCcpOwogICAgICBhZGRlZCsrOwogICAgfSk7CiAgICAKICAgIGlmIChhZGRlZCA+IDApIHsKICAgICAgdXBkYXRlVG90YWxzKCk7CiAgICAgIHJlbmRlck92ZXJsYXkoKTsKICAgICAgdG9hc3QoYEFkZGVkICR7YWRkZWR9IGl0ZW0ke2FkZGVkICE9PSAxID8gJ3MnIDogJyd9ICgke3RvdGFsR0J9IEdCKWApOwogICAgfQogIH0KfSk7CgokKCdjb3B5TGluaycpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewogIGNvbnN0IGN1c3QgPSAoJCgnY3VzdG9tZXInKS52YWx1ZXx8JycpLnRyaW0oKTsgCiAgaWYoIWN1c3QpeyBhbGVydCgnQ3VzdG9tZXIgbmFtZSByZXF1aXJlZCcpOyByZXR1cm47IH0KICAKICBjb25zdCByYXdMaW5rID0gJCgnc2hhcmVhYmxlJykudmFsdWUudHJpbSgpOwogIGNvbnN0IGxpbmsgPSByYXdMaW5rCiAgICAucmVwbGFjZSgvXmh0dHBzPzpcL1wvLywgJ2h4eHBjZmYnKQogICAgLnJlcGxhY2UoL1wuL2csICdfZG90XycpOwoKICBjb25zdCB0aXRsZXNBcnIgPSBzdGF0ZS5zZWxlY3RlZC5tYXAocyA9PiBzLm5hbWUpOwoKICBpZiAodGl0bGVzQXJyLmxlbmd0aCA9PT0gMCkgewogICAgdG9hc3QoJ05vIHNlbGVjdGVkIGxpc3QgdG8gY29weScpOwogICAgYWxlcnQoJ05vIHNlbGVjdGVkIGxpc3QgdG8gY29weScpOwogICAgcmV0dXJuOwogIH0KCiAgY29uc3QgdG90YWxCeXRlcyA9IHN0YXRlLnNlbGVjdGVkLnJlZHVjZSgoc3VtLCBzKSA9PiBzdW0gKyBwYXJzZVNpemVUZXh0KHMuc2l6ZSksIDApOwogIGNvbnN0IHRvdGFsR0IgPSAodG90YWxCeXRlcyAvICgxMDI0ICoqIDMpKS50b0ZpeGVkKDIpOwogIGNvbnN0IGNvdW50ID0gdGl0bGVzQXJyLmxlbmd0aDsKCiAgY29uc3QgY3VzdG9tZXIgPSAoJCgnY3VzdG9tZXInKS52YWx1ZSB8fCAnJykudHJpbSgpIHx8ICdVbmtub3duIGN1c3RvbWVyJzsKICBjb25zdCBmaWxlbmFtZSA9ICQoJ2ZpbGVuYW1lUHJldmlldycpLnRleHRDb250ZW50IHx8IGBsaXN0JHtDT05GSUcuY2xpZW50RmlsZUV4dH1gOwoKICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpOwogIGNvbnN0IHN0YW1wID0gbm93LnRvTG9jYWxlU3RyaW5nKCdlbi1VUycsIHsKICAgIHllYXI6ICdudW1lcmljJywgbW9udGg6ICcyLWRpZ2l0JywgZGF5OiAnMi1kaWdpdCcsCiAgICBob3VyOiAnMi1kaWdpdCcsIG1pbnV0ZTogJzItZGlnaXQnLCBzZWNvbmQ6ICcyLWRpZ2l0JwogIH0pOwoKICBsZXQgbGlua1RvVXNlID0gbGluazsKCiAgaWYgKCFsaW5rKSB7CiAgICBjb25zdCBhc2sgPSBjb25maXJtKAogICAgICBgTm8gbGluayBmb3VuZC5cblxuYCArCiAgICAgIGBMaXN0IGNvbnRhaW5zICR7Y291bnR9IGl0ZW1zIHRvdGFsaW5nICR7dG90YWxHQn0gR0IuXG5cbmAgKwogICAgICBgV291bGQgeW91IGxpa2UgdG8gdXBsb2FkIG5vdz9gCiAgICApOwoKICAgIGlmIChhc2spIHsKICAgICAgJCgndXBsb2FkQnRuJykuY2xpY2soKTsKICAgICAgc2hvd0Jhbm5lcigiVXBsb2FkaW5n4oCmXG5cblBsZWFzZSB3YWl0IGZvciB0aGUgbGluayB0byBhcHBlYXIsIHRoZW4gcHJlc3MgQ29weSBhZ2Fpbi4iKTsKICAgICAgdG9hc3QoIlVwbG9hZGluZ+KApiB3YWl0IGZvciBsaW5rLCB0aGVuIHByZXNzIENvcHkgYWdhaW4iKTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGxpbmtUb1VzZSA9ICcoTm8gbGluayB1cGxvYWRlZCknOwogIH0KCiAgY29uc3Qgc3VtbWFyeSA9CiAgICBgQ3VzdG9tZXI6ICR7Y3VzdG9tZXJ9XG5gICsKICAgIGBGaWxlbmFtZTogJHtmaWxlbmFtZX1cbmAgKwogICAgYFF1YW50aXR5OiAke2NvdW50fSBpdGVtc1xuYCArCiAgICBgVG90YWwgU2l6ZTogJHt0b3RhbEdCfSBHQlxuYCArCiAgICBgR2VuZXJhdGVkOiAke3N0YW1wfVxuXG5gICsKICAgIGAke2xpbmtUb1VzZX1cblxuYDsKCiAgY29uc3QgZmluYWxUZXh0ID0gc3VtbWFyeSArIHRpdGxlc0Fyci5qb2luKCdcbicpOwoKICBsZXQgbWVzc2FnZSA9IGxpbmsKICAgID8gYExpc3QgJiBsaW5rIGNvcGllZC4gKCR7Y291bnR9IGl0ZW1zLCAke3RvdGFsR0J9IEdCKWAKICAgIDogYExpc3QgY29waWVkIChubyBsaW5rKS4gKCR7Y291bnR9IGl0ZW1zLCAke3RvdGFsR0J9IEdCKWA7CgogIG5hdmlnYXRvci5jbGlwYm9hcmQud3JpdGVUZXh0KGZpbmFsVGV4dCkudGhlbigoKSA9PiB7CiAgICB0b2FzdChtZXNzYWdlLnJlcGxhY2UoL1xuL2csICcgJykpOwogICAgYWxlcnQobWVzc2FnZSk7CiAgfSkuY2F0Y2goKCkgPT4gewogICAgYWxlcnQoJ0NvcHkgZmFpbGVkLCBwbGVhc2UgY29weSBtYW51YWxseScpOwogIH0pOwp9KTsKCmZ1bmN0aW9uIHJlbmRlclNlbGVjdGVkUGFuZWwoKSB7CiAgY29uc3QgYm9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZWxlY3RlZFBhbmVsQm9keScpOwogIGlmICghYm9keSkgcmV0dXJuOwoKICBib2R5LmlubmVySFRNTCA9ICcnOwoKICBpZiAoc3RhdGUuc2VsZWN0ZWQubGVuZ3RoID09PSAwKSB7CiAgICBib2R5LmlubmVySFRNTCA9ICc8ZGl2IHN0eWxlPSJwYWRkaW5nOjIwcHg7dGV4dC1hbGlnbjpjZW50ZXI7Y29sb3I6dmFyKC0tbXV0ZWQpO2ZvbnQtc2l6ZToxM3B4Ij5ObyBnYW1lcyBzZWxlY3RlZCB5ZXQ8L2Rpdj4nOwogICAgcmV0dXJuOwogIH0KCiAgc3RhdGUuc2VsZWN0ZWQuZm9yRWFjaCgocywgaSkgPT4gewogICAgY29uc3Qgcm93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgICByb3cuY2xhc3NOYW1lID0gJ3NlbGVjdGVkLWl0ZW0nOwoKICAgIGNvbnN0IHNpemVEaXNwbGF5ID0gZm9ybWF0U2l6ZVRvR0Iocy5zaXplKTsKICAgIGNvbnN0IGljb25VcmwgPSBnZXRJY29uVXJsKHMubmFtZSk7CgogICAgcm93LmlubmVySFRNTCA9IGAKICAgICAgPGRpdiBjbGFzcz0ic2VsZWN0ZWQtaXRlbS10aHVtYiI+CiAgICAgICAgJHtpY29uVXJsID8gYDxpbWcgc3JjPSIke2ljb25Vcmx9IiBhbHQ9IiIgc3R5bGU9IndpZHRoOjEwMCU7aGVpZ2h0OjEwMCU7b2JqZWN0LWZpdDpjb3Zlcjtib3JkZXItcmFkaXVzOjZweCI+YCA6ICc8c3BhbiBzdHlsZT0iZm9udC1zaXplOjE4cHgiPvCfjq48L3NwYW4+J30KICAgICAgPC9kaXY+CiAgICAgIDxkaXYgY2xhc3M9InNlbGVjdGVkLWl0ZW0tY29udGVudCI+CiAgICAgICAgPGRpdiBjbGFzcz0ic2VsZWN0ZWQtaXRlbS10aXRsZSI+JHtlc2Mocy5uYW1lKX08L2Rpdj4KICAgICAgPC9kaXY+CiAgICAgIDxkaXYgY2xhc3M9InNlbGVjdGVkLWl0ZW0tc2l6ZSI+JHtzaXplRGlzcGxheX08L2Rpdj4KICAgICAgPGRpdiBjbGFzcz0ic2VsZWN0ZWQtaXRlbS1jaGVjayI+4pyTPC9kaXY+CiAgICAgIDxkaXYgY2xhc3M9InNlbGVjdGVkLWl0ZW0tYWN0aW9ucyI+CiAgICAgICAgPGJ1dHRvbiBjbGFzcz0idXAiPuKGkTwvYnV0dG9uPgogICAgICAgIDxidXR0b24gY2xhc3M9ImRvd24iPuKGkzwvYnV0dG9uPgogICAgICAgIDxidXR0b24gY2xhc3M9InJlbW92ZSI+w5c8L2J1dHRvbj4KICAgICAgPC9kaXY+CiAgICBgOwoKICAgIHJvdy5xdWVyeVNlbGVjdG9yKCcudXAnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICAgICAgaWYgKGkgPiAwKSB7CiAgICAgICAgW3N0YXRlLnNlbGVjdGVkW2kgLSAxXSwgc3RhdGUuc2VsZWN0ZWRbaV1dID0gW3N0YXRlLnNlbGVjdGVkW2ldLCBzdGF0ZS5zZWxlY3RlZFtpIC0gMV1dOwogICAgICAgIHJlbmRlck92ZXJsYXkoKTsKICAgICAgICByZW5kZXJMaXN0KHN0YXRlLml0ZW1zKTsKICAgICAgICB1cGRhdGVUb3RhbHMoKTsKICAgICAgfQogICAgfSk7CgogICAgcm93LnF1ZXJ5U2VsZWN0b3IoJy5kb3duJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7CiAgICAgIGlmIChpIDwgc3RhdGUuc2VsZWN0ZWQubGVuZ3RoIC0gMSkgewogICAgICAgIFtzdGF0ZS5zZWxlY3RlZFtpICsgMV0sIHN0YXRlLnNlbGVjdGVkW2ldXSA9IFtzdGF0ZS5zZWxlY3RlZFtpXSwgc3RhdGUuc2VsZWN0ZWRbaSArIDFdXTsKICAgICAgICByZW5kZXJPdmVybGF5KCk7CiAgICAgICAgcmVuZGVyTGlzdChzdGF0ZS5pdGVtcyk7CiAgICAgICAgdXBkYXRlVG90YWxzKCk7CiAgICAgIH0KICAgIH0pOwoKICAgIHJvdy5xdWVyeVNlbGVjdG9yKCcucmVtb3ZlJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7CiAgICAgIHN0YXRlLnNlbGVjdGVkLnNwbGljZShpLCAxKTsKICAgICAgcmVuZGVyT3ZlcmxheSgpOwogICAgICByZW5kZXJMaXN0KHN0YXRlLml0ZW1zKTsKICAgICAgdXBkYXRlVG90YWxzKCk7CiAgICB9KTsKCiAgICBib2R5LmFwcGVuZENoaWxkKHJvdyk7CiAgfSk7Cn0KCmNvbnN0IHRvZ2dsZUJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0b2dnbGVDb25maWcnKTsKY29uc3QgY29uZmlnU2VjdGlvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjb25maWdTZWN0aW9uJyk7CgppZiAoaXNNb2JpbGUgJiYgdG9nZ2xlQnRuICYmIGNvbmZpZ1NlY3Rpb24pIHsKICBjb25maWdTZWN0aW9uLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpOwogIHRvZ2dsZUJ0bi50ZXh0Q29udGVudCA9ICdIaWRlIENvbmZpZ3VyYXRpb24nOwoKICB0b2dnbGVCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7CiAgICBjb25zdCBpc1Zpc2libGUgPSBjb25maWdTZWN0aW9uLmNsYXNzTGlzdC50b2dnbGUoJ2FjdGl2ZScpOwogICAgdG9nZ2xlQnRuLnRleHRDb250ZW50ID0gaXNWaXNpYmxlID8gJ0hpZGUgQ29uZmlndXJhdGlvbicgOiAnU2hvdyBDb25maWd1cmF0aW9uJzsKICB9KTsKfQoKZnVuY3Rpb24gcGFyc2VEYXRlRmxleGlibGUocykgewogIGlmICghcykgcmV0dXJuIG51bGw7CiAgbGV0IGQgPSBuZXcgRGF0ZShzKTsKICBpZiAoIWlzTmFOKGQuZ2V0VGltZSgpKSkgcmV0dXJuIGQ7CgogIGNvbnN0IHltZCA9ICgnJytzKS5tYXRjaCgvKFxkezR9KVxEPyhcZHsxLDJ9KVxEPyhcZHsxLDJ9KS8pOwogIGlmICh5bWQpIHsKICAgIGQgPSBuZXcgRGF0ZShOdW1iZXIoeW1kWzFdKSwgTnVtYmVyKHltZFsyXSkgLSAxLCBOdW1iZXIoeW1kWzNdKSk7CiAgICBpZiAoIWlzTmFOKGQuZ2V0VGltZSgpKSkgcmV0dXJuIGQ7CiAgfQoKICBjb25zdCBkbXkgPSAoJycrcykubWF0Y2goLyhcZHsxLDJ9KVxEKFxkezEsMn0pXEQoXGR7NH0pLyk7CiAgaWYgKGRteSkgewogICAgZCA9IG5ldyBEYXRlKE51bWJlcihkbXlbM10pLCBOdW1iZXIoZG15WzJdKSAtIDEsIE51bWJlcihkbXlbMV0pKTsKICAgIGlmICghaXNOYU4oZC5nZXRUaW1lKCkpKSByZXR1cm4gZDsKICB9CgogIHJldHVybiBudWxsOwp9CgovLyBTb3J0IGZ1bmN0aW9uYWxpdHkgbW92ZWQgdG8gZ2VucmUgZmlsdGVyIGJhcgoKZnVuY3Rpb24gZGV0ZWN0RW52aXJvbm1lbnQoKSB7CiAgY29uc3QgdWEgPSBuYXZpZ2F0b3IudXNlckFnZW50IHx8IG5hdmlnYXRvci52ZW5kb3IgfHwgd2luZG93Lm9wZXJhOwogIGNvbnN0IGlzTWVzc2VuZ2VyID0gL0ZCQU58RkJBVnxGQl9JQUJ8TWVzc2VuZ2VyL2kudGVzdCh1YSk7CiAgY29uc3QgaXNJbnN0YWdyYW0gPSAvSW5zdGFncmFtL2kudGVzdCh1YSk7CiAgY29uc3QgaXNXZWJWaWV3ID0gL1xid3ZcYi8udGVzdCh1YSkgfHwgKHdpbmRvdy5uYXZpZ2F0b3Iuc3RhbmRhbG9uZSA9PT0gZmFsc2UpOwoKICBpZiAoaXNNZXNzZW5nZXIgfHwgaXNJbnN0YWdyYW0gfHwgaXNXZWJWaWV3KSB7CiAgICBzaG93QmFubmVyKCJNZXNzZW5nZXIgb3IgaW4tYXBwIHdlYnZpZXcgZGV0ZWN0ZWQuXG5UaGlzIHBhZ2UgaXMgYmVzdCB1c2VkIG9uIGEgZnVsbCBtb2JpbGUgYnJvd3NlciBvciBkZXNrdG9wIGJyb3dzZXIsIGJ1dCBpdCB3aWxsIHByb2JhYmx5IHdvcmsgYW55d2F5IiwgNDAwMCk7CiAgfQogIHNob3dCYW5uZXIoIkhvdyB0byB1c2U6XG5cbjEuIEVudGVyIHlvdXIgbmFtZVxuMi4gU2VsZWN0IHlvdXIgZGV2aWNlIG1vZGVsIChPTEVEL0xpdGUvVjEvVjIpXG4zLiBTZWxlY3QgeW91ciBTRCBDYXJkIFNpemVcbjQuIENob29zZSB5b3VyIGdhbWVzXG41LiBQcmVzcyBVcGxvYWRcbjYuIFNlbmQgdGhlIGdlbmVyYXRlZCBsaW5rIHRvIG91ciBjaGF0IGNvbnZlcnNhdGlvbiIsIDgwMDApOwp9CgpmdW5jdGlvbiBzaG93QmFubmVyKG1lc3NhZ2UsIGR1cmF0aW9uID0gNDAwMCkgewogIGNvbnN0IGJhbm5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoImRpdiIpOwogIGJhbm5lci5pbm5lclRleHQgPSBtZXNzYWdlOwogIGJhbm5lci5zdHlsZS5jc3NUZXh0ID0gInBvc2l0aW9uOmZpeGVkO3RvcDozMCU7bGVmdDo1MCU7dHJhbnNmb3JtOnRyYW5zbGF0ZVgoLTUwJSk7YmFja2dyb3VuZDpyZ2JhKDAsMCwwLDAuOCk7Y29sb3I6I2ZmZjtwYWRkaW5nOjE4cHg7Ym9yZGVyLXJhZGl1czoxNnB4O2ZvbnQtc2l6ZToyMnB4O3otaW5kZXg6OTk5OTtib3gtc2hhZG93OjAgMnB4IDZweCByZ2JhKDAsMCwwLDAuMyk7dHJhbnNpdGlvbjpvcGFjaXR5IDAuNXMgZWFzZTt3aGl0ZS1zcGFjZTpwcmUtbGluZTttYXgtd2lkdGg6ODAlIjsKICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGJhbm5lcik7CgogIHNldFRpbWVvdXQoKCkgPT4gYmFubmVyLnN0eWxlLm9wYWNpdHkgPSAiMCIsIGR1cmF0aW9uKTsKICBzZXRUaW1lb3V0KCgpID0+IGJhbm5lci5yZW1vdmUoKSwgZHVyYXRpb24gKyA1MDApOwp9CgpmdW5jdGlvbiBsZXZlbnNodGVpbkRpc3RhbmNlKHN0cjEsIHN0cjIpIHsKICBjb25zdCBsZW4xID0gc3RyMS5sZW5ndGg7CiAgY29uc3QgbGVuMiA9IHN0cjIubGVuZ3RoOwogIGNvbnN0IG1hdHJpeCA9IEFycmF5KGxlbjIgKyAxKS5maWxsKG51bGwpLm1hcCgoKSA9PiBBcnJheShsZW4xICsgMSkuZmlsbCgwKSk7CiAgCiAgZm9yIChsZXQgaSA9IDA7IGkgPD0gbGVuMTsgaSsrKSBtYXRyaXhbMF1baV0gPSBpOwogIGZvciAobGV0IGogPSAwOyBqIDw9IGxlbjI7IGorKykgbWF0cml4W2pdWzBdID0gajsKICAKICBmb3IgKGxldCBqID0gMTsgaiA8PSBsZW4yOyBqKyspIHsKICAgIGZvciAobGV0IGkgPSAxOyBpIDw9IGxlbjE7IGkrKykgewogICAgICBjb25zdCBjb3N0ID0gc3RyMVtpIC0gMV0gPT09IHN0cjJbaiAtIDFdID8gMCA6IDE7CiAgICAgIG1hdHJpeFtqXVtpXSA9IE1hdGgubWluKAogICAgICAgIG1hdHJpeFtqXVtpIC0gMV0gKyAxLAogICAgICAgIG1hdHJpeFtqIC0gMV1baV0gKyAxLAogICAgICAgIG1hdHJpeFtqIC0gMV1baSAtIDFdICsgY29zdAogICAgICApOwogICAgfQogIH0KICAKICByZXR1cm4gbWF0cml4W2xlbjJdW2xlbjFdOwp9CgpmdW5jdGlvbiBub3JtYWxpemVUaXRsZSh0aXRsZSkgewogIHJldHVybiB0aXRsZS50b0xvd2VyQ2FzZSgpCiAgICAucmVwbGFjZSgvW15cd1xzXS9nLCAnICcpICAvLyBSZW1vdmUgcHVuY3R1YXRpb24KICAgIC5yZXBsYWNlKC9ccysvZywgJyAnKSAgICAgIC8vIENvbGxhcHNlIHNwYWNlcwogICAgLnRyaW0oKTsKfQoKZnVuY3Rpb24gZ2V0S2V5d29yZHModGl0bGUpIHsKICBjb25zdCBub3JtYWxpemVkID0gbm9ybWFsaXplVGl0bGUodGl0bGUpOwogIC8vIEZpbHRlciBvdXQgY29tbW9uIHdvcmRzCiAgY29uc3Qgc3RvcFdvcmRzID0gWyd0aGUnLCAnb2YnLCAnYW5kJywgJ2EnLCAnYW4nLCAnaW4nLCAnb24nLCAnZm9yJywgJ3RvJywgJ3dpdGgnXTsKICByZXR1cm4gbm9ybWFsaXplZC5zcGxpdCgnICcpLmZpbHRlcih3b3JkID0+IHdvcmQubGVuZ3RoID4gMCAmJiAhc3RvcFdvcmRzLmluY2x1ZGVzKHdvcmQpKTsKfQoKZnVuY3Rpb24gZXh0cmFjdE51bWJlcnModGl0bGUpIHsKICBjb25zdCBtYXRjaGVzID0gdGl0bGUubWF0Y2goL1xkKy9nKTsKICByZXR1cm4gbWF0Y2hlcyA/IG1hdGNoZXMubWFwKG4gPT4gbikgOiBbXTsKfQoKZnVuY3Rpb24gY2FsY3VsYXRlTWF0Y2hTY29yZSh1c2VyVGl0bGUsIGRiVGl0bGUpIHsKICBjb25zdCB1c2VyS2V5d29yZHMgPSBnZXRLZXl3b3Jkcyh1c2VyVGl0bGUpOwogIGNvbnN0IGRiS2V5d29yZHMgPSBnZXRLZXl3b3JkcyhkYlRpdGxlKTsKICAKICBpZiAodXNlcktleXdvcmRzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIHsgc2NvcmU6IDAsIG51bWJlck1hdGNoOiBmYWxzZSwgY29uc2VjdXRpdmVNYXRjaGVzOiAwIH07CiAgCiAgbGV0IG1hdGNoZWRXb3JkcyA9IDA7CiAgbGV0IHBhcnRpYWxNYXRjaGVzID0gMDsKICBsZXQgY29uc2VjdXRpdmVNYXRjaGVzID0gMDsKICBsZXQgbGFzdE1hdGNoSW5kZXggPSAtMjsKICAKICAvLyBDaGVjayBmb3IgbnVtYmVyIG1hdGNoaW5nCiAgY29uc3QgdXNlck51bWJlcnMgPSBleHRyYWN0TnVtYmVycyh1c2VyVGl0bGUpOwogIGNvbnN0IGRiTnVtYmVycyA9IGV4dHJhY3ROdW1iZXJzKGRiVGl0bGUpOwogIGNvbnN0IGhhc0V4YWN0TnVtYmVyTWF0Y2ggPSB1c2VyTnVtYmVycy5sZW5ndGggPiAwICYmIAogICAgdXNlck51bWJlcnMuZXZlcnkobnVtID0+IGRiTnVtYmVycy5pbmNsdWRlcyhudW0pKTsKICAKICB1c2VyS2V5d29yZHMuZm9yRWFjaCgodXNlcldvcmQsIGlkeCkgPT4gewogICAgbGV0IG1hdGNoZWQgPSBmYWxzZTsKICAgIAogICAgLy8gQ2hlY2sgZm9yIGV4YWN0IHdvcmQgbWF0Y2gKICAgIGNvbnN0IGV4YWN0SWR4ID0gZGJLZXl3b3Jkcy5maW5kSW5kZXgoZGJXb3JkID0+IGRiV29yZCA9PT0gdXNlcldvcmQpOwogICAgaWYgKGV4YWN0SWR4ICE9PSAtMSkgewogICAgICBtYXRjaGVkV29yZHMgKz0gMTsKICAgICAgbWF0Y2hlZCA9IHRydWU7CiAgICAgIAogICAgICAvLyBUcmFjayBjb25zZWN1dGl2ZSBtYXRjaGVzCiAgICAgIGlmIChleGFjdElkeCA9PT0gbGFzdE1hdGNoSW5kZXggKyAxKSB7CiAgICAgICAgY29uc2VjdXRpdmVNYXRjaGVzKys7CiAgICAgIH0KICAgICAgbGFzdE1hdGNoSW5kZXggPSBleGFjdElkeDsKICAgICAgcmV0dXJuOwogICAgfQogICAgCiAgICAvLyBDaGVjayBmb3Igc3Vic3RyaW5nIG1hdGNoIC0gYnV0IHJlcXVpcmUgbWluaW11bSBsZW5ndGgKICAgIC8vIEFORCB0aGUgdXNlciB3b3JkIG11c3QgYmUgc3Vic3RhbnRpYWwgKDMrIGNoYXJzIGZvciBtb3N0LCA0KyBmb3IgdmVyeSBjb21tb24gd29yZHMpCiAgICBpZiAodXNlcldvcmQubGVuZ3RoID49IDMpIHsKICAgICAgY29uc3Qgc3Vic3RyaW5nSWR4ID0gZGJLZXl3b3Jkcy5maW5kSW5kZXgoZGJXb3JkID0+IHsKICAgICAgICAvLyBEQiB3b3JkIG11c3QgYmUgbG9uZyBlbm91Z2ggdG8gY29udGFpbiB0aGUgdXNlciB3b3JkIG1lYW5pbmdmdWxseQogICAgICAgIGlmIChkYldvcmQubGVuZ3RoID49IHVzZXJXb3JkLmxlbmd0aCArIDEgJiYgZGJXb3JkLmluY2x1ZGVzKHVzZXJXb3JkKSkgewogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIC8vIE9yIGlmIHVzZXIgd29yZCBpcyBsb25nZXIsIGNoZWNrIGlmIGl0IGNvbnRhaW5zIERCIHdvcmQgKGZvciBjb21wb3VuZCB3b3JkcykKICAgICAgICBpZiAodXNlcldvcmQubGVuZ3RoID49IDQgJiYgdXNlcldvcmQuaW5jbHVkZXMoZGJXb3JkKSAmJiBkYldvcmQubGVuZ3RoID49IDMpIHsKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0pOwogICAgICAKICAgICAgaWYgKHN1YnN0cmluZ0lkeCAhPT0gLTEpIHsKICAgICAgICAvLyBHaXZlIGhpZ2hlciBzY29yZSBmb3IgbG9uZ2VyIG1hdGNoZXMKICAgICAgICBjb25zdCBtYXRjaFN0cmVuZ3RoID0gdXNlcldvcmQubGVuZ3RoID49IDQgPyAwLjggOiAwLjY7CiAgICAgICAgcGFydGlhbE1hdGNoZXMgKz0gbWF0Y2hTdHJlbmd0aDsKICAgICAgICBtYXRjaGVkID0gdHJ1ZTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgIH0KICAgIAogICAgLy8gQ2hlY2sgZm9yIHZlcnkgY2xvc2UgdHlwbyAoc2luZ2xlIGNoYXIgZGlmZmVyZW5jZSkKICAgIC8vIE9ubHkgZm9yIHdvcmRzIDMrIGNoYXJhY3RlcnMKICAgIGlmICh1c2VyV29yZC5sZW5ndGggPj0gMykgewogICAgICBkYktleXdvcmRzLmZvckVhY2goZGJXb3JkID0+IHsKICAgICAgICBpZiAoZGJXb3JkLmxlbmd0aCA8IDMpIHJldHVybjsgLy8gU2tpcCBzaG9ydCB3b3JkcwogICAgICAgIAogICAgICAgIGNvbnN0IG1heExlbiA9IE1hdGgubWF4KHVzZXJXb3JkLmxlbmd0aCwgZGJXb3JkLmxlbmd0aCk7CiAgICAgICAgY29uc3QgbWluTGVuID0gTWF0aC5taW4odXNlcldvcmQubGVuZ3RoLCBkYldvcmQubGVuZ3RoKTsKICAgICAgICAKICAgICAgICAvLyBPbmx5IGNvbnNpZGVyIGlmIGxlbmd0aHMgYXJlIHNpbWlsYXIKICAgICAgICBpZiAobWF4TGVuIC0gbWluTGVuIDw9IDIgJiYgbWluTGVuID49IDMpIHsKICAgICAgICAgIGNvbnN0IGRpc3RhbmNlID0gbGV2ZW5zaHRlaW5EaXN0YW5jZSh1c2VyV29yZCwgZGJXb3JkKTsKICAgICAgICAgIGlmIChkaXN0YW5jZSA8PSAyKSB7CiAgICAgICAgICAgIHBhcnRpYWxNYXRjaGVzICs9IDAuNTsKICAgICAgICAgICAgbWF0Y2hlZCA9IHRydWU7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9KTsKICAKICBjb25zdCB0b3RhbE1hdGNoZWQgPSBtYXRjaGVkV29yZHMgKyBwYXJ0aWFsTWF0Y2hlczsKICBjb25zdCBzY29yZSA9IHRvdGFsTWF0Y2hlZCAvIHVzZXJLZXl3b3Jkcy5sZW5ndGg7CiAgCiAgcmV0dXJuIHsgCiAgICBzY29yZSwgCiAgICBudW1iZXJNYXRjaDogaGFzRXhhY3ROdW1iZXJNYXRjaCwKICAgIGNvbnNlY3V0aXZlTWF0Y2hlcywKICAgIHRpdGxlTGVuZ3RoOiBkYktleXdvcmRzLmxlbmd0aCwKICAgIGV4YWN0V29yZENvdW50OiBtYXRjaGVkV29yZHMgIC8vIFRyYWNrIGV4YWN0IG1hdGNoZXMgc2VwYXJhdGVseQogIH07Cn0KCmZ1bmN0aW9uIGZpbmRCZXN0TWF0Y2godXNlclRpdGxlLCBkYkl0ZW1zKSB7CiAgY29uc3Qgbm9ybWFsaXplZCA9IG5vcm1hbGl6ZVRpdGxlKHVzZXJUaXRsZSk7CiAgCiAgLy8gVHJ5IGV4YWN0IG1hdGNoIGZpcnN0CiAgY29uc3QgZXhhY3RNYXRjaCA9IGRiSXRlbXMuZmluZChpdGVtID0+IG5vcm1hbGl6ZVRpdGxlKGl0ZW0ubmFtZSkgPT09IG5vcm1hbGl6ZWQpOwogIGlmIChleGFjdE1hdGNoKSB7CiAgICByZXR1cm4geyBtYXRjaDogZXhhY3RNYXRjaCwgY29uZmlkZW5jZTogJ2V4YWN0Jywgc2NvcmU6IDEuMCB9OwogIH0KICAKICAvLyBTY29yZSBhbGwgaXRlbXMKICBjb25zdCBzY29yZWQgPSBkYkl0ZW1zLm1hcChpdGVtID0+IHsKICAgIGNvbnN0IG1hdGNoRGF0YSA9IGNhbGN1bGF0ZU1hdGNoU2NvcmUodXNlclRpdGxlLCBpdGVtLm5hbWUpOwogICAgcmV0dXJuIHsKICAgICAgaXRlbSwKICAgICAgLi4ubWF0Y2hEYXRhCiAgICB9OwogIH0pLmZpbHRlcihzID0+IHMuc2NvcmUgPiAwKTsKICAKICBpZiAoc2NvcmVkLmxlbmd0aCA9PT0gMCkgcmV0dXJuIG51bGw7CiAgCiAgLy8gU29ydCBieSBwcmlvcml0eToKICAvLyAxLiBOdW1iZXIgbWF0Y2ggKGNyaXRpY2FsIGZvciBzZXF1ZWxzL3ZlcnNpb25zKQogIC8vIDIuIEV4YWN0IHdvcmQgY291bnQgKHByZWZlciBtb3JlIGV4YWN0IG1hdGNoZXMpCiAgLy8gMy4gU2NvcmUKICAvLyA0LiBDb25zZWN1dGl2ZSBtYXRjaGVzICh3b3JkIG9yZGVyIG1hdHRlcnMpCiAgLy8gNS4gU2hvcnRlciB0aXRsZSAobW9yZSBwcmVjaXNlKQogIHNjb3JlZC5zb3J0KChhLCBiKSA9PiB7CiAgICAvLyBQcmlvcml0eSAxOiBFeGFjdCBudW1iZXIgbWF0Y2gKICAgIGlmIChhLm51bWJlck1hdGNoICYmICFiLm51bWJlck1hdGNoKSByZXR1cm4gLTE7CiAgICBpZiAoIWEubnVtYmVyTWF0Y2ggJiYgYi5udW1iZXJNYXRjaCkgcmV0dXJuIDE7CiAgICAKICAgIC8vIFByaW9yaXR5IDI6IE1vcmUgZXhhY3Qgd29yZCBtYXRjaGVzIHdpbnMKICAgIGlmIChhLmV4YWN0V29yZENvdW50ICE9PSBiLmV4YWN0V29yZENvdW50KSB7CiAgICAgIHJldHVybiBiLmV4YWN0V29yZENvdW50IC0gYS5leGFjdFdvcmRDb3VudDsKICAgIH0KICAgIAogICAgLy8gUHJpb3JpdHkgMzogU2NvcmUgZGlmZmVyZW5jZQogICAgY29uc3Qgc2NvcmVEaWZmID0gYi5zY29yZSAtIGEuc2NvcmU7CiAgICBpZiAoTWF0aC5hYnMoc2NvcmVEaWZmKSA+IDAuMTUpIHJldHVybiBzY29yZURpZmY7CiAgICAKICAgIC8vIFByaW9yaXR5IDQ6IENvbnNlY3V0aXZlIG1hdGNoZXMgKHBocmFzZSBtYXRjaGluZykKICAgIGlmIChhLmNvbnNlY3V0aXZlTWF0Y2hlcyAhPT0gYi5jb25zZWN1dGl2ZU1hdGNoZXMpIHsKICAgICAgcmV0dXJuIGIuY29uc2VjdXRpdmVNYXRjaGVzIC0gYS5jb25zZWN1dGl2ZU1hdGNoZXM7CiAgICB9CiAgICAKICAgIC8vIFByaW9yaXR5IDU6IFByZWZlciBzaG9ydGVyIHRpdGxlcwogICAgcmV0dXJuIGEudGl0bGVMZW5ndGggLSBiLnRpdGxlTGVuZ3RoOwogIH0pOwogIAogIGNvbnN0IGJlc3QgPSBzY29yZWRbMF07CiAgCiAgLy8gRGV0ZXJtaW5lIGNvbmZpZGVuY2UgYmFzZWQgb24gc2NvcmUKICBsZXQgY29uZmlkZW5jZTsKICBpZiAoYmVzdC5zY29yZSA+PSAwLjk1KSB7CiAgICBjb25maWRlbmNlID0gJ2hpZ2gnOwogIH0gZWxzZSBpZiAoYmVzdC5zY29yZSA+PSAwLjcpIHsKICAgIGNvbmZpZGVuY2UgPSAnbWVkaXVtJzsKICB9IGVsc2UgaWYgKGJlc3Quc2NvcmUgPj0gMC41KSB7CiAgICBjb25maWRlbmNlID0gJ2xvdyc7CiAgfSBlbHNlIHsKICAgIHJldHVybiBudWxsOyAvLyBUb28gbG93IGNvbmZpZGVuY2UKICB9CiAgCiAgcmV0dXJuIHsgbWF0Y2g6IGJlc3QuaXRlbSwgY29uZmlkZW5jZSwgc2NvcmU6IGJlc3Quc2NvcmUgfTsKfQoKZnVuY3Rpb24gbWF0Y2hVc2VyTGlzdCh1c2VyTGlzdCkgewogIGNvbnN0IGxpbmVzID0gdXNlckxpc3Quc3BsaXQoJ1xuJykubWFwKHMgPT4gcy50cmltKCkpLmZpbHRlcihCb29sZWFuKTsKICBjb25zdCByZXN1bHRzID0gewogICAgZXhhY3Q6IFtdLAogICAgaGlnaDogW10sCiAgICBtZWRpdW06IFtdLAogICAgbG93OiBbXSwKICAgIG5vdEZvdW5kOiBbXQogIH07CiAgCiAgbGluZXMuZm9yRWFjaCh1c2VyVGl0bGUgPT4gewogICAgY29uc3QgcmVzdWx0ID0gZmluZEJlc3RNYXRjaCh1c2VyVGl0bGUsIHN0YXRlLml0ZW1zKTsKICAgIAogICAgaWYgKCFyZXN1bHQpIHsKICAgICAgcmVzdWx0cy5ub3RGb3VuZC5wdXNoKHVzZXJUaXRsZSk7CiAgICB9IGVsc2UgewogICAgICByZXN1bHRzW3Jlc3VsdC5jb25maWRlbmNlXS5wdXNoKHsKICAgICAgICBvcmlnaW5hbDogdXNlclRpdGxlLAogICAgICAgIG1hdGNoZWQ6IHJlc3VsdC5tYXRjaC5uYW1lLAogICAgICAgIHNpemU6IHJlc3VsdC5tYXRjaC5zaXplLAogICAgICAgIHNjb3JlOiByZXN1bHQuc2NvcmUKICAgICAgfSk7CiAgICB9CiAgfSk7CiAgCiAgcmV0dXJuIHJlc3VsdHM7Cn0KCiQoJ21hdGNoTGlzdCcpPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICBjb25zdCBtb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmaWxlc01vZGFsJyk7CiAgbW9kYWwuaW5uZXJIVE1MID0gJyc7CiAgbW9kYWwuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7CiAgbW9kYWwuc3R5bGUubWF4V2lkdGggPSAnNjAwcHgnOwogIAogIGNvbnN0IGhlYWRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogIGhlYWRlci5pbm5lckhUTUwgPSAnPHN0cm9uZz5NYXRjaCBVc2VyIExpc3Q8L3N0cm9uZz48YnI+PHNwYW4gY2xhc3M9Im1ldGEiPlBhc3RlIHVzZXJcJ3MgZ2FtZSBsaXN0IGJlbG93IChvbmUgcGVyIGxpbmUpPC9zcGFuPic7CiAgbW9kYWwuYXBwZW5kQ2hpbGQoaGVhZGVyKTsKICAKICBjb25zdCB0ZXh0YXJlYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RleHRhcmVhJyk7CiAgdGV4dGFyZWEuc3R5bGUuY3NzVGV4dCA9ICd3aWR0aDoxMDAlO21pbi1oZWlnaHQ6MjAwcHg7bWFyZ2luLXRvcDoxMnB4O3BhZGRpbmc6OHB4O2JvcmRlcjoxcHggc29saWQgI2U1ZTdlYjtib3JkZXItcmFkaXVzOjhweDtmb250LWZhbWlseTptb25vc3BhY2U7Zm9udC1zaXplOjEzcHg7JzsKICB0ZXh0YXJlYS5wbGFjZWhvbGRlciA9ICdTdXBlciBNYXJpbyBPZHlzc2V5XG5UaGUgTGVnZW5kIG9mIFplbGRhXG5NYXJpbyBLYXJ0IDhcbi4uLic7CiAgbW9kYWwuYXBwZW5kQ2hpbGQodGV4dGFyZWEpOwogIAogIGNvbnN0IGJ0bkNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogIGJ0bkNvbnRhaW5lci5zdHlsZS5jc3NUZXh0ID0gJ2Rpc3BsYXk6ZmxleDtnYXA6OHB4O21hcmdpbi10b3A6MTJweDsnOwogIAogIGNvbnN0IG1hdGNoQnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7CiAgbWF0Y2hCdG4udGV4dENvbnRlbnQgPSAnQW5hbHl6ZSAmIE1hdGNoJzsKICBtYXRjaEJ0bi5jbGFzc05hbWUgPSAnYnRuJzsKICBtYXRjaEJ0bi5vbmNsaWNrID0gKCkgPT4gewogICAgY29uc3QgdXNlckxpc3QgPSB0ZXh0YXJlYS52YWx1ZS50cmltKCk7CiAgICBpZiAoIXVzZXJMaXN0KSB7CiAgICAgIGFsZXJ0KCdQbGVhc2UgcGFzdGUgYSBnYW1lIGxpc3QnKTsKICAgICAgcmV0dXJuOwogICAgfQogICAgCiAgICBzaG93TWF0Y2hSZXN1bHRzKHVzZXJMaXN0KTsKICB9OwogIGJ0bkNvbnRhaW5lci5hcHBlbmRDaGlsZChtYXRjaEJ0bik7CiAgCiAgY29uc3QgY2xvc2VCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTsKICBjbG9zZUJ0bi50ZXh0Q29udGVudCA9ICdDYW5jZWwnOwogIGNsb3NlQnRuLmNsYXNzTmFtZSA9ICdidG4gZ2hvc3QnOwogIGNsb3NlQnRuLm9uY2xpY2sgPSAoKSA9PiB7CiAgICBtb2RhbC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgbW9kYWwuaW5uZXJIVE1MID0gJyc7CiAgfTsKICBidG5Db250YWluZXIuYXBwZW5kQ2hpbGQoY2xvc2VCdG4pOwogIAogIG1vZGFsLmFwcGVuZENoaWxkKGJ0bkNvbnRhaW5lcik7Cn0pOwoKZnVuY3Rpb24gc2hvd01hdGNoUmVzdWx0cyh1c2VyTGlzdCkgewogIGNvbnN0IHJlc3VsdHMgPSBtYXRjaFVzZXJMaXN0KHVzZXJMaXN0KTsKICBjb25zdCB0b3RhbE1hdGNoZWQgPSByZXN1bHRzLmV4YWN0Lmxlbmd0aCArIHJlc3VsdHMuaGlnaC5sZW5ndGggKyByZXN1bHRzLm1lZGl1bS5sZW5ndGggKyByZXN1bHRzLmxvdy5sZW5ndGg7CiAgY29uc3QgdG90YWxJdGVtcyA9IHRvdGFsTWF0Y2hlZCArIHJlc3VsdHMubm90Rm91bmQubGVuZ3RoOwogIAogIGNvbnN0IG1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpbGVzTW9kYWwnKTsKICBtb2RhbC5pbm5lckhUTUwgPSAnJzsKICBtb2RhbC5zdHlsZS5tYXhXaWR0aCA9ICc3MDBweCc7CiAgbW9kYWwuc3R5bGUubWF4SGVpZ2h0ID0gJzgwdmgnOwogIAogIGNvbnN0IGhlYWRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogIGhlYWRlci5pbm5lckhUTUwgPSBgPHN0cm9uZz5NYXRjaCBSZXN1bHRzPC9zdHJvbmc+PGJyPjxzcGFuIGNsYXNzPSJtZXRhIj5NYXRjaGVkOiAke3RvdGFsTWF0Y2hlZH0gLyAke3RvdGFsSXRlbXN9PC9zcGFuPmA7CiAgbW9kYWwuYXBwZW5kQ2hpbGQoaGVhZGVyKTsKICAKICBjb25zdCByZXN1bHRDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICByZXN1bHRDb250YWluZXIuc3R5bGUuY3NzVGV4dCA9ICdtYXJnaW4tdG9wOjEycHg7bWF4LWhlaWdodDo0MDBweDtvdmVyZmxvdy15OmF1dG87JzsKICAKICAvLyBFeGFjdCBtYXRjaGVzCiAgaWYgKHJlc3VsdHMuZXhhY3QubGVuZ3RoID4gMCkgewogICAgcmVzdWx0Q29udGFpbmVyLmlubmVySFRNTCArPSBgPGRpdiBzdHlsZT0ibWFyZ2luLWJvdHRvbTo4cHg7Ij48c3Ryb25nIHN0eWxlPSJjb2xvcjojMTBiOTgxOyI+4pyTIEV4YWN0IE1hdGNoZXMgKCR7cmVzdWx0cy5leGFjdC5sZW5ndGh9KTwvc3Ryb25nPjwvZGl2PmA7CiAgICByZXN1bHRzLmV4YWN0LmZvckVhY2gociA9PiB7CiAgICAgIHJlc3VsdENvbnRhaW5lci5pbm5lckhUTUwgKz0gYDxkaXYgc3R5bGU9InBhZGRpbmc6NHB4IDhweDtiYWNrZ3JvdW5kOiNmMGZkZjQ7Ym9yZGVyLWxlZnQ6M3B4IHNvbGlkICMxMGI5ODE7bWFyZ2luLWJvdHRvbTo0cHg7Zm9udC1zaXplOjEycHg7Ij4ke2VzYyhyLm1hdGNoZWQpfSA8c3BhbiBzdHlsZT0iY29sb3I6IzZiNzI4MDsiPiR7ZXNjKHIuc2l6ZSl9PC9zcGFuPjwvZGl2PmA7CiAgICB9KTsKICB9CiAgCiAgLy8gSGlnaCBjb25maWRlbmNlCiAgaWYgKHJlc3VsdHMuaGlnaC5sZW5ndGggPiAwKSB7CiAgICByZXN1bHRDb250YWluZXIuaW5uZXJIVE1MICs9IGA8ZGl2IHN0eWxlPSJtYXJnaW46MTJweCAwIDhweDsiPjxzdHJvbmcgc3R5bGU9ImNvbG9yOiMzYjgyZjY7Ij7iiYggSGlnaCBDb25maWRlbmNlICgke3Jlc3VsdHMuaGlnaC5sZW5ndGh9KTwvc3Ryb25nPjwvZGl2PmA7CiAgICByZXN1bHRzLmhpZ2guZm9yRWFjaChyID0+IHsKICAgICAgcmVzdWx0Q29udGFpbmVyLmlubmVySFRNTCArPSBgPGRpdiBzdHlsZT0icGFkZGluZzo0cHggOHB4O2JhY2tncm91bmQ6I2VmZjZmZjtib3JkZXItbGVmdDozcHggc29saWQgIzNiODJmNjttYXJnaW4tYm90dG9tOjRweDtmb250LXNpemU6MTJweDsiPjxkaXY+JHtlc2Moci5vcmlnaW5hbCl9IOKGkiA8c3Ryb25nPiR7ZXNjKHIubWF0Y2hlZCl9PC9zdHJvbmc+PC9kaXY+PGRpdiBzdHlsZT0iY29sb3I6IzZiNzI4MDsiPiR7ZXNjKHIuc2l6ZSl9PC9kaXY+PC9kaXY+YDsKICAgIH0pOwogIH0KICAKICAvLyBNZWRpdW0gY29uZmlkZW5jZQogIGlmIChyZXN1bHRzLm1lZGl1bS5sZW5ndGggPiAwKSB7CiAgICByZXN1bHRDb250YWluZXIuaW5uZXJIVE1MICs9IGA8ZGl2IHN0eWxlPSJtYXJnaW46MTJweCAwIDhweDsiPjxzdHJvbmcgc3R5bGU9ImNvbG9yOiNmNTllMGI7Ij4/IE1lZGl1bSBDb25maWRlbmNlICgke3Jlc3VsdHMubWVkaXVtLmxlbmd0aH0pPC9zdHJvbmc+IDxzcGFuIHN0eWxlPSJmb250LXNpemU6MTJweDtjb2xvcjojNmI3MjgwOyI+UmV2aWV3IHRoZXNlPC9zcGFuPjwvZGl2PmA7CiAgICByZXN1bHRzLm1lZGl1bS5mb3JFYWNoKHIgPT4gewogICAgICByZXN1bHRDb250YWluZXIuaW5uZXJIVE1MICs9IGA8ZGl2IHN0eWxlPSJwYWRkaW5nOjRweCA4cHg7YmFja2dyb3VuZDojZmZmYmViO2JvcmRlci1sZWZ0OjNweCBzb2xpZCAjZjU5ZTBiO21hcmdpbi1ib3R0b206NHB4O2ZvbnQtc2l6ZToxMnB4OyI+PGRpdj4ke2VzYyhyLm9yaWdpbmFsKX0g4oaSIDxzdHJvbmc+JHtlc2Moci5tYXRjaGVkKX08L3N0cm9uZz48L2Rpdj48ZGl2IHN0eWxlPSJjb2xvcjojNmI3MjgwOyI+JHtlc2Moci5zaXplKX08L2Rpdj48L2Rpdj5gOwogICAgfSk7CiAgfQogIAogIC8vIExvdyBjb25maWRlbmNlCiAgaWYgKHJlc3VsdHMubG93Lmxlbmd0aCA+IDApIHsKICAgIHJlc3VsdENvbnRhaW5lci5pbm5lckhUTUwgKz0gYDxkaXYgc3R5bGU9Im1hcmdpbjoxMnB4IDAgOHB4OyI+PHN0cm9uZyBzdHlsZT0iY29sb3I6I2Y5NzMxNjsiPuKaoCBMb3cgQ29uZmlkZW5jZSAoJHtyZXN1bHRzLmxvdy5sZW5ndGh9KTwvc3Ryb25nPiA8c3BhbiBzdHlsZT0iZm9udC1zaXplOjEycHg7Y29sb3I6IzZiNzI4MDsiPlZlcmlmeSBtYW51YWxseTwvc3Bhbj48L2Rpdj5gOwogICAgcmVzdWx0cy5sb3cuZm9yRWFjaChyID0+IHsKICAgICAgcmVzdWx0Q29udGFpbmVyLmlubmVySFRNTCArPSBgPGRpdiBzdHlsZT0icGFkZGluZzo0cHggOHB4O2JhY2tncm91bmQ6I2ZmZjdlZDtib3JkZXItbGVmdDozcHggc29saWQgI2Y5NzMxNjttYXJnaW4tYm90dG9tOjRweDtmb250LXNpemU6MTJweDsiPjxkaXY+JHtlc2Moci5vcmlnaW5hbCl9IOKGkiA8c3Ryb25nPiR7ZXNjKHIubWF0Y2hlZCl9PC9zdHJvbmc+PC9kaXY+PGRpdiBzdHlsZT0iY29sb3I6IzZiNzI4MDsiPiR7ZXNjKHIuc2l6ZSl9PC9kaXY+PC9kaXY+YDsKICAgIH0pOwogIH0KICAKICAvLyBOb3QgZm91bmQKICBpZiAocmVzdWx0cy5ub3RGb3VuZC5sZW5ndGggPiAwKSB7CiAgICByZXN1bHRDb250YWluZXIuaW5uZXJIVE1MICs9IGA8ZGl2IHN0eWxlPSJtYXJnaW46MTJweCAwIDhweDsiPjxzdHJvbmcgc3R5bGU9ImNvbG9yOiNlZjQ0NDQ7Ij7inJcgTm90IEZvdW5kICgke3Jlc3VsdHMubm90Rm91bmQubGVuZ3RofSk8L3N0cm9uZz48L2Rpdj5gOwogICAgcmVzdWx0cy5ub3RGb3VuZC5mb3JFYWNoKHRpdGxlID0+IHsKICAgICAgcmVzdWx0Q29udGFpbmVyLmlubmVySFRNTCArPSBgPGRpdiBzdHlsZT0icGFkZGluZzo0cHggOHB4O2JhY2tncm91bmQ6I2ZlZjJmMjtib3JkZXItbGVmdDozcHggc29saWQgI2VmNDQ0NDttYXJnaW4tYm90dG9tOjRweDtmb250LXNpemU6MTJweDsiPiR7ZXNjKHRpdGxlKX08L2Rpdj5gOwogICAgfSk7CiAgfQogIAogIG1vZGFsLmFwcGVuZENoaWxkKHJlc3VsdENvbnRhaW5lcik7CiAgCiAgY29uc3QgYnRuQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgYnRuQ29udGFpbmVyLnN0eWxlLmNzc1RleHQgPSAnZGlzcGxheTpmbGV4O2dhcDo4cHg7bWFyZ2luLXRvcDoxMnB4O2ZsZXgtd3JhcDp3cmFwOyc7CiAgCiAgaWYgKHRvdGFsTWF0Y2hlZCA+IDApIHsKICAgIGNvbnN0IGFkZEFsbEJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpOwogICAgYWRkQWxsQnRuLnRleHRDb250ZW50ID0gYEFkZCAke3RvdGFsTWF0Y2hlZH0gTWF0Y2hlcyB0byBTZWxlY3Rpb25gOwogICAgYWRkQWxsQnRuLmNsYXNzTmFtZSA9ICdidG4nOwogICAgYWRkQWxsQnRuLm9uY2xpY2sgPSAoKSA9PiB7CiAgICAgIGxldCBhZGRlZCA9IDA7CiAgICAgIFsuLi5yZXN1bHRzLmV4YWN0LCAuLi5yZXN1bHRzLmhpZ2gsIC4uLnJlc3VsdHMubWVkaXVtLCAuLi5yZXN1bHRzLmxvd10uZm9yRWFjaChyID0+IHsKICAgICAgICBpZiAoIXN0YXRlLnNlbGVjdGVkLnNvbWUocyA9PiBzLm5hbWUgPT09IHIubWF0Y2hlZCkpIHsKICAgICAgICAgIGNvbnN0IGl0ZW0gPSBzdGF0ZS5pdGVtcy5maW5kKGl0ID0+IGl0Lm5hbWUgPT09IHIubWF0Y2hlZCk7CiAgICAgICAgICBpZiAoaXRlbSkgewogICAgICAgICAgICBzdGF0ZS5zZWxlY3RlZC5wdXNoKHsKICAgICAgICAgICAgICBuYW1lOiBpdGVtLm5hbWUsCiAgICAgICAgICAgICAgZmlsZW5hbWU6IGl0ZW0uZmlsZW5hbWUgfHwgaXRlbS5uYW1lLAogICAgICAgICAgICAgIHNpemU6IGl0ZW0uc2l6ZQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgYWRkZWQrKzsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgICAKICAgICAgdXBkYXRlVG90YWxzKCk7CiAgICAgIHJlbmRlck92ZXJsYXkoKTsKICAgICAgcmVuZGVyTGlzdChzdGF0ZS5pdGVtcyk7CiAgICAgIHRvYXN0KGBBZGRlZCAke2FkZGVkfSBtYXRjaGVkIGdhbWVzYCk7CiAgICAgIG1vZGFsLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgIG1vZGFsLmlubmVySFRNTCA9ICcnOwogICAgfTsKICAgIGJ0bkNvbnRhaW5lci5hcHBlbmRDaGlsZChhZGRBbGxCdG4pOwogIH0KICAKICBjb25zdCBleHBvcnRNYXRjaGVkQnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7CiAgZXhwb3J0TWF0Y2hlZEJ0bi50ZXh0Q29udGVudCA9ICdFeHBvcnQgTWF0Y2hlZCc7CiAgZXhwb3J0TWF0Y2hlZEJ0bi5jbGFzc05hbWUgPSAnYnRuIGdob3N0JzsKICBleHBvcnRNYXRjaGVkQnRuLm9uY2xpY2sgPSAoKSA9PiB7CiAgICBjb25zdCBjb250ZW50ID0gWy4uLnJlc3VsdHMuZXhhY3QsIC4uLnJlc3VsdHMuaGlnaCwgLi4ucmVzdWx0cy5tZWRpdW0sIC4uLnJlc3VsdHMubG93XQogICAgICAubWFwKHIgPT4gci5tYXRjaGVkKQogICAgICAuam9pbignXG4nKTsKICAgIGNvbnN0IGJsb2IgPSBuZXcgQmxvYihbY29udGVudF0sIHsgdHlwZTogJ3RleHQvcGxhaW4nIH0pOwogICAgY29uc3QgYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTsKICAgIGEuaHJlZiA9IFVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYik7CiAgICBhLmRvd25sb2FkID0gYG1hdGNoZWRfJHtEYXRlLm5vdygpfS50eHRgOwogICAgYS5jbGljaygpOwogICAgVVJMLnJldm9rZU9iamVjdFVSTChhLmhyZWYpOwogICAgdG9hc3QoJ0V4cG9ydGVkIG1hdGNoZWQgbGlzdCcpOwogIH07CiAgYnRuQ29udGFpbmVyLmFwcGVuZENoaWxkKGV4cG9ydE1hdGNoZWRCdG4pOwogIAogIGlmIChyZXN1bHRzLm5vdEZvdW5kLmxlbmd0aCA+IDApIHsKICAgIGNvbnN0IGV4cG9ydE5vdEZvdW5kQnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7CiAgICBleHBvcnROb3RGb3VuZEJ0bi50ZXh0Q29udGVudCA9ICdFeHBvcnQgTm90IEZvdW5kJzsKICAgIGV4cG9ydE5vdEZvdW5kQnRuLmNsYXNzTmFtZSA9ICdidG4gZ2hvc3QnOwogICAgZXhwb3J0Tm90Rm91bmRCdG4uc3R5bGUuYmFja2dyb3VuZCA9ICcjZmVmMmYyJzsKICAgIGV4cG9ydE5vdEZvdW5kQnRuLnN0eWxlLmNvbG9yID0gJyNlZjQ0NDQnOwogICAgZXhwb3J0Tm90Rm91bmRCdG4ub25jbGljayA9ICgpID0+IHsKICAgICAgY29uc3QgY29udGVudCA9IHJlc3VsdHMubm90Rm91bmQuam9pbignXG4nKTsKICAgICAgY29uc3QgYmxvYiA9IG5ldyBCbG9iKFtjb250ZW50XSwgeyB0eXBlOiAndGV4dC9wbGFpbicgfSk7CiAgICAgIGNvbnN0IGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7CiAgICAgIGEuaHJlZiA9IFVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYik7CiAgICAgIGEuZG93bmxvYWQgPSBgbm90X2ZvdW5kXyR7RGF0ZS5ub3coKX0udHh0YDsKICAgICAgYS5jbGljaygpOwogICAgICBVUkwucmV2b2tlT2JqZWN0VVJMKGEuaHJlZik7CiAgICAgIHRvYXN0KCdFeHBvcnRlZCBub3QgZm91bmQgbGlzdCcpOwogICAgfTsKICAgIGJ0bkNvbnRhaW5lci5hcHBlbmRDaGlsZChleHBvcnROb3RGb3VuZEJ0bik7CiAgfQogIAogIGNvbnN0IGNsb3NlQnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7CiAgY2xvc2VCdG4udGV4dENvbnRlbnQgPSAnQ2xvc2UnOwogIGNsb3NlQnRuLmNsYXNzTmFtZSA9ICdidG4gZ2hvc3QnOwogIGNsb3NlQnRuLm9uY2xpY2sgPSAoKSA9PiB7CiAgICBtb2RhbC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgbW9kYWwuaW5uZXJIVE1MID0gJyc7CiAgfTsKICBidG5Db250YWluZXIuYXBwZW5kQ2hpbGQoY2xvc2VCdG4pOwogIAogIG1vZGFsLmFwcGVuZENoaWxkKGJ0bkNvbnRhaW5lcik7Cn0KCmlmICghaXNMb2NhbCkgewogIGNvbnN0IGFkbWluID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FkbWluRXhwb3J0Jyk7CiAgaWYgKGFkbWluKSBhZG1pbi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwoKICBjb25zdCBiaW4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYmluTGlzdCcpOwogIGlmIChiaW4pIGJpbi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogIAogIGNvbnN0IG1hdGNoID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hdGNoTGlzdCcpOwogIGlmIChtYXRjaCkgbWF0Y2guc3R5bGUuZGlzcGxheSA9ICdub25lJzsgIAoKfQoKY29uc3Qgc2VhcmNoSW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2VhcmNoJyk7CgppZiAoIWlzTW9iaWxlKSB7CiAgZnVuY3Rpb24gcmVmb2N1c1NlYXJjaCgpIHsKICAgIGNvbnN0IGFjdGl2ZSA9IGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQ7CiAgICBpZiAoCiAgICAgIGFjdGl2ZSAmJgogICAgICAoYWN0aXZlLmlkID09PSAnY3VzdG9tZXInIHx8CiAgICAgICBhY3RpdmUudGFnTmFtZSA9PT0gJ1NFTEVDVCcgfHwKICAgICAgIGFjdGl2ZS50YWdOYW1lID09PSAnVEVYVEFSRUEnKQogICAgKSByZXR1cm47CiAgICBzZWFyY2hJbnB1dC5mb2N1cygpOwogICAgc2VhcmNoSW5wdXQuc2VsZWN0KCk7CiAgfQoKICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsIHJlZm9jdXNTZWFyY2gpOwoKICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7CiAgICBjb25zdCBtb2RhbE9wZW4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsZXNNb2RhbCcpLnN0eWxlLmRpc3BsYXkgPT09ICdibG9jayc7CiAgICBjb25zdCBvdmVybGF5T3BlbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvdmVybGF5Jykuc3R5bGUuZGlzcGxheSA9PT0gJ2ZsZXgnOwogICAgaWYgKAogICAgICAhbW9kYWxPcGVuICYmCiAgICAgICFvdmVybGF5T3BlbiAmJgogICAgICBlLnRhcmdldC5pZCAhPT0gJ3NlYXJjaCcgJiYKICAgICAgZS50YXJnZXQuaWQgIT09ICdjdXN0b21lcicgJiYKICAgICAgIWUudGFyZ2V0LmNsb3Nlc3QoJ3NlbGVjdCcpCiAgICApIHsKICAgICAgcmVmb2N1c1NlYXJjaCgpOwogICAgfQogIH0pOwoKICBbJ2NsZWFyU2VhcmNoJywgJ3Nob3dTZWxlY3RlZCcsICdzYXZlQnRuJywgJ3VwbG9hZEJ0biddLmZvckVhY2goaWQgPT4gewogICAgY29uc3QgYnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpOwogICAgaWYgKGJ0bikgYnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgcmVmb2N1c1NlYXJjaCk7CiAgfSk7CgogIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHsKICAgIGlmIChlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2l0ZW0nKSkgewogICAgICBzZXRUaW1lb3V0KHJlZm9jdXNTZWFyY2gsIDEyMCk7CiAgICB9CiAgfSk7CgogIFsnY2xvc2VPdmVybGF5J10uZm9yRWFjaChpZCA9PiB7CiAgICBjb25zdCBidG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7CiAgICBpZiAoYnRuKSBidG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiBzZXRUaW1lb3V0KHJlZm9jdXNTZWFyY2gsIDIwMCkpOwogIH0pOwoKICBzZWFyY2hJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgKGV2KSA9PiB7CiAgICBpZiAoZXYua2V5ID09PSAnRW50ZXInKSB7CiAgICAgIHNldFRpbWVvdXQocmVmb2N1c1NlYXJjaCwgMTUwKTsKICAgIH0KICB9KTsKfQoKKGFzeW5jIGZ1bmN0aW9uIGluaXQoKSB7CiAgYnVpbGREeW5hbWljQ29udHJvbHMoKTsKCiAgLy8gTG9hZCBpY29uIGNhY2hlIGZpcnN0IChub24tYmxvY2tpbmcpCiAgYXdhaXQgbG9hZEljb25DYWNoZSgpOwoKICAvLyBCdWlsZCBnZW5yZSBmaWx0ZXIgZnJvbSBjYWNoZSBkYXRhCiAgYnVpbGRHZW5yZUZpbHRlcigpOwoKICBhd2FpdCBsb2FkWE1MKCk7CiAgdXBkYXRlVG90YWxzKCk7CiAgdXBkYXRlRmlsZW5hbWVQcmV2aWV3KCk7CgogIC8vIFNldCBmaWxlIGlucHV0IGFjY2VwdCBhdHRyaWJ1dGUgZnJvbSBjb25maWcKICBjb25zdCBmaWxlSW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsZUluJyk7CiAgaWYgKGZpbGVJbnB1dCAmJiBDT05GSUcuY2xpZW50RmlsZUV4dCkgewogICAgZmlsZUlucHV0LmFjY2VwdCA9IENPTkZJRy5jbGllbnRGaWxlRXh0OwogIH0KfSkoKTsKPC9zY3JpcHQ+CjwvYm9keT4KPC9odG1sPg==`;
    const decoded = atob(base64html);
    const iframe = document.getElementById('viewer');
    const doc = iframe.contentWindow.document;
    doc.open();
    doc.write(decoded);
    doc.close();
  </script>
</body>
</html>