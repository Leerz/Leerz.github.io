<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PremazingPH Games</title>
  <style>
    html, body {
      margin: 0; padding: 0;
      width: 100%; height: 100%;
      overflow: hidden;
    }
    iframe {
      width: 100vw; height: 100vh;
      border: none;
      display: block;
    }
  </style>
</head>
<body>
  <iframe id="viewer"></iframe>
  <script>
    const base64html = `PCFET0NUWVBFIGh0bWw+CjxodG1sIGxhbmc9ImVuIj4KPGhlYWQ+CjxtZXRhIGNoYXJzZXQ9InV0Zi04IiAvPgo8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLGluaXRpYWwtc2NhbGU9MSIgLz4KPHRpdGxlIGlkPSJwYWdlVGl0bGUiPkdhbWUgU2VsZWN0b3I8L3RpdGxlPgo8c3R5bGU+Cjpyb290ewogIC0tYmc6IzBhMGUxYTsKICAtLWJnLXNlY29uZGFyeTojMTExODI3OwogIC0tcGFuZWw6IzFlMjkzYjsKICAtLXBhbmVsLWhvdmVyOiMyNzM0NDk7CiAgLS1jYXJkOiMxZTI5M2I7CiAgLS1jYXJkLXNlbGVjdGVkOiMxZTNhNWY7CiAgLS1ib3JkZXI6IzMzNDE1NTsKICAtLXRleHQ6I2YxZjVmOTsKICAtLXRleHQtc2Vjb25kYXJ5OiM5NGEzYjg7CiAgLS1tdXRlZDojNjQ3NDhiOwogIC0tcHJpbWFyeTojM2I4MmY2OwogIC0tcHJpbWFyeS1ob3ZlcjojMjU2M2ViOwogIC0tYWNjZW50OiNmNTllMGI7CiAgLS1zdWNjZXNzOiMyMmM1NWU7CiAgLS1kYW5nZXI6I2VmNDQ0NDsKICAtLXJhZGl1czoxMnB4OwogIC0tcmFkaXVzLWxnOjE2cHg7Cn0KKntib3gtc2l6aW5nOmJvcmRlci1ib3g7LXdlYmtpdC10YXAtaGlnaGxpZ2h0LWNvbG9yOnRyYW5zcGFyZW50fQpodG1sLGJvZHl7aGVpZ2h0OjEwMCU7bWFyZ2luOjA7Zm9udC1mYW1pbHk6J0ludGVyJywtYXBwbGUtc3lzdGVtLEJsaW5rTWFjU3lzdGVtRm9udCwnU2Vnb2UgVUknLFJvYm90byxzYW5zLXNlcmlmO2JhY2tncm91bmQ6dmFyKC0tYmcpO2NvbG9yOnZhcigtLXRleHQpfQoKLyogSGVhZGVyICovCi5oZWFkZXJ7cG9zaXRpb246Zml4ZWQ7dG9wOjA7cmlnaHQ6MDtsZWZ0OjA7aGVpZ2h0OjcwcHg7YmFja2dyb3VuZDpsaW5lYXItZ3JhZGllbnQoMTgwZGVnLCMzYjgyZjYgMCUsIzI1NjNlYiAxMDAlKTtkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2dhcDoxMnB4O3BhZGRpbmc6MTJweCAxNnB4O3otaW5kZXg6NjA7Ym94LXNoYWRvdzowIDRweCAyMHB4IHJnYmEoMCwwLDAsMC4zKX0KLmhlYWRlciAuc2VhcmNoe2ZsZXg6MTttaW4td2lkdGg6MTQwcHh9Ci5oZWFkZXIgaW5wdXQuc2VhcmNoe2hlaWdodDo0MnB4O2JvcmRlci1yYWRpdXM6dmFyKC0tcmFkaXVzKTtib3JkZXI6bm9uZTtwYWRkaW5nOjAgMTZweDtiYWNrZ3JvdW5kOnJnYmEoMjU1LDI1NSwyNTUsMC4xNSk7Y29sb3I6I2ZmZjtmb250LXNpemU6MTVweDtiYWNrZHJvcC1maWx0ZXI6Ymx1cigxMHB4KX0KLmhlYWRlciBpbnB1dC5zZWFyY2g6OnBsYWNlaG9sZGVye2NvbG9yOnJnYmEoMjU1LDI1NSwyNTUsMC43KX0KLmhlYWRlciBpbnB1dC5zZWFyY2g6Zm9jdXN7b3V0bGluZTpub25lO2JhY2tncm91bmQ6cmdiYSgyNTUsMjU1LDI1NSwwLjI1KTtib3gtc2hhZG93OjAgMCAwIDNweCByZ2JhKDI1NSwyNTUsMjU1LDAuMil9Ci5oZWFkZXIgLmFjdGlvbnN7ZGlzcGxheTpmbGV4O2dhcDo2cHg7YWxpZ24taXRlbXM6Y2VudGVyfQouaGVhZGVyIGJ1dHRvbntoZWlnaHQ6NDJweDtib3JkZXItcmFkaXVzOnZhcigtLXJhZGl1cyk7Ym9yZGVyOm5vbmU7cGFkZGluZzowIDE0cHg7YmFja2dyb3VuZDpyZ2JhKDI1NSwyNTUsMjU1LDAuMTUpO2NvbG9yOiNmZmY7Zm9udC1zaXplOjE0cHg7Zm9udC13ZWlnaHQ6NTAwO2N1cnNvcjpwb2ludGVyO3RyYW5zaXRpb246YWxsIDAuMnN9Ci5oZWFkZXIgYnV0dG9uOmhvdmVye2JhY2tncm91bmQ6cmdiYSgyNTUsMjU1LDI1NSwwLjI1KX0KCi8qIEZpbHRlciBUYWJzICovCi5maWx0ZXItdGFic3tkaXNwbGF5OmZsZXg7Z2FwOjhweDtwYWRkaW5nOjEycHggMTZweDtiYWNrZ3JvdW5kOnZhcigtLWJnLXNlY29uZGFyeSk7Ym9yZGVyLWJvdHRvbToxcHggc29saWQgdmFyKC0tYm9yZGVyKX0KLmZpbHRlci10YWJ7cGFkZGluZzo4cHggMTZweDtib3JkZXItcmFkaXVzOjIwcHg7Ym9yZGVyOjFweCBzb2xpZCB2YXIoLS1ib3JkZXIpO2JhY2tncm91bmQ6dHJhbnNwYXJlbnQ7Y29sb3I6dmFyKC0tdGV4dC1zZWNvbmRhcnkpO2ZvbnQtc2l6ZToxM3B4O2ZvbnQtd2VpZ2h0OjUwMDtjdXJzb3I6cG9pbnRlcjt0cmFuc2l0aW9uOmFsbCAwLjJzfQouZmlsdGVyLXRhYjpob3ZlcntiYWNrZ3JvdW5kOnZhcigtLXBhbmVsKTtjb2xvcjp2YXIoLS10ZXh0KX0KLmZpbHRlci10YWIuYWN0aXZle2JhY2tncm91bmQ6dmFyKC0tcHJpbWFyeSk7Ym9yZGVyLWNvbG9yOnZhcigtLXByaW1hcnkpO2NvbG9yOiNmZmZ9CgovKiBDb250YWluZXIgKi8KLmNvbnRhaW5lcntkaXNwbGF5OmdyaWQ7Z3JpZC10ZW1wbGF0ZS1jb2x1bW5zOjFmciA0MDBweDtnYXA6MTZweDtwYWRkaW5nOmNhbGMoNzBweCArIDE2cHgpIDE2cHggMTAwcHg7bWluLWhlaWdodDoxMDB2aH0KCi8qIExlZnQgUGFuZSAtIEdhbWUgTGlzdCAqLwoubGVmdFBhbmV7YmFja2dyb3VuZDp2YXIoLS1iZy1zZWNvbmRhcnkpO2JvcmRlci1yYWRpdXM6dmFyKC0tcmFkaXVzLWxnKTtwYWRkaW5nOjA7b3ZlcmZsb3c6aGlkZGVuO2JvcmRlcjoxcHggc29saWQgdmFyKC0tYm9yZGVyKX0KLmxlZnRQYW5lLWlubmVye3BhZGRpbmc6MTJweDtvdmVyZmxvdy15OmF1dG87bWF4LWhlaWdodDpjYWxjKDEwMHZoIC0gMjAwcHgpfQoKLyogR2FtZSBJdGVtIENhcmQgKi8KLml0ZW17ZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtnYXA6MTJweDtwYWRkaW5nOjEycHg7Ym9yZGVyLXJhZGl1czp2YXIoLS1yYWRpdXMpO2JhY2tncm91bmQ6dmFyKC0tY2FyZCk7Ym9yZGVyOjFweCBzb2xpZCB2YXIoLS1ib3JkZXIpO2N1cnNvcjpwb2ludGVyO21hcmdpbi1ib3R0b206MTBweDt0cmFuc2l0aW9uOmFsbCAwLjJzfQouaXRlbTpob3ZlcntiYWNrZ3JvdW5kOnZhcigtLXBhbmVsLWhvdmVyKTtib3JkZXItY29sb3I6IzQ3NTU2OTt0cmFuc2Zvcm06dHJhbnNsYXRlWSgtMXB4KX0KLml0ZW0uc2VsZWN0ZWR7YmFja2dyb3VuZDp2YXIoLS1jYXJkLXNlbGVjdGVkKTtib3JkZXItY29sb3I6dmFyKC0tcHJpbWFyeSl9Ci5pdGVtLnNlbGVjdGVkIC5pdGVtLWNoZWNrYm94e2JhY2tncm91bmQ6dmFyKC0tcHJpbWFyeSk7Ym9yZGVyLWNvbG9yOnZhcigtLXByaW1hcnkpfQouaXRlbS5zZWxlY3RlZCAuaXRlbS1jaGVja2JveDo6YWZ0ZXJ7Y29udGVudDon4pyTJztjb2xvcjojZmZmO2ZvbnQtc2l6ZToxMnB4O2ZvbnQtd2VpZ2h0OmJvbGR9CgovKiBHYW1lIFRodW1ibmFpbCAqLwouaXRlbS10aHVtYnt3aWR0aDo1NnB4O2hlaWdodDo1NnB4O2JvcmRlci1yYWRpdXM6OHB4O2JhY2tncm91bmQ6bGluZWFyLWdyYWRpZW50KDEzNWRlZywjMzc0MTUxIDAlLCMxZjI5MzcgMTAwJSk7ZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO2ZsZXgtc2hyaW5rOjA7b3ZlcmZsb3c6aGlkZGVuO3Bvc2l0aW9uOnJlbGF0aXZlfQouaXRlbS10aHVtYiBpbWd7d2lkdGg6MTAwJTtoZWlnaHQ6MTAwJTtvYmplY3QtZml0OmNvdmVyfQouaXRlbS10aHVtYi1wbGFjZWhvbGRlcntmb250LXNpemU6MjBweDtjb2xvcjp2YXIoLS1tdXRlZCl9CgovKiBGb3JtYXQgQmFkZ2UgKi8KLmZvcm1hdC1iYWRnZXtwb3NpdGlvbjphYnNvbHV0ZTtib3R0b206NHB4O2xlZnQ6NHB4O3BhZGRpbmc6MnB4IDZweDtib3JkZXItcmFkaXVzOjRweDtmb250LXNpemU6OXB4O2ZvbnQtd2VpZ2h0OjcwMDt0ZXh0LXRyYW5zZm9ybTp1cHBlcmNhc2U7bGV0dGVyLXNwYWNpbmc6MC41cHh9Ci5mb3JtYXQtYmFkZ2UubnNwe2JhY2tncm91bmQ6IzIyYzU1ZTtjb2xvcjojZmZmfQouZm9ybWF0LWJhZGdlLm5zentiYWNrZ3JvdW5kOiMzYjgyZjY7Y29sb3I6I2ZmZn0KLmZvcm1hdC1iYWRnZS54Y2l7YmFja2dyb3VuZDojYTg1NWY3O2NvbG9yOiNmZmZ9CgovKiBJdGVtIENvbnRlbnQgKi8KLml0ZW0tY29udGVudHtmbGV4OjE7bWluLXdpZHRoOjB9Ci5pdGVtLXRpdGxle2ZvbnQtc2l6ZToxNHB4O2ZvbnQtd2VpZ2h0OjYwMDtjb2xvcjp2YXIoLS10ZXh0KTttYXJnaW4tYm90dG9tOjRweDt3aGl0ZS1zcGFjZTpub3dyYXA7b3ZlcmZsb3c6aGlkZGVuO3RleHQtb3ZlcmZsb3c6ZWxsaXBzaXN9Ci5pdGVtLXNpemV7Zm9udC1zaXplOjEzcHg7Y29sb3I6dmFyKC0tdGV4dC1zZWNvbmRhcnkpfQouaXRlbS1tZXRhe2ZvbnQtc2l6ZToxMXB4O2NvbG9yOnZhcigtLW11dGVkKTttYXJnaW4tdG9wOjJweH0KCi8qIENpcmN1bGFyIENoZWNrYm94ICovCi5pdGVtLWNoZWNrYm94e3dpZHRoOjI2cHg7aGVpZ2h0OjI2cHg7Ym9yZGVyLXJhZGl1czo1MCU7Ym9yZGVyOjJweCBzb2xpZCB2YXIoLS1ib3JkZXIpO2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OmNlbnRlcjtmbGV4LXNocmluazowO3RyYW5zaXRpb246YWxsIDAuMnN9CgovKiBSaWdodCBQYW5lICovCi5yaWdodFBhbmV7YmFja2dyb3VuZDp2YXIoLS1iZy1zZWNvbmRhcnkpO2JvcmRlci1yYWRpdXM6dmFyKC0tcmFkaXVzLWxnKTtwYWRkaW5nOjE2cHg7b3ZlcmZsb3cteTphdXRvO2JvcmRlcjoxcHggc29saWQgdmFyKC0tYm9yZGVyKTtkaXNwbGF5OmZsZXg7ZmxleC1kaXJlY3Rpb246Y29sdW1uO2dhcDoxNnB4fQoKLyogU3RvcmFnZSBDYXJkICovCi5zdG9yYWdlLWNhcmR7YmFja2dyb3VuZDp2YXIoLS1jYXJkKTtib3JkZXItcmFkaXVzOnZhcigtLXJhZGl1cyk7cGFkZGluZzoxNnB4O2JvcmRlcjoxcHggc29saWQgdmFyKC0tYm9yZGVyKX0KLnN0b3JhZ2UtaGVhZGVye2Rpc3BsYXk6ZmxleDtqdXN0aWZ5LWNvbnRlbnQ6c3BhY2UtYmV0d2VlbjthbGlnbi1pdGVtczpjZW50ZXI7bWFyZ2luLWJvdHRvbToxMnB4fQouc3RvcmFnZS10aXRsZXtkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2dhcDo4cHg7Zm9udC1zaXplOjE0cHg7Zm9udC13ZWlnaHQ6NjAwO2NvbG9yOnZhcigtLXRleHQpfQouc3RvcmFnZS10aXRsZSBzdmd7d2lkdGg6MjBweDtoZWlnaHQ6MjBweDtjb2xvcjp2YXIoLS1wcmltYXJ5KX0KLnN0b3JhZ2UtY2FwYWNpdHl7Zm9udC1zaXplOjEzcHg7Y29sb3I6dmFyKC0tdGV4dC1zZWNvbmRhcnkpfQoKLyogUHJvZ3Jlc3MgQmFyICovCi5zdG9yYWdlLXByb2dyZXNze2hlaWdodDoxMHB4O2JhY2tncm91bmQ6dmFyKC0tYmcpO2JvcmRlci1yYWRpdXM6NXB4O292ZXJmbG93OmhpZGRlbjtkaXNwbGF5OmZsZXh9Ci5wcm9ncmVzcy11c2Vke2JhY2tncm91bmQ6IzQ3NTU2OTt0cmFuc2l0aW9uOndpZHRoIDAuM3N9Ci5wcm9ncmVzcy1zZWxlY3RlZHtiYWNrZ3JvdW5kOnZhcigtLXByaW1hcnkpO3RyYW5zaXRpb246d2lkdGggMC4zc30KLnByb2dyZXNzLWZyZWV7YmFja2dyb3VuZDp0cmFuc3BhcmVudH0KLnN0b3JhZ2UtbGVnZW5ke2Rpc3BsYXk6ZmxleDtnYXA6MTZweDttYXJnaW4tdG9wOjEwcHg7Zm9udC1zaXplOjEycHh9Ci5sZWdlbmQtaXRlbXtkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2dhcDo2cHg7Y29sb3I6dmFyKC0tdGV4dC1zZWNvbmRhcnkpfQoubGVnZW5kLWRvdHt3aWR0aDo4cHg7aGVpZ2h0OjhweDtib3JkZXItcmFkaXVzOjUwJX0KLmxlZ2VuZC1kb3QudXNlZHtiYWNrZ3JvdW5kOiM0NzU1Njl9Ci5sZWdlbmQtZG90LnNlbGVjdGVke2JhY2tncm91bmQ6dmFyKC0tcHJpbWFyeSl9Ci5sZWdlbmQtZG90LmZyZWV7YmFja2dyb3VuZDp2YXIoLS1iZyk7Ym9yZGVyOjFweCBzb2xpZCB2YXIoLS1ib3JkZXIpfQoKLyogU3RhdHMgR3JpZCAqLwouc3RhdHMtZ3JpZHtkaXNwbGF5OmdyaWQ7Z3JpZC10ZW1wbGF0ZS1jb2x1bW5zOnJlcGVhdCgzLDFmcik7Z2FwOjhweH0KLnN0YXQtY2FyZHtiYWNrZ3JvdW5kOnZhcigtLWNhcmQpO2JvcmRlci1yYWRpdXM6dmFyKC0tcmFkaXVzKTtwYWRkaW5nOjE0cHg7dGV4dC1hbGlnbjpjZW50ZXI7Ym9yZGVyOjFweCBzb2xpZCB2YXIoLS1ib3JkZXIpfQouc3RhdC1jYXJkLmhpZ2hsaWdodHtib3JkZXItY29sb3I6dmFyKC0tcHJpbWFyeSk7YmFja2dyb3VuZDpsaW5lYXItZ3JhZGllbnQoMTgwZGVnLHJnYmEoNTksMTMwLDI0NiwwLjEpIDAlLHZhcigtLWNhcmQpIDEwMCUpfQouc3RhdC12YWx1ZXtmb250LXNpemU6MjJweDtmb250LXdlaWdodDo3MDA7Y29sb3I6dmFyKC0tdGV4dCl9Ci5zdGF0LWNhcmQuaGlnaGxpZ2h0IC5zdGF0LXZhbHVle2NvbG9yOnZhcigtLXByaW1hcnkpfQouc3RhdC1sYWJlbHtmb250LXNpemU6MTBweDtmb250LXdlaWdodDo2MDA7dGV4dC10cmFuc2Zvcm06dXBwZXJjYXNlO2xldHRlci1zcGFjaW5nOjAuNXB4O2NvbG9yOnZhcigtLW11dGVkKTttYXJnaW4tdG9wOjRweH0KLnN0YXQtbm90ZXtmb250LXNpemU6MTFweDtjb2xvcjp2YXIoLS1tdXRlZCk7dGV4dC1hbGlnbjpjZW50ZXI7ZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO2dhcDo0cHh9CgovKiBDb250cm9scyAqLwouY29udHJvbHN7ZGlzcGxheTpncmlkO2dyaWQtdGVtcGxhdGUtY29sdW1uczoxZnIgMWZyO2dhcDo4cHh9Ci5jb250cm9scyAuZnVsbHtncmlkLWNvbHVtbjoxIC8gLTF9Ci5jb250cm9scyBpbnB1dCwuY29udHJvbHMgc2VsZWN0e2hlaWdodDo0NHB4O2JvcmRlci1yYWRpdXM6dmFyKC0tcmFkaXVzKTtib3JkZXI6MXB4IHNvbGlkIHZhcigtLWJvcmRlcik7cGFkZGluZzowIDEycHg7YmFja2dyb3VuZDp2YXIoLS1jYXJkKTtjb2xvcjp2YXIoLS10ZXh0KTtmb250LXNpemU6MTRweDt3aWR0aDoxMDAlfQouY29udHJvbHMgaW5wdXQ6Zm9jdXMsLmNvbnRyb2xzIHNlbGVjdDpmb2N1c3tvdXRsaW5lOm5vbmU7Ym9yZGVyLWNvbG9yOnZhcigtLXByaW1hcnkpO2JveC1zaGFkb3c6MCAwIDAgM3B4IHJnYmEoNTksMTMwLDI0NiwwLjIpfQouY29udHJvbHMgc2VsZWN0e2N1cnNvcjpwb2ludGVyO2FwcGVhcmFuY2U6bm9uZTtiYWNrZ3JvdW5kLWltYWdlOnVybCgiZGF0YTppbWFnZS9zdmcreG1sLCUzQ3N2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScxMicgaGVpZ2h0PScxMicgdmlld0JveD0nMCAwIDEyIDEyJyUzRSUzQ3BhdGggZmlsbD0nJTIzOTRhM2I4JyBkPSdNNiA4TDEgM2gxMHonLyUzRSUzQy9zdmclM0UiKTtiYWNrZ3JvdW5kLXJlcGVhdDpuby1yZXBlYXQ7YmFja2dyb3VuZC1wb3NpdGlvbjpyaWdodCAxMnB4IGNlbnRlcjtwYWRkaW5nLXJpZ2h0OjM2cHh9Ci5jb250cm9scyBsYWJlbHtmb250LXNpemU6MTJweDtjb2xvcjp2YXIoLS1tdXRlZCk7bWFyZ2luLWJvdHRvbTo0cHg7ZGlzcGxheTpibG9ja30KCi8qIER5bmFtaWMgQ29udHJvbHMgR3JpZCAqLwojZHluYW1pY0NvbnRyb2xze2Rpc3BsYXk6Y29udGVudHN9CiNkeW5hbWljQ29udHJvbHMgPiBkaXZ7ZGlzcGxheTpmbGV4O2ZsZXgtZGlyZWN0aW9uOmNvbHVtbn0KCi5maWxlbmFtZS1wcmV2aWV3e2dyaWQtY29sdW1uOjEgLyAtMTtwYWRkaW5nOjEwcHggMTJweDtiYWNrZ3JvdW5kOnZhcigtLWJnKTtib3JkZXI6MXB4IHNvbGlkIHZhcigtLWJvcmRlcik7Ym9yZGVyLXJhZGl1czp2YXIoLS1yYWRpdXMpO2ZvbnQtZmFtaWx5OidTRiBNb25vJyxNb25hY28sbW9ub3NwYWNlO2ZvbnQtc2l6ZToxMnB4O2NvbG9yOnZhcigtLXRleHQtc2Vjb25kYXJ5KTtvdmVyZmxvdy14OmF1dG87d2hpdGUtc3BhY2U6bm93cmFwfQoKLyogQnV0dG9ucyAqLwouYnRue3BhZGRpbmc6MTBweCAxNnB4O2JvcmRlci1yYWRpdXM6dmFyKC0tcmFkaXVzKTtib3JkZXI6bm9uZTtmb250LXNpemU6MTRweDtmb250LXdlaWdodDo2MDA7Y3Vyc29yOnBvaW50ZXI7dHJhbnNpdGlvbjphbGwgMC4ycztkaXNwbGF5OmlubGluZS1mbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO2dhcDo2cHh9Ci5idG4tcHJpbWFyeXtiYWNrZ3JvdW5kOnZhcigtLXByaW1hcnkpO2NvbG9yOiNmZmZ9Ci5idG4tcHJpbWFyeTpob3ZlcntiYWNrZ3JvdW5kOnZhcigtLXByaW1hcnktaG92ZXIpO3RyYW5zZm9ybTp0cmFuc2xhdGVZKC0xcHgpfQouYnRuLmdob3N0e2JhY2tncm91bmQ6dHJhbnNwYXJlbnQ7Y29sb3I6dmFyKC0tdGV4dC1zZWNvbmRhcnkpO2JvcmRlcjoxcHggc29saWQgdmFyKC0tYm9yZGVyKX0KLmJ0bi5naG9zdDpob3ZlcntiYWNrZ3JvdW5kOnZhcigtLXBhbmVsKTtjb2xvcjp2YXIoLS10ZXh0KTtib3JkZXItY29sb3I6IzQ3NTU2OX0KLmJ0bi5kYW5nZXJ7YmFja2dyb3VuZDp2YXIoLS1kYW5nZXIpO2NvbG9yOiNmZmZ9Ci5idG4uZGFuZ2VyOmhvdmVye2JhY2tncm91bmQ6I2RjMjYyNn0KCi8qIEFjdGlvbiBCdXR0b25zIFJvdyAqLwouYWN0aW9uLXJvd3tkaXNwbGF5OmZsZXg7Z2FwOjhweDtmbGV4LXdyYXA6d3JhcH0KLmFjdGlvbi1yb3cgLmJ0bntmbGV4OjE7bWluLXdpZHRoOmZpdC1jb250ZW50fQoKLyogU2hhcmUgSW5wdXQgKi8KLnNoYXJlLXJvd3tkaXNwbGF5OmZsZXg7Z2FwOjhweDthbGlnbi1pdGVtczpjZW50ZXJ9Ci5zaGFyZS1yb3cgaW5wdXR7ZmxleDoxO2hlaWdodDo0NHB4O2JvcmRlci1yYWRpdXM6dmFyKC0tcmFkaXVzKTtib3JkZXI6MXB4IHNvbGlkIHZhcigtLWJvcmRlcik7cGFkZGluZzowIDEycHg7YmFja2dyb3VuZDp2YXIoLS1jYXJkKTtjb2xvcjp2YXIoLS10ZXh0KTtmb250LXNpemU6MTNweH0KCi8qIFNlbGVjdGVkIFBhbmVsICovCi5zZWxlY3RlZC1wYW5lbHtiYWNrZ3JvdW5kOnZhcigtLWNhcmQpO2JvcmRlci1yYWRpdXM6dmFyKC0tcmFkaXVzKTtib3JkZXI6MXB4IHNvbGlkIHZhcigtLWJvcmRlcik7ZmxleDoxO2Rpc3BsYXk6ZmxleDtmbGV4LWRpcmVjdGlvbjpjb2x1bW47b3ZlcmZsb3c6aGlkZGVuO21pbi1oZWlnaHQ6MjAwcHh9Ci5zZWxlY3RlZC1wYW5lbCAuaGVhZHtwYWRkaW5nOjEycHggMTZweDtib3JkZXItYm90dG9tOjFweCBzb2xpZCB2YXIoLS1ib3JkZXIpO2ZvbnQtd2VpZ2h0OjYwMDtmb250LXNpemU6MTRweDtjb2xvcjp2YXIoLS10ZXh0KTtkaXNwbGF5OmZsZXg7anVzdGlmeS1jb250ZW50OnNwYWNlLWJldHdlZW47YWxpZ24taXRlbXM6Y2VudGVyfQouc2VsZWN0ZWQtcGFuZWwgLmJvZHl7ZmxleDoxO292ZXJmbG93LXk6YXV0bztwYWRkaW5nOjhweH0KCi8qIFNlbGVjdGVkIEl0ZW0gKi8KLnNlbGVjdGVkLWl0ZW17ZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtnYXA6MTBweDtwYWRkaW5nOjEwcHg7YmFja2dyb3VuZDp2YXIoLS1iZyk7Ym9yZGVyLXJhZGl1czp2YXIoLS1yYWRpdXMpO21hcmdpbi1ib3R0b206OHB4O2JvcmRlcjoxcHggc29saWQgdmFyKC0tYm9yZGVyKX0KLnNlbGVjdGVkLWl0ZW0tdGh1bWJ7d2lkdGg6NDRweDtoZWlnaHQ6NDRweDtib3JkZXItcmFkaXVzOjhweDtiYWNrZ3JvdW5kOnZhcigtLXBhbmVsKTtkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2p1c3RpZnktY29udGVudDpjZW50ZXI7ZmxleC1zaHJpbms6MH0KLnNlbGVjdGVkLWl0ZW0tY29udGVudHtmbGV4OjE7bWluLXdpZHRoOjB9Ci5zZWxlY3RlZC1pdGVtLXRpdGxle2ZvbnQtc2l6ZToxM3B4O2ZvbnQtd2VpZ2h0OjYwMDtjb2xvcjp2YXIoLS10ZXh0KTt3aGl0ZS1zcGFjZTpub3dyYXA7b3ZlcmZsb3c6aGlkZGVuO3RleHQtb3ZlcmZsb3c6ZWxsaXBzaXN9Ci5zZWxlY3RlZC1pdGVtLW1ldGF7Zm9udC1zaXplOjExcHg7Y29sb3I6dmFyKC0tbXV0ZWQpO2Rpc3BsYXk6ZmxleDtnYXA6OHB4O2FsaWduLWl0ZW1zOmNlbnRlcjttYXJnaW4tdG9wOjJweH0KLnNlbGVjdGVkLWl0ZW0tdmVyc2lvbntwYWRkaW5nOjJweCA2cHg7YmFja2dyb3VuZDp2YXIoLS1wYW5lbCk7Ym9yZGVyLXJhZGl1czo0cHg7Zm9udC1zaXplOjEwcHg7Y29sb3I6dmFyKC0tdGV4dC1zZWNvbmRhcnkpfQouc2VsZWN0ZWQtaXRlbS1zaXple2ZvbnQtc2l6ZToxM3B4O2ZvbnQtd2VpZ2h0OjYwMDtjb2xvcjp2YXIoLS10ZXh0KTt3aGl0ZS1zcGFjZTpub3dyYXB9Ci5zZWxlY3RlZC1pdGVtLWNoZWNre2NvbG9yOnZhcigtLXN1Y2Nlc3MpO2ZvbnQtc2l6ZToxNnB4fQouc2VsZWN0ZWQtaXRlbS1hY3Rpb25ze2Rpc3BsYXk6ZmxleDtnYXA6NHB4fQouc2VsZWN0ZWQtaXRlbS1hY3Rpb25zIGJ1dHRvbnt3aWR0aDoyOHB4O2hlaWdodDoyOHB4O2JvcmRlci1yYWRpdXM6NnB4O2JvcmRlcjpub25lO2N1cnNvcjpwb2ludGVyO2ZvbnQtc2l6ZToxMnB4O2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OmNlbnRlcn0KLnNlbGVjdGVkLWl0ZW0tYWN0aW9ucyAudXAsLnNlbGVjdGVkLWl0ZW0tYWN0aW9ucyAuZG93bntiYWNrZ3JvdW5kOnZhcigtLXBhbmVsKTtjb2xvcjp2YXIoLS10ZXh0KX0KLnNlbGVjdGVkLWl0ZW0tYWN0aW9ucyAucmVtb3Zle2JhY2tncm91bmQ6cmdiYSgyMzksNjgsNjgsMC4yKTtjb2xvcjp2YXIoLS1kYW5nZXIpfQoKLyogQm90dG9tIENUQSAqLwouYm90dG9tLWN0YXtwb3NpdGlvbjpmaXhlZDtib3R0b206MDtsZWZ0OjA7cmlnaHQ6MDtwYWRkaW5nOjEycHggMTZweDtiYWNrZ3JvdW5kOmxpbmVhci1ncmFkaWVudCgxODBkZWcsdHJhbnNwYXJlbnQgMCUsdmFyKC0tYmcpIDMwJSk7ei1pbmRleDo1MDtwb2ludGVyLWV2ZW50czpub25lfQouYm90dG9tLWN0YS1pbm5lcntkaXNwbGF5OmZsZXg7Z2FwOjEwcHg7bWF4LXdpZHRoOjUwMHB4O21hcmdpbjowIGF1dG87cG9pbnRlci1ldmVudHM6YXV0b30KLmN0YS1idXR0b257ZmxleDoxO2Rpc3BsYXk6ZmxleDtoZWlnaHQ6NTBweDtib3JkZXItcmFkaXVzOnZhcigtLXJhZGl1cyk7YmFja2dyb3VuZDp2YXIoLS1wcmltYXJ5KTtjb2xvcjojZmZmO2JvcmRlcjpub25lO2ZvbnQtc2l6ZToxNXB4O2ZvbnQtd2VpZ2h0OjYwMDtjdXJzb3I6cG9pbnRlcjthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OmNlbnRlcjtnYXA6NnB4O3RyYW5zaXRpb246YWxsIDAuMnM7Ym94LXNoYWRvdzowIDRweCAyMHB4IHJnYmEoNTksMTMwLDI0NiwwLjQpfQouY3RhLWJ1dHRvbjpob3ZlcntiYWNrZ3JvdW5kOnZhcigtLXByaW1hcnktaG92ZXIpO3RyYW5zZm9ybTp0cmFuc2xhdGVZKC0ycHgpO2JveC1zaGFkb3c6MCA2cHggMjVweCByZ2JhKDU5LDEzMCwyNDYsMC41KX0KLmN0YS1idXR0b246YWN0aXZle3RyYW5zZm9ybTp0cmFuc2xhdGVZKDApfQouY3RhLWJ1dHRvbiBzdmd7d2lkdGg6MThweDtoZWlnaHQ6MThweH0KLmN0YS1idXR0b24uZGlzYWJsZWR7b3BhY2l0eTowLjU7Y3Vyc29yOm5vdC1hbGxvd2VkO3BvaW50ZXItZXZlbnRzOm5vbmV9Ci5jdGEtc2hvd3t3aWR0aDo1MHB4O2ZsZXgtc2hyaW5rOjA7ZGlzcGxheTpmbGV4O2hlaWdodDo1MHB4O2JvcmRlci1yYWRpdXM6dmFyKC0tcmFkaXVzKTtiYWNrZ3JvdW5kOnZhcigtLXBhbmVsKTtjb2xvcjp2YXIoLS10ZXh0KTtib3JkZXI6MXB4IHNvbGlkIHZhcigtLWJvcmRlcik7Zm9udC1zaXplOjE0cHg7Zm9udC13ZWlnaHQ6NjAwO2N1cnNvcjpwb2ludGVyO2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO3RyYW5zaXRpb246YWxsIDAuMnM7cG9zaXRpb246cmVsYXRpdmV9Ci5jdGEtc2hvdzpob3ZlcntiYWNrZ3JvdW5kOnZhcigtLXBhbmVsLWhvdmVyKTtib3JkZXItY29sb3I6IzQ3NTU2OX0KLmN0YS1zaG93IC5iYWRnZXtwb3NpdGlvbjphYnNvbHV0ZTt0b3A6LTZweDtyaWdodDotNnB4O21pbi13aWR0aDoyMHB4O2hlaWdodDoyMHB4O2JvcmRlci1yYWRpdXM6MTBweDtiYWNrZ3JvdW5kOnZhcigtLWFjY2VudCk7Y29sb3I6IzAwMDtmb250LXNpemU6MTFweDtmb250LXdlaWdodDo3MDA7ZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyO3BhZGRpbmc6MCA1cHh9Ci5jdGEtYnV0dG9uLndhcm5pbmd7YmFja2dyb3VuZDp2YXIoLS1kYW5nZXIpO2JveC1zaGFkb3c6MCA0cHggMjBweCByZ2JhKDIzOSw2OCw2OCwwLjQpfQouY3RhLWJ1dHRvbi53YXJuaW5nOmhvdmVye2JhY2tncm91bmQ6I2RjMjYyNjtib3gtc2hhZG93OjAgNnB4IDI1cHggcmdiYSgyMzksNjgsNjgsMC41KX0KLmN0YS1idXR0b24gLndhcm5pbmctaWNvbntkaXNwbGF5Om5vbmV9Ci5jdGEtYnV0dG9uLndhcm5pbmcgLndhcm5pbmctaWNvbntkaXNwbGF5OmlubGluZX0KLmN0YS1idXR0b24ud2FybmluZyAudXBsb2FkLWljb257ZGlzcGxheTpub25lfQoKLyogQW5pbWF0aW9ucyAqLwpAa2V5ZnJhbWVzIGZhZGVJbntmcm9te29wYWNpdHk6MDt0cmFuc2Zvcm06dHJhbnNsYXRlWSgxMHB4KX10b3tvcGFjaXR5OjE7dHJhbnNmb3JtOnRyYW5zbGF0ZVkoMCl9fQouaXRlbXthbmltYXRpb246ZmFkZUluIDAuMnMgZWFzZS1vdXR9Ci5zZWxlY3RlZC1pdGVte2FuaW1hdGlvbjpmYWRlSW4gMC4xNXMgZWFzZS1vdXR9CgovKiBTdGF0dXMgKi8KLnN0YXR1c3tmb250LXNpemU6MTJweDtjb2xvcjp2YXIoLS1tdXRlZCk7cGFkZGluZzo4cHggMH0KCi8qIE92ZXJsYXkgKi8KLm92ZXJsYXl7cG9zaXRpb246Zml4ZWQ7aW5zZXQ6MDtiYWNrZ3JvdW5kOnJnYmEoMTAsMTQsMjYsMC45NSk7ZGlzcGxheTpub25lO2ZsZXgtZGlyZWN0aW9uOmNvbHVtbjt6LWluZGV4OjE1MDtiYWNrZHJvcC1maWx0ZXI6Ymx1cigxMHB4KX0KLm92ZXJsYXkgLmhlYWR7ZGlzcGxheTpmbGV4O2p1c3RpZnktY29udGVudDpzcGFjZS1iZXR3ZWVuO3BhZGRpbmc6MTZweDtiYWNrZ3JvdW5kOnZhcigtLXBhbmVsKTthbGlnbi1pdGVtczpjZW50ZXI7Ym9yZGVyLWJvdHRvbToxcHggc29saWQgdmFyKC0tYm9yZGVyKX0KLm92ZXJsYXkgLmhlYWQgc3Ryb25ne2NvbG9yOnZhcigtLXRleHQpfQoub3ZlcmxheSAuYm9keXtwYWRkaW5nOjE2cHg7b3ZlcmZsb3c6YXV0bztmbGV4OjE7cGFkZGluZy1ib3R0b206ODBweH0KLm92ZXJsYXkgLnJvd3tkaXNwbGF5OmZsZXg7Z2FwOjEycHg7YWxpZ24taXRlbXM6Y2VudGVyO3BhZGRpbmc6MTJweDtiYWNrZ3JvdW5kOnZhcigtLWNhcmQpO2JvcmRlci1yYWRpdXM6dmFyKC0tcmFkaXVzKTttYXJnaW4tYm90dG9tOjhweDtib3JkZXI6MXB4IHNvbGlkIHZhcigtLWJvcmRlcil9Ci5vdmVybGF5IC5yb3cuaGlnaGxpZ2h0e2JhY2tncm91bmQ6dmFyKC0tY2FyZC1zZWxlY3RlZCk7Ym9yZGVyLWNvbG9yOnZhcigtLXByaW1hcnkpfQoub3ZlcmxheSAucm93LWluZm97ZmxleDoxO21pbi13aWR0aDowfQoub3ZlcmxheSAucm93LWluZm8gc3Ryb25ne2Rpc3BsYXk6YmxvY2s7d2hpdGUtc3BhY2U6bm93cmFwO292ZXJmbG93OmhpZGRlbjt0ZXh0LW92ZXJmbG93OmVsbGlwc2lzfQoub3ZlcmxheSAucm93LWFjdGlvbnN7ZGlzcGxheTpmbGV4O2dhcDo2cHg7ZmxleC1zaHJpbms6MH0KLm92ZXJsYXkgYnV0dG9uLmljb257d2lkdGg6MzZweDtoZWlnaHQ6MzZweDtib3JkZXItcmFkaXVzOjhweDtib3JkZXI6bm9uZTtjdXJzb3I6cG9pbnRlcjtmb250LXdlaWdodDo2MDA7Zm9udC1zaXplOjE0cHg7ZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyfQoub3ZlcmxheSBidXR0b24udXAsLm92ZXJsYXkgYnV0dG9uLmRvd257YmFja2dyb3VuZDp2YXIoLS1wYW5lbCk7Y29sb3I6dmFyKC0tdGV4dCl9Ci5vdmVybGF5IGJ1dHRvbi51cDpob3Zlciwub3ZlcmxheSBidXR0b24uZG93bjpob3ZlcntiYWNrZ3JvdW5kOnZhcigtLXBhbmVsLWhvdmVyKX0KLm92ZXJsYXkgYnV0dG9uLnJlbW92ZXtiYWNrZ3JvdW5kOnZhcigtLWRhbmdlcik7Y29sb3I6I2ZmZn0KLm92ZXJsYXkgYnV0dG9uLnJlbW92ZTpob3ZlcntiYWNrZ3JvdW5kOiNkYzI2MjZ9CgovKiBNb2RhbCAqLwojZmlsZXNNb2RhbHtiYWNrZ3JvdW5kOnZhcigtLXBhbmVsKTtib3JkZXI6MXB4IHNvbGlkIHZhcigtLWJvcmRlcik7Y29sb3I6dmFyKC0tdGV4dCl9CgoubWV0YXtmb250LXNpemU6MTJweDtjb2xvcjp2YXIoLS1tdXRlZCl9Ci5zbWFsbHtmb250LXNpemU6MTNweDtjb2xvcjp2YXIoLS1tdXRlZCl9CgojdG90YWxzLmV4Y2VlZGVke2NvbG9yOnZhcigtLWRhbmdlcik7Zm9udC13ZWlnaHQ6Ym9sZH0KCi8qIEZpbGUgTGlzdCBDb250YWluZXIgKi8KI2ZpbGVMaXN0Q29udGFpbmVye2JhY2tncm91bmQ6dmFyKC0tY2FyZCk7Ym9yZGVyOjFweCBzb2xpZCB2YXIoLS1ib3JkZXIpO2JvcmRlci1yYWRpdXM6dmFyKC0tcmFkaXVzKTtjb2xvcjp2YXIoLS10ZXh0KX0KI2ZpbGVMaXN0Q29udGFpbmVyIGF7Y29sb3I6dmFyKC0tcHJpbWFyeSl9CgovKiBNb2JpbGUgUmVzcG9uc2l2ZSAqLwpAbWVkaWEgKG1heC13aWR0aDo5MDBweCl7CiAgLmNvbnRhaW5lcntncmlkLXRlbXBsYXRlLWNvbHVtbnM6MWZyO3BhZGRpbmctdG9wOmNhbGMoNzBweCArIDhweCk7cGFkZGluZy1ib3R0b206MTAwcHg7Z2FwOjEycHh9CiAgLnJpZ2h0UGFuZXtvcmRlcjotMTtwYWRkaW5nOjEycHg7Z2FwOjEycHh9CiAgLmhlYWRlcntwYWRkaW5nOjEwcHggMTJweH0KICAuaGVhZGVyIGJ1dHRvbiBzcGFue2Rpc3BsYXk6bm9uZX0KICAuc3RhdHMtZ3JpZHtncmlkLXRlbXBsYXRlLWNvbHVtbnM6cmVwZWF0KDMsMWZyKX0KICAuc3RhdC1jYXJke3BhZGRpbmc6MTBweH0KICAuc3RhdC12YWx1ZXtmb250LXNpemU6MThweH0KICAuc2VsZWN0ZWQtcGFuZWx7ZGlzcGxheTpub25lICFpbXBvcnRhbnR9CiAgLmZpbHRlci10YWJze292ZXJmbG93LXg6YXV0bztmbGV4LXdyYXA6bm93cmFwO3BhZGRpbmc6MTBweCAxMnB4Oy13ZWJraXQtb3ZlcmZsb3ctc2Nyb2xsaW5nOnRvdWNofQogIC5maWx0ZXItdGFiczo6LXdlYmtpdC1zY3JvbGxiYXJ7ZGlzcGxheTpub25lfQogIC5sZWZ0UGFuZXtib3JkZXItcmFkaXVzOnZhcigtLXJhZGl1cyl9CiAgLmxlZnRQYW5lLWlubmVye21heC1oZWlnaHQ6bm9uZTtwYWRkaW5nOjEwcHh9CiAgLnN0b3JhZ2UtY2FyZHtwYWRkaW5nOjEycHh9CiAgLnN0b3JhZ2UtbGVnZW5ke2ZsZXgtd3JhcDp3cmFwO2dhcDo4cHh9CiAgLmFjdGlvbi1yb3d7ZmxleC13cmFwOm5vd3JhcH0KICAuYWN0aW9uLXJvdyAuYnRue2ZvbnQtc2l6ZToxMnB4O3BhZGRpbmc6OHB4IDEwcHh9CiAgLnNoYXJlLXJvdyBpbnB1dHtmb250LXNpemU6MTJweH0KICAuYm90dG9tLWN0YXtwYWRkaW5nOjEycHh9CiAgLmN0YS1idXR0b257aGVpZ2h0OjUwcHg7Zm9udC1zaXplOjE1cHh9Cn0KCkBtZWRpYSAobWF4LXdpZHRoOjYwMHB4KXsKICAuaGVhZGVye2hlaWdodDo2MHB4O2dhcDo4cHh9CiAgLmhlYWRlciAuc2VhcmNoe2hlaWdodDozOHB4O2ZvbnQtc2l6ZToxNHB4fQogIC5oZWFkZXIgLmFjdGlvbnN7Z2FwOjRweH0KICAuaGVhZGVyIGJ1dHRvbntoZWlnaHQ6MzhweDtwYWRkaW5nOjAgMTBweDtmb250LXNpemU6MTJweH0KICAuaXRlbXtwYWRkaW5nOjEwcHg7Z2FwOjEwcHh9CiAgLml0ZW0tdGh1bWJ7d2lkdGg6NDhweDtoZWlnaHQ6NDhweH0KICAuaXRlbS10aXRsZXtmb250LXNpemU6MTNweH0KICAuaXRlbS1zaXple2ZvbnQtc2l6ZToxMnB4fQogIC5pdGVtLWNoZWNrYm94e3dpZHRoOjIycHg7aGVpZ2h0OjIycHh9CiAgLmZvcm1hdC1iYWRnZXtmb250LXNpemU6OHB4O3BhZGRpbmc6MXB4IDRweH0KICAuZmlsdGVyLXRhYntwYWRkaW5nOjZweCAxMnB4O2ZvbnQtc2l6ZToxMnB4fQogIC5jb250YWluZXJ7cGFkZGluZy10b3A6Y2FsYyg2MHB4ICsgOHB4KX0KICAuY29udHJvbHN7Z2FwOjZweH0KICAuY29udHJvbHMgaW5wdXQsLmNvbnRyb2xzIHNlbGVjdHtoZWlnaHQ6NDBweDtmb250LXNpemU6MTNweH0KICAuc3RhdC1jYXJke3BhZGRpbmc6OHB4fQogIC5zdGF0LXZhbHVle2ZvbnQtc2l6ZToxNnB4fQogIC5zdGF0LWxhYmVse2ZvbnQtc2l6ZTo5cHh9Cn0KCkBtZWRpYSAobWF4LXdpZHRoOjQwMHB4KXsKICAuaGVhZGVye3BhZGRpbmc6OHB4fQogIC5oZWFkZXIgYnV0dG9ue3BhZGRpbmc6MCA4cHh9CiAgLml0ZW0tdGh1bWJ7d2lkdGg6NDJweDtoZWlnaHQ6NDJweH0KICAuc3RhdHMtZ3JpZHtnYXA6NnB4fQp9CgouY29uZmlnLXNlY3Rpb257dHJhbnNpdGlvbjphbGwgMC4yNXMgZWFzZX0KLm1vYmlsZS1vbmx5e2Rpc3BsYXk6bm9uZX0KQG1lZGlhIChtYXgtd2lkdGg6OTAwcHgpewogIC5tb2JpbGUtb25seXtkaXNwbGF5OmJsb2NrfQogIC5jb25maWctc2VjdGlvbntkaXNwbGF5Om5vbmV9CiAgLmNvbmZpZy1zZWN0aW9uLmFjdGl2ZXtkaXNwbGF5OmJsb2NrfQp9CgovKiBGaWxlIGJ1dHRvbiBpbiBpdGVtcyAqLwouZmlsZS1idG57YmFja2dyb3VuZDp2YXIoLS1wYW5lbCkgIWltcG9ydGFudDtjb2xvcjp2YXIoLS10ZXh0KSAhaW1wb3J0YW50O2JvcmRlcjoxcHggc29saWQgdmFyKC0tYm9yZGVyKSAhaW1wb3J0YW50fQoKLyogTG9uZyBwcmVzcyB2aXN1YWwgZmVlZGJhY2sgKi8KLml0ZW0ubG9uZy1wcmVzcy1hY3RpdmV7YmFja2dyb3VuZDp2YXIoLS1wcmltYXJ5KSAhaW1wb3J0YW50O3RyYW5zZm9ybTpzY2FsZSgwLjk4KX0KLml0ZW17dXNlci1zZWxlY3Q6bm9uZTstd2Via2l0LXVzZXItc2VsZWN0Om5vbmV9CgovKiBJY29uIGltYWdlIGluIHRodW1ibmFpbCAqLwouaXRlbS10aHVtYiBpbWd7d2lkdGg6MTAwJTtoZWlnaHQ6MTAwJTtvYmplY3QtZml0OmNvdmVyO2JvcmRlci1yYWRpdXM6NnB4fQoKLyogR2FtZSBJbmZvIE1vZGFsICovCiNnYW1lSW5mb01vZGFse2Rpc3BsYXk6bm9uZTtwb3NpdGlvbjpmaXhlZDtpbnNldDowO2JhY2tncm91bmQ6cmdiYSgxMCwxNCwyNiwwLjk1KTt6LWluZGV4OjIwMDtvdmVyZmxvdy15OmF1dG87YmFja2Ryb3AtZmlsdGVyOmJsdXIoMTBweCl9Ci5nYW1lLWluZm97bWF4LXdpZHRoOjYwMHB4O21hcmdpbjowIGF1dG87cGFkZGluZzoxNnB4O3BhZGRpbmctYm90dG9tOjEwMHB4fQouZ2FtZS1pbmZvLWhlYWRlcntwb3NpdGlvbjpyZWxhdGl2ZTttYXJnaW4tYm90dG9tOjE2cHh9Ci5nYW1lLWluZm8tYmFubmVye3dpZHRoOjEwMCU7aGVpZ2h0OjIwMHB4O29iamVjdC1maXQ6Y292ZXI7Ym9yZGVyLXJhZGl1czp2YXIoLS1yYWRpdXMtbGcpO2JhY2tncm91bmQ6dmFyKC0tcGFuZWwpfQouZ2FtZS1pbmZvLWljb257cG9zaXRpb246YWJzb2x1dGU7Ym90dG9tOi0zMHB4O2xlZnQ6MTZweDt3aWR0aDo4MHB4O2hlaWdodDo4MHB4O2JvcmRlci1yYWRpdXM6dmFyKC0tcmFkaXVzKTtib3JkZXI6M3B4IHNvbGlkIHZhcigtLWJnKTtib3gtc2hhZG93OjAgNHB4IDEycHggcmdiYSgwLDAsMCwwLjMpfQouZ2FtZS1pbmZvLWNsb3Nle3Bvc2l0aW9uOmFic29sdXRlO3RvcDoxMnB4O3JpZ2h0OjEycHg7d2lkdGg6MzZweDtoZWlnaHQ6MzZweDtib3JkZXItcmFkaXVzOjUwJTtiYWNrZ3JvdW5kOnJnYmEoMCwwLDAsMC42KTtib3JkZXI6bm9uZTtjb2xvcjojZmZmO2ZvbnQtc2l6ZToyMHB4O2N1cnNvcjpwb2ludGVyO2Rpc3BsYXk6ZmxleDthbGlnbi1pdGVtczpjZW50ZXI7anVzdGlmeS1jb250ZW50OmNlbnRlcn0KLmdhbWUtaW5mby10aXRsZXtmb250LXNpemU6MjBweDtmb250LXdlaWdodDo3MDA7Y29sb3I6dmFyKC0tdGV4dCk7bWFyZ2luLXRvcDo0MHB4O21hcmdpbi1ib3R0b206NHB4fQouZ2FtZS1pbmZvLXB1Ymxpc2hlcntmb250LXNpemU6MTRweDtjb2xvcjp2YXIoLS1tdXRlZCk7bWFyZ2luLWJvdHRvbToxMnB4fQouZ2FtZS1pbmZvLW1ldGF7ZGlzcGxheTpmbGV4O2ZsZXgtd3JhcDp3cmFwO2dhcDo4cHg7bWFyZ2luLWJvdHRvbToxNnB4fQouZ2FtZS1pbmZvLXRhZ3twYWRkaW5nOjRweCAxMHB4O2JhY2tncm91bmQ6dmFyKC0tcGFuZWwpO2JvcmRlci1yYWRpdXM6MjBweDtmb250LXNpemU6MTJweDtjb2xvcjp2YXIoLS10ZXh0LXNlY29uZGFyeSk7Ym9yZGVyOjFweCBzb2xpZCB2YXIoLS1ib3JkZXIpfQouZ2FtZS1pbmZvLXRhZy5nZW5yZXtiYWNrZ3JvdW5kOnZhcigtLXByaW1hcnkpO2NvbG9yOiNmZmY7Ym9yZGVyLWNvbG9yOnZhcigtLXByaW1hcnkpfQouZ2FtZS1pbmZvLXNlY3Rpb257YmFja2dyb3VuZDp2YXIoLS1wYW5lbCk7Ym9yZGVyLXJhZGl1czp2YXIoLS1yYWRpdXMpO3BhZGRpbmc6MTZweDttYXJnaW4tYm90dG9tOjEycHg7Ym9yZGVyOjFweCBzb2xpZCB2YXIoLS1ib3JkZXIpfQouZ2FtZS1pbmZvLXNlY3Rpb24tdGl0bGV7Zm9udC1zaXplOjEycHg7Zm9udC13ZWlnaHQ6NjAwO3RleHQtdHJhbnNmb3JtOnVwcGVyY2FzZTtsZXR0ZXItc3BhY2luZzowLjVweDtjb2xvcjp2YXIoLS1tdXRlZCk7bWFyZ2luLWJvdHRvbTo4cHh9Ci5nYW1lLWluZm8tZGVzY3JpcHRpb257Zm9udC1zaXplOjE0cHg7bGluZS1oZWlnaHQ6MS42O2NvbG9yOnZhcigtLXRleHQtc2Vjb25kYXJ5KTt3aGl0ZS1zcGFjZTpwcmUtbGluZX0KLmdhbWUtaW5mby1pbnRyb3tmb250LXNpemU6MTVweDtmb250LXdlaWdodDo1MDA7Y29sb3I6dmFyKC0tdGV4dCk7bWFyZ2luLWJvdHRvbTo4cHg7Zm9udC1zdHlsZTppdGFsaWN9Ci5nYW1lLWluZm8tc2NyZWVuc2hvdHN7ZGlzcGxheTpncmlkO2dyaWQtdGVtcGxhdGUtY29sdW1uczpyZXBlYXQoMiwxZnIpO2dhcDo4cHh9Ci5nYW1lLWluZm8tc2NyZWVuc2hvdHMgaW1ne3dpZHRoOjEwMCU7Ym9yZGVyLXJhZGl1czo4cHg7Y3Vyc29yOnBvaW50ZXI7dHJhbnNpdGlvbjp0cmFuc2Zvcm0gMC4yc30KLmdhbWUtaW5mby1zY3JlZW5zaG90cyBpbWc6aG92ZXJ7dHJhbnNmb3JtOnNjYWxlKDEuMDIpfQouZ2FtZS1pbmZvLWZpbGVzLXNlY3Rpb257cGFkZGluZzowO292ZXJmbG93OmhpZGRlbn0KLmdhbWUtaW5mby1maWxlcy1idG57d2lkdGg6MTAwJTtwYWRkaW5nOjE0cHggMTZweDtiYWNrZ3JvdW5kOnRyYW5zcGFyZW50O2JvcmRlcjpub25lO2NvbG9yOnZhcigtLXRleHQpO2ZvbnQtc2l6ZToxNHB4O2ZvbnQtd2VpZ2h0OjUwMDtjdXJzb3I6cG9pbnRlcjtkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2p1c3RpZnktY29udGVudDpzcGFjZS1iZXR3ZWVufQouZ2FtZS1pbmZvLWZpbGVzLWJ0bjpob3ZlcntiYWNrZ3JvdW5kOnZhcigtLXBhbmVsLWhvdmVyKX0KLmdhbWUtaW5mby1maWxlcy1idG4gLmNoZXZyb257dHJhbnNpdGlvbjp0cmFuc2Zvcm0gMC4yc30KLmdhbWUtaW5mby1maWxlcy1idG4ub3BlbiAuY2hldnJvbnt0cmFuc2Zvcm06cm90YXRlKDE4MGRlZyl9Ci5nYW1lLWluZm8tZmlsZXN7ZGlzcGxheTpmbGV4O2ZsZXgtZGlyZWN0aW9uOmNvbHVtbjtnYXA6NHB4O21heC1oZWlnaHQ6MjAwcHg7b3ZlcmZsb3cteTphdXRvO3BhZGRpbmc6MCAxNnB4IDE2cHh9Ci5nYW1lLWluZm8tZmlsZXtwYWRkaW5nOjhweCAxMnB4O2JhY2tncm91bmQ6dmFyKC0tYmcpO2JvcmRlci1yYWRpdXM6NnB4O2ZvbnQtc2l6ZToxMnB4O2ZvbnQtZmFtaWx5OidTRiBNb25vJyxNb25hY28sQ29uc29sYXMsbW9ub3NwYWNlO2NvbG9yOnZhcigtLXRleHQtc2Vjb25kYXJ5KTt3b3JkLWJyZWFrOmJyZWFrLWFsbH0KLmdhbWUtaW5mby1hY3Rpb25ze3Bvc2l0aW9uOmZpeGVkO2JvdHRvbTowO2xlZnQ6MDtyaWdodDowO3BhZGRpbmc6MTZweDtiYWNrZ3JvdW5kOmxpbmVhci1ncmFkaWVudCh0cmFuc3BhcmVudCx2YXIoLS1iZykpO2Rpc3BsYXk6ZmxleDtnYXA6OHB4O2p1c3RpZnktY29udGVudDpjZW50ZXJ9Ci5nYW1lLWluZm8tYWN0aW9ucyAuYnRue21pbi13aWR0aDoxNDBweH0KCi8qIEdlbnJlIEZpbHRlciAqLwouZ2VucmUtZmlsdGVye2Rpc3BsYXk6ZmxleDtnYXA6OHB4O3BhZGRpbmc6MTJweDtiYWNrZ3JvdW5kOnZhcigtLWJnLXNlY29uZGFyeSk7b3ZlcmZsb3cteDphdXRvOy13ZWJraXQtb3ZlcmZsb3ctc2Nyb2xsaW5nOnRvdWNofQouZ2VucmUtZmlsdGVyOjotd2Via2l0LXNjcm9sbGJhcntkaXNwbGF5Om5vbmV9Ci5nZW5yZS1jaGlwe3BhZGRpbmc6NnB4IDE0cHg7Ym9yZGVyLXJhZGl1czoyMHB4O2JvcmRlcjoxcHggc29saWQgdmFyKC0tYm9yZGVyKTtiYWNrZ3JvdW5kOnRyYW5zcGFyZW50O2NvbG9yOnZhcigtLXRleHQtc2Vjb25kYXJ5KTtmb250LXNpemU6MTNweDtmb250LXdlaWdodDo1MDA7Y3Vyc29yOnBvaW50ZXI7dHJhbnNpdGlvbjphbGwgMC4yczt3aGl0ZS1zcGFjZTpub3dyYXA7ZmxleC1zaHJpbms6MH0KLmdlbnJlLWNoaXA6aG92ZXJ7YmFja2dyb3VuZDp2YXIoLS1wYW5lbCk7Y29sb3I6dmFyKC0tdGV4dCl9Ci5nZW5yZS1jaGlwLmFjdGl2ZXtiYWNrZ3JvdW5kOnZhcigtLXByaW1hcnkpO2JvcmRlci1jb2xvcjp2YXIoLS1wcmltYXJ5KTtjb2xvcjojZmZmfQouZ2VucmUtZmlsdGVyIC5kaXZpZGVye3dpZHRoOjFweDtiYWNrZ3JvdW5kOnZhcigtLWJvcmRlcik7bWFyZ2luOjAgNHB4O2ZsZXgtc2hyaW5rOjB9Ci5zb3J0LWNoaXB7cGFkZGluZzo2cHggMTRweDtib3JkZXItcmFkaXVzOjIwcHg7Ym9yZGVyOjFweCBzb2xpZCB2YXIoLS1hY2NlbnQpO2JhY2tncm91bmQ6dHJhbnNwYXJlbnQ7Y29sb3I6dmFyKC0tYWNjZW50KTtmb250LXNpemU6MTNweDtmb250LXdlaWdodDo1MDA7Y3Vyc29yOnBvaW50ZXI7dHJhbnNpdGlvbjphbGwgMC4yczt3aGl0ZS1zcGFjZTpub3dyYXA7ZmxleC1zaHJpbms6MH0KLnNvcnQtY2hpcDpob3ZlcntiYWNrZ3JvdW5kOnZhcigtLWFjY2VudCk7Y29sb3I6IzAwMH0KLnNvcnQtY2hpcC5hY3RpdmV7YmFja2dyb3VuZDp2YXIoLS1hY2NlbnQpO2NvbG9yOiMwMDB9CgovKiBTY3JlZW5zaG90IGZ1bGxzY3JlZW4gKi8KLnNjcmVlbnNob3QtZnVsbHNjcmVlbntkaXNwbGF5Om5vbmU7cG9zaXRpb246Zml4ZWQ7aW5zZXQ6MDtiYWNrZ3JvdW5kOnJnYmEoMCwwLDAsMC45NSk7ei1pbmRleDoyNTA7YWxpZ24taXRlbXM6Y2VudGVyO2p1c3RpZnktY29udGVudDpjZW50ZXI7Y3Vyc29yOnBvaW50ZXI7ZmxleC1kaXJlY3Rpb246Y29sdW1uO2dhcDoxNnB4fQouc2NyZWVuc2hvdC1mdWxsc2NyZWVuLmFjdGl2ZXtkaXNwbGF5OmZsZXh9Ci5zY3JlZW5zaG90LWZ1bGxzY3JlZW4gaW1ne21heC13aWR0aDo5NSU7bWF4LWhlaWdodDo4NSU7b2JqZWN0LWZpdDpjb250YWluO2JvcmRlci1yYWRpdXM6OHB4fQouc2NyZWVuc2hvdC1mdWxsc2NyZWVuIC5jbG9zZS1oaW50e2NvbG9yOnJnYmEoMjU1LDI1NSwyNTUsMC42KTtmb250LXNpemU6MTRweDtwYWRkaW5nOjhweCAxNnB4O2JhY2tncm91bmQ6cmdiYSgwLDAsMCwwLjUpO2JvcmRlci1yYWRpdXM6MjBweH0KCi8qIFRvYXN0IG5vdGlmaWNhdGlvbiAqLwoudG9hc3R7cG9zaXRpb246Zml4ZWQ7dG9wOjUwJTtsZWZ0OjUwJTt0cmFuc2Zvcm06dHJhbnNsYXRlKC01MCUsLTUwJSkgc2NhbGUoMC44KTtiYWNrZ3JvdW5kOnZhcigtLXN1Y2Nlc3MpO2NvbG9yOiNmZmY7cGFkZGluZzoyNHB4IDQ4cHg7Ym9yZGVyLXJhZGl1czp2YXIoLS1yYWRpdXMtbGcpO2ZvbnQtc2l6ZToyMHB4O2ZvbnQtd2VpZ2h0OjYwMDt6LWluZGV4OjMwMDtvcGFjaXR5OjA7dHJhbnNpdGlvbjphbGwgMC4zcztwb2ludGVyLWV2ZW50czpub25lO2JveC1zaGFkb3c6MCAxMHB4IDQwcHggcmdiYSgwLDAsMCwwLjQpfQoudG9hc3Quc2hvd3tvcGFjaXR5OjE7dHJhbnNmb3JtOnRyYW5zbGF0ZSgtNTAlLC01MCUpIHNjYWxlKDEpfQo8L3N0eWxlPgo8L2hlYWQ+Cjxib2R5PgogIDxkaXYgY2xhc3M9ImhlYWRlciI+CiAgICA8aW5wdXQgaWQ9InNlYXJjaCIgY2xhc3M9InNlYXJjaCIgdHlwZT0idGV4dCIgcGxhY2Vob2xkZXI9IlNlYXJjaCBnYW1lcy4uLiI+CiAgICA8ZGl2IGNsYXNzPSJhY3Rpb25zIj4KICAgICAgPGJ1dHRvbiBpZD0iY2xlYXJTZWFyY2giPjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSJjdXJyZW50Q29sb3IiIHN0cm9rZS13aWR0aD0iMi41IiBzdHJva2UtbGluZWNhcD0icm91bmQiPjxsaW5lIHgxPSIxOCIgeTE9IjYiIHgyPSI2IiB5Mj0iMTgiLz48bGluZSB4MT0iNiIgeTE9IjYiIHgyPSIxOCIgeTI9IjE4Ii8+PC9zdmc+PC9idXR0b24+CiAgICA8L2Rpdj4KICA8L2Rpdj4KCiAgPGRpdiBjbGFzcz0iY29udGFpbmVyIj4KICAgIDxzZWN0aW9uIGNsYXNzPSJsZWZ0UGFuZSIgaWQ9ImxlZnRQYW5lIiBhcmlhLWxhYmVsPSJHYW1lIGxpc3QiPgogICAgICA8ZGl2IGNsYXNzPSJnZW5yZS1maWx0ZXIiIGlkPSJnZW5yZUZpbHRlciI+PC9kaXY+CiAgICAgIDxkaXYgY2xhc3M9ImxlZnRQYW5lLWlubmVyIiBpZD0ibGVmdFBhbmVJbm5lciI+PC9kaXY+CiAgICA8L3NlY3Rpb24+CgogICAgPGFzaWRlIGNsYXNzPSJyaWdodFBhbmUiPgogICAgICA8YnV0dG9uIGlkPSJ0b2dnbGVDb25maWciIGNsYXNzPSJidG4gZ2hvc3QgbW9iaWxlLW9ubHkiPkhpZGUgQ29uZmlndXJhdGlvbjwvYnV0dG9uPgoKICAgICAgPGRpdiBpZD0iY29uZmlnU2VjdGlvbiIgY2xhc3M9ImNvbmZpZy1zZWN0aW9uIj4KICAgICAgICA8IS0tIFN0b3JhZ2UgQ2FyZCAtLT4KICAgICAgICA8ZGl2IGNsYXNzPSJzdG9yYWdlLWNhcmQiPgogICAgICAgICAgPGRpdiBjbGFzcz0ic3RvcmFnZS1oZWFkZXIiPgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJzdG9yYWdlLXRpdGxlIj4KICAgICAgICAgICAgICA8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgZmlsbD0ibm9uZSIgdmlld0JveD0iMCAwIDI0IDI0IiBzdHJva2U9ImN1cnJlbnRDb2xvciI+PHBhdGggc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiIGQ9Ik0xOSAxMUg1bTE0IDBhMiAyIDAgMDEyIDJ2NmEyIDIgMCAwMS0yIDJINWEyIDIgMCAwMS0yLTJ2LTZhMiAyIDAgMDEyLTJtMTQgMFY5YTIgMiAwIDAwLTItMk01IDExVjlhMiAyIDAgMDEyLTJtMCAwVjVhMiAyIDAgMDEyLTJoNmEyIDIgMCAwMTIgMnYyTTcgN2gxMCIvPjwvc3ZnPgogICAgICAgICAgICAgIFNEIENhcmQgU3RvcmFnZQogICAgICAgICAgICA8L2Rpdj4KICAgICAgICAgICAgPGRpdiBjbGFzcz0ic3RvcmFnZS1jYXBhY2l0eSI+PHNwYW4gaWQ9InNwYWNlIj4wPC9zcGFuPkdCIENhcGFjaXR5PC9kaXY+CiAgICAgICAgICA8L2Rpdj4KICAgICAgICAgIDxkaXYgY2xhc3M9InN0b3JhZ2UtcHJvZ3Jlc3MiPgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJwcm9ncmVzcy11c2VkIiBpZD0icHJvZ3Jlc3NVc2VkIiBzdHlsZT0id2lkdGg6MCUiPjwvZGl2PgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJwcm9ncmVzcy1zZWxlY3RlZCIgaWQ9InByb2dyZXNzU2VsZWN0ZWQiIHN0eWxlPSJ3aWR0aDowJSI+PC9kaXY+CiAgICAgICAgICA8L2Rpdj4KICAgICAgICAgIDxkaXYgY2xhc3M9InN0b3JhZ2UtbGVnZW5kIj4KICAgICAgICAgICAgPGRpdiBjbGFzcz0ibGVnZW5kLWl0ZW0iPjxkaXYgY2xhc3M9ImxlZ2VuZC1kb3QgdXNlZCI+PC9kaXY+VXNlZDogPHNwYW4gaWQ9InVzZWRTcGFjZSI+MDwvc3Bhbj4gR0I8L2Rpdj4KICAgICAgICAgICAgPGRpdiBjbGFzcz0ibGVnZW5kLWl0ZW0iPjxkaXYgY2xhc3M9ImxlZ2VuZC1kb3Qgc2VsZWN0ZWQiPjwvZGl2PlNlbGVjdGVkOiA8c3BhbiBpZD0ic2VsZWN0ZWRTaXplIj4wLjAwPC9zcGFuPiBHQjwvZGl2PgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJsZWdlbmQtaXRlbSI+PGRpdiBjbGFzcz0ibGVnZW5kLWRvdCBmcmVlIj48L2Rpdj5GcmVlOiA8c3BhbiBpZD0iZnJlZVNwYWNlIj4wPC9zcGFuPiBHQjwvZGl2PgogICAgICAgICAgPC9kaXY+CiAgICAgICAgPC9kaXY+CgogICAgICAgIDwhLS0gU3RhdHMgR3JpZCAtLT4KICAgICAgICA8ZGl2IGNsYXNzPSJzdGF0cy1ncmlkIj4KICAgICAgICAgIDxkaXYgY2xhc3M9InN0YXQtY2FyZCI+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9InN0YXQtdmFsdWUiIGlkPSJjb3VudCI+MDwvZGl2PgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJzdGF0LWxhYmVsIj5UaXRsZXM8L2Rpdj4KICAgICAgICAgIDwvZGl2PgogICAgICAgICAgPGRpdiBjbGFzcz0ic3RhdC1jYXJkIGhpZ2hsaWdodCI+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9InN0YXQtdmFsdWUiPjxzcGFuIGlkPSJzZWxlY3RlZFNpemVEaXNwbGF5Ij4wLjA8L3NwYW4+PHNtYWxsIHN0eWxlPSJmb250LXNpemU6MTRweCI+R0I8L3NtYWxsPjwvZGl2PgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJzdGF0LWxhYmVsIj5Ub3RhbCBTaXplPC9kaXY+CiAgICAgICAgICA8L2Rpdj4KICAgICAgICAgIDxkaXYgY2xhc3M9InN0YXQtY2FyZCI+CiAgICAgICAgICAgIDxkaXYgY2xhc3M9InN0YXQtdmFsdWUiIGlkPSJpbnN0YWxsRXN0aW1hdGUiPn4wbTwvZGl2PgogICAgICAgICAgICA8ZGl2IGNsYXNzPSJzdGF0LWxhYmVsIj5Fc3QuIFRpbWU8L2Rpdj4KICAgICAgICAgIDwvZGl2PgogICAgICAgIDwvZGl2PgogICAgICAgIDxkaXYgY2xhc3M9InN0YXQtbm90ZSI+CiAgICAgICAgICA8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjE0IiBoZWlnaHQ9IjE0IiBmaWxsPSJub25lIiB2aWV3Qm94PSIwIDAgMjQgMjQiIHN0cm9rZT0iY3VycmVudENvbG9yIj48Y2lyY2xlIGN4PSIxMiIgY3k9IjEyIiByPSIxMCIgc3Ryb2tlLXdpZHRoPSIyIi8+PHBhdGggc3Ryb2tlLXdpZHRoPSIyIiBkPSJNMTIgMTZ2LTRtMC00aC4wMSIvPjwvc3ZnPgogICAgICAgICAgRXN0LiBiYXNlZCBvbiAxNE1CL3MgdHJhbnNmZXIgcmF0ZQogICAgICAgIDwvZGl2PgoKICAgICAgICA8IS0tIENvbnRyb2xzIC0tPgogICAgICAgIDxkaXYgY2xhc3M9ImNvbnRyb2xzIj4KICAgICAgICAgIDxkaXYgY2xhc3M9ImZ1bGwiPgogICAgICAgICAgICA8bGFiZWw+Q3VzdG9tZXIgTmFtZTwvbGFiZWw+CiAgICAgICAgICAgIDxpbnB1dCBpZD0iY3VzdG9tZXIiIHR5cGU9InRleHQiIHBsYWNlaG9sZGVyPSJFbnRlciBuYW1lICh1c2UgdW5kZXJzY29yZXMpIj4KICAgICAgICAgIDwvZGl2PgogICAgICAgICAgPGRpdiBjbGFzcz0iZmlsZW5hbWUtcHJldmlldyIgaWQ9ImZpbGVuYW1lUHJldmlldyI+RmlsZW5hbWUgcHJldmlldyB3aWxsIGFwcGVhciBoZXJl4oCmPC9kaXY+CiAgICAgICAgICA8ZGl2IGlkPSJkeW5hbWljQ29udHJvbHMiPjwvZGl2PgogICAgICAgIDwvZGl2PgogICAgICA8L2Rpdj4KCiAgICAgIDwhLS0gU2hhcmUgUm93IC0tPgogICAgICA8ZGl2IGNsYXNzPSJzaGFyZS1yb3ciPgogICAgICAgIDxpbnB1dCBpZD0ic2hhcmVhYmxlIiB0eXBlPSJ0ZXh0IiBwbGFjZWhvbGRlcj0iVXBsb2FkIGxpbmsgd2lsbCBhcHBlYXIgaGVyZS4uLiIgcmVhZG9ubHk+CiAgICAgICAgPGJ1dHRvbiBpZD0iY29weUxpbmsiIGNsYXNzPSJidG4gYnRuLXByaW1hcnkiPkNvcHk8L2J1dHRvbj4KICAgICAgPC9kaXY+CgogICAgICA8IS0tIEFjdGlvbiBCdXR0b25zIC0tPgogICAgICA8ZGl2IGNsYXNzPSJhY3Rpb24tcm93Ij4KICAgICAgICA8YnV0dG9uIGlkPSJzYXZlQnRuIiBjbGFzcz0iYnRuIGdob3N0Ij5TYXZlPC9idXR0b24+CiAgICAgICAgPGxhYmVsIGZvcj0iZmlsZUluIiBjbGFzcz0iYnRuIGdob3N0IiBzdHlsZT0iY3Vyc29yOnBvaW50ZXIiPk9wZW48L2xhYmVsPgogICAgICAgIDxpbnB1dCBpZD0iZmlsZUluIiB0eXBlPSJmaWxlIiBzdHlsZT0iZGlzcGxheTpub25lOyI+CiAgICAgIDwvZGl2PgoKICAgICAgPGRpdiBjbGFzcz0iYWN0aW9uLXJvdyI+CiAgICAgICAgPGJ1dHRvbiBpZD0iYWRtaW5FeHBvcnQiIGNsYXNzPSJidG4gZ2hvc3QiPkV4cG9ydCBBZG1pbjwvYnV0dG9uPgogICAgICAgIDxidXR0b24gaWQ9Im1hdGNoTGlzdCIgY2xhc3M9ImJ0biBnaG9zdCI+TWF0Y2ggTGlzdDwvYnV0dG9uPgogICAgICAgIDxidXR0b24gaWQ9ImJpbkxpc3QiIGNsYXNzPSJidG4gZ2hvc3QiPlVwbG9hZHM8L2J1dHRvbj4KICAgICAgPC9kaXY+CgogICAgICA8ZGl2IGlkPSJmaWxlTGlzdENvbnRhaW5lciIgc3R5bGU9ImRpc3BsYXk6bm9uZTsiPgogICAgICAgIDxkaXYgaWQ9ImJpbkZpbGVMaXN0Ij48L2Rpdj4KICAgICAgPC9kaXY+CgogICAgICA8ZGl2IGNsYXNzPSJzdGF0dXMiIGlkPSJzdGF0dXMiPlJlYWR5PC9kaXY+CgogICAgICA8IS0tIFNlbGVjdGVkIFBhbmVsIC0tPgogICAgICA8ZGl2IGlkPSJzZWxlY3RlZFBhbmVsIiBjbGFzcz0ic2VsZWN0ZWQtcGFuZWwiPgogICAgICAgIDxkaXYgY2xhc3M9ImhlYWQiPgogICAgICAgICAgPHNwYW4+U2VsZWN0ZWQgU29mdHdhcmU8L3NwYW4+CiAgICAgICAgICA8c3BhbiBpZD0ic2VsZWN0ZWRQYW5lbENvdW50Ij4wIGl0ZW1zPC9zcGFuPgogICAgICAgIDwvZGl2PgogICAgICAgIDxkaXYgY2xhc3M9ImJvZHkiIGlkPSJzZWxlY3RlZFBhbmVsQm9keSI+PC9kaXY+CiAgICAgIDwvZGl2PgogICAgPC9hc2lkZT4KICA8L2Rpdj4KCiAgPCEtLSBCb3R0b20gQ1RBIEJ1dHRvbiAtLT4KICA8ZGl2IGNsYXNzPSJib3R0b20tY3RhIiBpZD0iYm90dG9tQ3RhIj4KICAgIDxkaXYgY2xhc3M9ImJvdHRvbS1jdGEtaW5uZXIiPgogICAgICA8YnV0dG9uIGNsYXNzPSJjdGEtc2hvdyIgaWQ9ImN0YVNob3ciPgogICAgICAgIDxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIGZpbGw9Im5vbmUiIHZpZXdCb3g9IjAgMCAyNCAyNCIgc3Ryb2tlPSJjdXJyZW50Q29sb3IiPjxwYXRoIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLXdpZHRoPSIyIiBkPSJNNCA2aDE2TTQgMTBoMTZNNCAxNGgxNk00IDE4aDE2Ii8+PC9zdmc+CiAgICAgICAgPHNwYW4gY2xhc3M9ImJhZGdlIiBpZD0iY3RhQmFkZ2UiPjA8L3NwYW4+CiAgICAgIDwvYnV0dG9uPgogICAgICA8YnV0dG9uIGNsYXNzPSJjdGEtYnV0dG9uIiBpZD0iY3RhVXBsb2FkIj4KICAgICAgICA8c3BhbiBjbGFzcz0id2FybmluZy1pY29uIj7imqDvuI88L3NwYW4+CiAgICAgICAgPHN2ZyBjbGFzcz0idXBsb2FkLWljb24iIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgZmlsbD0ibm9uZSIgdmlld0JveD0iMCAwIDI0IDI0IiBzdHJva2U9ImN1cnJlbnRDb2xvciI+PHBhdGggc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2Utd2lkdGg9IjIiIGQ9Ik03IDE2YTQgNCAwIDAxLS44OC03LjkwM0E1IDUgMCAxMTE1LjkgNkwxNiA2YTUgNSAwIDAxMSA5LjlNMTUgMTNsLTMtM20wIDBsLTMgM20zLTN2MTIiLz48L3N2Zz4KICAgICAgICA8c3BhbiBpZD0iY3RhVGV4dCI+VXBsb2FkPC9zcGFuPgogICAgICA8L2J1dHRvbj4KICAgIDwvZGl2PgogIDwvZGl2PgoKICA8ZGl2IGNsYXNzPSJvdmVybGF5IiBpZD0ib3ZlcmxheSI+CiAgICA8ZGl2IGNsYXNzPSJoZWFkIj48ZGl2PjxzdHJvbmc+U2VsZWN0ZWQgVGl0bGVzPC9zdHJvbmc+IC0gPHNwYW4gaWQ9Im92ZXJsYXlDb3VudCI+MDwvc3Bhbj48L2Rpdj48ZGl2PjxidXR0b24gaWQ9ImNsb3NlT3ZlcmxheSIgY2xhc3M9ImJ0biBnaG9zdCI+Q2xvc2U8L2J1dHRvbj48L2Rpdj48L2Rpdj4KICAgIDxkaXYgY2xhc3M9ImJvZHkiIGlkPSJvdmVybGF5Qm9keSI+PC9kaXY+CiAgPC9kaXY+CjxkaXYgaWQ9ImZpbGVzTW9kYWwiIHN0eWxlPSJkaXNwbGF5Om5vbmU7cG9zaXRpb246Zml4ZWQ7dG9wOjUwJTtsZWZ0OjUwJTt0cmFuc2Zvcm06dHJhbnNsYXRlKC01MCUsLTUwJSk7CiAgYmFja2dyb3VuZDp2YXIoLS1wYW5lbCk7cGFkZGluZzoyMHB4O2JvcmRlci1yYWRpdXM6dmFyKC0tcmFkaXVzLWxnKTtib3gtc2hhZG93OjAgMjBweCA1MHB4IHJnYmEoMCwwLDAsMC41KTt6LWluZGV4OjIwMDsKICBtYXgtd2lkdGg6NTAwcHg7d2lkdGg6OTAlO21heC1oZWlnaHQ6NzB2aDtvdmVyZmxvdzphdXRvO2ZvbnQtc2l6ZToxM3B4O2JvcmRlcjoxcHggc29saWQgdmFyKC0tYm9yZGVyKTtjb2xvcjp2YXIoLS10ZXh0KSI+CjwvZGl2PgoKPCEtLSBHYW1lIEluZm8gTW9kYWwgLS0+CjxkaXYgaWQ9ImdhbWVJbmZvTW9kYWwiPgogIDxkaXYgY2xhc3M9ImdhbWUtaW5mbyIgaWQ9ImdhbWVJbmZvQ29udGVudCI+PC9kaXY+CjwvZGl2PgoKPCEtLSBTY3JlZW5zaG90IEZ1bGxzY3JlZW4gVmlld2VyIC0tPgo8ZGl2IGNsYXNzPSJzY3JlZW5zaG90LWZ1bGxzY3JlZW4iIGlkPSJzY3JlZW5zaG90Vmlld2VyIj4KICA8aW1nIHNyYz0iIiBhbHQ9IlNjcmVlbnNob3QiIGlkPSJzY3JlZW5zaG90SW1hZ2UiPgogIDxzcGFuIGNsYXNzPSJjbG9zZS1oaW50Ij5UYXAgYW55d2hlcmUgdG8gY2xvc2U8L3NwYW4+CjwvZGl2PgoKPCEtLSBUb2FzdCBub3RpZmljYXRpb24gLS0+CjxkaXYgY2xhc3M9InRvYXN0IiBpZD0idG9hc3QiPjwvZGl2PgoKPHNjcmlwdCB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiPmNvbnN0IENPTkZJRyA9IHsNCiAgeG1sRmlsZTogJ3N3aXRjaGdhbWVzLnhtbCcsICAvLyBDaGFuZ2UgdGhpcyB0byB5b3VyIHBsYXRmb3JtIFhNTA0KICBjbGllbnRGaWxlRXh0OiAnLkNMSV9QUk1aJywNCiAgYWRtaW5GaWxlRXh0OiAnLlBSTVonLA0KICBmaWxlYmluQnVja2V0OiAneGxnNGtnZ296YmRnc253NCcsDQogIA0KICAvLyBBdXRvLWRldGVjdGVkIGZyb20gWE1MDQogIHBsYXRmb3JtOiBudWxsLA0KICBzdHJ1Y3R1cmVUeXBlOiBudWxsLCAgLy8gJ2ZvbGRlcnMnIG9yICdmaWxlcycNCiAgYWRtaW5CYXNlUGF0aDogJ0s6XFxOU1AgMjAyMVxcJywNCiAgDQogIHN0b3JhZ2VDb250cm9sczogWw0KICAgIHsNCiAgICAgIGlkOiAnY29uc29sZScsDQogICAgICBsYWJlbDogJ0NvbnNvbGUnLA0KICAgICAgdHlwZTogJ3NlbGVjdCcsDQogICAgICBvcHRpb25zOiBbDQogICAgICAgIHsgdmFsdWU6ICd2MScsIGxhYmVsOiAndjEnIH0sDQogICAgICAgIHsgdmFsdWU6ICd2MicsIGxhYmVsOiAndjInIH0sDQogICAgICAgIHsgdmFsdWU6ICdsaXRlJywgbGFiZWw6ICdsaXRlJyB9LA0KICAgICAgICB7IHZhbHVlOiAnb2xlZCcsIGxhYmVsOiAnb2xlZCcgfQ0KICAgICAgXSwNCiAgICAgIGRlZmF1bHQ6ICd2MScsDQogICAgICBmaWxlbmFtZVRva2VuOiB0cnVlDQogICAgfSwNCiAgICB7DQogICAgICBpZDogJ3NkJywNCiAgICAgIGxhYmVsOiAnU0QgQ2FyZCAoR0IpJywNCiAgICAgIHR5cGU6ICdzZWxlY3QnLA0KICAgICAgb3B0aW9uczogWw0KICAgICAgICB7IHZhbHVlOiAnMTI4JywgbGFiZWw6ICcxMjgnIH0sDQogICAgICAgIHsgdmFsdWU6ICcyNTYnLCBsYWJlbDogJzI1NicgfSwNCiAgICAgICAgeyB2YWx1ZTogJzUxMicsIGxhYmVsOiAnNTEyJyB9LA0KICAgICAgICB7IHZhbHVlOiAnMTAyNCcsIGxhYmVsOiAnMTAyNCcgfQ0KICAgICAgXSwNCiAgICAgIGRlZmF1bHQ6ICcxMjgnLA0KICAgICAgZmlsZW5hbWVUb2tlbjogJ3NkJywNCiAgICAgIHN0b3JhZ2VDYWxjOiB0cnVlDQogICAgfSwNCiAgICB7DQogICAgICBpZDogJ2FuZHJvaWQnLA0KICAgICAgbGFiZWw6ICdBbmRyb2lkIChHQiknLA0KICAgICAgdHlwZTogJ3NlbGVjdCcsDQogICAgICBvcHRpb25zOiBbDQogICAgICAgIHsgdmFsdWU6ICcwJywgbGFiZWw6ICcwJyB9LA0KICAgICAgICB7IHZhbHVlOiAnMTYnLCBsYWJlbDogJzE2JyB9LA0KICAgICAgICB7IHZhbHVlOiAnMzInLCBsYWJlbDogJzMyJyB9LA0KICAgICAgICB7IHZhbHVlOiAnNjQnLCBsYWJlbDogJzY0JyB9DQogICAgICBdLA0KICAgICAgZGVmYXVsdDogJzAnLA0KICAgICAgZmlsZW5hbWVUb2tlbjogJ2Ryb2lkJywNCiAgICAgIHN0b3JhZ2VDYWxjOiB0cnVlDQogICAgfSwNCiAgICB7DQogICAgICBpZDogJ2xpbnV4JywNCiAgICAgIGxhYmVsOiAnTGludXggKEdCKScsDQogICAgICB0eXBlOiAnc2VsZWN0JywNCiAgICAgIG9wdGlvbnM6IFsNCiAgICAgICAgeyB2YWx1ZTogJzAnLCBsYWJlbDogJzAnIH0sDQogICAgICAgIHsgdmFsdWU6ICcxNicsIGxhYmVsOiAnMTYnIH0sDQogICAgICAgIHsgdmFsdWU6ICczMicsIGxhYmVsOiAnMzInIH0sDQogICAgICAgIHsgdmFsdWU6ICc2NCcsIGxhYmVsOiAnNjQnIH0NCiAgICAgIF0sDQogICAgICBkZWZhdWx0OiAnMCcsDQogICAgICBmaWxlbmFtZVRva2VuOiAnbGluJywNCiAgICAgIHN0b3JhZ2VDYWxjOiB0cnVlDQogICAgfQ0KICBdLA0KICANCiAgY2FsY3VsYXRlU3RvcmFnZTogZnVuY3Rpb24odmFsdWVzKSB7DQogICAgY29uc3QgY29uc29sZVZhbCA9IHZhbHVlcy5jb25zb2xlIHx8ICd2MSc7DQogICAgY29uc3Qgc2RWYWwgPSBOdW1iZXIodmFsdWVzLnNkIHx8IDEyOCk7DQogICAgY29uc3QgYW5kcm9pZCA9IE51bWJlcih2YWx1ZXMuYW5kcm9pZCB8fCAwKTsNCiAgICBjb25zdCBsaW51eCA9IE51bWJlcih2YWx1ZXMubGludXggfHwgMCk7DQogICAgY29uc3QganZmaWxlID0gMTsNCiAgICBjb25zdCBlbXUgPSBjb25zb2xlVmFsID09PSAnb2xlZCcgPyA2NCA6IDMyOw0KICAgIGNvbnN0IGJ1ZmZhID0gTWF0aC5mbG9vcihlbXUgLyAzKTsNCiAgICBjb25zdCB0b3RhbFJlc2VydmVkID0gZW11ICsgYW5kcm9pZCArIGxpbnV4ICsganZmaWxlICsgYnVmZmE7DQogICAgY29uc3QgZXh0cmEgPSBNYXRoLmZsb29yKGVtdSAvIDYpOw0KICAgIHJldHVybiAoc2RWYWwgLSB0b3RhbFJlc2VydmVkKSArIGV4dHJhOw0KICB9DQp9Ozwvc2NyaXB0Pgo8c2NyaXB0PgovLyA9PT09PT09PT09PT09PT09PT09PSBDT05GSUdVUkFUSU9OIEJMT0NLID09PT09PT09PT09PT09PT09PT09CgovLyA9PT09PT09PT09PT09PT09PT09PSBFTkQgQ09ORklHVVJBVElPTiA9PT09PT09PT09PT09PT09PT09PQoKY29uc3Qgc3RhdGUgPSB7IGl0ZW1zOiBbXSwgc2VsZWN0ZWQ6IFtdLCB4bWw6IG51bGwsIGxhc3RVcGxvYWQ6MCwgaWNvbkNhY2hlOiB7fSwgY3VycmVudEdlbnJlOiAnYWxsJywgY3VycmVudFNvcnQ6ICduYW1lJywgZ2VucmVzOiBuZXcgU2V0KCkgfTsKY29uc3QgbGVmdFBhbmUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbGVmdFBhbmVJbm5lcicpOwpjb25zdCBvdmVybGF5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ292ZXJsYXknKTsKY29uc3Qgb3ZlcmxheUJvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3ZlcmxheUJvZHknKTsKY29uc3QgaXNNb2JpbGUgPSAvTW9iaXxBbmRyb2lkfGlQaG9uZXxpUGFkfGlQb2QvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpOwpjb25zdCBpc0xvY2FsID0gZmFsc2U7CgovLyBMb25nIHByZXNzIGRldGVjdGlvbgpjb25zdCBMT05HX1BSRVNTX0RVUkFUSU9OID0gNTAwOyAvLyBtcwpsZXQgbG9uZ1ByZXNzVGltZXIgPSBudWxsOwpsZXQgbG9uZ1ByZXNzVHJpZ2dlcmVkID0gZmFsc2U7CgovLyBMb2FkIGljb24gY2FjaGUKYXN5bmMgZnVuY3Rpb24gbG9hZEljb25DYWNoZSgpIHsKICB0cnkgewogICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgnaWNvbl9jYWNoZS5qc29uJyk7CiAgICBpZiAocmVzcG9uc2Uub2spIHsKICAgICAgc3RhdGUuaWNvbkNhY2hlID0gYXdhaXQgcmVzcG9uc2UuanNvbigpOwogICAgICBjb25zb2xlLmxvZyhgTG9hZGVkICR7T2JqZWN0LmtleXMoc3RhdGUuaWNvbkNhY2hlKS5sZW5ndGh9IGljb25zIGZyb20gY2FjaGVgKTsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgfSBjYXRjaCAoZSkgewogICAgY29uc29sZS5sb2coJ05vIGljb24gY2FjaGUgZm91bmQgKHJ1biBidWlsZF9pY29uX2NhY2hlLnB5IHRvIGdlbmVyYXRlKScpOwogIH0KICByZXR1cm4gZmFsc2U7Cn0KCmZ1bmN0aW9uIGdldEljb25VcmwoZ2FtZU5hbWUpIHsKICBjb25zdCBjYWNoZWQgPSBzdGF0ZS5pY29uQ2FjaGVbZ2FtZU5hbWVdOwogIHJldHVybiBjYWNoZWQgPyBjYWNoZWQuaWNvblVybCA6IG51bGw7Cn0KCmZ1bmN0aW9uIGdldEdhbWVJbmZvKGdhbWVOYW1lKSB7CiAgcmV0dXJuIHN0YXRlLmljb25DYWNoZVtnYW1lTmFtZV0gfHwgbnVsbDsKfQoKZnVuY3Rpb24gYnVpbGRHZW5yZUZpbHRlcigpIHsKICBzdGF0ZS5nZW5yZXMuY2xlYXIoKTsKICBzdGF0ZS5nZW5yZXMuYWRkKCdhbGwnKTsKCiAgLy8gQ29sbGVjdCBhbGwgZ2VucmVzIGZyb20gY2FjaGUKICBPYmplY3QudmFsdWVzKHN0YXRlLmljb25DYWNoZSkuZm9yRWFjaChpbmZvID0+IHsKICAgIGlmIChpbmZvLmNhdGVnb3J5ICYmIEFycmF5LmlzQXJyYXkoaW5mby5jYXRlZ29yeSkpIHsKICAgICAgaW5mby5jYXRlZ29yeS5mb3JFYWNoKGNhdCA9PiBzdGF0ZS5nZW5yZXMuYWRkKGNhdCkpOwogICAgfQogIH0pOwoKICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZ2VucmVGaWx0ZXInKTsKICBpZiAoIWNvbnRhaW5lcikgcmV0dXJuOwoKICAvLyBTb3J0IGdlbnJlcyBhbHBoYWJldGljYWxseSwgYnV0IGtlZXAgJ2FsbCcgZmlyc3QKICBjb25zdCBzb3J0ZWRHZW5yZXMgPSBbJ2FsbCcsIC4uLkFycmF5LmZyb20oc3RhdGUuZ2VucmVzKS5maWx0ZXIoZyA9PiBnICE9PSAnYWxsJykuc29ydCgpXTsKCiAgLy8gQnVpbGQgc29ydCBjaGlwcyAobGVmdG1vc3QpICsgZ2VucmUgY2hpcHMKICBjb25zdCBzb3J0Q2hpcHMgPSBgCiAgICA8YnV0dG9uIGNsYXNzPSJzb3J0LWNoaXAgJHtzdGF0ZS5jdXJyZW50U29ydCA9PT0gJ25hbWUnID8gJ2FjdGl2ZScgOiAnJ30iIGRhdGEtc29ydD0ibmFtZSI+QS1aPC9idXR0b24+CiAgICA8YnV0dG9uIGNsYXNzPSJzb3J0LWNoaXAgJHtzdGF0ZS5jdXJyZW50U29ydCA9PT0gJ2xhdGVzdCcgPyAnYWN0aXZlJyA6ICcnfSIgZGF0YS1zb3J0PSJsYXRlc3QiPkxhdGVzdDwvYnV0dG9uPgogICAgPGJ1dHRvbiBjbGFzcz0ic29ydC1jaGlwICR7c3RhdGUuY3VycmVudFNvcnQgPT09ICd0b3AnID8gJ2FjdGl2ZScgOiAnJ30iIGRhdGEtc29ydD0idG9wIj5Ub3A8L2J1dHRvbj4KICAgIDxkaXYgY2xhc3M9ImRpdmlkZXIiPjwvZGl2PgogIGA7CgogIGNvbnN0IGdlbnJlQ2hpcHMgPSBzb3J0ZWRHZW5yZXMubWFwKGdlbnJlID0+IGAKICAgIDxidXR0b24gY2xhc3M9ImdlbnJlLWNoaXAgJHtnZW5yZSA9PT0gc3RhdGUuY3VycmVudEdlbnJlID8gJ2FjdGl2ZScgOiAnJ30iIGRhdGEtZ2VucmU9IiR7Z2VucmV9Ij4KICAgICAgJHtnZW5yZSA9PT0gJ2FsbCcgPyAnQWxsIEdhbWVzJyA6IGdlbnJlfQogICAgPC9idXR0b24+CiAgYCkuam9pbignJyk7CgogIGNvbnRhaW5lci5pbm5lckhUTUwgPSBzb3J0Q2hpcHMgKyBnZW5yZUNoaXBzOwoKICBjb250YWluZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gewogICAgaWYgKGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnZ2VucmUtY2hpcCcpKSB7CiAgICAgIHN0YXRlLmN1cnJlbnRHZW5yZSA9IGUudGFyZ2V0LmRhdGFzZXQuZ2VucmU7CiAgICAgIGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCcuZ2VucmUtY2hpcCcpLmZvckVhY2goYyA9PiBjLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpKTsKICAgICAgZS50YXJnZXQuY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7CiAgICAgIHJlbmRlckxpc3Qoc3RhdGUuaXRlbXMpOwogICAgfQogICAgaWYgKGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnc29ydC1jaGlwJykpIHsKICAgICAgc3RhdGUuY3VycmVudFNvcnQgPSBlLnRhcmdldC5kYXRhc2V0LnNvcnQ7CiAgICAgIGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCcuc29ydC1jaGlwJykuZm9yRWFjaChjID0+IGMuY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJykpOwogICAgICBlLnRhcmdldC5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTsKICAgICAgYXBwbHlTb3J0QW5kUmVuZGVyKCk7CiAgICB9CiAgfSk7Cn0KCmZ1bmN0aW9uIGFwcGx5U29ydEFuZFJlbmRlcigpIHsKICBpZiAoIXN0YXRlLml0ZW1zIHx8IHN0YXRlLml0ZW1zLmxlbmd0aCA9PT0gMCkgewogICAgdG9hc3QoJ05vIGxpc3QgbG9hZGVkIHlldCcpOwogICAgcmV0dXJuOwogIH0KCiAgaWYgKHN0YXRlLmN1cnJlbnRTb3J0ID09PSAnbGF0ZXN0JykgewogICAgc3RhdGUuaXRlbXMuZm9yRWFjaChpdCA9PiB7CiAgICAgIGNvbnN0IHJhdyA9IGl0LmRhdGUgfHwgaXQuZGF0ZU1vZGlmaWVkIHx8IGl0Lm1vZGlmaWVkIHx8ICcnOwogICAgICBjb25zdCBkID0gcGFyc2VEYXRlRmxleGlibGUocmF3KTsKICAgICAgaXQuX3BhcnNlZERhdGUgPSBkID8gZC5nZXRUaW1lKCkgOiAwOwogICAgfSk7CiAgICBzdGF0ZS5pdGVtcy5zb3J0KChhLCBiKSA9PiBiLl9wYXJzZWREYXRlIC0gYS5fcGFyc2VkRGF0ZSk7CiAgfSBlbHNlIGlmIChzdGF0ZS5jdXJyZW50U29ydCA9PT0gJ3RvcCcpIHsKICAgIHN0YXRlLml0ZW1zLnNvcnQoKGEsIGIpID0+IChwYXJzZUludChiLnNjb3JlIHx8IDApIC0gcGFyc2VJbnQoYS5zY29yZSB8fCAwKSkpOwogIH0gZWxzZSB7CiAgICAvLyBBLVogc29ydCBieSBuYW1lCiAgICBzdGF0ZS5pdGVtcy5zb3J0KChhLCBiKSA9PiAoYS5uYW1lIHx8ICcnKS5sb2NhbGVDb21wYXJlKGIubmFtZSB8fCAnJykpOwogIH0KCiAgcmVuZGVyTGlzdChzdGF0ZS5pdGVtcyk7Cn0KCmZ1bmN0aW9uIGZpbHRlckJ5R2VucmUobGlzdCkgewogIGlmIChzdGF0ZS5jdXJyZW50R2VucmUgPT09ICdhbGwnKSByZXR1cm4gbGlzdDsKCiAgcmV0dXJuIGxpc3QuZmlsdGVyKGl0ZW0gPT4gewogICAgY29uc3QgaW5mbyA9IGdldEdhbWVJbmZvKGl0ZW0ubmFtZSk7CiAgICBpZiAoIWluZm8gfHwgIWluZm8uY2F0ZWdvcnkpIHJldHVybiBmYWxzZTsKICAgIHJldHVybiBpbmZvLmNhdGVnb3J5LmluY2x1ZGVzKHN0YXRlLmN1cnJlbnRHZW5yZSk7CiAgfSk7Cn0KCmZ1bmN0aW9uIGZvcm1hdFJlbGVhc2VEYXRlKGRhdGVOdW0pIHsKICBpZiAoIWRhdGVOdW0pIHJldHVybiBudWxsOwogIGNvbnN0IHN0ciA9IFN0cmluZyhkYXRlTnVtKTsKICBpZiAoc3RyLmxlbmd0aCAhPT0gOCkgcmV0dXJuIG51bGw7CiAgY29uc3QgeWVhciA9IHN0ci5zbGljZSgwLCA0KTsKICBjb25zdCBtb250aCA9IHN0ci5zbGljZSg0LCA2KTsKICBjb25zdCBkYXkgPSBzdHIuc2xpY2UoNiwgOCk7CiAgcmV0dXJuIGAke3llYXJ9LSR7bW9udGh9LSR7ZGF5fWA7Cn0KCmZ1bmN0aW9uIHNob3dHYW1lSW5mbyhpdGVtKSB7CiAgY29uc3QgaW5mbyA9IGdldEdhbWVJbmZvKGl0ZW0ubmFtZSk7CiAgY29uc3QgbW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZ2FtZUluZm9Nb2RhbCcpOwogIGNvbnN0IGNvbnRlbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZ2FtZUluZm9Db250ZW50Jyk7CgogIGNvbnN0IGJhbm5lclVybCA9IGluZm8/LmJhbm5lclVybCB8fCBpbmZvPy5pY29uVXJsIHx8ICcnOwogIGNvbnN0IGljb25VcmwgPSBpbmZvPy5pY29uVXJsIHx8ICcnOwogIGNvbnN0IHRpdGxlID0gaW5mbz8ubWF0Y2hlZE5hbWUgfHwgaXRlbS5uYW1lOwogIGNvbnN0IHB1Ymxpc2hlciA9IGluZm8/LnB1Ymxpc2hlciB8fCAnVW5rbm93biBQdWJsaXNoZXInOwogIGNvbnN0IGNhdGVnb3JpZXMgPSBpbmZvPy5jYXRlZ29yeSB8fCBbXTsKICBjb25zdCBkZXNjcmlwdGlvbiA9IGluZm8/LmRlc2NyaXB0aW9uIHx8ICcnOwogIGNvbnN0IGludHJvID0gaW5mbz8uaW50cm8gfHwgJyc7CiAgY29uc3Qgc2NyZWVuc2hvdHMgPSBpbmZvPy5zY3JlZW5zaG90cyB8fCBbXTsKICBjb25zdCByZWxlYXNlRGF0ZSA9IGZvcm1hdFJlbGVhc2VEYXRlKGluZm8/LnJlbGVhc2VEYXRlKTsKICBjb25zdCBwbGF5ZXJzID0gaW5mbz8ubnVtYmVyT2ZQbGF5ZXJzOwogIGNvbnN0IGhhc0ZpbGVzID0gaXRlbS5maWxlcyAmJiBpdGVtLmZpbGVzLmxlbmd0aCA+IDA7CgogIGNvbnN0IGlzU2VsZWN0ZWQgPSBzdGF0ZS5zZWxlY3RlZC5zb21lKHMgPT4gcy5uYW1lID09PSBpdGVtLm5hbWUpOwoKICBjb250ZW50LmlubmVySFRNTCA9IGAKICAgIDxkaXYgY2xhc3M9ImdhbWUtaW5mby1oZWFkZXIiPgogICAgICAke2Jhbm5lclVybCA/IGA8aW1nIGNsYXNzPSJnYW1lLWluZm8tYmFubmVyIiBzcmM9IiR7YmFubmVyVXJsfSIgYWx0PSIiIG9uZXJyb3I9InRoaXMuc3R5bGUuZGlzcGxheT0nbm9uZSciPmAgOiAnPGRpdiBjbGFzcz0iZ2FtZS1pbmZvLWJhbm5lciI+PC9kaXY+J30KICAgICAgJHtpY29uVXJsID8gYDxpbWcgY2xhc3M9ImdhbWUtaW5mby1pY29uIiBzcmM9IiR7aWNvblVybH0iIGFsdD0iIj5gIDogJyd9CiAgICAgIDxidXR0b24gY2xhc3M9ImdhbWUtaW5mby1jbG9zZSIgb25jbGljaz0iY2xvc2VHYW1lSW5mbygpIj48c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjIwIiBoZWlnaHQ9IjIwIiB2aWV3Qm94PSIwIDAgMjQgMjQiIGZpbGw9Im5vbmUiIHN0cm9rZT0iY3VycmVudENvbG9yIiBzdHJva2Utd2lkdGg9IjIuNSIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIj48bGluZSB4MT0iMTgiIHkxPSI2IiB4Mj0iNiIgeTI9IjE4Ii8+PGxpbmUgeDE9IjYiIHkxPSI2IiB4Mj0iMTgiIHkyPSIxOCIvPjwvc3ZnPjwvYnV0dG9uPgogICAgPC9kaXY+CgogICAgPGRpdiBjbGFzcz0iZ2FtZS1pbmZvLXRpdGxlIj4ke2VzYyh0aXRsZSl9PC9kaXY+CiAgICA8ZGl2IGNsYXNzPSJnYW1lLWluZm8tcHVibGlzaGVyIj4ke2VzYyhwdWJsaXNoZXIpfTwvZGl2PgoKICAgIDxkaXYgY2xhc3M9ImdhbWUtaW5mby1tZXRhIj4KICAgICAgJHtjYXRlZ29yaWVzLm1hcChjID0+IGA8c3BhbiBjbGFzcz0iZ2FtZS1pbmZvLXRhZyBnZW5yZSI+JHtlc2MoYyl9PC9zcGFuPmApLmpvaW4oJycpfQogICAgICAke3JlbGVhc2VEYXRlID8gYDxzcGFuIGNsYXNzPSJnYW1lLWluZm8tdGFnIj4ke3JlbGVhc2VEYXRlfTwvc3Bhbj5gIDogJyd9CiAgICAgICR7cGxheWVycyA/IGA8c3BhbiBjbGFzcz0iZ2FtZS1pbmZvLXRhZyI+JHtwbGF5ZXJzfSBQbGF5ZXIke3BsYXllcnMgPiAxID8gJ3MnIDogJyd9PC9zcGFuPmAgOiAnJ30KICAgICAgPHNwYW4gY2xhc3M9ImdhbWUtaW5mby10YWciPiR7Zm9ybWF0U2l6ZVRvR0IoaXRlbS5zaXplKX08L3NwYW4+CiAgICAgICR7aGFzRmlsZXMgPyBgPHNwYW4gY2xhc3M9ImdhbWUtaW5mby10YWciPiR7aXRlbS5maWxlcy5sZW5ndGh9IGZpbGVzPC9zcGFuPmAgOiAnJ30KICAgIDwvZGl2PgoKICAgICR7aGFzRmlsZXMgPyBgCiAgICAgIDxkaXYgY2xhc3M9ImdhbWUtaW5mby1zZWN0aW9uIGdhbWUtaW5mby1maWxlcy1zZWN0aW9uIj4KICAgICAgICA8YnV0dG9uIGNsYXNzPSJnYW1lLWluZm8tZmlsZXMtYnRuIiBvbmNsaWNrPSJ0b2dnbGVGaWxlc1NlY3Rpb24odGhpcykiPgogICAgICAgICAgPHNwYW4+U2hvdyAke2l0ZW0uZmlsZXMubGVuZ3RofSBGaWxlczwvc3Bhbj4KICAgICAgICAgIDxzdmcgY2xhc3M9ImNoZXZyb24iIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2IiB2aWV3Qm94PSIwIDAgMjQgMjQiIGZpbGw9Im5vbmUiIHN0cm9rZT0iY3VycmVudENvbG9yIiBzdHJva2Utd2lkdGg9IjIiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCI+PHBhdGggZD0iTTYgOWw2IDYgNi02Ii8+PC9zdmc+CiAgICAgICAgPC9idXR0b24+CiAgICAgICAgPGRpdiBjbGFzcz0iZ2FtZS1pbmZvLWZpbGVzIiBzdHlsZT0iZGlzcGxheTpub25lIj4KICAgICAgICAgICR7aXRlbS5maWxlcy5tYXAoZiA9PiBgPGRpdiBjbGFzcz0iZ2FtZS1pbmZvLWZpbGUiPiR7ZXNjKGYpfTwvZGl2PmApLmpvaW4oJycpfQogICAgICAgIDwvZGl2PgogICAgICA8L2Rpdj4KICAgIGAgOiAnJ30KCiAgICAke2ludHJvIHx8IGRlc2NyaXB0aW9uID8gYAogICAgICA8ZGl2IGNsYXNzPSJnYW1lLWluZm8tc2VjdGlvbiI+CiAgICAgICAgPGRpdiBjbGFzcz0iZ2FtZS1pbmZvLXNlY3Rpb24tdGl0bGUiPkFib3V0PC9kaXY+CiAgICAgICAgJHtpbnRybyA/IGA8ZGl2IGNsYXNzPSJnYW1lLWluZm8taW50cm8iPiIke2VzYyhpbnRybyl9IjwvZGl2PmAgOiAnJ30KICAgICAgICAke2Rlc2NyaXB0aW9uID8gYDxkaXYgY2xhc3M9ImdhbWUtaW5mby1kZXNjcmlwdGlvbiI+JHtlc2MoZGVzY3JpcHRpb24uc2xpY2UoMCwgNTAwKSl9JHtkZXNjcmlwdGlvbi5sZW5ndGggPiA1MDAgPyAnLi4uJyA6ICcnfTwvZGl2PmAgOiAnJ30KICAgICAgPC9kaXY+CiAgICBgIDogJyd9CgogICAgJHtzY3JlZW5zaG90cy5sZW5ndGggPiAwID8gYAogICAgICA8ZGl2IGNsYXNzPSJnYW1lLWluZm8tc2VjdGlvbiI+CiAgICAgICAgPGRpdiBjbGFzcz0iZ2FtZS1pbmZvLXNlY3Rpb24tdGl0bGUiPlNjcmVlbnNob3RzPC9kaXY+CiAgICAgICAgPGRpdiBjbGFzcz0iZ2FtZS1pbmZvLXNjcmVlbnNob3RzIj4KICAgICAgICAgICR7c2NyZWVuc2hvdHMubWFwKHVybCA9PiBgPGltZyBzcmM9IiR7dXJsfSIgYWx0PSJTY3JlZW5zaG90IiBvbmNsaWNrPSJzaG93U2NyZWVuc2hvdCgnJHt1cmx9JykiIGxvYWRpbmc9ImxhenkiPmApLmpvaW4oJycpfQogICAgICAgIDwvZGl2PgogICAgICA8L2Rpdj4KICAgIGAgOiAnJ30KCiAgICA8ZGl2IGNsYXNzPSJnYW1lLWluZm8tYWN0aW9ucyI+CiAgICAgIDxidXR0b24gY2xhc3M9ImJ0biAke2lzU2VsZWN0ZWQgPyAnZGFuZ2VyJyA6ICdidG4tcHJpbWFyeSd9IiBvbmNsaWNrPSJ0b2dnbGVGcm9tSW5mbygnJHtlc2MoaXRlbS5uYW1lKS5yZXBsYWNlKC8nL2csICJcXCciKX0nKSI+CiAgICAgICAgJHtpc1NlbGVjdGVkID8gJ1JlbW92ZSBmcm9tIExpc3QnIDogJ0FkZCB0byBMaXN0J30KICAgICAgPC9idXR0b24+CiAgICAgIDxidXR0b24gY2xhc3M9ImJ0biBnaG9zdCIgb25jbGljaz0iY2xvc2VHYW1lSW5mbygpIj5DbG9zZTwvYnV0dG9uPgogICAgPC9kaXY+CiAgYDsKCiAgbW9kYWwuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7CiAgZG9jdW1lbnQuYm9keS5zdHlsZS5vdmVyZmxvdyA9ICdoaWRkZW4nOwp9CgpmdW5jdGlvbiBjbG9zZUdhbWVJbmZvKCkgewogIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdnYW1lSW5mb01vZGFsJykuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICBkb2N1bWVudC5ib2R5LnN0eWxlLm92ZXJmbG93ID0gJyc7Cn0KCmZ1bmN0aW9uIHRvZ2dsZUZpbGVzU2VjdGlvbihidG4pIHsKICBjb25zdCBmaWxlc0RpdiA9IGJ0bi5uZXh0RWxlbWVudFNpYmxpbmc7CiAgY29uc3QgaXNPcGVuID0gZmlsZXNEaXYuc3R5bGUuZGlzcGxheSAhPT0gJ25vbmUnOwoKICBpZiAoaXNPcGVuKSB7CiAgICBmaWxlc0Rpdi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOwogICAgYnRuLmNsYXNzTGlzdC5yZW1vdmUoJ29wZW4nKTsKICAgIGJ0bi5xdWVyeVNlbGVjdG9yKCdzcGFuJykudGV4dENvbnRlbnQgPSBidG4ucXVlcnlTZWxlY3Rvcignc3BhbicpLnRleHRDb250ZW50LnJlcGxhY2UoJ0hpZGUnLCAnU2hvdycpOwogIH0gZWxzZSB7CiAgICBmaWxlc0Rpdi5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnOwogICAgYnRuLmNsYXNzTGlzdC5hZGQoJ29wZW4nKTsKICAgIGJ0bi5xdWVyeVNlbGVjdG9yKCdzcGFuJykudGV4dENvbnRlbnQgPSBidG4ucXVlcnlTZWxlY3Rvcignc3BhbicpLnRleHRDb250ZW50LnJlcGxhY2UoJ1Nob3cnLCAnSGlkZScpOwogIH0KfQoKZnVuY3Rpb24gc2hvd1RvYXN0KG1lc3NhZ2UpIHsKICBjb25zdCB0b2FzdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0b2FzdCcpOwogIHRvYXN0LnRleHRDb250ZW50ID0gbWVzc2FnZTsKICB0b2FzdC5jbGFzc0xpc3QuYWRkKCdzaG93Jyk7CiAgc2V0VGltZW91dCgoKSA9PiB0b2FzdC5jbGFzc0xpc3QucmVtb3ZlKCdzaG93JyksIDIwMDApOwp9CgpmdW5jdGlvbiB0b2dnbGVGcm9tSW5mbyhnYW1lTmFtZSkgewogIGNvbnN0IGl0ZW0gPSBzdGF0ZS5pdGVtcy5maW5kKGkgPT4gaS5uYW1lID09PSBnYW1lTmFtZSk7CiAgaWYgKGl0ZW0pIHsKICAgIGNvbnN0IGlkeCA9IHN0YXRlLnNlbGVjdGVkLmZpbmRJbmRleChzID0+IHMubmFtZSA9PT0gZ2FtZU5hbWUpOwogICAgaWYgKGlkeCA+PSAwKSB7CiAgICAgIHN0YXRlLnNlbGVjdGVkLnNwbGljZShpZHgsIDEpOwogICAgICBzaG93VG9hc3QoJ1JlbW92ZWQgZnJvbSBsaXN0Jyk7CiAgICB9IGVsc2UgewogICAgICBzdGF0ZS5zZWxlY3RlZC5wdXNoKGl0ZW0pOwogICAgICBzaG93VG9hc3QoJ0FkZGVkIHRvIGxpc3QnKTsKICAgIH0KICAgIHJlbmRlckxpc3Qoc3RhdGUuaXRlbXMpOwogICAgcmVuZGVyT3ZlcmxheSgpOwogICAgdXBkYXRlVG90YWxzKCk7CiAgICAvLyBTaG93IHRvYXN0IGZpcnN0LCB0aGVuIGNsb3NlIGFmdGVyIGRlbGF5CiAgICBzZXRUaW1lb3V0KCgpID0+IGNsb3NlR2FtZUluZm8oKSwgODAwKTsKICB9Cn0KCmZ1bmN0aW9uIHNob3dTY3JlZW5zaG90KHVybCkgewogIGNvbnN0IHZpZXdlciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzY3JlZW5zaG90Vmlld2VyJyk7CiAgY29uc3QgaW1nID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NjcmVlbnNob3RJbWFnZScpOwogIGltZy5zcmMgPSB1cmw7CiAgdmlld2VyLmNsYXNzTGlzdC5hZGQoJ2FjdGl2ZScpOwp9Cgpkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2NyZWVuc2hvdFZpZXdlcicpPy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2NyZWVuc2hvdFZpZXdlcicpLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpOwp9KTsKCmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdnYW1lSW5mb01vZGFsJyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHsKICBpZiAoZS50YXJnZXQuaWQgPT09ICdnYW1lSW5mb01vZGFsJykgY2xvc2VHYW1lSW5mbygpOwp9KTsKCmNvbnN0IE1JTl9ERUxBWSA9IDEwMDA7CmxldCBub3cgPSBEYXRlLm5vdygpOwpsZXQgbGFzdEV4cG9ydFRpbWUgPSBEYXRlLm5vdygpOwoKY29uc3QgJCA9IGlkPT5kb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7CmZ1bmN0aW9uIGVzYyhzKXsgcmV0dXJuIChzfHwnJykucmVwbGFjZSgvJi9nLCcmYW1wOycpLnJlcGxhY2UoLzwvZywnJmx0OycpLnJlcGxhY2UoLz4vZywnJmd0OycpLnJlcGxhY2UoLycvZywnJiMzOTsnKS5yZXBsYWNlKC8iL2csJyZxdW90OycpOyB9CmZ1bmN0aW9uIHRvYXN0KG1zZyl7ICQoJ3N0YXR1cycpLnRleHRDb250ZW50ID0gbXNnOyBzZXRUaW1lb3V0KCgpPT57IGlmKCQoJ3N0YXR1cycpLnRleHRDb250ZW50ID09PSBtc2cpICQoJ3N0YXR1cycpLnRleHRDb250ZW50ID0gJ1JlYWR5JzsgfSwgMjUwMCk7IH0KCmZ1bmN0aW9uIHBhcnNlU2l6ZVRleHQocyl7IGlmKCFzKSByZXR1cm4gMDsgY29uc3QgbSA9ICgnJytzKS5tYXRjaCgvKFtcZFwuXSspXHMqKEdpQnxNaUJ8S2lCfEdCfE1CfEtCfEIpL2kpOyBpZighbSkgcmV0dXJuIDA7IGNvbnN0IHY9cGFyc2VGbG9hdChtWzFdKTsgY29uc3QgdT1tWzJdLnRvVXBwZXJDYXNlKCk7IGlmKHU9PT0nQicpIHJldHVybiB2OyBpZih1PT09J0tCJ3x8dT09PSdLSUInKSByZXR1cm4gdioxMDI0OyBpZih1PT09J01CJ3x8dT09PSdNSUInKSByZXR1cm4gdioxMDI0KjEwMjQ7IHJldHVybiB2KjEwMjQqMTAyNCoxMDI0OyB9CmZ1bmN0aW9uIGJ5dGVzVG9HQihiKXsgcmV0dXJuIGIvKDEwMjQqMTAyNCoxMDI0KTsgfQoKLy8gRm9ybWF0IHNpemUgc3RyaW5nIHRvIEdCIGRpc3BsYXkgKGhhbmRsZXMgTUIgcHJvcGVybHkpCmZ1bmN0aW9uIGZvcm1hdFNpemVUb0dCKHNpemVTdHIpIHsKICBjb25zdCBieXRlcyA9IHBhcnNlU2l6ZVRleHQoc2l6ZVN0cik7CiAgY29uc3QgZ2IgPSBieXRlc1RvR0IoYnl0ZXMpOwogIGlmIChnYiA8IDAuMSkgcmV0dXJuIChnYiAqIDEwMjQpLnRvRml4ZWQoMCkgKyAnIE1CJzsKICByZXR1cm4gZ2IudG9GaXhlZCgxKSArICcgR0InOwp9CgpmdW5jdGlvbiBidWlsZER5bmFtaWNDb250cm9scygpIHsKICBjb25zdCBjb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZHluYW1pY0NvbnRyb2xzJyk7CiAgY29udGFpbmVyLmlubmVySFRNTCA9ICcnOwogIGNvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ2dyaWQnOwogIGNvbnRhaW5lci5zdHlsZS5ncmlkVGVtcGxhdGVDb2x1bW5zID0gJzFmciAxZnInOwogIGNvbnRhaW5lci5zdHlsZS5nYXAgPSAnOHB4JzsKICAKICBDT05GSUcuc3RvcmFnZUNvbnRyb2xzLmZvckVhY2goY3RybCA9PiB7CiAgICBjb25zdCBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgIGNvbnN0IGxhYmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGFiZWwnKTsKICAgIGxhYmVsLmNsYXNzTmFtZSA9ICdzbWFsbCc7CiAgICBsYWJlbC50ZXh0Q29udGVudCA9IGN0cmwubGFiZWw7CiAgICBkaXYuYXBwZW5kQ2hpbGQobGFiZWwpOwogICAgaWYgKGN0cmwudHlwZSA9PT0gJ3NlbGVjdCcpIHsKICAgICAgY29uc3Qgc2VsZWN0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc2VsZWN0Jyk7CiAgICAgIHNlbGVjdC5pZCA9IGN0cmwuaWQ7CiAgICAgIHNlbGVjdC5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCBjdHJsLmxhYmVsKTsKICAgICAgY3RybC5vcHRpb25zLmZvckVhY2gob3B0ID0+IHsKICAgICAgICBjb25zdCBvcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTsKICAgICAgICBvcHRpb24udmFsdWUgPSBvcHQudmFsdWU7CiAgICAgICAgb3B0aW9uLnRleHRDb250ZW50ID0gb3B0LmxhYmVsOwogICAgICAgIGlmIChvcHQudmFsdWUgPT09IGN0cmwuZGVmYXVsdCkgb3B0aW9uLnNlbGVjdGVkID0gdHJ1ZTsKICAgICAgICBzZWxlY3QuYXBwZW5kQ2hpbGQob3B0aW9uKTsKICAgICAgfSk7CiAgICAgIGRpdi5hcHBlbmRDaGlsZChzZWxlY3QpOwogICAgICBzZWxlY3QuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoKSA9PiB1cGRhdGVGaWxlbmFtZVByZXZpZXcoKSk7CiAgICAgIHNlbGVjdC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoKSA9PiB1cGRhdGVUb3RhbHMoKSk7CiAgICB9CiAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoZGl2KTsKICB9KTsKfQoKYXN5bmMgZnVuY3Rpb24gbG9hZFhNTCgpewogIHRyeXsKICAgIGNvbnN0IHR4dCA9IGF3YWl0IGZldGNoKENPTkZJRy54bWxGaWxlKS50aGVuKHI9PnIudGV4dCgpKTsKICAgIGNvbnN0IHhtbCA9IG5ldyBET01QYXJzZXIoKS5wYXJzZUZyb21TdHJpbmcodHh0LCdhcHBsaWNhdGlvbi94bWwnKTsKICAgIHN0YXRlLnhtbCA9IHhtbDsKICAgIAogICAgY29uc3Qgcm9vdCA9IHhtbC5kb2N1bWVudEVsZW1lbnQ7CiAgICBDT05GSUcucGxhdGZvcm0gPSByb290LmdldEF0dHJpYnV0ZSgncGxhdGZvcm0nKSB8fCAnVW5rbm93bic7CiAgICBDT05GSUcuc3RydWN0dXJlVHlwZSA9IHJvb3QuZ2V0QXR0cmlidXRlKCdzdHJ1Y3R1cmVUeXBlJykgfHwgJ2ZvbGRlcnMnOwogICAgCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGFnZVRpdGxlJykudGV4dENvbnRlbnQgPSBgJHtDT05GSUcucGxhdGZvcm19IEdhbWVzYDsKICAgIAogICAgbGV0IGl0ZW1zID0gW107CiAgICAKICAgIGlmIChDT05GSUcuc3RydWN0dXJlVHlwZSA9PT0gJ2ZvbGRlcnMnKSB7CiAgICAgIGl0ZW1zID0gQXJyYXkuZnJvbSh4bWwucXVlcnlTZWxlY3RvckFsbCgnZm9sZGVyJykpCiAgICAgICAgLm1hcChmID0+ICh7CiAgICAgICAgICBuYW1lOiBmLmdldEF0dHJpYnV0ZSgnbmFtZScpLAogICAgICAgICAgc2NvcmU6IGYuZ2V0QXR0cmlidXRlKCdzY29yZScpIHx8ICcwJywKICAgICAgICAgIHNpemU6IGYuZ2V0QXR0cmlidXRlKCdzaXplJykgfHwgJzAgR2lCJywKICAgICAgICAgIGRhdGU6IGYuZ2V0QXR0cmlidXRlKCdkYXRlQ3JlYXRlZCcpIHx8ICcnLAogICAgICAgICAgZmlsZUNvdW50OiBmLmdldEF0dHJpYnV0ZSgnZmlsZUNvdW50JykgfHwgJzAnLAogICAgICAgICAgZmlsZXM6IEFycmF5LmZyb20oZi5xdWVyeVNlbGVjdG9yQWxsKCdmaWxlJykpLm1hcCh4ID0+IHguZ2V0QXR0cmlidXRlKCduYW1lJykpCiAgICAgICAgfSkpOwogICAgfSBlbHNlIHsKICAgICAgaXRlbXMgPSBBcnJheS5mcm9tKHhtbC5xdWVyeVNlbGVjdG9yQWxsKCdmaWxlJykpCiAgICAgICAgLm1hcChmID0+ICh7CiAgICAgICAgICBuYW1lOiBmLmdldEF0dHJpYnV0ZSgnbmFtZScpLAogICAgICAgICAgZmlsZW5hbWU6IGYuZ2V0QXR0cmlidXRlKCdmaWxlbmFtZScpIHx8IGYuZ2V0QXR0cmlidXRlKCduYW1lJyksCiAgICAgICAgICBzaXplOiBmLmdldEF0dHJpYnV0ZSgnc2l6ZScpIHx8ICcwIEdpQicsCiAgICAgICAgICBkYXRlOiBmLmdldEF0dHJpYnV0ZSgnZGF0ZUNyZWF0ZWQnKSB8fCAnJwogICAgICAgIH0pKTsKICAgIH0KICAgIAogICAgc3RhdGUuaXRlbXMgPSBpdGVtczsKICAgIHJlbmRlckxpc3QoaXRlbXMpOwogICAgdG9hc3QoYExvYWRlZCAke2l0ZW1zLmxlbmd0aH0gJHtDT05GSUcucGxhdGZvcm19IGdhbWVzYCk7CiAgfWNhdGNoKGUpeyAKICAgIGNvbnNvbGUuZXJyb3IoZSk7IAogICAgbGVmdFBhbmUuaW5uZXJIVE1MID0gYDxkaXYgc3R5bGU9ImNvbG9yOiNiOTFjMWM7cGFkZGluZzoxMnB4Ij5GYWlsZWQgdG8gbG9hZCAke0NPTkZJRy54bWxGaWxlfTwvZGl2PmA7IAogIH0KfQoKCmZ1bmN0aW9uIHJlbmRlckxpc3QobGlzdCl7CiAgbGVmdFBhbmUuaW5uZXJIVE1MID0gJyc7CgogIC8vIEFwcGx5IGdlbnJlIGZpbHRlcgogIGNvbnN0IGZpbHRlcmVkTGlzdCA9IGZpbHRlckJ5R2VucmUobGlzdCk7CgogIGlmKCFmaWx0ZXJlZExpc3R8fCFmaWx0ZXJlZExpc3QubGVuZ3RoKXsKICAgIGxlZnRQYW5lLmlubmVySFRNTCA9ICc8ZGl2IHN0eWxlPSJwYWRkaW5nOjQwcHg7dGV4dC1hbGlnbjpjZW50ZXI7Y29sb3I6dmFyKC0tbXV0ZWQpIj5ObyBnYW1lcyBmb3VuZDwvZGl2Pic7CiAgICByZXR1cm47CiAgfQoKICBmaWx0ZXJlZExpc3QuZm9yRWFjaChpdGVtPT57CiAgICBjb25zdCByb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgIHJvdy5jbGFzc05hbWU9J2l0ZW0nOwogICAgcm93LmRhdGFzZXQubmFtZSA9IGl0ZW0ubmFtZTsKICAgIHJvdy5kYXRhc2V0LnNpemUgPSBpdGVtLnNpemU7CiAgICBpZiAoaXRlbS5maWxlbmFtZSkgcm93LmRhdGFzZXQuZmlsZW5hbWUgPSBpdGVtLmZpbGVuYW1lOwoKICAgIGNvbnN0IGhhc0ZpbGVzID0gQ09ORklHLnN0cnVjdHVyZVR5cGUgPT09ICdmb2xkZXJzJyAmJiBpdGVtLmZpbGVzICYmIGl0ZW0uZmlsZXMubGVuZ3RoID4gMDsKICAgIGNvbnN0IGlzU2VsZWN0ZWQgPSBzdGF0ZS5zZWxlY3RlZC5zb21lKHM9PnMubmFtZT09PWl0ZW0ubmFtZSk7CgogICAgLy8gUGFyc2Ugc2l6ZSBmb3IgZGlzcGxheQogICAgY29uc3Qgc2l6ZURpc3BsYXkgPSBmb3JtYXRTaXplVG9HQihpdGVtLnNpemUpOwoKICAgIC8vIFNjb3JlIGluZm8KICAgIGNvbnN0IHNjb3JlVmFsID0gaXRlbS5zY29yZSA/IHBhcnNlSW50KGl0ZW0uc2NvcmUpIDogMDsKCiAgICAvLyBHZXQgaWNvbiBmcm9tIGNhY2hlCiAgICBjb25zdCBpY29uVXJsID0gZ2V0SWNvblVybChpdGVtLm5hbWUpOwogICAgY29uc3QgdGh1bWJDb250ZW50ID0gaWNvblVybAogICAgICA/IGA8aW1nIHNyYz0iJHtpY29uVXJsfSIgYWx0PSIiIGxvYWRpbmc9ImxhenkiIG9uZXJyb3I9InRoaXMuc3R5bGUuZGlzcGxheT0nbm9uZSc7dGhpcy5uZXh0RWxlbWVudFNpYmxpbmcuc3R5bGUuZGlzcGxheT0nYmxvY2snIj5gCiAgICAgIDogJyc7CiAgICBjb25zdCBwbGFjZWhvbGRlclN0eWxlID0gaWNvblVybCA/ICdkaXNwbGF5Om5vbmUnIDogJyc7CgogICAgcm93LmlubmVySFRNTCA9IGAKICAgICAgPGRpdiBjbGFzcz0iaXRlbS10aHVtYiI+CiAgICAgICAgJHt0aHVtYkNvbnRlbnR9CiAgICAgICAgPHNwYW4gY2xhc3M9Iml0ZW0tdGh1bWItcGxhY2Vob2xkZXIiIHN0eWxlPSIke3BsYWNlaG9sZGVyU3R5bGV9Ij7wn46uPC9zcGFuPgogICAgICA8L2Rpdj4KICAgICAgPGRpdiBjbGFzcz0iaXRlbS1jb250ZW50Ij4KICAgICAgICA8ZGl2IGNsYXNzPSJpdGVtLXRpdGxlIj4ke2VzYyhpdGVtLm5hbWUpfTwvZGl2PgogICAgICAgIDxkaXYgY2xhc3M9Iml0ZW0tc2l6ZSI+JHtzaXplRGlzcGxheX08L2Rpdj4KICAgICAgICAke3Njb3JlVmFsID4gMCA/IGA8ZGl2IGNsYXNzPSJpdGVtLW1ldGEiPlNjb3JlOiAke3Njb3JlVmFsfTwvZGl2PmAgOiAnJ30KICAgICAgPC9kaXY+CiAgICAgIDxkaXYgY2xhc3M9Iml0ZW0tY2hlY2tib3giPjwvZGl2PgogICAgYDsKCiAgICBpZihpc1NlbGVjdGVkKSByb3cuY2xhc3NMaXN0LmFkZCgnc2VsZWN0ZWQnKTsKCiAgICAvLyBMb25nIHByZXNzIHRvIHNob3cgZ2FtZSBpbmZvCiAgICBsZXQgcHJlc3NUaW1lciA9IG51bGw7CiAgICBsZXQgcHJlc3NUcmlnZ2VyZWQgPSBmYWxzZTsKCiAgICBjb25zdCBzdGFydFByZXNzID0gKGUpID0+IHsKICAgICAgcHJlc3NUcmlnZ2VyZWQgPSBmYWxzZTsKICAgICAgcHJlc3NUaW1lciA9IHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgIHByZXNzVHJpZ2dlcmVkID0gdHJ1ZTsKICAgICAgICByb3cuY2xhc3NMaXN0LmFkZCgnbG9uZy1wcmVzcy1hY3RpdmUnKTsKICAgICAgICBzaG93R2FtZUluZm8oaXRlbSk7CiAgICAgICAgc2V0VGltZW91dCgoKSA9PiByb3cuY2xhc3NMaXN0LnJlbW92ZSgnbG9uZy1wcmVzcy1hY3RpdmUnKSwgMjAwKTsKICAgICAgfSwgTE9OR19QUkVTU19EVVJBVElPTik7CiAgICB9OwoKICAgIGNvbnN0IGVuZFByZXNzID0gKGUpID0+IHsKICAgICAgY2xlYXJUaW1lb3V0KHByZXNzVGltZXIpOwogICAgICBpZiAocHJlc3NUcmlnZ2VyZWQpIHsKICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsKICAgICAgfQogICAgfTsKCiAgICBjb25zdCBjYW5jZWxQcmVzcyA9ICgpID0+IHsKICAgICAgY2xlYXJUaW1lb3V0KHByZXNzVGltZXIpOwogICAgfTsKCiAgICAvLyBUb3VjaCBldmVudHMKICAgIHJvdy5hZGRFdmVudExpc3RlbmVyKCd0b3VjaHN0YXJ0Jywgc3RhcnRQcmVzcywgeyBwYXNzaXZlOiB0cnVlIH0pOwogICAgcm93LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoZW5kJywgZW5kUHJlc3MpOwogICAgcm93LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoY2FuY2VsJywgY2FuY2VsUHJlc3MpOwogICAgcm93LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsIGNhbmNlbFByZXNzKTsKCiAgICAvLyBNb3VzZSBsb25nIHByZXNzIChkZXNrdG9wKQogICAgcm93LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIChlKSA9PiB7CiAgICAgIGlmIChlLmJ1dHRvbiA9PT0gMCkgc3RhcnRQcmVzcyhlKTsKICAgIH0pOwogICAgcm93LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCBlbmRQcmVzcyk7CiAgICByb3cuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsIGNhbmNlbFByZXNzKTsKCiAgICByb3cuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXYpPT57CiAgICAgIC8vIFNraXAgaWYgbG9uZyBwcmVzcyB3YXMgdHJpZ2dlcmVkCiAgICAgIGlmIChldi50YXJnZXQuY2xvc2VzdCgnLml0ZW0nKT8uY2xhc3NMaXN0LmNvbnRhaW5zKCdsb25nLXByZXNzLWFjdGl2ZScpKSByZXR1cm47CgogICAgICBpZihldi5hbHRLZXkpewogICAgICAgIHNob3dHYW1lSW5mbyhpdGVtKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgdG9nZ2xlU2VsZWN0KGl0ZW0sIHJvdyk7CiAgICB9KTsKCiAgICBsZWZ0UGFuZS5hcHBlbmRDaGlsZChyb3cpOwogIH0pOwoKICB1cGRhdGVDVEFCdXR0b24oKTsKfQoKZnVuY3Rpb24gdXBkYXRlQ1RBQnV0dG9uKCkgewogIGNvbnN0IGN0YVRleHQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY3RhVGV4dCcpOwogIGNvbnN0IGNvdW50ID0gc3RhdGUuc2VsZWN0ZWQubGVuZ3RoOwogIGNvbnN0IHRvdGFsQnl0ZXMgPSBzdGF0ZS5zZWxlY3RlZC5yZWR1Y2UoKHN1bSwgcykgPT4gc3VtICsgcGFyc2VTaXplVGV4dChzLnNpemUpLCAwKTsKICBjb25zdCBnYiA9IGJ5dGVzVG9HQih0b3RhbEJ5dGVzKS50b0ZpeGVkKDEpOwoKICBpZiAoY291bnQgPiAwKSB7CiAgICBjdGFUZXh0LnRleHRDb250ZW50ID0gYFVwbG9hZCAke2NvdW50fSBHYW1lJHtjb3VudCAhPT0gMSA/ICdzJyA6ICcnfSAoJHtnYn0gR0IpYDsKICB9IGVsc2UgewogICAgY3RhVGV4dC50ZXh0Q29udGVudCA9ICdVcGxvYWQgU2VsZWN0aW9uJzsKICB9Cn0KCmZ1bmN0aW9uIHRvZ2dsZVNlbGVjdChpdGVtLCByb3dFbCl7IAogIGNvbnN0IGlkeCA9IHN0YXRlLnNlbGVjdGVkLmZpbmRJbmRleChzPT5zLm5hbWU9PT1pdGVtLm5hbWUpOyAKICBpZihpZHg+PTApeyAKICAgIHN0YXRlLnNlbGVjdGVkLnNwbGljZShpZHgsMSk7IAogICAgaWYocm93RWwpIHJvd0VsLmNsYXNzTGlzdC5yZW1vdmUoJ3NlbGVjdGVkJyk7IAogIH0gZWxzZSB7IAogICAgc3RhdGUuc2VsZWN0ZWQucHVzaCh7IAogICAgICBuYW1lOml0ZW0ubmFtZSwgCiAgICAgIGZpbGVuYW1lOiBpdGVtLmZpbGVuYW1lIHx8IGl0ZW0ubmFtZSwKICAgICAgc2l6ZTppdGVtLnNpemUgCiAgICB9KTsgCiAgICBpZihyb3dFbCkgcm93RWwuY2xhc3NMaXN0LmFkZCgnc2VsZWN0ZWQnKTsgCiAgfQogIHVwZGF0ZVRvdGFscygpOyAKICByZW5kZXJPdmVybGF5KCk7IAp9CgpmdW5jdGlvbiByZW5kZXJPdmVybGF5KCkgewogIG92ZXJsYXlCb2R5LmlubmVySFRNTCA9ICcnOwogIHN0YXRlLnNlbGVjdGVkLmZvckVhY2goKHMsaSk9PnsKICAgIGNvbnN0IHJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogICAgcm93LmNsYXNzTmFtZT0ncm93JzsKICAgIGNvbnN0IGljb25VcmwgPSBnZXRJY29uVXJsKHMubmFtZSk7CiAgICBjb25zdCBzaXplRGlzcGxheSA9IGZvcm1hdFNpemVUb0dCKHMuc2l6ZSk7CiAgICByb3cuaW5uZXJIVE1MID0gYAogICAgICA8ZGl2IGNsYXNzPSJpdGVtLXRodW1iIiBzdHlsZT0id2lkdGg6NDRweDtoZWlnaHQ6NDRweDtmbGV4LXNocmluazowIj4KICAgICAgICAke2ljb25VcmwgPyBgPGltZyBzcmM9IiR7aWNvblVybH0iIGFsdD0iIiBzdHlsZT0id2lkdGg6MTAwJTtoZWlnaHQ6MTAwJTtvYmplY3QtZml0OmNvdmVyO2JvcmRlci1yYWRpdXM6NnB4Ij5gIDogJzxzcGFuIHN0eWxlPSJmb250LXNpemU6MThweCI+8J+Orjwvc3Bhbj4nfQogICAgICA8L2Rpdj4KICAgICAgPGRpdiBjbGFzcz0icm93LWluZm8iPgogICAgICAgIDxzdHJvbmc+JHtpKzF9LiAke2VzYyhzLm5hbWUpfTwvc3Ryb25nPgogICAgICAgIDxkaXYgY2xhc3M9J21ldGEnPiR7c2l6ZURpc3BsYXl9PC9kaXY+CiAgICAgIDwvZGl2PgogICAgICA8ZGl2IGNsYXNzPSJyb3ctYWN0aW9ucyI+CiAgICAgICAgPGJ1dHRvbiBjbGFzcz0naWNvbiB1cCc+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNCIgaGVpZ2h0PSIxNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyLjUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCI+PHBhdGggZD0iTTE4IDE1bC02LTYtNiA2Ii8+PC9zdmc+PC9idXR0b24+CiAgICAgICAgPGJ1dHRvbiBjbGFzcz0naWNvbiBkb3duJz48c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjE0IiBoZWlnaHQ9IjE0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIGZpbGw9Im5vbmUiIHN0cm9rZT0iY3VycmVudENvbG9yIiBzdHJva2Utd2lkdGg9IjIuNSIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48cGF0aCBkPSJNNiA5bDYgNiA2LTYiLz48L3N2Zz48L2J1dHRvbj4KICAgICAgICA8YnV0dG9uIGNsYXNzPSdpY29uIHJlbW92ZSc+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNCIgaGVpZ2h0PSIxNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyLjUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCI+PGxpbmUgeDE9IjE4IiB5MT0iNiIgeDI9IjYiIHkyPSIxOCIvPjxsaW5lIHgxPSI2IiB5MT0iNiIgeDI9IjE4IiB5Mj0iMTgiLz48L3N2Zz48L2J1dHRvbj4KICAgICAgPC9kaXY+YDsKCiAgICByb3cucXVlcnlTZWxlY3RvcignLnVwJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKT0+ewogICAgICBpZihpPjApewogICAgICAgIFtzdGF0ZS5zZWxlY3RlZFtpLTFdLCBzdGF0ZS5zZWxlY3RlZFtpXV0gPSBbc3RhdGUuc2VsZWN0ZWRbaV0sIHN0YXRlLnNlbGVjdGVkW2ktMV1dOwogICAgICAgIHJlbmRlck92ZXJsYXkoKTsKICAgICAgICByZW5kZXJMaXN0KHN0YXRlLml0ZW1zKTsKICAgICAgICB1cGRhdGVUb3RhbHMoKTsKICAgICAgICBvdmVybGF5Qm9keS5jaGlsZHJlbltpLTFdLmNsYXNzTGlzdC5hZGQoJ2hpZ2hsaWdodCcpOwogICAgICB9CiAgICB9KTsKCiAgICByb3cucXVlcnlTZWxlY3RvcignLmRvd24nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpPT57CiAgICAgIGlmKGk8c3RhdGUuc2VsZWN0ZWQubGVuZ3RoLTEpewogICAgICAgIFtzdGF0ZS5zZWxlY3RlZFtpKzFdLCBzdGF0ZS5zZWxlY3RlZFtpXV0gPSBbc3RhdGUuc2VsZWN0ZWRbaV0sIHN0YXRlLnNlbGVjdGVkW2krMV1dOwogICAgICAgIHJlbmRlck92ZXJsYXkoKTsKICAgICAgICByZW5kZXJMaXN0KHN0YXRlLml0ZW1zKTsKICAgICAgICB1cGRhdGVUb3RhbHMoKTsKICAgICAgICBvdmVybGF5Qm9keS5jaGlsZHJlbltpKzFdLmNsYXNzTGlzdC5hZGQoJ2hpZ2hsaWdodCcpOwogICAgICB9CiAgICB9KTsKCiAgICByb3cucXVlcnlTZWxlY3RvcignLnJlbW92ZScpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCk9PnsKICAgICAgY29uc3QgcmVtb3ZlZCA9IHN0YXRlLnNlbGVjdGVkLnNwbGljZShpLDEpWzBdOwogICAgICBjb25zdCBsZWZ0Um93ID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuaXRlbScpKQogICAgICAgIC5maW5kKHg9PnguZGF0YXNldC5uYW1lPT09cmVtb3ZlZC5uYW1lKTsKICAgICAgaWYobGVmdFJvdykgbGVmdFJvdy5jbGFzc0xpc3QucmVtb3ZlKCdzZWxlY3RlZCcpOwogICAgICByZW5kZXJPdmVybGF5KCk7CiAgICAgIHJlbmRlckxpc3Qoc3RhdGUuaXRlbXMpOwogICAgICB1cGRhdGVUb3RhbHMoKTsKICAgIH0pOwoKICAgIG92ZXJsYXlCb2R5LmFwcGVuZENoaWxkKHJvdyk7CiAgfSk7CiAgJCgnb3ZlcmxheUNvdW50JykudGV4dENvbnRlbnQgPSBzdGF0ZS5zZWxlY3RlZC5sZW5ndGg7CiAgcmVuZGVyU2VsZWN0ZWRQYW5lbCgpOwp9CgokKCdzaG93U2VsZWN0ZWQnKT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKT0+eyBvdmVybGF5LnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7IHJlbmRlck92ZXJsYXkoKTsgfSk7CiQoJ2Nsb3NlT3ZlcmxheScpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCk9PiBvdmVybGF5LnN0eWxlLmRpc3BsYXkgPSAnbm9uZScpOwoKLy8gQ1RBIFNob3cgYnV0dG9uCiQoJ2N0YVNob3cnKT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7CiAgb3ZlcmxheS5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnOwogIHJlbmRlck92ZXJsYXkoKTsKfSk7CgovLyBDVEEgVXBsb2FkIGJ1dHRvbgokKCdjdGFVcGxvYWQnKT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7CiAgZG9VcGxvYWQoKTsKfSk7CgovLyBQcmV2ZW50IGFjY2lkZW50YWwgcGFnZSByZWZyZXNoL2Nsb3NlIHdoZW4gdXNlciBoYXMgc2VsZWN0aW9ucwp3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignYmVmb3JldW5sb2FkJywgKGUpID0+IHsKICBpZiAoc3RhdGUuc2VsZWN0ZWQubGVuZ3RoID4gMCkgewogICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgZS5yZXR1cm5WYWx1ZSA9ICcnOwogICAgcmV0dXJuICcnOwogIH0KfSk7CgpmdW5jdGlvbiBzaG93RmlsZXMobmFtZSwgZmlsZXMsIHNpemUpIHsKICBpZiAoIWZpbGVzIHx8ICFmaWxlcy5sZW5ndGgpIHsKICAgIGFsZXJ0KGBObyBmaWxlcyBmb3IgJHtuYW1lfWApOwogICAgcmV0dXJuOwogIH0KCiAgY29uc3QgbW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsZXNNb2RhbCcpOwogIG1vZGFsLmlubmVySFRNTCA9ICcnOyAKICBtb2RhbC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsKICAKICBjb25zdCBoZWFkZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICBoZWFkZXIuaW5uZXJIVE1MID0gYDxzdHJvbmc+JHtlc2MobmFtZSl9PC9zdHJvbmc+PGJyPjxzcGFuIGNsYXNzPSJtZXRhIj5TaXplOiAke2VzYyhzaXplKX0gLSAke2ZpbGVzLmxlbmd0aH0gZmlsZXM8L3NwYW4+YDsKICBtb2RhbC5hcHBlbmRDaGlsZChoZWFkZXIpOwoKICBjb25zdCBsaXN0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgbGlzdC5zdHlsZS5tYXJnaW5Ub3AgPSAnOHB4JzsKICBtb2RhbC5hcHBlbmRDaGlsZChsaXN0KTsKCiAgbGV0IGluZGV4ID0gMDsKICBjb25zdCBiYXRjaCA9IDIwOwogIGZ1bmN0aW9uIGxvYWRNb3JlKCkgewogICAgY29uc3QgbmV4dCA9IGZpbGVzLnNsaWNlKGluZGV4LCBpbmRleCtiYXRjaCk7CiAgICBsaXN0LmlubmVySFRNTCArPSBuZXh0Lm1hcChmPT5lc2MoZikpLmpvaW4oJzxicj4nKTsKICAgIGluZGV4ICs9IGJhdGNoOwogICAgaWYgKGluZGV4ID49IGZpbGVzLmxlbmd0aCkgewogICAgICBtb3JlQnRuLnJlbW92ZSgpOwogICAgfQogIH0KCiAgY29uc3QgbW9yZUJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpOwogIG1vcmVCdG4udGV4dENvbnRlbnQgPSAnTW9yZSc7CiAgbW9yZUJ0bi5jbGFzc05hbWUgPSAnYnRuIGdob3N0JzsKICBtb3JlQnRuLnN0eWxlLm1hcmdpblRvcCA9ICcxMHB4JzsKICBtb3JlQnRuLm9uY2xpY2sgPSBsb2FkTW9yZTsKICBtb2RhbC5hcHBlbmRDaGlsZChtb3JlQnRuKTsKCiAgY29uc3QgY2xvc2VCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTsKICBjbG9zZUJ0bi50ZXh0Q29udGVudCA9ICdDbG9zZSc7CiAgY2xvc2VCdG4uY2xhc3NOYW1lID0gJ2J0bic7CiAgY2xvc2VCdG4uc3R5bGUubWFyZ2luVG9wID0gJzEwcHgnOwogIGNsb3NlQnRuLm9uY2xpY2sgPSAoKT0+eyBtb2RhbC5zdHlsZS5kaXNwbGF5PSdub25lJzsgbW9kYWwuaW5uZXJIVE1MPScnOyB9OwogIG1vZGFsLmFwcGVuZENoaWxkKGNsb3NlQnRuKTsKICBsb2FkTW9yZSgpOwp9CgpmdW5jdGlvbiBnZXRDb250cm9sVmFsdWVzKCkgewogIGNvbnN0IHZhbHVlcyA9IHt9OwogIENPTkZJRy5zdG9yYWdlQ29udHJvbHMuZm9yRWFjaChjdHJsID0+IHsKICAgIGNvbnN0IGVsID0gJChjdHJsLmlkKTsKICAgIGlmIChlbCkgdmFsdWVzW2N0cmwuaWRdID0gZWwudmFsdWU7CiAgfSk7CiAgcmV0dXJuIHZhbHVlczsKfQoKZnVuY3Rpb24gdXBkYXRlVG90YWxzKCkgewogIGNvbnN0IHRvdGFsQnl0ZXMgPSBzdGF0ZS5zZWxlY3RlZC5yZWR1Y2UoKHN1bSwgcykgPT4gc3VtICsgcGFyc2VTaXplVGV4dChzLnNpemUpLCAwKTsKICBjb25zdCBnYiA9IGJ5dGVzVG9HQih0b3RhbEJ5dGVzKTsKCiAgLy8gVXBkYXRlIG1haW4gc2VsZWN0ZWQgc2l6ZSBkaXNwbGF5CiAgY29uc3Qgc2VsZWN0ZWRTaXplRWwgPSAkKCdzZWxlY3RlZFNpemUnKTsKICBpZiAoc2VsZWN0ZWRTaXplRWwpIHNlbGVjdGVkU2l6ZUVsLnRleHRDb250ZW50ID0gZ2IudG9GaXhlZCgyKTsKCiAgLy8gVXBkYXRlIHRoZSBzdGF0IGNhcmQgZGlzcGxheQogIGNvbnN0IHNlbGVjdGVkU2l6ZURpc3BsYXkgPSAkKCdzZWxlY3RlZFNpemVEaXNwbGF5Jyk7CiAgaWYgKHNlbGVjdGVkU2l6ZURpc3BsYXkpIHNlbGVjdGVkU2l6ZURpc3BsYXkudGV4dENvbnRlbnQgPSBnYi50b0ZpeGVkKDEpOwoKICAvLyBDYWxjdWxhdGUgdGltZSBlc3RpbWF0ZQogIGNvbnN0IGJsb2F0ZWQgPSB0b3RhbEJ5dGVzICogMS4yOwogIGNvbnN0IHNwZWVkID0gMTQgKiAxMDI0ICogMTAyNDsKICBjb25zdCBzZWNzID0gTWF0aC5jZWlsKGJsb2F0ZWQgLyBzcGVlZCk7CiAgY29uc3QgaG91cnMgPSBNYXRoLmZsb29yKHNlY3MvMzYwMCk7CiAgY29uc3QgbWlucyA9IE1hdGguZmxvb3IoKHNlY3MlMzYwMCkvNjApOwoKICBjb25zdCBpbnN0YWxsRWwgPSAkKCdpbnN0YWxsRXN0aW1hdGUnKTsKICBpZiAoaW5zdGFsbEVsKSB7CiAgICBpZiAoaG91cnMgPiAwKSB7CiAgICAgIGluc3RhbGxFbC50ZXh0Q29udGVudCA9IGB+JHtob3Vyc31oICR7bWluc31tYDsKICAgIH0gZWxzZSB7CiAgICAgIGluc3RhbGxFbC50ZXh0Q29udGVudCA9IGB+JHttaW5zfW1gOwogICAgfQogIH0KCiAgLy8gVXBkYXRlIGNvdW50CiAgY29uc3QgY291bnRFbCA9ICQoJ2NvdW50Jyk7CiAgaWYgKGNvdW50RWwpIGNvdW50RWwudGV4dENvbnRlbnQgPSBzdGF0ZS5zZWxlY3RlZC5sZW5ndGg7CgogIC8vIFVwZGF0ZSBzZWxlY3RlZCBwYW5lbCBjb3VudAogIGNvbnN0IHBhbmVsQ291bnQgPSAkKCdzZWxlY3RlZFBhbmVsQ291bnQnKTsKICBpZiAocGFuZWxDb3VudCkgcGFuZWxDb3VudC50ZXh0Q29udGVudCA9IGAke3N0YXRlLnNlbGVjdGVkLmxlbmd0aH0gaXRlbSR7c3RhdGUuc2VsZWN0ZWQubGVuZ3RoICE9PSAxID8gJ3MnIDogJyd9YDsKCiAgLy8gVXBkYXRlIENUQSBiYWRnZQogIGNvbnN0IGN0YUJhZGdlID0gJCgnY3RhQmFkZ2UnKTsKICBpZiAoY3RhQmFkZ2UpIGN0YUJhZGdlLnRleHRDb250ZW50ID0gc3RhdGUuc2VsZWN0ZWQubGVuZ3RoOwoKICAvLyBHZXQgc3RvcmFnZSB2YWx1ZXMKICBjb25zdCB2YWx1ZXMgPSBnZXRDb250cm9sVmFsdWVzKCk7CiAgY29uc3Qgc3BhY2VGb3JHYW1lcyA9IENPTkZJRy5jYWxjdWxhdGVTdG9yYWdlKHZhbHVlcyk7CiAgY29uc3QgdG90YWxDYXBhY2l0eSA9IGlzRmluaXRlKHNwYWNlRm9yR2FtZXMpID8gc3BhY2VGb3JHYW1lcyA6IDA7CgogIC8vIFVwZGF0ZSBDVEEgd2FybmluZyBpZiBleGNlZWRzIGNhcGFjaXR5CiAgY29uc3QgY3RhVXBsb2FkID0gJCgnY3RhVXBsb2FkJyk7CiAgaWYgKGN0YVVwbG9hZCkgewogICAgaWYgKHRvdGFsQ2FwYWNpdHkgPiAwICYmIGdiID4gdG90YWxDYXBhY2l0eSkgewogICAgICBjdGFVcGxvYWQuY2xhc3NMaXN0LmFkZCgnd2FybmluZycpOwogICAgICAkKCdjdGFUZXh0JykudGV4dENvbnRlbnQgPSAnRXhjZWVkcyBMaW1pdCEnOwogICAgfSBlbHNlIHsKICAgICAgY3RhVXBsb2FkLmNsYXNzTGlzdC5yZW1vdmUoJ3dhcm5pbmcnKTsKICAgICAgJCgnY3RhVGV4dCcpLnRleHRDb250ZW50ID0gJ1VwbG9hZCc7CiAgICB9CiAgfQoKICAvLyBVcGRhdGUgc3BhY2UgZGlzcGxheQogIGNvbnN0IHNwYWNlRWwgPSAkKCdzcGFjZScpOwogIGlmIChzcGFjZUVsKSBzcGFjZUVsLnRleHRDb250ZW50ID0gdG90YWxDYXBhY2l0eTsKCiAgLy8gQ2FsY3VsYXRlIHN0b3JhZ2UgYnJlYWtkb3duCiAgY29uc3QgdXNlZFNwYWNlID0gMDsgLy8gQ291bGQgYmUgY2FsY3VsYXRlZCBmcm9tIGV4aXN0aW5nIHNlbGVjdGlvbnMgb3IgY29uZmlnCiAgY29uc3Qgc2VsZWN0ZWRTcGFjZSA9IGdiOwogIGNvbnN0IGZyZWVTcGFjZSA9IE1hdGgubWF4KDAsIHRvdGFsQ2FwYWNpdHkgLSBzZWxlY3RlZFNwYWNlIC0gdXNlZFNwYWNlKTsKCiAgLy8gVXBkYXRlIGxlZ2VuZCB2YWx1ZXMKICBjb25zdCB1c2VkU3BhY2VFbCA9ICQoJ3VzZWRTcGFjZScpOwogIGlmICh1c2VkU3BhY2VFbCkgdXNlZFNwYWNlRWwudGV4dENvbnRlbnQgPSB1c2VkU3BhY2UudG9GaXhlZCgwKTsKCiAgY29uc3QgZnJlZVNwYWNlRWwgPSAkKCdmcmVlU3BhY2UnKTsKICBpZiAoZnJlZVNwYWNlRWwpIGZyZWVTcGFjZUVsLnRleHRDb250ZW50ID0gZnJlZVNwYWNlLnRvRml4ZWQoMSk7CgogIC8vIFVwZGF0ZSBwcm9ncmVzcyBiYXIKICBjb25zdCBwcm9ncmVzc1VzZWQgPSAkKCdwcm9ncmVzc1VzZWQnKTsKICBjb25zdCBwcm9ncmVzc1NlbGVjdGVkID0gJCgncHJvZ3Jlc3NTZWxlY3RlZCcpOwoKICBpZiAodG90YWxDYXBhY2l0eSA+IDApIHsKICAgIGNvbnN0IHVzZWRQZXJjZW50ID0gKHVzZWRTcGFjZSAvIHRvdGFsQ2FwYWNpdHkpICogMTAwOwogICAgY29uc3Qgc2VsZWN0ZWRQZXJjZW50ID0gTWF0aC5taW4oKHNlbGVjdGVkU3BhY2UgLyB0b3RhbENhcGFjaXR5KSAqIDEwMCwgMTAwIC0gdXNlZFBlcmNlbnQpOwoKICAgIGlmIChwcm9ncmVzc1VzZWQpIHByb2dyZXNzVXNlZC5zdHlsZS53aWR0aCA9IGAke3VzZWRQZXJjZW50fSVgOwogICAgaWYgKHByb2dyZXNzU2VsZWN0ZWQpIHByb2dyZXNzU2VsZWN0ZWQuc3R5bGUud2lkdGggPSBgJHtzZWxlY3RlZFBlcmNlbnR9JWA7CiAgfSBlbHNlIHsKICAgIGlmIChwcm9ncmVzc1VzZWQpIHByb2dyZXNzVXNlZC5zdHlsZS53aWR0aCA9ICcwJSc7CiAgICBpZiAocHJvZ3Jlc3NTZWxlY3RlZCkgcHJvZ3Jlc3NTZWxlY3RlZC5zdHlsZS53aWR0aCA9ICcwJSc7CiAgfQoKICAvLyBIaWdobGlnaHQgaWYgb3ZlciBjYXBhY2l0eQogIGlmIChnYiA+IHRvdGFsQ2FwYWNpdHkgJiYgdG90YWxDYXBhY2l0eSA+IDApIHsKICAgIGlmIChzZWxlY3RlZFNpemVFbCkgewogICAgICBzZWxlY3RlZFNpemVFbC5zdHlsZS5jb2xvciA9ICd2YXIoLS1kYW5nZXIpJzsKICAgICAgc2VsZWN0ZWRTaXplRWwuc3R5bGUuZm9udFdlaWdodCA9ICdib2xkJzsKICAgIH0KICAgIGlmIChzZWxlY3RlZFNpemVEaXNwbGF5KSB7CiAgICAgIHNlbGVjdGVkU2l6ZURpc3BsYXkuc3R5bGUuY29sb3IgPSAndmFyKC0tZGFuZ2VyKSc7CiAgICB9CiAgfSBlbHNlIHsKICAgIGlmIChzZWxlY3RlZFNpemVFbCkgewogICAgICBzZWxlY3RlZFNpemVFbC5zdHlsZS5jb2xvciA9ICcnOwogICAgICBzZWxlY3RlZFNpemVFbC5zdHlsZS5mb250V2VpZ2h0ID0gJyc7CiAgICB9CiAgICBpZiAoc2VsZWN0ZWRTaXplRGlzcGxheSkgewogICAgICBzZWxlY3RlZFNpemVEaXNwbGF5LnN0eWxlLmNvbG9yID0gJyc7CiAgICB9CiAgfQoKICB1cGRhdGVGaWxlbmFtZVByZXZpZXcoKTsKICB1cGRhdGVDVEFCdXR0b24oKTsKfQoKZnVuY3Rpb24gdXBkYXRlRmlsZW5hbWVQcmV2aWV3KCkgewogIGNvbnN0IGN1c3RvbWVyID0gKCQoJ2N1c3RvbWVyJykudmFsdWUgfHwgJ2N1c3RvbWVyJykudHJpbSgpLnJlcGxhY2UoL1teYS16QS1aMC05XS9nLCdfJykudG9Mb3dlckNhc2UoKTsKICBjb25zdCB2YWx1ZXMgPSBnZXRDb250cm9sVmFsdWVzKCk7CiAgY29uc3QgdG9rZW5zID0gW2N1c3RvbWVyXTsKICAKICBDT05GSUcuc3RvcmFnZUNvbnRyb2xzLmZvckVhY2goY3RybCA9PiB7CiAgICBpZiAoY3RybC5maWxlbmFtZVRva2VuKSB7CiAgICAgIGNvbnN0IHZhbCA9IHZhbHVlc1tjdHJsLmlkXSB8fCBjdHJsLmRlZmF1bHQ7CiAgICAgIGNvbnN0IHRva2VuID0gY3RybC5maWxlbmFtZVRva2VuID09PSB0cnVlID8gdmFsIDogKGN0cmwuZmlsZW5hbWVUb2tlbiArIHZhbCk7CiAgICAgIHRva2Vucy5wdXNoKHRva2VuKTsKICAgIH0KICB9KTsKICAKICBjb25zdCBub3cgPSBuZXcgRGF0ZSgpOwogIGNvbnN0IHN0YW1wID0gbm93LmdldEZ1bGxZZWFyKCkudG9TdHJpbmcoKSArCiAgICBTdHJpbmcobm93LmdldE1vbnRoKCkgKyAxKS5wYWRTdGFydCgyLCAnMCcpICsKICAgIFN0cmluZyhub3cuZ2V0RGF0ZSgpKS5wYWRTdGFydCgyLCAnMCcpICsKICAgIFN0cmluZyhub3cuZ2V0SG91cnMoKSkucGFkU3RhcnQoMiwgJzAnKSArCiAgICBTdHJpbmcobm93LmdldE1pbnV0ZXMoKSkucGFkU3RhcnQoMiwgJzAnKSArCiAgICBTdHJpbmcobm93LmdldFNlY29uZHMoKSkucGFkU3RhcnQoMiwgJzAnKTsKICB0b2tlbnMucHVzaChzdGFtcCk7CiAgCiAgJCgnZmlsZW5hbWVQcmV2aWV3JykudGV4dENvbnRlbnQgPSB0b2tlbnMuam9pbignXycpICsgQ09ORklHLmNsaWVudEZpbGVFeHQ7Cn0KCmZ1bmN0aW9uIGRlYm91bmNlKGZuLG1zPTIwMCl7IGxldCBoOyByZXR1cm4gKC4uLmEpPT57IGNsZWFyVGltZW91dChoKTsgaD1zZXRUaW1lb3V0KCgpPT5mbiguLi5hKSxtcyk7IH07IH0KCmZ1bmN0aW9uIHNtYXJ0U2VhcmNoKGl0ZW1zLCBxdWVyeSkgewogIGlmICghcXVlcnkgfHwgIXF1ZXJ5LnRyaW0oKSkgcmV0dXJuIGl0ZW1zOwogIAogIGNvbnN0IHEgPSBxdWVyeS50b0xvd2VyQ2FzZSgpLnRyaW0oKTsKICAKICAvLyBQYXJzZSBzZWFyY2ggdGVybXM6IHN1cHBvcnQgcXVvdGVzIGZvciBleGFjdCBwaHJhc2VzCiAgY29uc3QgdGVybXMgPSBbXTsKICBjb25zdCBxdW90ZVJlZ2V4ID0gLyIoW14iXSspInwnKFteJ10rKSd8KFxTKykvZzsKICBsZXQgbWF0Y2g7CiAgCiAgd2hpbGUgKChtYXRjaCA9IHF1b3RlUmVnZXguZXhlYyhxKSkgIT09IG51bGwpIHsKICAgIGNvbnN0IHRlcm0gPSAobWF0Y2hbMV0gfHwgbWF0Y2hbMl0gfHwgbWF0Y2hbM10pLnRvTG93ZXJDYXNlKCk7CiAgICB0ZXJtcy5wdXNoKHRlcm0pOwogIH0KICAKICBpZiAodGVybXMubGVuZ3RoID09PSAwKSByZXR1cm4gaXRlbXM7CiAgCiAgLy8gRmlsdGVyIGl0ZW1zOiBBTEwgdGVybXMgbXVzdCBtYXRjaCAoQU5EIGxvZ2ljKQogIHJldHVybiBpdGVtcy5maWx0ZXIoaXRlbSA9PiB7CiAgICBjb25zdCBzZWFyY2hUZXh0ID0gKGl0ZW0ubmFtZSB8fCAnJykudG9Mb3dlckNhc2UoKQogICAgICAucmVwbGFjZSgvW15cd1xzXS9nLCAnICcpOyAvLyBSZW1vdmUgcHVuY3R1YXRpb24gZm9yIG1hdGNoaW5nCiAgICAKICAgIHJldHVybiB0ZXJtcy5ldmVyeSh0ZXJtID0+IHNlYXJjaFRleHQuaW5jbHVkZXModGVybSkpOwogIH0pOwp9CgovLyBBdXRvLWJsdXIgc2VhcmNoIG9uIG1vYmlsZSBhZnRlciB0eXBpbmcgc3RvcHMKbGV0IHNlYXJjaEJsdXJUaW1lciA9IG51bGw7CiQoJ3NlYXJjaCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgZGVib3VuY2UoKGUpPT57CiAgY29uc3QgcSA9IGUudGFyZ2V0LnZhbHVlIHx8ICcnOwogIGNvbnN0IGZpbHRlcmVkID0gc21hcnRTZWFyY2goc3RhdGUuaXRlbXMsIHEpOwogIHJlbmRlckxpc3QoZmlsdGVyZWQpOwoKICAvLyBPbiBtb2JpbGUsIGF1dG8taGlkZSBrZXlib2FyZCBhZnRlciAyIHNlY29uZHMgb2Ygbm8gdHlwaW5nCiAgaWYgKGlzTW9iaWxlKSB7CiAgICBjbGVhclRpbWVvdXQoc2VhcmNoQmx1clRpbWVyKTsKICAgIHNlYXJjaEJsdXJUaW1lciA9IHNldFRpbWVvdXQoKCkgPT4gewogICAgICBpZiAoZG9jdW1lbnQuYWN0aXZlRWxlbWVudCA9PT0gJCgnc2VhcmNoJykpIHsKICAgICAgICAkKCdzZWFyY2gnKS5ibHVyKCk7CiAgICAgIH0KICAgIH0sIDIwMDApOwogIH0KfSwgMTgwKSk7CgovLyBTdG9yZSBzZWFyY2ggcXVlcnkgZm9yIHVzZSBpbiByZW5kZXJpbmcKbGV0IGN1cnJlbnRTZWFyY2hRdWVyeSA9ICcnOwoKJCgnY2xlYXJTZWFyY2gnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpPT57ICQoJ3NlYXJjaCcpLnZhbHVlPScnOyByZW5kZXJMaXN0KHN0YXRlLml0ZW1zKTsgfSk7CgpDT05GSUcuc3RvcmFnZUNvbnRyb2xzLmZvckVhY2goY3RybCA9PiB7CiAgY29uc3QgaWQgPSBjdHJsLmlkOwogIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgKCkgPT4gewogICAgY29uc3QgZWwgPSAkKGlkKTsKICAgIGlmKGVsKXsKICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoKSA9PiB1cGRhdGVGaWxlbmFtZVByZXZpZXcoKSk7CiAgICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsICgpID0+IHVwZGF0ZVRvdGFscygpKTsKICAgIH0KICB9KTsKfSk7CgokKCdjdXN0b21lcicpLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgKCkgPT4gdXBkYXRlRmlsZW5hbWVQcmV2aWV3KCkpOwoKZnVuY3Rpb24gcGFyc2VGaWxlbmFtZVRvQ29uZmlnKGZuKSB7CiAgY29uc3QgYmFzZSA9IGZuLnJlcGxhY2UobmV3IFJlZ0V4cChgXFwke0NPTkZJRy5jbGllbnRGaWxlRXh0fXxcXCR7Q09ORklHLmFkbWluRmlsZUV4dH18XFwuKHR4dCkkYCwgJ2knKSwgJycpOwogIGNvbnN0IHBhcnRzID0gYmFzZS5zcGxpdCgnXycpOwogIGlmIChwYXJ0cy5sZW5ndGggPCAyKSByZXR1cm4gbnVsbDsKICAKICBjb25zdCBjb25maWcgPSB7IGN1c3RvbWVyOiBwYXJ0c1swXSB9OwogIAogIENPTkZJRy5zdG9yYWdlQ29udHJvbHMuZm9yRWFjaChjdHJsID0+IHsKICAgIGlmIChjdHJsLmZpbGVuYW1lVG9rZW4pIHsKICAgICAgY29uc3QgcGF0dGVybiA9IGN0cmwuZmlsZW5hbWVUb2tlbiA9PT0gdHJ1ZSAKICAgICAgICA/IGBeKCR7Y3RybC5vcHRpb25zLm1hcChvID0+IG8udmFsdWUpLmpvaW4oJ3wnKX0pJGAKICAgICAgICA6IGBeJHtjdHJsLmZpbGVuYW1lVG9rZW59XFxkKyRgOwogICAgICBjb25zdCByZWdleCA9IG5ldyBSZWdFeHAocGF0dGVybik7CiAgICAgIAogICAgICBwYXJ0cy5mb3JFYWNoKHAgPT4gewogICAgICAgIGlmIChyZWdleC50ZXN0KHApKSB7CiAgICAgICAgICBjb25maWdbY3RybC5pZF0gPSBjdHJsLmZpbGVuYW1lVG9rZW4gPT09IHRydWUgPyBwIDogcC5yZXBsYWNlKGN0cmwuZmlsZW5hbWVUb2tlbiwgJycpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgfSk7CiAgCiAgcmV0dXJuIGNvbmZpZzsKfQoKJCgnZmlsZUluJykuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgKGV2KT0+ewogIGNvbnN0IGYgPSBldi50YXJnZXQuZmlsZXNbMF07IAogIGlmKCFmKSByZXR1cm47IAogIAogIGNvbnN0IGNmZyA9IHBhcnNlRmlsZW5hbWVUb0NvbmZpZyhmLm5hbWUpOyAKICBpZihjZmcpeyAKICAgICQoJ2N1c3RvbWVyJykudmFsdWUgPSBjZmcuY3VzdG9tZXIgfHwgJyc7CiAgICBDT05GSUcuc3RvcmFnZUNvbnRyb2xzLmZvckVhY2goY3RybCA9PiB7CiAgICAgIGNvbnN0IGVsID0gJChjdHJsLmlkKTsKICAgICAgaWYgKGVsICYmIGNmZ1tjdHJsLmlkXSkgewogICAgICAgIGlmIChjdHJsLnR5cGUgPT09ICdzZWxlY3QnKSB7CiAgICAgICAgICBBcnJheS5mcm9tKGVsLm9wdGlvbnMpLmZvckVhY2gobyA9PiB7CiAgICAgICAgICAgIGlmIChvLnZhbHVlID09PSBjZmdbY3RybC5pZF0pIG8uc2VsZWN0ZWQgPSB0cnVlOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9CiAgICB9KTsKICAgIHVwZGF0ZUZpbGVuYW1lUHJldmlldygpOyAKICAgIHVwZGF0ZVRvdGFscygpOwogIH0KICAKICBjb25zdCByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpOyAKICByZWFkZXIub25sb2FkID0gKGUpPT57IAogICAgY29uc3QgbGluZXMgPSBlLnRhcmdldC5yZXN1bHQuc3BsaXQoJ1xuJykubWFwKHM9PnMudHJpbSgpKS5maWx0ZXIoQm9vbGVhbik7IAogICAgc3RhdGUuc2VsZWN0ZWQ9W107IAogICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLml0ZW0nKS5mb3JFYWNoKGk9PmkuY2xhc3NMaXN0LnJlbW92ZSgnc2VsZWN0ZWQnKSk7CiAgICAKICAgIGxpbmVzLmZvckVhY2godGl0bGU9PnsgCiAgICAgIGNvbnN0IGxlZnQgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5pdGVtJykpLmZpbmQoaT0+aS5kYXRhc2V0Lm5hbWU9PT10aXRsZSk7IAogICAgICBpZihsZWZ0KXsgCiAgICAgICAgbGVmdC5jbGFzc0xpc3QuYWRkKCdzZWxlY3RlZCcpOyAKICAgICAgICBzdGF0ZS5zZWxlY3RlZC5wdXNoKHsgbmFtZTpsZWZ0LmRhdGFzZXQubmFtZSwgZmlsZW5hbWU6IGxlZnQuZGF0YXNldC5maWxlbmFtZSB8fCBsZWZ0LmRhdGFzZXQubmFtZSwgc2l6ZTpsZWZ0LmRhdGFzZXQuc2l6ZSB9KTsgCiAgICAgIH0gZWxzZSB7IAogICAgICAgIGNvbnN0IG1heWJlID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuaXRlbScpKS5maW5kKGk9PmkuZGF0YXNldC5uYW1lICYmIGkuZGF0YXNldC5uYW1lLnRvTG93ZXJDYXNlKCk9PT10aXRsZS50b0xvd2VyQ2FzZSgpKTsgCiAgICAgICAgaWYobWF5YmUpeyAKICAgICAgICAgIG1heWJlLmNsYXNzTGlzdC5hZGQoJ3NlbGVjdGVkJyk7IAogICAgICAgICAgc3RhdGUuc2VsZWN0ZWQucHVzaCh7IG5hbWU6bWF5YmUuZGF0YXNldC5uYW1lLCBmaWxlbmFtZTogbWF5YmUuZGF0YXNldC5maWxlbmFtZSB8fCBtYXliZS5kYXRhc2V0Lm5hbWUsIHNpemU6bWF5YmUuZGF0YXNldC5zaXplIH0pOyAKICAgICAgICB9IAogICAgICB9IAogICAgfSk7IAogICAgdXBkYXRlVG90YWxzKCk7IAogICAgcmVuZGVyT3ZlcmxheSgpOyAKICB9OwogIHJlYWRlci5yZWFkQXNUZXh0KGYpOwp9KTsKCiQoJ3NhdmVCdG4nKT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKT0+ewogIG5vdyA9IERhdGUubm93KCk7CiAgaWYgKG5vdyAtIGxhc3RFeHBvcnRUaW1lIDwgTUlOX0RFTEFZKSB7CiAgICB0b2FzdCgnUGxlYXNlIHdhaXQgYmVmb3JlIGV4cG9ydGluZyBhZ2FpbicpOwogICAgYWxlcnQoJ1BsZWFzZSB3YWl0IGJlZm9yZSBleHBvcnRpbmcgYWdhaW4nKTsKICAgIHJldHVybjsKICB9CiAgbGFzdEV4cG9ydFRpbWUgPSBub3c7CgogIGlmKHN0YXRlLnNlbGVjdGVkLmxlbmd0aD09PTApeyBhbGVydCgnTm8gaXRlbXMgc2VsZWN0ZWQnKTsgcmV0dXJuOyB9CiAgY29uc3QgY3VzdCA9ICgkKCdjdXN0b21lcicpLnZhbHVlfHwnJykudHJpbSgpOyAKICBpZighY3VzdCl7IGFsZXJ0KCdDdXN0b21lciBuYW1lIHJlcXVpcmVkJyk7IHJldHVybjsgfQogIGNvbnN0IGZpbGVuYW1lID0gJCgnZmlsZW5hbWVQcmV2aWV3JykudGV4dENvbnRlbnQgfHwgYGxpc3Qke0NPTkZJRy5jbGllbnRGaWxlRXh0fWA7CiAgY29uc3QgYmxvYiA9IG5ldyBCbG9iKFtzdGF0ZS5zZWxlY3RlZC5tYXAocz0+cy5uYW1lKS5qb2luKCdcbicpXSwgeyB0eXBlOid0ZXh0L3BsYWluJyB9KTsgCiAgY29uc3QgYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTsgCiAgYS5ocmVmID0gVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTsgCiAgYS5kb3dubG9hZCA9IGZpbGVuYW1lOyAKICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGEpOyAKICBhLmNsaWNrKCk7IAogIGEucmVtb3ZlKCk7IAogIFVSTC5yZXZva2VPYmplY3RVUkwoYS5ocmVmKTsgCiAgdG9hc3QoJ1NhdmVkIGNsaWVudCBmaWxlJyk7Cn0pOwoKJCgnYWRtaW5FeHBvcnQnKT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoKT0+ewogIG5vdyA9IERhdGUubm93KCk7CiAgaWYgKG5vdyAtIGxhc3RFeHBvcnRUaW1lIDwgTUlOX0RFTEFZKSB7CiAgICB0b2FzdCgnUGxlYXNlIHdhaXQgYmVmb3JlIGV4cG9ydGluZyBhZ2FpbicpOwogICAgYWxlcnQoJ1BsZWFzZSB3YWl0IGJlZm9yZSBleHBvcnRpbmcgYWdhaW4nKTsKICAgIHJldHVybjsKICB9CiAgbGFzdEV4cG9ydFRpbWUgPSBub3c7CgogIGlmKHN0YXRlLnNlbGVjdGVkLmxlbmd0aD09PTApeyBhbGVydCgnTm8gaXRlbXMgc2VsZWN0ZWQnKTsgcmV0dXJuOyB9CiAgY29uc3QgY3VzdCA9ICgkKCdjdXN0b21lcicpLnZhbHVlfHwnJykudHJpbSgpOyAKICBpZighY3VzdCl7IGFsZXJ0KCdDdXN0b21lciBuYW1lIHJlcXVpcmVkJyk7IHJldHVybjsgfQogIAogIHRyeXsgCiAgICBjb25zdCB4bWx0eHQgPSBhd2FpdCBmZXRjaChDT05GSUcueG1sRmlsZSkudGhlbihyPT5yLnRleHQoKSk7IAogICAgY29uc3QgeG1sID0gbmV3IERPTVBhcnNlcigpLnBhcnNlRnJvbVN0cmluZyh4bWx0eHQsJ2FwcGxpY2F0aW9uL3htbCcpOyAKICAgIGxldCBjb250ZW50PScnOyAKICAgIAogICAgaWYgKENPTkZJRy5zdHJ1Y3R1cmVUeXBlID09PSAnZm9sZGVycycpIHsKICAgICAgc3RhdGUuc2VsZWN0ZWQuZm9yRWFjaChzZWw9PnsgCiAgICAgICAgY29uc3QgZm9sZGVyID0gQXJyYXkuZnJvbSh4bWwucXVlcnlTZWxlY3RvckFsbCgnZm9sZGVyJykpLmZpbmQoZj0+Zi5nZXRBdHRyaWJ1dGUoJ25hbWUnKT09PXNlbC5uYW1lKTsgCiAgICAgICAgaWYoZm9sZGVyKXsgCiAgICAgICAgICBmb2xkZXIucXVlcnlTZWxlY3RvckFsbCgnZmlsZScpLmZvckVhY2goZmlsZT0+IAogICAgICAgICAgICBjb250ZW50ICs9IGAke0NPTkZJRy5hZG1pbkJhc2VQYXRofSR7Zm9sZGVyLmdldEF0dHJpYnV0ZSgnbmFtZScpfVxcJHtmaWxlLmdldEF0dHJpYnV0ZSgnbmFtZScpfVxuYAogICAgICAgICAgKTsgCiAgICAgICAgfSAKICAgICAgfSk7CiAgICB9IGVsc2UgewogICAgICBzdGF0ZS5zZWxlY3RlZC5mb3JFYWNoKHNlbD0+eyAKICAgICAgICBjb25zdCBmaWxlbmFtZSA9IHNlbC5maWxlbmFtZSB8fCBzZWwubmFtZTsKICAgICAgICBjb250ZW50ICs9IGAke0NPTkZJRy5hZG1pbkJhc2VQYXRofSR7ZmlsZW5hbWV9XG5gOwogICAgICB9KTsKICAgIH0KICAgIAogICAgY29uc3Qgbm93ID0gbmV3IERhdGUoKTsgCiAgICBjb25zdCBzdGFtcCA9IGAke25vdy5nZXRGdWxsWWVhcigpfSR7U3RyaW5nKG5vdy5nZXRNb250aCgpKzEpLnBhZFN0YXJ0KDIsJzAnKX0ke1N0cmluZyhub3cuZ2V0RGF0ZSgpKS5wYWRTdGFydCgyLCcwJyl9XyR7U3RyaW5nKG5vdy5nZXRIb3VycygpKS5wYWRTdGFydCgyLCcwJyl9JHtTdHJpbmcobm93LmdldE1pbnV0ZXMoKSkucGFkU3RhcnQoMiwnMCcpfWA7IAogICAgY29uc3QgZm5hbWUgPSBgJHsoY3VzdHx8J2N1c3RvbWVyJykucmVwbGFjZSgvW15hLXpBLVowLTldL2csJ18nKX1fJHtzdGFtcH0ke0NPTkZJRy5hZG1pbkZpbGVFeHR9YDsgCiAgICBjb25zdCBibG9iID0gbmV3IEJsb2IoW2NvbnRlbnRdLCB7IHR5cGU6J3RleHQvcGxhaW4nIH0pOyAKICAgIGNvbnN0IGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7IAogICAgYS5ocmVmID0gVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTsgCiAgICBhLmRvd25sb2FkID0gZm5hbWU7IAogICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChhKTsgCiAgICBhLmNsaWNrKCk7IAogICAgYS5yZW1vdmUoKTsgCiAgICBVUkwucmV2b2tlT2JqZWN0VVJMKGEuaHJlZik7IAogICAgdG9hc3QoJ0FkbWluIGV4cG9ydCByZWFkeScpOyAKICB9Y2F0Y2goZSl7IAogICAgY29uc29sZS5lcnJvcihlKTsgCiAgICB0b2FzdCgnQWRtaW4gZXhwb3J0IGZhaWxlZCcpOyAKICB9Cn0pOwoKYXN5bmMgZnVuY3Rpb24gZG9VcGxvYWQoKSB7CiAgaWYoc3RhdGUuc2VsZWN0ZWQubGVuZ3RoPT09MCl7IGFsZXJ0KCdObyBpdGVtcyBzZWxlY3RlZCcpOyByZXR1cm47IH0KICBjb25zdCBjdXN0ID0gKCQoJ2N1c3RvbWVyJykudmFsdWV8fCcnKS50cmltKCk7CiAgaWYoIWN1c3QpeyBhbGVydCgnQ3VzdG9tZXIgcmVxdWlyZWQnKTsgcmV0dXJuOyB9CiAgaWYoIWNvbmZpcm0oYFVwbG9hZCBsaXN0IGZvciAke2N1c3R9P2ApKSByZXR1cm47CgogIGNvbnN0IGZpbGVuYW1lID0gJCgnZmlsZW5hbWVQcmV2aWV3JykudGV4dENvbnRlbnQgfHwgYGxpc3Qke0NPTkZJRy5jbGllbnRGaWxlRXh0fWA7CiAgY29uc3QgYmxvYiA9IG5ldyBCbG9iKFtzdGF0ZS5zZWxlY3RlZC5tYXAocz0+cy5uYW1lKS5qb2luKCdcbicpXSwgeyB0eXBlOid0ZXh0L3BsYWluJyB9KTsKICBjb25zdCBub3cgPSBEYXRlLm5vdygpOwogIGlmKG5vdyAtIHN0YXRlLmxhc3RVcGxvYWQgPCAxNTAwMCl7IGFsZXJ0KCdQbGVhc2Ugd2FpdCAxNSBzZWNvbmRzIGJldHdlZW4gdXBsb2FkcycpOyByZXR1cm47IH0KCiAgdHJ5ewogICAgY29uc3QgdXJsID0gYGh0dHBzOi8vZmlsZWJpbi5uZXQvJHtDT05GSUcuZmlsZWJpbkJ1Y2tldH0vJHtmaWxlbmFtZX1gOwogICAgY29uc3QgciA9IGF3YWl0IGZldGNoKHVybCx7IG1ldGhvZDonUE9TVCcsIGhlYWRlcnM6eyAnQ29udGVudC1UeXBlJzondGV4dC9wbGFpbicgfSwgYm9keTogYmxvYiB9KTsKCiAgICBpZihyLm9rIHx8IHIuc3RhdHVzPT09MjAxKXsKICAgICAgc3RhdGUubGFzdFVwbG9hZCA9IG5vdzsKICAgICAgJCgnc2hhcmVhYmxlJykudmFsdWUgPSBgaHR0cHM6Ly9maWxlYmluLm5ldC8ke0NPTkZJRy5maWxlYmluQnVja2V0fS8ke2ZpbGVuYW1lfWA7CiAgICAgIHRvYXN0KCdVcGxvYWRlZCB0byBmaWxlYmluJyk7CiAgICAgIHNob3dCYW5uZXIoIlVwbG9hZCBDb21wbGV0ZSAtIFByZXNzIENvcHkgTGluayBhbmQgc2VuZCBpdCB0byBvdXIgY2hhdCIpOwoKICAgICAgY29uc3QgY29uZmlnU2VjdGlvbiA9ICQoJ2NvbmZpZ1NlY3Rpb24nKTsKICAgICAgY29uc3QgdG9nZ2xlQnRuID0gJCgndG9nZ2xlQ29uZmlnJyk7CiAgICAgIGlmIChjb25maWdTZWN0aW9uICYmIHRvZ2dsZUJ0biAmJiBjb25maWdTZWN0aW9uLmNsYXNzTGlzdC5jb250YWlucygnYWN0aXZlJykpIHsKICAgICAgICBjb25maWdTZWN0aW9uLmNsYXNzTGlzdC5yZW1vdmUoJ2FjdGl2ZScpOwogICAgICAgIHRvZ2dsZUJ0bi50ZXh0Q29udGVudCA9ICdTaG93IENvbmZpZ3VyYXRpb24nOwogICAgICB9CiAgICAgIHJldHVybjsKICAgIH0KICB9Y2F0Y2goZSl7CiAgICBjb25zb2xlLndhcm4oJ2ZpbGViaW4gZXJyb3InLCBlKTsKICB9CgogIHRyeXsKICAgIGNvbnN0IGZvcm0gPSBuZXcgRm9ybURhdGEoKTsKICAgIGZvcm0uYXBwZW5kKCdmaWxlJywgYmxvYiwgZmlsZW5hbWUpOwogICAgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2goJ2h0dHBzOi8vdXBsb2FkLmdvZmlsZS5pby91cGxvYWRGaWxlJywgeyBtZXRob2Q6J1BPU1QnLCBib2R5OiBmb3JtIH0pOwogICAgY29uc3QgaiA9IGF3YWl0IHJlcy5qc29uKCk7CiAgICBpZihqLnN0YXR1cyA9PT0gJ29rJyl7CiAgICAgIHN0YXRlLmxhc3RVcGxvYWQgPSBub3c7CiAgICAgICQoJ3NoYXJlYWJsZScpLnZhbHVlID0gai5kYXRhLmRvd25sb2FkUGFnZTsKICAgICAgdG9hc3QoJ1VwbG9hZGVkIHRvIEdvRmlsZScpOwogICAgICByZXR1cm47CiAgICB9CiAgICB0b2FzdCgnVXBsb2FkIGZhaWxlZCcpOwogIH1jYXRjaChlKXsKICAgIGNvbnNvbGUuZXJyb3IoZSk7CiAgICB0b2FzdCgnVXBsb2FkIGVycm9yJyk7CiAgfQp9CgokKCd1cGxvYWRCdG4nKT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBkb1VwbG9hZCk7CgpsZXQgYmluTGlzdFBhZ2UgPSAwOwpjb25zdCBiaW5MaXN0UGFnZVNpemUgPSAxMDsKbGV0IGNhY2hlZEJpbkZpbGVzID0gbnVsbDsKCiQoJ2Jpbkxpc3QnKT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoKSA9PiB7CiAgdHJ5IHsKICAgIGNvbnN0IHIgPSBhd2FpdCBmZXRjaChgaHR0cHM6Ly9maWxlYmluLm5ldC8ke0NPTkZJRy5maWxlYmluQnVja2V0fT9qc29uYCwgewogICAgICBoZWFkZXJzOiB7ICJBY2NlcHQiOiAiYXBwbGljYXRpb24vanNvbiIgfQogICAgfSk7CiAgICBpZiAoIXIub2spIHsgdG9hc3QoYEZhaWxlZCB0byBmZXRjaCB1cGxvYWRzOiAke3Iuc3RhdHVzVGV4dH1gKTsgcmV0dXJuOyB9CgogICAgbGV0IGo7CiAgICB0cnkgewogICAgICBqID0gYXdhaXQgci5qc29uKCk7CiAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgdG9hc3QoIkZhaWxlZCB0byBwYXJzZSBzZXJ2ZXIgcmVzcG9uc2UiKTsKICAgICAgY29uc29sZS5lcnJvcihlcnIpOwogICAgICByZXR1cm47CiAgICB9CgogICAgaWYgKCFqLmZpbGVzIHx8ICFqLmZpbGVzLmxlbmd0aCkgeyB0b2FzdCgnTm8gZmlsZXMgZm91bmQnKTsgcmV0dXJuOyB9CgogICAgLy8gPT09PT09PT09PSBBREQgVEhFU0UgMyBMSU5FUyA9PT09PT09PT09CiAgICBjb25zdCBwbGF0Zm9ybUZpbGVzID0gai5maWxlcy5maWx0ZXIoZmlsZSA9PiAKICAgICAgZmlsZS5maWxlbmFtZS5lbmRzV2l0aChDT05GSUcuY2xpZW50RmlsZUV4dCkKICAgICk7CiAgICAKICAgIGlmIChwbGF0Zm9ybUZpbGVzLmxlbmd0aCA9PT0gMCkgewogICAgICB0b2FzdChgTm8gJHtDT05GSUcucGxhdGZvcm0gfHwgJ3BsYXRmb3JtJ30gZmlsZXMgZm91bmRgKTsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IHNvcnRlZCA9IHBsYXRmb3JtRmlsZXMuc29ydCgoYSxiKT0+IG5ldyBEYXRlKGIudXBkYXRlZF9hdCkgLSBuZXcgRGF0ZShhLnVwZGF0ZWRfYXQpKTsKICAgIC8vID09PT09PT09PT0gQ0hBTkdFIFRISVMgTElORSA9PT09PT09PT09CiAgICAvLyBPTEQ6IGNvbnN0IHNvcnRlZCA9IGouZmlsZXMuc29ydCguLi4pCiAgICAvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09CiAgICAKICAgIGNhY2hlZEJpbkZpbGVzID0gc29ydGVkOwogICAgYmluTGlzdFBhZ2UgPSAwOwogICAgcmVuZGVyQmluTGlzdCgpOwogIH0gY2F0Y2ggKGUpIHsKICAgIGNvbnNvbGUuZXJyb3IoZSk7CiAgICB0b2FzdCgnRXJyb3IgZmV0Y2hpbmcgdXBsb2FkcycpOwogIH0KfSk7CgpmdW5jdGlvbiByZW5kZXJCaW5MaXN0KCkgewogIGlmICghY2FjaGVkQmluRmlsZXMpIHJldHVybjsKICAKICBjb25zdCBzdGFydCA9IGJpbkxpc3RQYWdlICogYmluTGlzdFBhZ2VTaXplOwogIGNvbnN0IGVuZCA9IHN0YXJ0ICsgYmluTGlzdFBhZ2VTaXplOwogIGNvbnN0IHBhZ2VGaWxlcyA9IGNhY2hlZEJpbkZpbGVzLnNsaWNlKHN0YXJ0LCBlbmQpOwogIGNvbnN0IGhhc01vcmUgPSBlbmQgPCBjYWNoZWRCaW5GaWxlcy5sZW5ndGg7CiAgCiAgbGV0IGh0bWwgPSAnPGRpdiBzdHlsZT0iZGlzcGxheTpmbGV4O2p1c3RpZnktY29udGVudDpzcGFjZS1iZXR3ZWVuO2FsaWduLWl0ZW1zOmxlZnQ7bWFyZ2luLWJvdHRvbTo4cHg7Ij4nOwogIGh0bWwgKz0gJzxidXR0b24gaWQ9ImNsb3NlQmluIiBjbGFzcz0iYnRuIGdob3N0IiBzdHlsZT0icGFkZGluZzo0cHggOHB4OyI+Q2xvc2U8L2J1dHRvbj4nOwogIGh0bWwgKz0gYDxzdHJvbmc+UmVjZW50IFVwbG9hZHM8L3N0cm9uZz5gOwogIGh0bWwgKz0gJzwvZGl2Pic7CiAgCiAgaHRtbCArPSAnPGRpdiBzdHlsZT0iZGlzcGxheTpmbGV4O2dhcDo4cHg7bWFyZ2luLWJvdHRvbTo4cHg7Ij4nOwogIGh0bWwgKz0gYDxidXR0b24gaWQ9InByZXZQYWdlIiBjbGFzcz0iYnRuIGdob3N0IiBzdHlsZT0icGFkZGluZzo0cHggOHB4O2ZsZXg6MTsiICR7YmluTGlzdFBhZ2UgPT09IDAgPyAnZGlzYWJsZWQnIDogJyd9PlByZXY8L2J1dHRvbj5gOwogIGh0bWwgKz0gYDxzcGFuIHN0eWxlPSJkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2ZvbnQtc2l6ZToxMnB4O2NvbG9yOiM2YjcyODA7Ij5QYWdlICR7YmluTGlzdFBhZ2UgKyAxfTwvc3Bhbj5gOwogIGh0bWwgKz0gYDxidXR0b24gaWQ9Im5leHRQYWdlIiBjbGFzcz0iYnRuIGdob3N0IiBzdHlsZT0icGFkZGluZzo0cHggOHB4O2ZsZXg6MTsiICR7IWhhc01vcmUgPyAnZGlzYWJsZWQnIDogJyd9Pk5leHQ8L2J1dHRvbj5gOwogIGh0bWwgKz0gJzwvZGl2Pic7CiAgCiAgaHRtbCArPSAnPHVsIHN0eWxlPSJtYXJnaW46MDtwYWRkaW5nLWxlZnQ6MjBweDsiPic7CiAgcGFnZUZpbGVzLmZvckVhY2goZmlsZSA9PiB7CiAgICBjb25zdCBmaWxlVXJsID0gYGh0dHBzOi8vZmlsZWJpbi5uZXQvJHtDT05GSUcuZmlsZWJpbkJ1Y2tldH0vJHtlbmNvZGVVUklDb21wb25lbnQoZmlsZS5maWxlbmFtZSl9YDsKICAgIGNvbnN0IGFkZGVkRGF0ZSA9IG5ldyBEYXRlKGZpbGUudXBkYXRlZF9hdCk7CiAgICBjb25zdCBmb3JtYXR0ZWREYXRlID0gYWRkZWREYXRlLnRvSVNPU3RyaW5nKCkuc2xpY2UoMCwxMCkucmVwbGFjZSgvLS9nLCcnKTsKICAgIGNvbnN0IGhvdXJzID0gYWRkZWREYXRlLmdldEhvdXJzKCk7CiAgICBjb25zdCBtaW51dGVzID0gYWRkZWREYXRlLmdldE1pbnV0ZXMoKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsJzAnKTsKICAgIGNvbnN0IGFtcG0gPSBob3VycyA+PSAxMiA/ICdQTSc6J0FNJzsKICAgIGNvbnN0IGZvcm1hdHRlZFRpbWUgPSBgJHtob3VycyAlIDEyIHx8IDEyfToke21pbnV0ZXN9ICR7YW1wbX1gOwogICAgY29uc3Qgc3RyaXBwZWROYW1lID0gZmlsZS5maWxlbmFtZS5zcGxpdCgnLicpLnNsaWNlKDAsLTEpLmpvaW4oJy4nKTsKICAgIGNvbnN0IGZpbGVTaXplID0gZmlsZS5ieXRlc19yZWFkYWJsZSB8fCAnJzsKICAgIGh0bWwgKz0gYDxsaSBzdHlsZT0ibWFyZ2luLWJvdHRvbTo0cHg7IGZvbnQtc2l6ZTogMTJweDsiPjxhIGhyZWY9IiR7ZmlsZVVybH0iIHRhcmdldD0iX2JsYW5rIiBzdHlsZT0idGV4dC1kZWNvcmF0aW9uOm5vbmU7Y29sb3I6IzAzNjZkNjsiPiR7Zm9ybWF0dGVkRGF0ZX0gJHtmb3JtYXR0ZWRUaW1lfSB8ICR7c3RyaXBwZWROYW1lfSB8ICR7ZmlsZVNpemV9PC9hPjwvbGk+YDsKICB9KTsKICBodG1sICs9ICc8L3VsPic7CgogIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmaWxlTGlzdENvbnRhaW5lcicpOwogIGNvbnRhaW5lci5pbm5lckhUTUwgPSBodG1sOwogIGNvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsKICBjb250YWluZXIuc3R5bGUuYmFja2dyb3VuZCA9ICcjZjlmYWZiJzsKICBjb250YWluZXIuc3R5bGUucGFkZGluZyA9ICcxMnB4JzsKICBjb250YWluZXIuc3R5bGUuYm9yZGVyUmFkaXVzID0gJzhweCc7CiAgY29udGFpbmVyLnN0eWxlLmJvcmRlciA9ICcxcHggc29saWQgI2U1ZTdlYic7CiAgY29udGFpbmVyLnN0eWxlLm1hcmdpblRvcCA9ICc4cHgnOwogICAgY29udGFpbmVyLnN0eWxlLm92ZXJmbG93WSA9ICdhdXRvJzsKY29udGFpbmVyLnN0eWxlLm92ZXJmbG93WCA9ICdoaWRkZW4nOyAgIC8vIG9yICdhdXRvJyBpZiB5b3UgcHJlZmVyIGhvcml6b250YWwgc2Nyb2xsCmNvbnRhaW5lci5zdHlsZS5tYXhIZWlnaHQgPSAnMzAwcHgnOyAgICAvLyBzZXQgd2hhdGV2ZXIgZml4ZWQgaGVpZ2h0IHlvdSB3YW50CgogIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjbG9zZUJpbicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewogICAgY29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICBiaW5MaXN0UGFnZSA9IDA7CiAgICBjYWNoZWRCaW5GaWxlcyA9IG51bGw7CiAgfSk7CiAgCiAgY29uc3QgcHJldkJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwcmV2UGFnZScpOwogIGlmIChwcmV2QnRuICYmIGJpbkxpc3RQYWdlID4gMCkgewogICAgcHJldkJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICAgICAgYmluTGlzdFBhZ2UtLTsKICAgICAgcmVuZGVyQmluTGlzdCgpOwogICAgfSk7CiAgfQogIAogIGNvbnN0IG5leHRCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmV4dFBhZ2UnKTsKICBpZiAobmV4dEJ0biAmJiBoYXNNb3JlKSB7CiAgICBuZXh0QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewogICAgICBiaW5MaXN0UGFnZSsrOwogICAgICByZW5kZXJCaW5MaXN0KCk7CiAgICB9KTsKICB9Cn0KCiQoJ3NlYXJjaCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCAoZXYpID0+IHsKICBpZiAoZXYua2V5ID09PSAnRW50ZXInKSB7CiAgICBldi5wcmV2ZW50RGVmYXVsdCgpOwogICAgCiAgICBjb25zdCB2aXNpYmxlSXRlbXMgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5pdGVtJykpCiAgICAgIC5maWx0ZXIoZWwgPT4gZWwub2Zmc2V0UGFyZW50ICE9PSBudWxsKTsgLy8gT25seSB2aXNpYmxlIGl0ZW1zCiAgICAKICAgIC8vIENhbGN1bGF0ZSB3aGF0IHdvdWxkIGJlIGFkZGVkCiAgICBjb25zdCB0b0FkZCA9IHZpc2libGVJdGVtcy5maWx0ZXIoZWwgPT4gewogICAgICBjb25zdCBuYW1lID0gZWwuZGF0YXNldC5uYW1lOwogICAgICByZXR1cm4gIXN0YXRlLnNlbGVjdGVkLnNvbWUocyA9PiBzLm5hbWUgPT09IG5hbWUpOwogICAgfSk7CiAgICAKICAgIGlmICh0b0FkZC5sZW5ndGggPT09IDApIHsKICAgICAgdG9hc3QoJ0FsbCB2aXNpYmxlIGl0ZW1zIGFscmVhZHkgc2VsZWN0ZWQnKTsKICAgICAgcmV0dXJuOwogICAgfQogICAgCiAgICAvLyBDYWxjdWxhdGUgdG90YWwgc2l6ZSBvZiBpdGVtcyB0byBiZSBhZGRlZAogICAgbGV0IHRvdGFsQnl0ZXMgPSAwOwogICAgdG9BZGQuZm9yRWFjaChlbCA9PiB7CiAgICAgIHRvdGFsQnl0ZXMgKz0gcGFyc2VTaXplVGV4dChlbC5kYXRhc2V0LnNpemUpOwogICAgfSk7CiAgICBjb25zdCB0b3RhbEdCID0gYnl0ZXNUb0dCKHRvdGFsQnl0ZXMpLnRvRml4ZWQoMik7CiAgICAKICAgIC8vIENvbmZpcm1hdGlvbiBkaWFsb2cKICAgIGNvbnN0IGNvbmZpcm1lZCA9IGNvbmZpcm0oCiAgICAgIGBBZGQgJHt0b0FkZC5sZW5ndGh9IGdhbWUke3RvQWRkLmxlbmd0aCAhPT0gMSA/ICdzJyA6ICcnfSBmcm9tIHNlYXJjaCByZXN1bHRzP1xuXG5gICsKICAgICAgYFRvdGFsIHNpemU6ICR7dG90YWxHQn0gR0JcblxuYCArCiAgICAgIGBQcmVzcyBPSyB0byBhZGQgdGhlc2UgaXRlbXMuYAogICAgKTsKICAgIAogICAgaWYgKCFjb25maXJtZWQpIHsKICAgICAgdG9hc3QoJ0FkZCBjYW5jZWxsZWQnKTsKICAgICAgcmV0dXJuOwogICAgfQogICAgCiAgICAvLyBBZGQgdGhlIGl0ZW1zCiAgICBsZXQgYWRkZWQgPSAwOwogICAgdG9BZGQuZm9yRWFjaChlbCA9PiB7CiAgICAgIGNvbnN0IG5hbWUgPSBlbC5kYXRhc2V0Lm5hbWU7CiAgICAgIGNvbnN0IHNpemUgPSBlbC5kYXRhc2V0LnNpemU7CiAgICAgIGNvbnN0IGZpbGVuYW1lID0gZWwuZGF0YXNldC5maWxlbmFtZSB8fCBuYW1lOwogICAgICBzdGF0ZS5zZWxlY3RlZC5wdXNoKHsgbmFtZSwgZmlsZW5hbWUsIHNpemUgfSk7CiAgICAgIGVsLmNsYXNzTGlzdC5hZGQoJ3NlbGVjdGVkJyk7CiAgICAgIGFkZGVkKys7CiAgICB9KTsKICAgIAogICAgaWYgKGFkZGVkID4gMCkgewogICAgICB1cGRhdGVUb3RhbHMoKTsKICAgICAgcmVuZGVyT3ZlcmxheSgpOwogICAgICB0b2FzdChgQWRkZWQgJHthZGRlZH0gaXRlbSR7YWRkZWQgIT09IDEgPyAncycgOiAnJ30gKCR7dG90YWxHQn0gR0IpYCk7CiAgICB9CiAgfQp9KTsKCiQoJ2NvcHlMaW5rJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7CiAgY29uc3QgY3VzdCA9ICgkKCdjdXN0b21lcicpLnZhbHVlfHwnJykudHJpbSgpOyAKICBpZighY3VzdCl7IGFsZXJ0KCdDdXN0b21lciBuYW1lIHJlcXVpcmVkJyk7IHJldHVybjsgfQogIAogIGNvbnN0IHJhd0xpbmsgPSAkKCdzaGFyZWFibGUnKS52YWx1ZS50cmltKCk7CiAgY29uc3QgbGluayA9IHJhd0xpbmsKICAgIC5yZXBsYWNlKC9eaHR0cHM/OlwvXC8vLCAnaHh4cGNmZicpCiAgICAucmVwbGFjZSgvXC4vZywgJ19kb3RfJyk7CgogIGNvbnN0IHRpdGxlc0FyciA9IHN0YXRlLnNlbGVjdGVkLm1hcChzID0+IHMubmFtZSk7CgogIGlmICh0aXRsZXNBcnIubGVuZ3RoID09PSAwKSB7CiAgICB0b2FzdCgnTm8gc2VsZWN0ZWQgbGlzdCB0byBjb3B5Jyk7CiAgICBhbGVydCgnTm8gc2VsZWN0ZWQgbGlzdCB0byBjb3B5Jyk7CiAgICByZXR1cm47CiAgfQoKICBjb25zdCB0b3RhbEJ5dGVzID0gc3RhdGUuc2VsZWN0ZWQucmVkdWNlKChzdW0sIHMpID0+IHN1bSArIHBhcnNlU2l6ZVRleHQocy5zaXplKSwgMCk7CiAgY29uc3QgdG90YWxHQiA9ICh0b3RhbEJ5dGVzIC8gKDEwMjQgKiogMykpLnRvRml4ZWQoMik7CiAgY29uc3QgY291bnQgPSB0aXRsZXNBcnIubGVuZ3RoOwoKICBjb25zdCBjdXN0b21lciA9ICgkKCdjdXN0b21lcicpLnZhbHVlIHx8ICcnKS50cmltKCkgfHwgJ1Vua25vd24gY3VzdG9tZXInOwogIGNvbnN0IGZpbGVuYW1lID0gJCgnZmlsZW5hbWVQcmV2aWV3JykudGV4dENvbnRlbnQgfHwgYGxpc3Qke0NPTkZJRy5jbGllbnRGaWxlRXh0fWA7CgogIGNvbnN0IG5vdyA9IG5ldyBEYXRlKCk7CiAgY29uc3Qgc3RhbXAgPSBub3cudG9Mb2NhbGVTdHJpbmcoJ2VuLVVTJywgewogICAgeWVhcjogJ251bWVyaWMnLCBtb250aDogJzItZGlnaXQnLCBkYXk6ICcyLWRpZ2l0JywKICAgIGhvdXI6ICcyLWRpZ2l0JywgbWludXRlOiAnMi1kaWdpdCcsIHNlY29uZDogJzItZGlnaXQnCiAgfSk7CgogIGxldCBsaW5rVG9Vc2UgPSBsaW5rOwoKICBpZiAoIWxpbmspIHsKICAgIGNvbnN0IGFzayA9IGNvbmZpcm0oCiAgICAgIGBObyBsaW5rIGZvdW5kLlxuXG5gICsKICAgICAgYExpc3QgY29udGFpbnMgJHtjb3VudH0gaXRlbXMgdG90YWxpbmcgJHt0b3RhbEdCfSBHQi5cblxuYCArCiAgICAgIGBXb3VsZCB5b3UgbGlrZSB0byB1cGxvYWQgbm93P2AKICAgICk7CgogICAgaWYgKGFzaykgewogICAgICAkKCd1cGxvYWRCdG4nKS5jbGljaygpOwogICAgICBzaG93QmFubmVyKCJVcGxvYWRpbmfigKZcblxuUGxlYXNlIHdhaXQgZm9yIHRoZSBsaW5rIHRvIGFwcGVhciwgdGhlbiBwcmVzcyBDb3B5IGFnYWluLiIpOwogICAgICB0b2FzdCgiVXBsb2FkaW5n4oCmIHdhaXQgZm9yIGxpbmssIHRoZW4gcHJlc3MgQ29weSBhZ2FpbiIpOwogICAgICByZXR1cm47CiAgICB9CgogICAgbGlua1RvVXNlID0gJyhObyBsaW5rIHVwbG9hZGVkKSc7CiAgfQoKICBjb25zdCBzdW1tYXJ5ID0KICAgIGBDdXN0b21lcjogJHtjdXN0b21lcn1cbmAgKwogICAgYEZpbGVuYW1lOiAke2ZpbGVuYW1lfVxuYCArCiAgICBgUXVhbnRpdHk6ICR7Y291bnR9IGl0ZW1zXG5gICsKICAgIGBUb3RhbCBTaXplOiAke3RvdGFsR0J9IEdCXG5gICsKICAgIGBHZW5lcmF0ZWQ6ICR7c3RhbXB9XG5cbmAgKwogICAgYCR7bGlua1RvVXNlfVxuXG5gOwoKICBjb25zdCBmaW5hbFRleHQgPSBzdW1tYXJ5ICsgdGl0bGVzQXJyLmpvaW4oJ1xuJyk7CgogIGxldCBtZXNzYWdlID0gbGluawogICAgPyBgTGlzdCAmIGxpbmsgY29waWVkLiAoJHtjb3VudH0gaXRlbXMsICR7dG90YWxHQn0gR0IpYAogICAgOiBgTGlzdCBjb3BpZWQgKG5vIGxpbmspLiAoJHtjb3VudH0gaXRlbXMsICR7dG90YWxHQn0gR0IpYDsKCiAgbmF2aWdhdG9yLmNsaXBib2FyZC53cml0ZVRleHQoZmluYWxUZXh0KS50aGVuKCgpID0+IHsKICAgIHRvYXN0KG1lc3NhZ2UucmVwbGFjZSgvXG4vZywgJyAnKSk7CiAgICBhbGVydChtZXNzYWdlKTsKICB9KS5jYXRjaCgoKSA9PiB7CiAgICBhbGVydCgnQ29weSBmYWlsZWQsIHBsZWFzZSBjb3B5IG1hbnVhbGx5Jyk7CiAgfSk7Cn0pOwoKZnVuY3Rpb24gcmVuZGVyU2VsZWN0ZWRQYW5lbCgpIHsKICBjb25zdCBib2R5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NlbGVjdGVkUGFuZWxCb2R5Jyk7CiAgaWYgKCFib2R5KSByZXR1cm47CgogIGJvZHkuaW5uZXJIVE1MID0gJyc7CgogIGlmIChzdGF0ZS5zZWxlY3RlZC5sZW5ndGggPT09IDApIHsKICAgIGJvZHkuaW5uZXJIVE1MID0gJzxkaXYgc3R5bGU9InBhZGRpbmc6MjBweDt0ZXh0LWFsaWduOmNlbnRlcjtjb2xvcjp2YXIoLS1tdXRlZCk7Zm9udC1zaXplOjEzcHgiPk5vIGdhbWVzIHNlbGVjdGVkIHlldDwvZGl2Pic7CiAgICByZXR1cm47CiAgfQoKICBzdGF0ZS5zZWxlY3RlZC5mb3JFYWNoKChzLCBpKSA9PiB7CiAgICBjb25zdCByb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICAgIHJvdy5jbGFzc05hbWUgPSAnc2VsZWN0ZWQtaXRlbSc7CgogICAgY29uc3Qgc2l6ZURpc3BsYXkgPSBmb3JtYXRTaXplVG9HQihzLnNpemUpOwogICAgY29uc3QgaWNvblVybCA9IGdldEljb25Vcmwocy5uYW1lKTsKCiAgICByb3cuaW5uZXJIVE1MID0gYAogICAgICA8ZGl2IGNsYXNzPSJzZWxlY3RlZC1pdGVtLXRodW1iIj4KICAgICAgICAke2ljb25VcmwgPyBgPGltZyBzcmM9IiR7aWNvblVybH0iIGFsdD0iIiBzdHlsZT0id2lkdGg6MTAwJTtoZWlnaHQ6MTAwJTtvYmplY3QtZml0OmNvdmVyO2JvcmRlci1yYWRpdXM6NnB4Ij5gIDogJzxzcGFuIHN0eWxlPSJmb250LXNpemU6MThweCI+8J+Orjwvc3Bhbj4nfQogICAgICA8L2Rpdj4KICAgICAgPGRpdiBjbGFzcz0ic2VsZWN0ZWQtaXRlbS1jb250ZW50Ij4KICAgICAgICA8ZGl2IGNsYXNzPSJzZWxlY3RlZC1pdGVtLXRpdGxlIj4ke2VzYyhzLm5hbWUpfTwvZGl2PgogICAgICA8L2Rpdj4KICAgICAgPGRpdiBjbGFzcz0ic2VsZWN0ZWQtaXRlbS1zaXplIj4ke3NpemVEaXNwbGF5fTwvZGl2PgogICAgICA8ZGl2IGNsYXNzPSJzZWxlY3RlZC1pdGVtLWNoZWNrIj48c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2IiB2aWV3Qm94PSIwIDAgMjQgMjQiIGZpbGw9Im5vbmUiIHN0cm9rZT0iY3VycmVudENvbG9yIiBzdHJva2Utd2lkdGg9IjMiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCI+PHBvbHlsaW5lIHBvaW50cz0iMjAgNiA5IDE3IDQgMTIiLz48L3N2Zz48L2Rpdj4KICAgICAgPGRpdiBjbGFzcz0ic2VsZWN0ZWQtaXRlbS1hY3Rpb25zIj4KICAgICAgICA8YnV0dG9uIGNsYXNzPSJ1cCI+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMiIgaGVpZ2h0PSIxMiIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyLjUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCI+PHBhdGggZD0iTTE4IDE1bC02LTYtNiA2Ii8+PC9zdmc+PC9idXR0b24+CiAgICAgICAgPGJ1dHRvbiBjbGFzcz0iZG93biI+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMiIgaGVpZ2h0PSIxMiIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9ImN1cnJlbnRDb2xvciIgc3Ryb2tlLXdpZHRoPSIyLjUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCI+PHBhdGggZD0iTTYgOWw2IDYgNi02Ii8+PC9zdmc+PC9idXR0b24+CiAgICAgICAgPGJ1dHRvbiBjbGFzcz0icmVtb3ZlIj48c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjEyIiBoZWlnaHQ9IjEyIiB2aWV3Qm94PSIwIDAgMjQgMjQiIGZpbGw9Im5vbmUiIHN0cm9rZT0iY3VycmVudENvbG9yIiBzdHJva2Utd2lkdGg9IjIuNSIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIj48bGluZSB4MT0iMTgiIHkxPSI2IiB4Mj0iNiIgeTI9IjE4Ii8+PGxpbmUgeDE9IjYiIHkxPSI2IiB4Mj0iMTgiIHkyPSIxOCIvPjwvc3ZnPjwvYnV0dG9uPgogICAgICA8L2Rpdj4KICAgIGA7CgogICAgcm93LnF1ZXJ5U2VsZWN0b3IoJy51cCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewogICAgICBpZiAoaSA+IDApIHsKICAgICAgICBbc3RhdGUuc2VsZWN0ZWRbaSAtIDFdLCBzdGF0ZS5zZWxlY3RlZFtpXV0gPSBbc3RhdGUuc2VsZWN0ZWRbaV0sIHN0YXRlLnNlbGVjdGVkW2kgLSAxXV07CiAgICAgICAgcmVuZGVyT3ZlcmxheSgpOwogICAgICAgIHJlbmRlckxpc3Qoc3RhdGUuaXRlbXMpOwogICAgICAgIHVwZGF0ZVRvdGFscygpOwogICAgICB9CiAgICB9KTsKCiAgICByb3cucXVlcnlTZWxlY3RvcignLmRvd24nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICAgICAgaWYgKGkgPCBzdGF0ZS5zZWxlY3RlZC5sZW5ndGggLSAxKSB7CiAgICAgICAgW3N0YXRlLnNlbGVjdGVkW2kgKyAxXSwgc3RhdGUuc2VsZWN0ZWRbaV1dID0gW3N0YXRlLnNlbGVjdGVkW2ldLCBzdGF0ZS5zZWxlY3RlZFtpICsgMV1dOwogICAgICAgIHJlbmRlck92ZXJsYXkoKTsKICAgICAgICByZW5kZXJMaXN0KHN0YXRlLml0ZW1zKTsKICAgICAgICB1cGRhdGVUb3RhbHMoKTsKICAgICAgfQogICAgfSk7CgogICAgcm93LnF1ZXJ5U2VsZWN0b3IoJy5yZW1vdmUnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICAgICAgc3RhdGUuc2VsZWN0ZWQuc3BsaWNlKGksIDEpOwogICAgICByZW5kZXJPdmVybGF5KCk7CiAgICAgIHJlbmRlckxpc3Qoc3RhdGUuaXRlbXMpOwogICAgICB1cGRhdGVUb3RhbHMoKTsKICAgIH0pOwoKICAgIGJvZHkuYXBwZW5kQ2hpbGQocm93KTsKICB9KTsKfQoKY29uc3QgdG9nZ2xlQnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3RvZ2dsZUNvbmZpZycpOwpjb25zdCBjb25maWdTZWN0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvbmZpZ1NlY3Rpb24nKTsKCmlmIChpc01vYmlsZSAmJiB0b2dnbGVCdG4gJiYgY29uZmlnU2VjdGlvbikgewogIGNvbmZpZ1NlY3Rpb24uY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7CiAgdG9nZ2xlQnRuLnRleHRDb250ZW50ID0gJ0hpZGUgQ29uZmlndXJhdGlvbic7CgogIHRvZ2dsZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsKICAgIGNvbnN0IGlzVmlzaWJsZSA9IGNvbmZpZ1NlY3Rpb24uY2xhc3NMaXN0LnRvZ2dsZSgnYWN0aXZlJyk7CiAgICB0b2dnbGVCdG4udGV4dENvbnRlbnQgPSBpc1Zpc2libGUgPyAnSGlkZSBDb25maWd1cmF0aW9uJyA6ICdTaG93IENvbmZpZ3VyYXRpb24nOwogIH0pOwp9CgpmdW5jdGlvbiBwYXJzZURhdGVGbGV4aWJsZShzKSB7CiAgaWYgKCFzKSByZXR1cm4gbnVsbDsKICBsZXQgZCA9IG5ldyBEYXRlKHMpOwogIGlmICghaXNOYU4oZC5nZXRUaW1lKCkpKSByZXR1cm4gZDsKCiAgY29uc3QgeW1kID0gKCcnK3MpLm1hdGNoKC8oXGR7NH0pXEQ/KFxkezEsMn0pXEQ/KFxkezEsMn0pLyk7CiAgaWYgKHltZCkgewogICAgZCA9IG5ldyBEYXRlKE51bWJlcih5bWRbMV0pLCBOdW1iZXIoeW1kWzJdKSAtIDEsIE51bWJlcih5bWRbM10pKTsKICAgIGlmICghaXNOYU4oZC5nZXRUaW1lKCkpKSByZXR1cm4gZDsKICB9CgogIGNvbnN0IGRteSA9ICgnJytzKS5tYXRjaCgvKFxkezEsMn0pXEQoXGR7MSwyfSlcRChcZHs0fSkvKTsKICBpZiAoZG15KSB7CiAgICBkID0gbmV3IERhdGUoTnVtYmVyKGRteVszXSksIE51bWJlcihkbXlbMl0pIC0gMSwgTnVtYmVyKGRteVsxXSkpOwogICAgaWYgKCFpc05hTihkLmdldFRpbWUoKSkpIHJldHVybiBkOwogIH0KCiAgcmV0dXJuIG51bGw7Cn0KCi8vIFNvcnQgZnVuY3Rpb25hbGl0eSBtb3ZlZCB0byBnZW5yZSBmaWx0ZXIgYmFyCgpmdW5jdGlvbiBkZXRlY3RFbnZpcm9ubWVudCgpIHsKICBjb25zdCB1YSA9IG5hdmlnYXRvci51c2VyQWdlbnQgfHwgbmF2aWdhdG9yLnZlbmRvciB8fCB3aW5kb3cub3BlcmE7CiAgY29uc3QgaXNNZXNzZW5nZXIgPSAvRkJBTnxGQkFWfEZCX0lBQnxNZXNzZW5nZXIvaS50ZXN0KHVhKTsKICBjb25zdCBpc0luc3RhZ3JhbSA9IC9JbnN0YWdyYW0vaS50ZXN0KHVhKTsKICBjb25zdCBpc1dlYlZpZXcgPSAvXGJ3dlxiLy50ZXN0KHVhKSB8fCAod2luZG93Lm5hdmlnYXRvci5zdGFuZGFsb25lID09PSBmYWxzZSk7CgogIGlmIChpc01lc3NlbmdlciB8fCBpc0luc3RhZ3JhbSB8fCBpc1dlYlZpZXcpIHsKICAgIHNob3dCYW5uZXIoIk1lc3NlbmdlciBvciBpbi1hcHAgd2VidmlldyBkZXRlY3RlZC5cblRoaXMgcGFnZSBpcyBiZXN0IHVzZWQgb24gYSBmdWxsIG1vYmlsZSBicm93c2VyIG9yIGRlc2t0b3AgYnJvd3NlciwgYnV0IGl0IHdpbGwgcHJvYmFibHkgd29yayBhbnl3YXkiLCA0MDAwKTsKICB9CiAgc2hvd0Jhbm5lcigiSG93IHRvIHVzZTpcblxuMS4gRW50ZXIgeW91ciBuYW1lXG4yLiBTZWxlY3QgeW91ciBkZXZpY2UgbW9kZWwgKE9MRUQvTGl0ZS9WMS9WMilcbjMuIFNlbGVjdCB5b3VyIFNEIENhcmQgU2l6ZVxuNC4gQ2hvb3NlIHlvdXIgZ2FtZXNcbjUuIFByZXNzIFVwbG9hZFxuNi4gU2VuZCB0aGUgZ2VuZXJhdGVkIGxpbmsgdG8gb3VyIGNoYXQgY29udmVyc2F0aW9uIiwgODAwMCk7Cn0KCmZ1bmN0aW9uIHNob3dCYW5uZXIobWVzc2FnZSwgZHVyYXRpb24gPSA0MDAwKSB7CiAgY29uc3QgYmFubmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7CiAgYmFubmVyLmlubmVyVGV4dCA9IG1lc3NhZ2U7CiAgYmFubmVyLnN0eWxlLmNzc1RleHQgPSAicG9zaXRpb246Zml4ZWQ7dG9wOjMwJTtsZWZ0OjUwJTt0cmFuc2Zvcm06dHJhbnNsYXRlWCgtNTAlKTtiYWNrZ3JvdW5kOnJnYmEoMCwwLDAsMC44KTtjb2xvcjojZmZmO3BhZGRpbmc6MThweDtib3JkZXItcmFkaXVzOjE2cHg7Zm9udC1zaXplOjIycHg7ei1pbmRleDo5OTk5O2JveC1zaGFkb3c6MCAycHggNnB4IHJnYmEoMCwwLDAsMC4zKTt0cmFuc2l0aW9uOm9wYWNpdHkgMC41cyBlYXNlO3doaXRlLXNwYWNlOnByZS1saW5lO21heC13aWR0aDo4MCUiOwogIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoYmFubmVyKTsKCiAgc2V0VGltZW91dCgoKSA9PiBiYW5uZXIuc3R5bGUub3BhY2l0eSA9ICIwIiwgZHVyYXRpb24pOwogIHNldFRpbWVvdXQoKCkgPT4gYmFubmVyLnJlbW92ZSgpLCBkdXJhdGlvbiArIDUwMCk7Cn0KCmZ1bmN0aW9uIGxldmVuc2h0ZWluRGlzdGFuY2Uoc3RyMSwgc3RyMikgewogIGNvbnN0IGxlbjEgPSBzdHIxLmxlbmd0aDsKICBjb25zdCBsZW4yID0gc3RyMi5sZW5ndGg7CiAgY29uc3QgbWF0cml4ID0gQXJyYXkobGVuMiArIDEpLmZpbGwobnVsbCkubWFwKCgpID0+IEFycmF5KGxlbjEgKyAxKS5maWxsKDApKTsKICAKICBmb3IgKGxldCBpID0gMDsgaSA8PSBsZW4xOyBpKyspIG1hdHJpeFswXVtpXSA9IGk7CiAgZm9yIChsZXQgaiA9IDA7IGogPD0gbGVuMjsgaisrKSBtYXRyaXhbal1bMF0gPSBqOwogIAogIGZvciAobGV0IGogPSAxOyBqIDw9IGxlbjI7IGorKykgewogICAgZm9yIChsZXQgaSA9IDE7IGkgPD0gbGVuMTsgaSsrKSB7CiAgICAgIGNvbnN0IGNvc3QgPSBzdHIxW2kgLSAxXSA9PT0gc3RyMltqIC0gMV0gPyAwIDogMTsKICAgICAgbWF0cml4W2pdW2ldID0gTWF0aC5taW4oCiAgICAgICAgbWF0cml4W2pdW2kgLSAxXSArIDEsCiAgICAgICAgbWF0cml4W2ogLSAxXVtpXSArIDEsCiAgICAgICAgbWF0cml4W2ogLSAxXVtpIC0gMV0gKyBjb3N0CiAgICAgICk7CiAgICB9CiAgfQogIAogIHJldHVybiBtYXRyaXhbbGVuMl1bbGVuMV07Cn0KCmZ1bmN0aW9uIG5vcm1hbGl6ZVRpdGxlKHRpdGxlKSB7CiAgcmV0dXJuIHRpdGxlLnRvTG93ZXJDYXNlKCkKICAgIC5yZXBsYWNlKC9bXlx3XHNdL2csICcgJykgIC8vIFJlbW92ZSBwdW5jdHVhdGlvbgogICAgLnJlcGxhY2UoL1xzKy9nLCAnICcpICAgICAgLy8gQ29sbGFwc2Ugc3BhY2VzCiAgICAudHJpbSgpOwp9CgpmdW5jdGlvbiBnZXRLZXl3b3Jkcyh0aXRsZSkgewogIGNvbnN0IG5vcm1hbGl6ZWQgPSBub3JtYWxpemVUaXRsZSh0aXRsZSk7CiAgLy8gRmlsdGVyIG91dCBjb21tb24gd29yZHMKICBjb25zdCBzdG9wV29yZHMgPSBbJ3RoZScsICdvZicsICdhbmQnLCAnYScsICdhbicsICdpbicsICdvbicsICdmb3InLCAndG8nLCAnd2l0aCddOwogIHJldHVybiBub3JtYWxpemVkLnNwbGl0KCcgJykuZmlsdGVyKHdvcmQgPT4gd29yZC5sZW5ndGggPiAwICYmICFzdG9wV29yZHMuaW5jbHVkZXMod29yZCkpOwp9CgpmdW5jdGlvbiBleHRyYWN0TnVtYmVycyh0aXRsZSkgewogIGNvbnN0IG1hdGNoZXMgPSB0aXRsZS5tYXRjaCgvXGQrL2cpOwogIHJldHVybiBtYXRjaGVzID8gbWF0Y2hlcy5tYXAobiA9PiBuKSA6IFtdOwp9CgpmdW5jdGlvbiBjYWxjdWxhdGVNYXRjaFNjb3JlKHVzZXJUaXRsZSwgZGJUaXRsZSkgewogIGNvbnN0IHVzZXJLZXl3b3JkcyA9IGdldEtleXdvcmRzKHVzZXJUaXRsZSk7CiAgY29uc3QgZGJLZXl3b3JkcyA9IGdldEtleXdvcmRzKGRiVGl0bGUpOwogIAogIGlmICh1c2VyS2V5d29yZHMubGVuZ3RoID09PSAwKSByZXR1cm4geyBzY29yZTogMCwgbnVtYmVyTWF0Y2g6IGZhbHNlLCBjb25zZWN1dGl2ZU1hdGNoZXM6IDAgfTsKICAKICBsZXQgbWF0Y2hlZFdvcmRzID0gMDsKICBsZXQgcGFydGlhbE1hdGNoZXMgPSAwOwogIGxldCBjb25zZWN1dGl2ZU1hdGNoZXMgPSAwOwogIGxldCBsYXN0TWF0Y2hJbmRleCA9IC0yOwogIAogIC8vIENoZWNrIGZvciBudW1iZXIgbWF0Y2hpbmcKICBjb25zdCB1c2VyTnVtYmVycyA9IGV4dHJhY3ROdW1iZXJzKHVzZXJUaXRsZSk7CiAgY29uc3QgZGJOdW1iZXJzID0gZXh0cmFjdE51bWJlcnMoZGJUaXRsZSk7CiAgY29uc3QgaGFzRXhhY3ROdW1iZXJNYXRjaCA9IHVzZXJOdW1iZXJzLmxlbmd0aCA+IDAgJiYgCiAgICB1c2VyTnVtYmVycy5ldmVyeShudW0gPT4gZGJOdW1iZXJzLmluY2x1ZGVzKG51bSkpOwogIAogIHVzZXJLZXl3b3Jkcy5mb3JFYWNoKCh1c2VyV29yZCwgaWR4KSA9PiB7CiAgICBsZXQgbWF0Y2hlZCA9IGZhbHNlOwogICAgCiAgICAvLyBDaGVjayBmb3IgZXhhY3Qgd29yZCBtYXRjaAogICAgY29uc3QgZXhhY3RJZHggPSBkYktleXdvcmRzLmZpbmRJbmRleChkYldvcmQgPT4gZGJXb3JkID09PSB1c2VyV29yZCk7CiAgICBpZiAoZXhhY3RJZHggIT09IC0xKSB7CiAgICAgIG1hdGNoZWRXb3JkcyArPSAxOwogICAgICBtYXRjaGVkID0gdHJ1ZTsKICAgICAgCiAgICAgIC8vIFRyYWNrIGNvbnNlY3V0aXZlIG1hdGNoZXMKICAgICAgaWYgKGV4YWN0SWR4ID09PSBsYXN0TWF0Y2hJbmRleCArIDEpIHsKICAgICAgICBjb25zZWN1dGl2ZU1hdGNoZXMrKzsKICAgICAgfQogICAgICBsYXN0TWF0Y2hJbmRleCA9IGV4YWN0SWR4OwogICAgICByZXR1cm47CiAgICB9CiAgICAKICAgIC8vIENoZWNrIGZvciBzdWJzdHJpbmcgbWF0Y2ggLSBidXQgcmVxdWlyZSBtaW5pbXVtIGxlbmd0aAogICAgLy8gQU5EIHRoZSB1c2VyIHdvcmQgbXVzdCBiZSBzdWJzdGFudGlhbCAoMysgY2hhcnMgZm9yIG1vc3QsIDQrIGZvciB2ZXJ5IGNvbW1vbiB3b3JkcykKICAgIGlmICh1c2VyV29yZC5sZW5ndGggPj0gMykgewogICAgICBjb25zdCBzdWJzdHJpbmdJZHggPSBkYktleXdvcmRzLmZpbmRJbmRleChkYldvcmQgPT4gewogICAgICAgIC8vIERCIHdvcmQgbXVzdCBiZSBsb25nIGVub3VnaCB0byBjb250YWluIHRoZSB1c2VyIHdvcmQgbWVhbmluZ2Z1bGx5CiAgICAgICAgaWYgKGRiV29yZC5sZW5ndGggPj0gdXNlcldvcmQubGVuZ3RoICsgMSAmJiBkYldvcmQuaW5jbHVkZXModXNlcldvcmQpKSB7CiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgICAgLy8gT3IgaWYgdXNlciB3b3JkIGlzIGxvbmdlciwgY2hlY2sgaWYgaXQgY29udGFpbnMgREIgd29yZCAoZm9yIGNvbXBvdW5kIHdvcmRzKQogICAgICAgIGlmICh1c2VyV29yZC5sZW5ndGggPj0gNCAmJiB1c2VyV29yZC5pbmNsdWRlcyhkYldvcmQpICYmIGRiV29yZC5sZW5ndGggPj0gMykgewogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfSk7CiAgICAgIAogICAgICBpZiAoc3Vic3RyaW5nSWR4ICE9PSAtMSkgewogICAgICAgIC8vIEdpdmUgaGlnaGVyIHNjb3JlIGZvciBsb25nZXIgbWF0Y2hlcwogICAgICAgIGNvbnN0IG1hdGNoU3RyZW5ndGggPSB1c2VyV29yZC5sZW5ndGggPj0gNCA/IDAuOCA6IDAuNjsKICAgICAgICBwYXJ0aWFsTWF0Y2hlcyArPSBtYXRjaFN0cmVuZ3RoOwogICAgICAgIG1hdGNoZWQgPSB0cnVlOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgfQogICAgCiAgICAvLyBDaGVjayBmb3IgdmVyeSBjbG9zZSB0eXBvIChzaW5nbGUgY2hhciBkaWZmZXJlbmNlKQogICAgLy8gT25seSBmb3Igd29yZHMgMysgY2hhcmFjdGVycwogICAgaWYgKHVzZXJXb3JkLmxlbmd0aCA+PSAzKSB7CiAgICAgIGRiS2V5d29yZHMuZm9yRWFjaChkYldvcmQgPT4gewogICAgICAgIGlmIChkYldvcmQubGVuZ3RoIDwgMykgcmV0dXJuOyAvLyBTa2lwIHNob3J0IHdvcmRzCiAgICAgICAgCiAgICAgICAgY29uc3QgbWF4TGVuID0gTWF0aC5tYXgodXNlcldvcmQubGVuZ3RoLCBkYldvcmQubGVuZ3RoKTsKICAgICAgICBjb25zdCBtaW5MZW4gPSBNYXRoLm1pbih1c2VyV29yZC5sZW5ndGgsIGRiV29yZC5sZW5ndGgpOwogICAgICAgIAogICAgICAgIC8vIE9ubHkgY29uc2lkZXIgaWYgbGVuZ3RocyBhcmUgc2ltaWxhcgogICAgICAgIGlmIChtYXhMZW4gLSBtaW5MZW4gPD0gMiAmJiBtaW5MZW4gPj0gMykgewogICAgICAgICAgY29uc3QgZGlzdGFuY2UgPSBsZXZlbnNodGVpbkRpc3RhbmNlKHVzZXJXb3JkLCBkYldvcmQpOwogICAgICAgICAgaWYgKGRpc3RhbmNlIDw9IDIpIHsKICAgICAgICAgICAgcGFydGlhbE1hdGNoZXMgKz0gMC41OwogICAgICAgICAgICBtYXRjaGVkID0gdHJ1ZTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0pOwogIAogIGNvbnN0IHRvdGFsTWF0Y2hlZCA9IG1hdGNoZWRXb3JkcyArIHBhcnRpYWxNYXRjaGVzOwogIGNvbnN0IHNjb3JlID0gdG90YWxNYXRjaGVkIC8gdXNlcktleXdvcmRzLmxlbmd0aDsKICAKICByZXR1cm4geyAKICAgIHNjb3JlLCAKICAgIG51bWJlck1hdGNoOiBoYXNFeGFjdE51bWJlck1hdGNoLAogICAgY29uc2VjdXRpdmVNYXRjaGVzLAogICAgdGl0bGVMZW5ndGg6IGRiS2V5d29yZHMubGVuZ3RoLAogICAgZXhhY3RXb3JkQ291bnQ6IG1hdGNoZWRXb3JkcyAgLy8gVHJhY2sgZXhhY3QgbWF0Y2hlcyBzZXBhcmF0ZWx5CiAgfTsKfQoKZnVuY3Rpb24gZmluZEJlc3RNYXRjaCh1c2VyVGl0bGUsIGRiSXRlbXMpIHsKICBjb25zdCBub3JtYWxpemVkID0gbm9ybWFsaXplVGl0bGUodXNlclRpdGxlKTsKICAKICAvLyBUcnkgZXhhY3QgbWF0Y2ggZmlyc3QKICBjb25zdCBleGFjdE1hdGNoID0gZGJJdGVtcy5maW5kKGl0ZW0gPT4gbm9ybWFsaXplVGl0bGUoaXRlbS5uYW1lKSA9PT0gbm9ybWFsaXplZCk7CiAgaWYgKGV4YWN0TWF0Y2gpIHsKICAgIHJldHVybiB7IG1hdGNoOiBleGFjdE1hdGNoLCBjb25maWRlbmNlOiAnZXhhY3QnLCBzY29yZTogMS4wIH07CiAgfQogIAogIC8vIFNjb3JlIGFsbCBpdGVtcwogIGNvbnN0IHNjb3JlZCA9IGRiSXRlbXMubWFwKGl0ZW0gPT4gewogICAgY29uc3QgbWF0Y2hEYXRhID0gY2FsY3VsYXRlTWF0Y2hTY29yZSh1c2VyVGl0bGUsIGl0ZW0ubmFtZSk7CiAgICByZXR1cm4gewogICAgICBpdGVtLAogICAgICAuLi5tYXRjaERhdGEKICAgIH07CiAgfSkuZmlsdGVyKHMgPT4gcy5zY29yZSA+IDApOwogIAogIGlmIChzY29yZWQubGVuZ3RoID09PSAwKSByZXR1cm4gbnVsbDsKICAKICAvLyBTb3J0IGJ5IHByaW9yaXR5OgogIC8vIDEuIE51bWJlciBtYXRjaCAoY3JpdGljYWwgZm9yIHNlcXVlbHMvdmVyc2lvbnMpCiAgLy8gMi4gRXhhY3Qgd29yZCBjb3VudCAocHJlZmVyIG1vcmUgZXhhY3QgbWF0Y2hlcykKICAvLyAzLiBTY29yZQogIC8vIDQuIENvbnNlY3V0aXZlIG1hdGNoZXMgKHdvcmQgb3JkZXIgbWF0dGVycykKICAvLyA1LiBTaG9ydGVyIHRpdGxlIChtb3JlIHByZWNpc2UpCiAgc2NvcmVkLnNvcnQoKGEsIGIpID0+IHsKICAgIC8vIFByaW9yaXR5IDE6IEV4YWN0IG51bWJlciBtYXRjaAogICAgaWYgKGEubnVtYmVyTWF0Y2ggJiYgIWIubnVtYmVyTWF0Y2gpIHJldHVybiAtMTsKICAgIGlmICghYS5udW1iZXJNYXRjaCAmJiBiLm51bWJlck1hdGNoKSByZXR1cm4gMTsKICAgIAogICAgLy8gUHJpb3JpdHkgMjogTW9yZSBleGFjdCB3b3JkIG1hdGNoZXMgd2lucwogICAgaWYgKGEuZXhhY3RXb3JkQ291bnQgIT09IGIuZXhhY3RXb3JkQ291bnQpIHsKICAgICAgcmV0dXJuIGIuZXhhY3RXb3JkQ291bnQgLSBhLmV4YWN0V29yZENvdW50OwogICAgfQogICAgCiAgICAvLyBQcmlvcml0eSAzOiBTY29yZSBkaWZmZXJlbmNlCiAgICBjb25zdCBzY29yZURpZmYgPSBiLnNjb3JlIC0gYS5zY29yZTsKICAgIGlmIChNYXRoLmFicyhzY29yZURpZmYpID4gMC4xNSkgcmV0dXJuIHNjb3JlRGlmZjsKICAgIAogICAgLy8gUHJpb3JpdHkgNDogQ29uc2VjdXRpdmUgbWF0Y2hlcyAocGhyYXNlIG1hdGNoaW5nKQogICAgaWYgKGEuY29uc2VjdXRpdmVNYXRjaGVzICE9PSBiLmNvbnNlY3V0aXZlTWF0Y2hlcykgewogICAgICByZXR1cm4gYi5jb25zZWN1dGl2ZU1hdGNoZXMgLSBhLmNvbnNlY3V0aXZlTWF0Y2hlczsKICAgIH0KICAgIAogICAgLy8gUHJpb3JpdHkgNTogUHJlZmVyIHNob3J0ZXIgdGl0bGVzCiAgICByZXR1cm4gYS50aXRsZUxlbmd0aCAtIGIudGl0bGVMZW5ndGg7CiAgfSk7CiAgCiAgY29uc3QgYmVzdCA9IHNjb3JlZFswXTsKICAKICAvLyBEZXRlcm1pbmUgY29uZmlkZW5jZSBiYXNlZCBvbiBzY29yZQogIGxldCBjb25maWRlbmNlOwogIGlmIChiZXN0LnNjb3JlID49IDAuOTUpIHsKICAgIGNvbmZpZGVuY2UgPSAnaGlnaCc7CiAgfSBlbHNlIGlmIChiZXN0LnNjb3JlID49IDAuNykgewogICAgY29uZmlkZW5jZSA9ICdtZWRpdW0nOwogIH0gZWxzZSBpZiAoYmVzdC5zY29yZSA+PSAwLjUpIHsKICAgIGNvbmZpZGVuY2UgPSAnbG93JzsKICB9IGVsc2UgewogICAgcmV0dXJuIG51bGw7IC8vIFRvbyBsb3cgY29uZmlkZW5jZQogIH0KICAKICByZXR1cm4geyBtYXRjaDogYmVzdC5pdGVtLCBjb25maWRlbmNlLCBzY29yZTogYmVzdC5zY29yZSB9Owp9CgpmdW5jdGlvbiBtYXRjaFVzZXJMaXN0KHVzZXJMaXN0KSB7CiAgY29uc3QgbGluZXMgPSB1c2VyTGlzdC5zcGxpdCgnXG4nKS5tYXAocyA9PiBzLnRyaW0oKSkuZmlsdGVyKEJvb2xlYW4pOwogIGNvbnN0IHJlc3VsdHMgPSB7CiAgICBleGFjdDogW10sCiAgICBoaWdoOiBbXSwKICAgIG1lZGl1bTogW10sCiAgICBsb3c6IFtdLAogICAgbm90Rm91bmQ6IFtdCiAgfTsKICAKICBsaW5lcy5mb3JFYWNoKHVzZXJUaXRsZSA9PiB7CiAgICBjb25zdCByZXN1bHQgPSBmaW5kQmVzdE1hdGNoKHVzZXJUaXRsZSwgc3RhdGUuaXRlbXMpOwogICAgCiAgICBpZiAoIXJlc3VsdCkgewogICAgICByZXN1bHRzLm5vdEZvdW5kLnB1c2godXNlclRpdGxlKTsKICAgIH0gZWxzZSB7CiAgICAgIHJlc3VsdHNbcmVzdWx0LmNvbmZpZGVuY2VdLnB1c2goewogICAgICAgIG9yaWdpbmFsOiB1c2VyVGl0bGUsCiAgICAgICAgbWF0Y2hlZDogcmVzdWx0Lm1hdGNoLm5hbWUsCiAgICAgICAgc2l6ZTogcmVzdWx0Lm1hdGNoLnNpemUsCiAgICAgICAgc2NvcmU6IHJlc3VsdC5zY29yZQogICAgICB9KTsKICAgIH0KICB9KTsKICAKICByZXR1cm4gcmVzdWx0czsKfQoKJCgnbWF0Y2hMaXN0Jyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gewogIGNvbnN0IG1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpbGVzTW9kYWwnKTsKICBtb2RhbC5pbm5lckhUTUwgPSAnJzsKICBtb2RhbC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsKICBtb2RhbC5zdHlsZS5tYXhXaWR0aCA9ICc2MDBweCc7CiAgCiAgY29uc3QgaGVhZGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgaGVhZGVyLmlubmVySFRNTCA9ICc8c3Ryb25nPk1hdGNoIFVzZXIgTGlzdDwvc3Ryb25nPjxicj48c3BhbiBjbGFzcz0ibWV0YSI+UGFzdGUgdXNlclwncyBnYW1lIGxpc3QgYmVsb3cgKG9uZSBwZXIgbGluZSk8L3NwYW4+JzsKICBtb2RhbC5hcHBlbmRDaGlsZChoZWFkZXIpOwogIAogIGNvbnN0IHRleHRhcmVhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGV4dGFyZWEnKTsKICB0ZXh0YXJlYS5zdHlsZS5jc3NUZXh0ID0gJ3dpZHRoOjEwMCU7bWluLWhlaWdodDoyMDBweDttYXJnaW4tdG9wOjEycHg7cGFkZGluZzo4cHg7Ym9yZGVyOjFweCBzb2xpZCAjZTVlN2ViO2JvcmRlci1yYWRpdXM6OHB4O2ZvbnQtZmFtaWx5Om1vbm9zcGFjZTtmb250LXNpemU6MTNweDsnOwogIHRleHRhcmVhLnBsYWNlaG9sZGVyID0gJ1N1cGVyIE1hcmlvIE9keXNzZXlcblRoZSBMZWdlbmQgb2YgWmVsZGFcbk1hcmlvIEthcnQgOFxuLi4uJzsKICBtb2RhbC5hcHBlbmRDaGlsZCh0ZXh0YXJlYSk7CiAgCiAgY29uc3QgYnRuQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgYnRuQ29udGFpbmVyLnN0eWxlLmNzc1RleHQgPSAnZGlzcGxheTpmbGV4O2dhcDo4cHg7bWFyZ2luLXRvcDoxMnB4Oyc7CiAgCiAgY29uc3QgbWF0Y2hCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTsKICBtYXRjaEJ0bi50ZXh0Q29udGVudCA9ICdBbmFseXplICYgTWF0Y2gnOwogIG1hdGNoQnRuLmNsYXNzTmFtZSA9ICdidG4nOwogIG1hdGNoQnRuLm9uY2xpY2sgPSAoKSA9PiB7CiAgICBjb25zdCB1c2VyTGlzdCA9IHRleHRhcmVhLnZhbHVlLnRyaW0oKTsKICAgIGlmICghdXNlckxpc3QpIHsKICAgICAgYWxlcnQoJ1BsZWFzZSBwYXN0ZSBhIGdhbWUgbGlzdCcpOwogICAgICByZXR1cm47CiAgICB9CiAgICAKICAgIHNob3dNYXRjaFJlc3VsdHModXNlckxpc3QpOwogIH07CiAgYnRuQ29udGFpbmVyLmFwcGVuZENoaWxkKG1hdGNoQnRuKTsKICAKICBjb25zdCBjbG9zZUJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpOwogIGNsb3NlQnRuLnRleHRDb250ZW50ID0gJ0NhbmNlbCc7CiAgY2xvc2VCdG4uY2xhc3NOYW1lID0gJ2J0biBnaG9zdCc7CiAgY2xvc2VCdG4ub25jbGljayA9ICgpID0+IHsKICAgIG1vZGFsLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICBtb2RhbC5pbm5lckhUTUwgPSAnJzsKICB9OwogIGJ0bkNvbnRhaW5lci5hcHBlbmRDaGlsZChjbG9zZUJ0bik7CiAgCiAgbW9kYWwuYXBwZW5kQ2hpbGQoYnRuQ29udGFpbmVyKTsKfSk7CgpmdW5jdGlvbiBzaG93TWF0Y2hSZXN1bHRzKHVzZXJMaXN0KSB7CiAgY29uc3QgcmVzdWx0cyA9IG1hdGNoVXNlckxpc3QodXNlckxpc3QpOwogIGNvbnN0IHRvdGFsTWF0Y2hlZCA9IHJlc3VsdHMuZXhhY3QubGVuZ3RoICsgcmVzdWx0cy5oaWdoLmxlbmd0aCArIHJlc3VsdHMubWVkaXVtLmxlbmd0aCArIHJlc3VsdHMubG93Lmxlbmd0aDsKICBjb25zdCB0b3RhbEl0ZW1zID0gdG90YWxNYXRjaGVkICsgcmVzdWx0cy5ub3RGb3VuZC5sZW5ndGg7CiAgCiAgY29uc3QgbW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsZXNNb2RhbCcpOwogIG1vZGFsLmlubmVySFRNTCA9ICcnOwogIG1vZGFsLnN0eWxlLm1heFdpZHRoID0gJzcwMHB4JzsKICBtb2RhbC5zdHlsZS5tYXhIZWlnaHQgPSAnODB2aCc7CiAgCiAgY29uc3QgaGVhZGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7CiAgaGVhZGVyLmlubmVySFRNTCA9IGA8c3Ryb25nPk1hdGNoIFJlc3VsdHM8L3N0cm9uZz48YnI+PHNwYW4gY2xhc3M9Im1ldGEiPk1hdGNoZWQ6ICR7dG90YWxNYXRjaGVkfSAvICR7dG90YWxJdGVtc308L3NwYW4+YDsKICBtb2RhbC5hcHBlbmRDaGlsZChoZWFkZXIpOwogIAogIGNvbnN0IHJlc3VsdENvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOwogIHJlc3VsdENvbnRhaW5lci5zdHlsZS5jc3NUZXh0ID0gJ21hcmdpbi10b3A6MTJweDttYXgtaGVpZ2h0OjQwMHB4O292ZXJmbG93LXk6YXV0bzsnOwogIAogIC8vIEV4YWN0IG1hdGNoZXMKICBpZiAocmVzdWx0cy5leGFjdC5sZW5ndGggPiAwKSB7CiAgICByZXN1bHRDb250YWluZXIuaW5uZXJIVE1MICs9IGA8ZGl2IHN0eWxlPSJtYXJnaW4tYm90dG9tOjhweDsiPjxzdHJvbmcgc3R5bGU9ImNvbG9yOiMxMGI5ODE7Ij7inJMgRXhhY3QgTWF0Y2hlcyAoJHtyZXN1bHRzLmV4YWN0Lmxlbmd0aH0pPC9zdHJvbmc+PC9kaXY+YDsKICAgIHJlc3VsdHMuZXhhY3QuZm9yRWFjaChyID0+IHsKICAgICAgcmVzdWx0Q29udGFpbmVyLmlubmVySFRNTCArPSBgPGRpdiBzdHlsZT0icGFkZGluZzo0cHggOHB4O2JhY2tncm91bmQ6I2YwZmRmNDtib3JkZXItbGVmdDozcHggc29saWQgIzEwYjk4MTttYXJnaW4tYm90dG9tOjRweDtmb250LXNpemU6MTJweDsiPiR7ZXNjKHIubWF0Y2hlZCl9IDxzcGFuIHN0eWxlPSJjb2xvcjojNmI3MjgwOyI+JHtlc2Moci5zaXplKX08L3NwYW4+PC9kaXY+YDsKICAgIH0pOwogIH0KICAKICAvLyBIaWdoIGNvbmZpZGVuY2UKICBpZiAocmVzdWx0cy5oaWdoLmxlbmd0aCA+IDApIHsKICAgIHJlc3VsdENvbnRhaW5lci5pbm5lckhUTUwgKz0gYDxkaXYgc3R5bGU9Im1hcmdpbjoxMnB4IDAgOHB4OyI+PHN0cm9uZyBzdHlsZT0iY29sb3I6IzNiODJmNjsiPuKJiCBIaWdoIENvbmZpZGVuY2UgKCR7cmVzdWx0cy5oaWdoLmxlbmd0aH0pPC9zdHJvbmc+PC9kaXY+YDsKICAgIHJlc3VsdHMuaGlnaC5mb3JFYWNoKHIgPT4gewogICAgICByZXN1bHRDb250YWluZXIuaW5uZXJIVE1MICs9IGA8ZGl2IHN0eWxlPSJwYWRkaW5nOjRweCA4cHg7YmFja2dyb3VuZDojZWZmNmZmO2JvcmRlci1sZWZ0OjNweCBzb2xpZCAjM2I4MmY2O21hcmdpbi1ib3R0b206NHB4O2ZvbnQtc2l6ZToxMnB4OyI+PGRpdj4ke2VzYyhyLm9yaWdpbmFsKX0g4oaSIDxzdHJvbmc+JHtlc2Moci5tYXRjaGVkKX08L3N0cm9uZz48L2Rpdj48ZGl2IHN0eWxlPSJjb2xvcjojNmI3MjgwOyI+JHtlc2Moci5zaXplKX08L2Rpdj48L2Rpdj5gOwogICAgfSk7CiAgfQogIAogIC8vIE1lZGl1bSBjb25maWRlbmNlCiAgaWYgKHJlc3VsdHMubWVkaXVtLmxlbmd0aCA+IDApIHsKICAgIHJlc3VsdENvbnRhaW5lci5pbm5lckhUTUwgKz0gYDxkaXYgc3R5bGU9Im1hcmdpbjoxMnB4IDAgOHB4OyI+PHN0cm9uZyBzdHlsZT0iY29sb3I6I2Y1OWUwYjsiPj8gTWVkaXVtIENvbmZpZGVuY2UgKCR7cmVzdWx0cy5tZWRpdW0ubGVuZ3RofSk8L3N0cm9uZz4gPHNwYW4gc3R5bGU9ImZvbnQtc2l6ZToxMnB4O2NvbG9yOiM2YjcyODA7Ij5SZXZpZXcgdGhlc2U8L3NwYW4+PC9kaXY+YDsKICAgIHJlc3VsdHMubWVkaXVtLmZvckVhY2gociA9PiB7CiAgICAgIHJlc3VsdENvbnRhaW5lci5pbm5lckhUTUwgKz0gYDxkaXYgc3R5bGU9InBhZGRpbmc6NHB4IDhweDtiYWNrZ3JvdW5kOiNmZmZiZWI7Ym9yZGVyLWxlZnQ6M3B4IHNvbGlkICNmNTllMGI7bWFyZ2luLWJvdHRvbTo0cHg7Zm9udC1zaXplOjEycHg7Ij48ZGl2PiR7ZXNjKHIub3JpZ2luYWwpfSDihpIgPHN0cm9uZz4ke2VzYyhyLm1hdGNoZWQpfTwvc3Ryb25nPjwvZGl2PjxkaXYgc3R5bGU9ImNvbG9yOiM2YjcyODA7Ij4ke2VzYyhyLnNpemUpfTwvZGl2PjwvZGl2PmA7CiAgICB9KTsKICB9CiAgCiAgLy8gTG93IGNvbmZpZGVuY2UKICBpZiAocmVzdWx0cy5sb3cubGVuZ3RoID4gMCkgewogICAgcmVzdWx0Q29udGFpbmVyLmlubmVySFRNTCArPSBgPGRpdiBzdHlsZT0ibWFyZ2luOjEycHggMCA4cHg7Ij48c3Ryb25nIHN0eWxlPSJjb2xvcjojZjk3MzE2OyI+4pqgIExvdyBDb25maWRlbmNlICgke3Jlc3VsdHMubG93Lmxlbmd0aH0pPC9zdHJvbmc+IDxzcGFuIHN0eWxlPSJmb250LXNpemU6MTJweDtjb2xvcjojNmI3MjgwOyI+VmVyaWZ5IG1hbnVhbGx5PC9zcGFuPjwvZGl2PmA7CiAgICByZXN1bHRzLmxvdy5mb3JFYWNoKHIgPT4gewogICAgICByZXN1bHRDb250YWluZXIuaW5uZXJIVE1MICs9IGA8ZGl2IHN0eWxlPSJwYWRkaW5nOjRweCA4cHg7YmFja2dyb3VuZDojZmZmN2VkO2JvcmRlci1sZWZ0OjNweCBzb2xpZCAjZjk3MzE2O21hcmdpbi1ib3R0b206NHB4O2ZvbnQtc2l6ZToxMnB4OyI+PGRpdj4ke2VzYyhyLm9yaWdpbmFsKX0g4oaSIDxzdHJvbmc+JHtlc2Moci5tYXRjaGVkKX08L3N0cm9uZz48L2Rpdj48ZGl2IHN0eWxlPSJjb2xvcjojNmI3MjgwOyI+JHtlc2Moci5zaXplKX08L2Rpdj48L2Rpdj5gOwogICAgfSk7CiAgfQogIAogIC8vIE5vdCBmb3VuZAogIGlmIChyZXN1bHRzLm5vdEZvdW5kLmxlbmd0aCA+IDApIHsKICAgIHJlc3VsdENvbnRhaW5lci5pbm5lckhUTUwgKz0gYDxkaXYgc3R5bGU9Im1hcmdpbjoxMnB4IDAgOHB4OyI+PHN0cm9uZyBzdHlsZT0iY29sb3I6I2VmNDQ0NDsiPuKclyBOb3QgRm91bmQgKCR7cmVzdWx0cy5ub3RGb3VuZC5sZW5ndGh9KTwvc3Ryb25nPjwvZGl2PmA7CiAgICByZXN1bHRzLm5vdEZvdW5kLmZvckVhY2godGl0bGUgPT4gewogICAgICByZXN1bHRDb250YWluZXIuaW5uZXJIVE1MICs9IGA8ZGl2IHN0eWxlPSJwYWRkaW5nOjRweCA4cHg7YmFja2dyb3VuZDojZmVmMmYyO2JvcmRlci1sZWZ0OjNweCBzb2xpZCAjZWY0NDQ0O21hcmdpbi1ib3R0b206NHB4O2ZvbnQtc2l6ZToxMnB4OyI+JHtlc2ModGl0bGUpfTwvZGl2PmA7CiAgICB9KTsKICB9CiAgCiAgbW9kYWwuYXBwZW5kQ2hpbGQocmVzdWx0Q29udGFpbmVyKTsKICAKICBjb25zdCBidG5Db250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKICBidG5Db250YWluZXIuc3R5bGUuY3NzVGV4dCA9ICdkaXNwbGF5OmZsZXg7Z2FwOjhweDttYXJnaW4tdG9wOjEycHg7ZmxleC13cmFwOndyYXA7JzsKICAKICBpZiAodG90YWxNYXRjaGVkID4gMCkgewogICAgY29uc3QgYWRkQWxsQnRuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYnV0dG9uJyk7CiAgICBhZGRBbGxCdG4udGV4dENvbnRlbnQgPSBgQWRkICR7dG90YWxNYXRjaGVkfSBNYXRjaGVzIHRvIFNlbGVjdGlvbmA7CiAgICBhZGRBbGxCdG4uY2xhc3NOYW1lID0gJ2J0bic7CiAgICBhZGRBbGxCdG4ub25jbGljayA9ICgpID0+IHsKICAgICAgbGV0IGFkZGVkID0gMDsKICAgICAgWy4uLnJlc3VsdHMuZXhhY3QsIC4uLnJlc3VsdHMuaGlnaCwgLi4ucmVzdWx0cy5tZWRpdW0sIC4uLnJlc3VsdHMubG93XS5mb3JFYWNoKHIgPT4gewogICAgICAgIGlmICghc3RhdGUuc2VsZWN0ZWQuc29tZShzID0+IHMubmFtZSA9PT0gci5tYXRjaGVkKSkgewogICAgICAgICAgY29uc3QgaXRlbSA9IHN0YXRlLml0ZW1zLmZpbmQoaXQgPT4gaXQubmFtZSA9PT0gci5tYXRjaGVkKTsKICAgICAgICAgIGlmIChpdGVtKSB7CiAgICAgICAgICAgIHN0YXRlLnNlbGVjdGVkLnB1c2goewogICAgICAgICAgICAgIG5hbWU6IGl0ZW0ubmFtZSwKICAgICAgICAgICAgICBmaWxlbmFtZTogaXRlbS5maWxlbmFtZSB8fCBpdGVtLm5hbWUsCiAgICAgICAgICAgICAgc2l6ZTogaXRlbS5zaXplCiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBhZGRlZCsrOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICAgIAogICAgICB1cGRhdGVUb3RhbHMoKTsKICAgICAgcmVuZGVyT3ZlcmxheSgpOwogICAgICByZW5kZXJMaXN0KHN0YXRlLml0ZW1zKTsKICAgICAgdG9hc3QoYEFkZGVkICR7YWRkZWR9IG1hdGNoZWQgZ2FtZXNgKTsKICAgICAgbW9kYWwuc3R5bGUuZGlzcGxheSA9ICdub25lJzsKICAgICAgbW9kYWwuaW5uZXJIVE1MID0gJyc7CiAgICB9OwogICAgYnRuQ29udGFpbmVyLmFwcGVuZENoaWxkKGFkZEFsbEJ0bik7CiAgfQogIAogIGNvbnN0IGV4cG9ydE1hdGNoZWRCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTsKICBleHBvcnRNYXRjaGVkQnRuLnRleHRDb250ZW50ID0gJ0V4cG9ydCBNYXRjaGVkJzsKICBleHBvcnRNYXRjaGVkQnRuLmNsYXNzTmFtZSA9ICdidG4gZ2hvc3QnOwogIGV4cG9ydE1hdGNoZWRCdG4ub25jbGljayA9ICgpID0+IHsKICAgIGNvbnN0IGNvbnRlbnQgPSBbLi4ucmVzdWx0cy5leGFjdCwgLi4ucmVzdWx0cy5oaWdoLCAuLi5yZXN1bHRzLm1lZGl1bSwgLi4ucmVzdWx0cy5sb3ddCiAgICAgIC5tYXAociA9PiByLm1hdGNoZWQpCiAgICAgIC5qb2luKCdcbicpOwogICAgY29uc3QgYmxvYiA9IG5ldyBCbG9iKFtjb250ZW50XSwgeyB0eXBlOiAndGV4dC9wbGFpbicgfSk7CiAgICBjb25zdCBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpOwogICAgYS5ocmVmID0gVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTsKICAgIGEuZG93bmxvYWQgPSBgbWF0Y2hlZF8ke0RhdGUubm93KCl9LnR4dGA7CiAgICBhLmNsaWNrKCk7CiAgICBVUkwucmV2b2tlT2JqZWN0VVJMKGEuaHJlZik7CiAgICB0b2FzdCgnRXhwb3J0ZWQgbWF0Y2hlZCBsaXN0Jyk7CiAgfTsKICBidG5Db250YWluZXIuYXBwZW5kQ2hpbGQoZXhwb3J0TWF0Y2hlZEJ0bik7CiAgCiAgaWYgKHJlc3VsdHMubm90Rm91bmQubGVuZ3RoID4gMCkgewogICAgY29uc3QgZXhwb3J0Tm90Rm91bmRCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTsKICAgIGV4cG9ydE5vdEZvdW5kQnRuLnRleHRDb250ZW50ID0gJ0V4cG9ydCBOb3QgRm91bmQnOwogICAgZXhwb3J0Tm90Rm91bmRCdG4uY2xhc3NOYW1lID0gJ2J0biBnaG9zdCc7CiAgICBleHBvcnROb3RGb3VuZEJ0bi5zdHlsZS5iYWNrZ3JvdW5kID0gJyNmZWYyZjInOwogICAgZXhwb3J0Tm90Rm91bmRCdG4uc3R5bGUuY29sb3IgPSAnI2VmNDQ0NCc7CiAgICBleHBvcnROb3RGb3VuZEJ0bi5vbmNsaWNrID0gKCkgPT4gewogICAgICBjb25zdCBjb250ZW50ID0gcmVzdWx0cy5ub3RGb3VuZC5qb2luKCdcbicpOwogICAgICBjb25zdCBibG9iID0gbmV3IEJsb2IoW2NvbnRlbnRdLCB7IHR5cGU6ICd0ZXh0L3BsYWluJyB9KTsKICAgICAgY29uc3QgYSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTsKICAgICAgYS5ocmVmID0gVVJMLmNyZWF0ZU9iamVjdFVSTChibG9iKTsKICAgICAgYS5kb3dubG9hZCA9IGBub3RfZm91bmRfJHtEYXRlLm5vdygpfS50eHRgOwogICAgICBhLmNsaWNrKCk7CiAgICAgIFVSTC5yZXZva2VPYmplY3RVUkwoYS5ocmVmKTsKICAgICAgdG9hc3QoJ0V4cG9ydGVkIG5vdCBmb3VuZCBsaXN0Jyk7CiAgICB9OwogICAgYnRuQ29udGFpbmVyLmFwcGVuZENoaWxkKGV4cG9ydE5vdEZvdW5kQnRuKTsKICB9CiAgCiAgY29uc3QgY2xvc2VCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdidXR0b24nKTsKICBjbG9zZUJ0bi50ZXh0Q29udGVudCA9ICdDbG9zZSc7CiAgY2xvc2VCdG4uY2xhc3NOYW1lID0gJ2J0biBnaG9zdCc7CiAgY2xvc2VCdG4ub25jbGljayA9ICgpID0+IHsKICAgIG1vZGFsLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgICBtb2RhbC5pbm5lckhUTUwgPSAnJzsKICB9OwogIGJ0bkNvbnRhaW5lci5hcHBlbmRDaGlsZChjbG9zZUJ0bik7CiAgCiAgbW9kYWwuYXBwZW5kQ2hpbGQoYnRuQ29udGFpbmVyKTsKfQoKaWYgKCFpc0xvY2FsKSB7CiAgY29uc3QgYWRtaW4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYWRtaW5FeHBvcnQnKTsKICBpZiAoYWRtaW4pIGFkbWluLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CgogIGNvbnN0IGJpbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdiaW5MaXN0Jyk7CiAgaWYgKGJpbikgYmluLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7CiAgCiAgY29uc3QgbWF0Y2ggPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWF0Y2hMaXN0Jyk7CiAgaWYgKG1hdGNoKSBtYXRjaC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOyAgCgp9Cgpjb25zdCBzZWFyY2hJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZWFyY2gnKTsKCmlmICghaXNNb2JpbGUpIHsKICBmdW5jdGlvbiByZWZvY3VzU2VhcmNoKCkgewogICAgY29uc3QgYWN0aXZlID0gZG9jdW1lbnQuYWN0aXZlRWxlbWVudDsKICAgIGlmICgKICAgICAgYWN0aXZlICYmCiAgICAgIChhY3RpdmUuaWQgPT09ICdjdXN0b21lcicgfHwKICAgICAgIGFjdGl2ZS50YWdOYW1lID09PSAnU0VMRUNUJyB8fAogICAgICAgYWN0aXZlLnRhZ05hbWUgPT09ICdURVhUQVJFQScpCiAgICApIHJldHVybjsKICAgIHNlYXJjaElucHV0LmZvY3VzKCk7CiAgICBzZWFyY2hJbnB1dC5zZWxlY3QoKTsKICB9CgogIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgcmVmb2N1c1NlYXJjaCk7CgogIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHsKICAgIGNvbnN0IG1vZGFsT3BlbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmaWxlc01vZGFsJykuc3R5bGUuZGlzcGxheSA9PT0gJ2Jsb2NrJzsKICAgIGNvbnN0IG92ZXJsYXlPcGVuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ292ZXJsYXknKS5zdHlsZS5kaXNwbGF5ID09PSAnZmxleCc7CiAgICBpZiAoCiAgICAgICFtb2RhbE9wZW4gJiYKICAgICAgIW92ZXJsYXlPcGVuICYmCiAgICAgIGUudGFyZ2V0LmlkICE9PSAnc2VhcmNoJyAmJgogICAgICBlLnRhcmdldC5pZCAhPT0gJ2N1c3RvbWVyJyAmJgogICAgICAhZS50YXJnZXQuY2xvc2VzdCgnc2VsZWN0JykKICAgICkgewogICAgICByZWZvY3VzU2VhcmNoKCk7CiAgICB9CiAgfSk7CgogIFsnY2xlYXJTZWFyY2gnLCAnc2hvd1NlbGVjdGVkJywgJ3NhdmVCdG4nLCAndXBsb2FkQnRuJ10uZm9yRWFjaChpZCA9PiB7CiAgICBjb25zdCBidG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7CiAgICBpZiAoYnRuKSBidG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCByZWZvY3VzU2VhcmNoKTsKICB9KTsKCiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gewogICAgaWYgKGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnaXRlbScpKSB7CiAgICAgIHNldFRpbWVvdXQocmVmb2N1c1NlYXJjaCwgMTIwKTsKICAgIH0KICB9KTsKCiAgWydjbG9zZU92ZXJsYXknXS5mb3JFYWNoKGlkID0+IHsKICAgIGNvbnN0IGJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTsKICAgIGlmIChidG4pIGJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHNldFRpbWVvdXQocmVmb2N1c1NlYXJjaCwgMjAwKSk7CiAgfSk7CgogIHNlYXJjaElucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCAoZXYpID0+IHsKICAgIGlmIChldi5rZXkgPT09ICdFbnRlcicpIHsKICAgICAgc2V0VGltZW91dChyZWZvY3VzU2VhcmNoLCAxNTApOwogICAgfQogIH0pOwp9CgooYXN5bmMgZnVuY3Rpb24gaW5pdCgpIHsKICBidWlsZER5bmFtaWNDb250cm9scygpOwoKICAvLyBMb2FkIGljb24gY2FjaGUgZmlyc3QgKG5vbi1ibG9ja2luZykKICBhd2FpdCBsb2FkSWNvbkNhY2hlKCk7CgogIC8vIEJ1aWxkIGdlbnJlIGZpbHRlciBmcm9tIGNhY2hlIGRhdGEKICBidWlsZEdlbnJlRmlsdGVyKCk7CgogIGF3YWl0IGxvYWRYTUwoKTsKICB1cGRhdGVUb3RhbHMoKTsKICB1cGRhdGVGaWxlbmFtZVByZXZpZXcoKTsKCiAgLy8gU2V0IGZpbGUgaW5wdXQgYWNjZXB0IGF0dHJpYnV0ZSBmcm9tIGNvbmZpZwogIGNvbnN0IGZpbGVJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmaWxlSW4nKTsKICBpZiAoZmlsZUlucHV0ICYmIENPTkZJRy5jbGllbnRGaWxlRXh0KSB7CiAgICBmaWxlSW5wdXQuYWNjZXB0ID0gQ09ORklHLmNsaWVudEZpbGVFeHQ7CiAgfQp9KSgpOwo8L3NjcmlwdD4KPC9ib2R5Pgo8L2h0bWw+`;
    // Properly decode UTF-8 from base64
    const decoded = decodeURIComponent(escape(atob(base64html)));
    const iframe = document.getElementById('viewer');
    const doc = iframe.contentWindow.document;
    doc.open();
    doc.write(decoded);
    doc.close();
  </script>
</body>
</html>