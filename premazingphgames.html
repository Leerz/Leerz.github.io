<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PremazingPH Games</title>
  <style>
    html, body {
      margin: 0; padding: 0;
      width: 100%; height: 100%;
      overflow: hidden;
    }
    iframe {
      width: 100vw; height: 100vh;
      border: none;
      display: block;
    }
  </style>
</head>
<body>
  <iframe id="viewer"></iframe>
  <script>
    const base64html = `PCFET0NUWVBFIGh0bWw+DQo8aHRtbCBsYW5nPSJlbiI+DQo8aGVhZD4NCjxtZXRhIGNoYXJzZXQ9InV0Zi04IiAvPg0KPG1ldGEgbmFtZT0idmlld3BvcnQiIGNvbnRlbnQ9IndpZHRoPWRldmljZS13aWR0aCxpbml0aWFsLXNjYWxlPTEiIC8+DQo8dGl0bGU+U3dpdGNoIEdhbWVzIOKAlCBSZXY2PC90aXRsZT4NCjxzdHlsZT4NCjpyb290ey0tYmc6I2Y0ZjZmODstLXBhbmVsOiNmZmY7LS1tdXRlZDojNmI3MjgwOy0tcHJpbWFyeTojMDM2NmQ2Oy0tYWNjZW50OiNmZjhhMDA7LS1kYW5nZXI6I2VmNDQ0NDstLXJhZGl1czoxMHB4fQ0KKntib3gtc2l6aW5nOmJvcmRlci1ib3h9DQpodG1sLGJvZHl7aGVpZ2h0OjEwMCU7bWFyZ2luOjA7Zm9udC1mYW1pbHk6SW50ZXIsU2Vnb2UgVUksQXJpYWwsc2Fucy1zZXJpZjtiYWNrZ3JvdW5kOnZhcigtLWJnKTtjb2xvcjojMTExfQ0KLmhlYWRlcntwb3NpdGlvbjpmaXhlZDt0b3A6MDtyaWdodDowO2xlZnQ6MDtoZWlnaHQ6NzZweDtiYWNrZ3JvdW5kOnZhcigtLXBhbmVsKTtkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2dhcDoxMnB4O3BhZGRpbmc6MTBweCAxNHB4O2JvcmRlci1ib3R0b206MXB4IHNvbGlkICNlNmVlZjY7ei1pbmRleDo2MH0NCi5oZWFkZXIgLnNlYXJjaHtmbGV4OjE7bWluLXdpZHRoOjE2MHB4fQ0KLmhlYWRlciBpbnB1dC5zZWFyY2gsIC5oZWFkZXIgYnV0dG9ue2hlaWdodDo0NHB4O2JvcmRlci1yYWRpdXM6MTBweDtib3JkZXI6MXB4IHNvbGlkICNlNmVlZjY7cGFkZGluZzowIDEycHh9DQouaGVhZGVyIC5hY3Rpb25ze2Rpc3BsYXk6ZmxleDtnYXA6OHB4O2FsaWduLWl0ZW1zOmNlbnRlcn0NCi5oZWFkZXIgLnVwbG9hZHtiYWNrZ3JvdW5kOnZhcigtLWFjY2VudCk7Y29sb3I6I2ZmZjtib3JkZXI6bm9uZTtwYWRkaW5nOjEwcHggMTZweDtib3JkZXItcmFkaXVzOjEwcHg7Zm9udC13ZWlnaHQ6NjAwfQ0KLmNvbnRhaW5lcntkaXNwbGF5OmdyaWQ7Z3JpZC10ZW1wbGF0ZS1jb2x1bW5zOjFmciAzODBweDtnYXA6MTJweDtwYWRkaW5nOmNhbGMoNzZweCArIDEycHgpIDEycHggMTZweDtoZWlnaHQ6Y2FsYygxMDB2aCl9DQoubGVmdFBhbmV7YmFja2dyb3VuZDp2YXIoLS1wYW5lbCk7Ym9yZGVyLXJhZGl1czoxMnB4O3BhZGRpbmc6MTJweDtvdmVyZmxvdzphdXRvO2JveC1zaGFkb3c6MCA2cHggMThweCByZ2JhKDEyLDE4LDMwLDAuMDQpfQ0KLnJpZ2h0UGFuZXtiYWNrZ3JvdW5kOnZhcigtLXBhbmVsKTtib3JkZXItcmFkaXVzOjEycHg7cGFkZGluZzoxMnB4O292ZXJmbG93OmhpZGRlbjtib3gtc2hhZG93OjAgNnB4IDE4cHggcmdiYSgxMiwxOCwzMCwwLjA0KTtkaXNwbGF5OmZsZXg7ZmxleC1kaXJlY3Rpb246Y29sdW1ufQ0KLml0ZW17ZGlzcGxheTpmbGV4O2p1c3RpZnktY29udGVudDpzcGFjZS1iZXR3ZWVuO2FsaWduLWl0ZW1zOmNlbnRlcjtwYWRkaW5nOjEwcHg7Ym9yZGVyLXJhZGl1czo4cHg7Ym9yZGVyOjFweCBzb2xpZCB0cmFuc3BhcmVudDtjdXJzb3I6cG9pbnRlcjttYXJnaW4tYm90dG9tOjhweH0NCi5pdGVtOmhvdmVye2JhY2tncm91bmQ6I2ZiZmRmZn0NCi5pdGVtLnNlbGVjdGVke2JhY2tncm91bmQ6IzBiM2I2Njtjb2xvcjojZmZmfQ0KDQoubWV0YXtmb250LXNpemU6MTJweDtjb2xvcjp2YXIoLS1tdXRlZCl9DQouY29udHJvbHN7ZGlzcGxheTpncmlkO2dyaWQtdGVtcGxhdGUtY29sdW1uczoxZnIgMWZyO2dhcDo4cHg7bWFyZ2luLWJvdHRvbTo4cHh9DQouY29udHJvbHMgLmZ1bGx7Z3JpZC1jb2x1bW46MSAvIC0xfQ0KLmZpbGVuYW1lLXByZXZpZXd7Z3JpZC1jb2x1bW46MSAvIC0xO3BhZGRpbmc6OHB4O2JhY2tncm91bmQ6I2Y5ZmFmYjtib3JkZXI6MXB4IHNvbGlkICNlNWU3ZWI7Ym9yZGVyLXJhZGl1czo4cHg7Zm9udC1mYW1pbHk6bW9ub3NwYWNlO292ZXJmbG93LXg6YXV0bzt3aGl0ZS1zcGFjZTpub3dyYXB9DQouaW5mb1Jvd3tkaXNwbGF5OmZsZXg7anVzdGlmeS1jb250ZW50OnNwYWNlLWJldHdlZW47YWxpZ24taXRlbXM6Y2VudGVyO3BhZGRpbmc6MTBweDtib3JkZXItcmFkaXVzOjhweDtiYWNrZ3JvdW5kOiNmZmY7bWFyZ2luLXRvcDo4cHg7Ym9yZGVyOjFweCBzb2xpZCAjZjFmNWY5fQ0KLmJ0bntwYWRkaW5nOjhweCAxMnB4O2JvcmRlci1yYWRpdXM6OHB4O2JvcmRlcjpub25lO2JhY2tncm91bmQ6dmFyKC0tcHJpbWFyeSk7Y29sb3I6I2ZmZjtjdXJzb3I6cG9pbnRlcn0NCi5idG4uZ2hvc3R7YmFja2dyb3VuZDp0cmFuc3BhcmVudDtjb2xvcjp2YXIoLS1wcmltYXJ5KTtib3JkZXI6MXB4IHNvbGlkICNlNmVlZjZ9DQouc21hbGx7Zm9udC1zaXplOjEzcHg7Y29sb3I6dmFyKC0tbXV0ZWQpfQ0KLm92ZXJsYXl7cG9zaXRpb246Zml4ZWQ7aW5zZXQ6MDtiYWNrZ3JvdW5kOnJnYmEoMjE1LDI0MCwyNTAsLjk1KTtkaXNwbGF5Om5vbmU7ZmxleC1kaXJlY3Rpb246Y29sdW1uO3otaW5kZXg6MTUwfQ0KLm92ZXJsYXkgLmhlYWR7ZGlzcGxheTpmbGV4O2p1c3RpZnktY29udGVudDpzcGFjZS1iZXR3ZWVuO3BhZGRpbmc6MTJweDtiYWNrZ3JvdW5kOnJnYmEoMCwwLDAsMC41NSk7YWxpZ24taXRlbXM6Y2VudGVyfQ0KLm92ZXJsYXkgLmJvZHl7cGFkZGluZzoxMnB4O292ZXJmbG93OmF1dG87ZmxleDoxfQ0KLm92ZXJsYXkgLnJvd3tkaXNwbGF5OmZsZXg7anVzdGlmeS1jb250ZW50OnNwYWNlLWJldHdlZW47YWxpZ24taXRlbXM6Y2VudGVyO3BhZGRpbmc6OHB4O2JvcmRlci1ib3R0b206MXB4IHNvbGlkIHJnYmEoMjU1LDI1NSwyNTUsMC4wNil9DQoNCi8qIEhpZ2hsaWdodCByZWNlbnRseSBtb3ZlZCBpdGVtICovDQoub3ZlcmxheSAucm93LmhpZ2hsaWdodCB7DQogIGJhY2tncm91bmQ6ICNmZmYzY2Q7ICAgLyogc29mdCB5ZWxsb3cgKi8NCiAgdHJhbnNpdGlvbjogYmFja2dyb3VuZCAwLjZzIGVhc2U7DQp9DQojZmlsZXNNb2RhbDo6YmFja2Ryb3Agew0KICBiYWNrZ3JvdW5kOiByZ2JhKDAsMCwwLDAuMyk7DQp9DQovKiBSZWQgd2FybmluZyBmb3Igb3ZlcmZsb3cgKi8NCiN0b3RhbHMuZXhjZWVkZWQgew0KICBjb2xvcjogI2MwMDsNCiAgZm9udC13ZWlnaHQ6IGJvbGQ7DQp9DQouYnRuLmRhbmdlciB7DQogIGJhY2tncm91bmQ6ICNjMDA7DQogIGNvbG9yOiAjZmZmOw0KfQ0KDQoNCi5vdmVybGF5IGJ1dHRvbi5pY29ue3BhZGRpbmc6NnB4IDhweDtib3JkZXItcmFkaXVzOjZweDtib3JkZXI6bm9uZTtjdXJzb3I6cG9pbnRlcjttYXJnaW4tbGVmdDo2cHh9DQoub3ZlcmxheSBidXR0b24udXAsIC5vdmVybGF5IGJ1dHRvbi5kb3due2JhY2tncm91bmQ6I2ZmZjtjb2xvcjojMTExfQ0KLm92ZXJsYXkgYnV0dG9uLnJlbW92ZXtiYWNrZ3JvdW5kOnZhcigtLWRhbmdlcik7Y29sb3I6I2ZmZn0NCi5mb290ZXJDb250cm9sc3tkaXNwbGF5OmZsZXg7Z2FwOjhweDtmbGV4LXdyYXA6d3JhcDthbGlnbi1pdGVtczpjZW50ZXJ9DQpAbWVkaWEgKG1heC13aWR0aDo5MDBweCl7DQogIC5jb250YWluZXJ7Z3JpZC10ZW1wbGF0ZS1jb2x1bW5zOjFmcjsgcGFkZGluZy10b3A6Y2FsYyg3NnB4ICsgOHB4KX0NCiAgLnJpZ2h0UGFuZXtvcmRlcjotMX0NCiAgLmhlYWRlcntwYWRkaW5nOjhweH0NCn0NCg0KLyogRGVza3RvcCBzaWRlLWJ5LXNpZGUgc2VsZWN0ZWQgcGFuZWwgKi8NCi5zZWxlY3RlZC1wYW5lbCB7DQogIG1hcmdpbi10b3A6IDEycHg7DQogIGJhY2tncm91bmQ6IHZhcigtLXBhbmVsKTsNCiAgYm9yZGVyOiAxcHggc29saWQgI2U2ZWVmNjsNCiAgYm9yZGVyLXJhZGl1czogMTBweDsNCiAgYm94LXNoYWRvdzogMCA0cHggMTJweCByZ2JhKDAsMCwwLDAuMDUpOw0KICBkaXNwbGF5OiBmbGV4Ow0KICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOw0KICBoZWlnaHQ6IDEwMCU7DQogIG92ZXJmbG93OiBoaWRkZW47DQp9DQoNCi5zZWxlY3RlZC1wYW5lbCAuaGVhZCB7DQogIGJhY2tncm91bmQ6ICNmOGZhZmM7DQogIHBhZGRpbmc6IDhweCAxMnB4Ow0KICBib3JkZXItYm90dG9tOiAxcHggc29saWQgI2U2ZWVmNjsNCiAgZm9udC13ZWlnaHQ6IDYwMDsNCiAgZm9udC1zaXplOiAxNHB4Ow0KfQ0KDQouc2VsZWN0ZWQtcGFuZWwgLmJvZHkgew0KICBmbGV4OiAxOw0KICBvdmVyZmxvdy15OiBhdXRvOw0KICBmb250LXNpemU6IDEzcHg7DQogIHBhZGRpbmc6IDhweCAxMnB4Ow0KfQ0KDQovKiBIaWRlIG9uIG1vYmlsZSAqLw0KQG1lZGlhIChtYXgtd2lkdGg6IDkwMHB4KSB7DQogIC5zZWxlY3RlZC1wYW5lbCB7DQogICAgZGlzcGxheTogbm9uZSAhaW1wb3J0YW50Ow0KICB9DQp9DQovKiAtLS0gQ29uZmlndXJhdGlvbiBzZWN0aW9uIHZpc2liaWxpdHkgLS0tICovDQouY29uZmlnLXNlY3Rpb24gew0KICB0cmFuc2l0aW9uOiBhbGwgMC4yNXMgZWFzZTsNCn0NCg0KLm1vYmlsZS1vbmx5IHsNCiAgZGlzcGxheTogbm9uZTsNCn0NCg0KLyogTW9iaWxlIGJlaGF2aW9yICovDQpAbWVkaWEgKG1heC13aWR0aDogOTAwcHgpIHsNCiAgLm1vYmlsZS1vbmx5IHsNCiAgICBkaXNwbGF5OiBibG9jazsNCiAgfQ0KDQogIC5jb25maWctc2VjdGlvbiB7DQogICAgZGlzcGxheTogbm9uZTsNCiAgfQ0KDQogIC5jb25maWctc2VjdGlvbi5hY3RpdmUgew0KICAgIGRpc3BsYXk6IGJsb2NrOw0KICB9DQp9DQoNCjwvc3R5bGU+DQo8L2hlYWQ+DQo8Ym9keT4NCiAgPGRpdiBjbGFzcz0iaGVhZGVyIj4NCiAgICA8IS0tPGJ1dHRvbiBpZD0icmVsb2FkQnRuIiBjbGFzcz0iYnRuIGRhbmdlciI+UmVsb2FkPC9idXR0b24+LS0+DQoJPGlucHV0IGlkPSJzZWFyY2giIGNsYXNzPSJzZWFyY2giIHR5cGU9InRleHQiIHBsYWNlaG9sZGVyPSJTZWFyY2ggZ2FtZXMuLi4iPg0KCSAgICA8ZGl2IGNsYXNzPSJhY3Rpb25zIj4NCiAgICAgIDxidXR0b24gaWQ9InVwbG9hZEJ0biIgY2xhc3M9ImJ0biBnaG9zdCI+VXBsb2FkPC9idXR0b24+DQogICAgICA8YnV0dG9uIGlkPSJzaG93U2VsZWN0ZWQiIGNsYXNzPSJidG4gZ2hvc3QiPlNob3c8L2J1dHRvbj4NCgkgIDxidXR0b24gaWQ9InNvcnRMYXRlc3QiIGNsYXNzPSJidG4gZ2hvc3QiPlNvcnQ8L2J1dHRvbj4NCiAgICAgIDxidXR0b24gaWQ9ImNsZWFyU2VhcmNoIiBjbGFzcz0iYnRuIGdob3N0Ij48L2J1dHRvbj4NCiAgICA8L2Rpdj4NCiAgPC9kaXY+DQoNCiAgPGRpdiBjbGFzcz0iY29udGFpbmVyIj4NCiAgICA8c2VjdGlvbiBjbGFzcz0ibGVmdFBhbmUiIGlkPSJsZWZ0UGFuZSIgYXJpYS1sYWJlbD0iR2FtZSBsaXN0Ij4NCiAgICAgIDwhLS0gbGlzdCBpbmplY3RlZCAtLT4NCiAgICA8L3NlY3Rpb24+DQoNCiAgICA8YXNpZGUgY2xhc3M9InJpZ2h0UGFuZSI+DQo8IS0tIENvbmZpZyBzZWN0aW9uIC0tPg0KPGJ1dHRvbiBpZD0idG9nZ2xlQ29uZmlnIiBjbGFzcz0iYnRuIGdob3N0IG1vYmlsZS1vbmx5IiBzdHlsZT0ibWFyZ2luLWJvdHRvbTo4cHg7Ij5IaWRlIENvbmZpZ3VyYXRpb248L2J1dHRvbj4NCg0KPGRpdiBpZD0iY29uZmlnU2VjdGlvbiIgY2xhc3M9ImNvbmZpZy1zZWN0aW9uIj4NCiAgICAgIDxkaXYgY2xhc3M9ImNvbnRyb2xzIj4NCiAgICAgICAgPGlucHV0IGlkPSJjdXN0b21lciIgY2xhc3M9ImZ1bGwiIHR5cGU9InRleHQiIHBsYWNlaG9sZGVyPSJDdXN0b21lciBuYW1lICh1c2UgdW5kZXJzY29yZXMpIj4NCiAgICAgICAgPGRpdiBjbGFzcz0iZmlsZW5hbWUtcHJldmlldyIgaWQ9ImZpbGVuYW1lUHJldmlldyI+RmlsZW5hbWUgcHJldmlldyB3aWxsIGFwcGVhciBoZXJl4oCmPC9kaXY+DQoJCQ0KICAgICAgICA8ZGl2Pg0KICAgICAgICAgIDxsYWJlbCBjbGFzcz0ic21hbGwiPkNvbnNvbGU8L2xhYmVsPg0KICAgICAgICAgIDxzZWxlY3QgaWQ9ImNvbnNvbGUiIGFyaWEtbGFiZWw9IkNvbnNvbGUgdHlwZSI+DQogICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJ2MSI+djE8L29wdGlvbj4NCiAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9InYyIj52Mjwvb3B0aW9uPg0KICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0ibGl0ZSI+bGl0ZTwvb3B0aW9uPg0KICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0ib2xlZCI+b2xlZDwvb3B0aW9uPg0KICAgICAgICAgIDwvc2VsZWN0Pg0KICAgICAgICA8L2Rpdj4NCiAgICAgICAgPGRpdj4NCiAgICAgICAgICA8bGFiZWwgY2xhc3M9InNtYWxsIj5TRCBDYXJkIChHQik8L2xhYmVsPg0KICAgICAgICAgIDxzZWxlY3QgaWQ9InNkIiBhcmlhLWxhYmVsPSJTRCBjYXJkIj4NCiAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9IjEyOCI+MTI4PC9vcHRpb24+DQogICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSIyNTYiPjI1Njwvb3B0aW9uPg0KICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iNTEyIj41MTI8L29wdGlvbj4NCiAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9IjEwMjQiPjEwMjQ8L29wdGlvbj4NCiAgICAgICAgICA8L3NlbGVjdD4NCiAgICAgICAgPC9kaXY+DQoNCiAgICAgICAgPGRpdj4NCiAgICAgICAgICA8bGFiZWwgY2xhc3M9InNtYWxsIj5BbmRyb2lkIChHQik8L2xhYmVsPg0KICAgICAgICAgIDxzZWxlY3QgaWQ9ImFuZHJvaWQiIGFyaWEtbGFiZWw9ImFuZHJvaWQgc2l6ZSI+DQogICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSIwIj4wPC9vcHRpb24+DQogICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSIxNiI+MTY8L29wdGlvbj4NCiAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9IjMyIj4zMjwvb3B0aW9uPg0KICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iNjQiPjY0PC9vcHRpb24+DQogICAgICAgICAgPC9zZWxlY3Q+DQogICAgICAgIDwvZGl2Pg0KICAgICAgICA8ZGl2Pg0KICAgICAgICAgIDxsYWJlbCBjbGFzcz0ic21hbGwiPkxpbnV4IChHQik8L2xhYmVsPg0KICAgICAgICAgIDxzZWxlY3QgaWQ9ImxpbnV4IiBhcmlhLWxhYmVsPSJsaW51eCBzaXplIj4NCiAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9IjAiPjA8L29wdGlvbj4NCiAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9IjE2Ij4xNjwvb3B0aW9uPg0KICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iMzIiPjMyPC9vcHRpb24+DQogICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSI2NCI+NjQ8L29wdGlvbj4NCiAgICAgICAgICA8L3NlbGVjdD4NCiAgICAgICAgPC9kaXY+DQogICAgICA8L2Rpdj4NCg0KICAgICAgPGRpdiBjbGFzcz0iaW5mb1JvdyIgc3R5bGU9Im1hcmdpbi10b3A6OHB4OyI+DQogICAgICAgIDxkaXY+DQogICAgICAgICAgPGRpdiBjbGFzcz0ic21hbGwiPlNwYWNlIGZvciBnYW1lczwvZGl2Pg0KICAgICAgICAgIDxkaXY+PHN0cm9uZyBpZD0ic3BhY2UiPjA8L3N0cm9uZz4gR0I8L2Rpdj4NCiAgICAgICAgPC9kaXY+DQogICAgICAgIDxkaXY+DQogICAgICAgICAgPGRpdiBjbGFzcz0ic21hbGwiPlNlbGVjdGVkIHNpemU8L2Rpdj4NCiAgICAgICAgICA8ZGl2PjxzdHJvbmcgaWQ9InNlbGVjdGVkU2l6ZSI+MC4wMDwvc3Ryb25nPiBHQjwvZGl2Pg0KICAgICAgICA8L2Rpdj4NCiAgICAgIDwvZGl2Pg0KDQogICAgICA8ZGl2IGNsYXNzPSJpbmZvUm93IiBzdHlsZT0ibWFyZ2luLXRvcDo4cHg7Ij4NCiAgICAgICAgPGRpdj4NCiAgICAgICAgICA8ZGl2IGNsYXNzPSJzbWFsbCI+SW5zdGFsbCBlc3RpbWF0ZTwvZGl2Pg0KICAgICAgICAgIDxkaXY+PHNwYW4gaWQ9Imluc3RhbGxFc3RpbWF0ZSI+MGggMG08L3NwYW4+PC9kaXY+DQogICAgICAgIDwvZGl2Pg0KICAgICAgICA8ZGl2Pg0KICAgICAgICAgIDxkaXYgY2xhc3M9InNtYWxsIj5TZWxlY3RlZDwvZGl2Pg0KICAgICAgICAgIDxkaXY+PHNwYW4gaWQ9ImNvdW50Ij4wPC9zcGFuPiBnYW1lczwvZGl2Pg0KICAgICAgICA8L2Rpdj4NCiAgICAgIDwvZGl2Pg0KDQogIDwvZGl2Pg0KICAgICAgPGRpdiBzdHlsZT0ibWFyZ2luLXRvcDoxMnB4O2Rpc3BsYXk6ZmxleDtnYXA6OHB4O2FsaWduLWl0ZW1zOmNlbnRlcjsiPg0KICAgICAgICA8IS0tPGJ1dHRvbiBpZD0iY29weUxpbmsiIGNsYXNzPSJidG4iPkNvcHkgTGluazwvYnV0dG9uPi0tPg0KDQoJCTxpbnB1dCBpZD0ic2hhcmVhYmxlIiB0eXBlPSJ0ZXh0IiBwbGFjZWhvbGRlcj0iVXBsb2FkZWQgZmlsZSBsaW5rIiBzdHlsZT0iZmxleDoxO3BhZGRpbmc6OHB4O2JvcmRlci1yYWRpdXM6OHB4O2JvcmRlcjoxcHggc29saWQgI2U2ZWVmNiIgcmVhZG9ubHk+DQoJCTxidXR0b24gaWQ9ImNvcHlMaW5rIiBjbGFzcz0iYnRuIj5Db3B5IExpc3QgJiBMaW5rIHRvIENsaXBib2FyZDwvYnV0dG9uPg0KICAgICAgICA8YnV0dG9uIGlkPSJzYXZlQnRuIiBjbGFzcz0iYnRuIj5TYXZlPC9idXR0b24+PGxhYmVsIGZvcj0iZmlsZUluIiBzdHlsZT0iDQogIGJhY2tncm91bmQ6IzNhNmRmMDsNCiAgY29sb3I6I2ZmZjsNCiAgcGFkZGluZzo1cHggNXB4Ow0KICBib3JkZXItcmFkaXVzOjNweDsNCiAgZm9udC1zaXplOjEycHg7DQogIGN1cnNvcjpwb2ludGVyOw0KICBmb250LWZhbWlseTpzYW5zLXNlcmlmOw0KICBkaXNwbGF5OmlubGluZS1ibG9jazsNCiI+DQogIE9wZW4NCjwvbGFiZWw+DQo8aW5wdXQgaWQ9ImZpbGVJbiIgdHlwZT0iZmlsZSIgYWNjZXB0PSIuQ0xJX1BSTVoiIHN0eWxlPSJkaXNwbGF5Om5vbmU7Ij4NCiAgICAgIDwvZGl2Pg0KDQogICAgICA8ZGl2IHN0eWxlPSJtYXJnaW4tdG9wOjEycHg7ZGlzcGxheTpmbGV4O2dhcDo4cHg7YWxpZ24taXRlbXM6Y2VudGVyO2ZsZXgtd3JhcDp3cmFwIj4NCiAgICAgICAgDQoNCiAgICAgICAgPGJ1dHRvbiBpZD0iYWRtaW5FeHBvcnQiIGNsYXNzPSJidG4gZ2hvc3QiPkV4cG9ydCBBZG1pbjwvYnV0dG9uPg0KICAgICAgICA8YnV0dG9uIGlkPSJiaW5MaXN0IiBjbGFzcz0iYnRuIGdob3N0Ij5VcGxvYWRzPC9idXR0b24+DQoJCTxkaXYgaWQ9ImZpbGVMaXN0Q29udGFpbmVyIiBzdHlsZT0iZGlzcGxheTpub25lOyI+DQoJCSAgPGRpdiBpZD0iYmluRmlsZUxpc3QiPjwvZGl2Pg0KCQk8L2Rpdj4NCiAgICAgIDwvZGl2Pg0KDQogICAgICA8ZGl2IHN0eWxlPSJtYXJnaW4tdG9wOjEycHg7ZmxleDoxO292ZXJmbG93OmF1dG87Zm9udC1zaXplOjEzcHg7Y29sb3I6dmFyKC0tbXV0ZWQpIj4NCiAgICAgICAgPCEtLSBzbWFsbCBoZWxwIC8gc3RhdHVzIGFyZWEgLS0+DQogICAgICAgIDxkaXYgaWQ9InN0YXR1cyI+UmVhZHk8L2Rpdj4NCiAgICAgIDwvZGl2Pg0KPCEtLSBBbHdheXMtdmlzaWJsZSBTZWxlY3RlZCBQYW5lbCAoZGVza3RvcCBvbmx5KSAtLT4NCjxkaXYgaWQ9InNlbGVjdGVkUGFuZWwiIGNsYXNzPSJzZWxlY3RlZC1wYW5lbCI+DQogIDwhLS08ZGl2IGNsYXNzPSJoZWFkIj4NCiAgICA8c3Ryb25nPlNlbGVjdGVkIFRpdGxlcyAoPHNwYW4gaWQ9InNlbGVjdGVkUGFuZWxDb3VudCI+MDwvc3Bhbj4pPC9zdHJvbmc+DQogIDwvZGl2Pi0tPg0KICA8ZGl2IGNsYXNzPSJib2R5IiBpZD0ic2VsZWN0ZWRQYW5lbEJvZHkiPjwvZGl2Pg0KPC9kaXY+DQogICAgPC9hc2lkZT4NCiAgPC9kaXY+DQoNCiAgPCEtLSBTZWxlY3RlZCBvdmVybGF5IC0tPg0KICA8ZGl2IGNsYXNzPSJvdmVybGF5IiBpZD0ib3ZlcmxheSI+DQogICAgPGRpdiBjbGFzcz0iaGVhZCI+PGRpdj48c3Ryb25nPlNlbGVjdGVkIFRpdGxlczwvc3Ryb25nPiDigJQgPHNwYW4gaWQ9Im92ZXJsYXlDb3VudCI+MDwvc3Bhbj48L2Rpdj48ZGl2PjxidXR0b24gaWQ9ImNsb3NlT3ZlcmxheSIgY2xhc3M9ImJ0biBnaG9zdCI+Q2xvc2U8L2J1dHRvbj48L2Rpdj48L2Rpdj4NCiAgICA8ZGl2IGNsYXNzPSJib2R5IiBpZD0ib3ZlcmxheUJvZHkiPjwvZGl2Pg0KICA8L2Rpdj4NCjxkaXYgaWQ9ImZpbGVzTW9kYWwiIHN0eWxlPSJkaXNwbGF5Om5vbmU7cG9zaXRpb246Zml4ZWQ7dG9wOjUwJTtsZWZ0OjUwJTt0cmFuc2Zvcm06dHJhbnNsYXRlKC01MCUsLTUwJSk7DQogIGJhY2tncm91bmQ6I2ZmZjtwYWRkaW5nOjE2cHg7Ym9yZGVyLXJhZGl1czoxMHB4O2JveC1zaGFkb3c6MCA2cHggMThweCByZ2JhKDAsMCwwLDAuMjUpO3otaW5kZXg6MjAwOw0KICBtYXgtd2lkdGg6NDIwcHg7d2lkdGg6OTAlO21heC1oZWlnaHQ6NzB2aDtvdmVyZmxvdzphdXRvO2ZvbnQtc2l6ZToxM3B4Ij4NCjwvZGl2Pg0KPHNjcmlwdD4NCi8vIFJldjYg4oCUIG1lcmdlZCBVSSArIGZ1bGwgZmVhdHVyZXMNCmNvbnN0IHN0YXRlID0geyBpdGVtczogW10sIHNlbGVjdGVkOiBbXSwgeG1sOiBudWxsLCBsYXN0VXBsb2FkOjAgfTsNCmNvbnN0IGxlZnRQYW5lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xlZnRQYW5lJyk7DQpjb25zdCBvdmVybGF5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ292ZXJsYXknKTsNCmNvbnN0IG92ZXJsYXlCb2R5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ292ZXJsYXlCb2R5Jyk7DQpjb25zdCBpc01vYmlsZSA9IC9Nb2JpfEFuZHJvaWR8aVBob25lfGlQYWR8aVBvZC9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCk7DQpjb25zdCBpc0xvY2FsID0gZmFsc2U7DQoNCmZ1bmN0aW9uIGRldGVjdEVudmlyb25tZW50KCkgew0KICBjb25zdCB1YSA9IG5hdmlnYXRvci51c2VyQWdlbnQgfHwgbmF2aWdhdG9yLnZlbmRvciB8fCB3aW5kb3cub3BlcmE7DQogIGNvbnN0IGlzTWVzc2VuZ2VyID0gL0ZCQU58RkJBVnxGQl9JQUJ8TWVzc2VuZ2VyL2kudGVzdCh1YSk7DQogIGNvbnN0IGlzSW5zdGFncmFtID0gL0luc3RhZ3JhbS9pLnRlc3QodWEpOw0KICBjb25zdCBpc0ZhY2Vib29rQXBwID0gL0ZCQU58RkJBVi9pLnRlc3QodWEpICYmICFpc01lc3NlbmdlciAmJiAhaXNJbnN0YWdyYW07DQogIGNvbnN0IGlzV2ViVmlldyA9IC9cYnd2XGIvLnRlc3QodWEpIHx8ICh3aW5kb3cubmF2aWdhdG9yLnN0YW5kYWxvbmUgPT09IGZhbHNlKTsNCg0KICBjb25zdCBlbnYgPSB7DQogICAgaXNNZXNzZW5nZXIsDQogICAgaXNJbnN0YWdyYW0sDQogICAgaXNGYWNlYm9va0FwcCwNCiAgICBpc1dlYlZpZXcNCiAgfTsNCg0KICBpZiAoaXNNZXNzZW5nZXIgfHwgaXNJbnN0YWdyYW0gfHwgaXNXZWJWaWV3KSB7DQogICAgc2hvd0Jhbm5lcigiTWVzc2VuZ2VyIG9yIGluLWFwcCB3ZWJ2aWV3IGRldGVjdGVkLlxuVGhpcyBwYWdlIGlzIGJlc3QgdXNlZCBvbiBhIGZ1bGwgbW9iaWxlIGJyb3dzZXIgb3IgZGVza3RvcCBicm93c2VyLiBidXQgaXQgd2lsbCBwcm9iYWJseSB3b3JrIGFueXdheSIpOw0KCXNob3dCYW5uZXIoIkhvdyB0byB1c2U6IFxuXG4xLiBFbnRlciB5b3VyIG5hbWUsIFxuMi4gU2VsZWN0IHlvdXIgZGV2aWNlIG1vZGVsIFxuIE9sZWQsTGl0ZSxWMVxWMiwgXG5cbiAzLiBTZWxlY3QgeW91ciBTRENBUkQgU2l6ZVxuNC4gUHJlc3MgVXBsb2FkIFxuIDUuIENob29zZSB5b3VyIGdhbWVzXG5cbjYuIFByZXNzIHVwbG9hZCwgU2VuZCB0aGUgZ2VuZXJhdGVkIExpbmsgdG8gb3VyIGNoYXQgY29udmVyc2F0aW9uIik7DQogIH0NCglzaG93QmFubmVyKCJIb3cgdG8gdXNlOiBcblxuMS4gRW50ZXIgeW91ciBuYW1lLCBcbjIuIFNlbGVjdCB5b3VyIGRldmljZSBtb2RlbCBcbiBPbGVkLExpdGUsVjFcVjIsIFxuXG4gMy4gU2VsZWN0IHlvdXIgU0RDQVJEIFNpemVcbjQuIFByZXNzIFVwbG9hZCBcbiA1LiBDaG9vc2UgeW91ciBnYW1lc1xuXG42LiBQcmVzcyB1cGxvYWQsIFNlbmQgdGhlIGdlbmVyYXRlZCBMaW5rIHRvIG91ciBjaGF0IGNvbnZlcnNhdGlvbiIpOw0KICByZXR1cm4gZW52Ow0KfQ0KDQpmdW5jdGlvbiBzaG93QmFubmVyKG1lc3NhZ2UpIHsNCiAgY29uc3QgYmFubmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiZGl2Iik7DQogIGJhbm5lci5pbm5lclRleHQgPSBtZXNzYWdlOw0KICBiYW5uZXIuc3R5bGUucG9zaXRpb24gPSAiZml4ZWQiOw0KICBiYW5uZXIuc3R5bGUudG9wID0gIjMwJSI7DQogIGJhbm5lci5zdHlsZS5sZWZ0ID0gIjQwJSI7DQogIGJhbm5lci5zdHlsZS50cmFuc2Zvcm0gPSAidHJhbnNsYXRlWCgtNTAlKSI7DQogIGJhbm5lci5zdHlsZS5iYWNrZ3JvdW5kID0gInJnYmEoMCwwLDAsMC44KSI7DQogIGJhbm5lci5zdHlsZS5jb2xvciA9ICIjZmZmIjsNCiAgYmFubmVyLnN0eWxlLnBhZGRpbmcgPSAiMThweCAxOHB4IjsNCiAgYmFubmVyLnN0eWxlLmJvcmRlclJhZGl1cyA9ICIxNnB4IjsNCiAgYmFubmVyLnN0eWxlLmZvbnRTaXplID0gIjIycHgiOw0KICBiYW5uZXIuc3R5bGUuekluZGV4ID0gIjk5OTkiOw0KICBiYW5uZXIuc3R5bGUuYm94U2hhZG93ID0gIjAgMnB4IDZweCByZ2JhKDAsMCwwLDAuMykiOw0KICBiYW5uZXIuc3R5bGUudHJhbnNpdGlvbiA9ICJvcGFjaXR5IDAuNXMgZWFzZSI7DQogIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoYmFubmVyKTsNCg0KICBzZXRUaW1lb3V0KCgpID0+IGJhbm5lci5zdHlsZS5vcGFjaXR5ID0gIjAiLCA0MDAwKTsNCiAgc2V0VGltZW91dCgoKSA9PiBiYW5uZXIucmVtb3ZlKCksIDEwMDAwKTsNCn0NCg0KY29uc3QgTUlOX0RFTEFZID0gMTAwMDsNCmxldCBub3cgPSBEYXRlLm5vdygpOw0KbGV0IGxhc3RFeHBvcnRUaW1lID0gRGF0ZS5ub3coKTsNCi8vIHV0aWxzDQpjb25zdCAkID0gaWQ9PmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTsNCmZ1bmN0aW9uIGVzYyhzKXsgcmV0dXJuIChzfHwnJykucmVwbGFjZSgvJi9nLCcmYW1wOycpLnJlcGxhY2UoLzwvZywnJmx0OycpLnJlcGxhY2UoLz4vZywnJmd0OycpOyB9DQpmdW5jdGlvbiB0b2FzdChtc2cpeyAkKCdzdGF0dXMnKS50ZXh0Q29udGVudCA9IG1zZzsgc2V0VGltZW91dCgoKT0+eyBpZigkKCdzdGF0dXMnKS50ZXh0Q29udGVudCA9PT0gbXNnKSAkKCdzdGF0dXMnKS50ZXh0Q29udGVudCA9ICdSZWFkeSc7IH0sIDI1MDApOyB9DQoNCi8vIHNpemUgaGVscGVycw0KZnVuY3Rpb24gcGFyc2VTaXplVGV4dChzKXsgaWYoIXMpIHJldHVybiAwOyBjb25zdCBtID0gKCcnK3MpLm1hdGNoKC8oW1xkXC5dKylccyooR2lCfE1pQnxLaUJ8R0J8TUJ8S0J8QikvaSk7IGlmKCFtKSByZXR1cm4gMDsgY29uc3Qgdj1wYXJzZUZsb2F0KG1bMV0pOyBjb25zdCB1PW1bMl0udG9VcHBlckNhc2UoKTsgaWYodT09PSdCJykgcmV0dXJuIHY7IGlmKHU9PT0nS0InfHx1PT09J0tJQicpIHJldHVybiB2KjEwMjQ7IGlmKHU9PT0nTUInfHx1PT09J01JQicpIHJldHVybiB2KjEwMjQqMTAyNDsgcmV0dXJuIHYqMTAyNCoxMDI0KjEwMjQ7IH0NCmZ1bmN0aW9uIGJ5dGVzVG9HQihiKXsgcmV0dXJuIGIvKDEwMjQqMTAyNCoxMDI0KTsgfQ0KDQovLyBsb2FkIFhNTCAoc3VwcG9ydCA8Zm9sZGVyPiBhbmQgPGdhbWU+KQ0KYXN5bmMgZnVuY3Rpb24gbG9hZFhNTCgpew0KICB0cnl7DQogICAgY29uc3QgdHh0ID0gYXdhaXQgZmV0Y2goJ3N3aXRjaGdhbWVzLnhtbCcpLnRoZW4ocj0+ci50ZXh0KCkpOw0KICAgIGNvbnN0IHhtbCA9IG5ldyBET01QYXJzZXIoKS5wYXJzZUZyb21TdHJpbmcodHh0LCdhcHBsaWNhdGlvbi94bWwnKTsNCiAgICBzdGF0ZS54bWwgPSB4bWw7DQogICAgLy8gcHJlZmVyIGZvbGRlcg0KbGV0IGl0ZW1zID0gQXJyYXkuZnJvbSh4bWwucXVlcnlTZWxlY3RvckFsbCgnZm9sZGVyJykpDQogIC5maWx0ZXIoZiA9PiBmLmdldEF0dHJpYnV0ZSgnbmFtZScpICE9PSAnTlNQIDIwMjEnKSAgLy8g8J+RiCBza2lwDQogIC5tYXAoZiA9PiAoew0KICAgIG5hbWU6IGYuZ2V0QXR0cmlidXRlKCduYW1lJyksDQogICAgc2NvcmU6IGYuZ2V0QXR0cmlidXRlKCdzY29yZScpIHx8ICcwJywNCiAgICBzaXplOiBmLmdldEF0dHJpYnV0ZSgnc2l6ZScpIHx8ICcwIEdpQicsDQogICAgZGF0ZTogZi5nZXRBdHRyaWJ1dGUoJ2RhdGVDcmVhdGVkJykgfHwgJycsDQogICAgZmlsZXM6IEFycmF5LmZyb20oZi5xdWVyeVNlbGVjdG9yQWxsKCdmaWxlJykpLm1hcCh4ID0+IHguZ2V0QXR0cmlidXRlKCduYW1lJykpDQogIH0pKTsNCg0KDQoNCiAgICBpZihpdGVtcy5sZW5ndGg9PT0wKXsgLy8gZmFsbGJhY2sgdG8gZ2FtZSBub2Rlcw0KICAgICAgY29uc3QgZ2FtZXMgPSBBcnJheS5mcm9tKHhtbC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnZ2FtZScpKTsNCiAgICAgIGl0ZW1zID0gZ2FtZXMubWFwKGc9Pih7IG5hbWU6IGcuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3RpdGxlJylbMF0/LnRleHRDb250ZW50IHx8ICdVbnRpdGxlZCcsIHNpemU6IGcuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3NpemUnKVswXT8udGV4dENvbnRlbnQgfHwgJzAgTUInLCBmaWxlczogW10gfSkpOw0KICAgIH0NCiAgICBzdGF0ZS5pdGVtcyA9IGl0ZW1zOw0KICAgIHJlbmRlckxpc3QoaXRlbXMpOw0KICB9Y2F0Y2goZSl7IGNvbnNvbGUuZXJyb3IoZSk7IGxlZnRQYW5lLmlubmVySFRNTCA9ICc8ZGl2IHN0eWxlPSJjb2xvcjojYjkxYzFjO3BhZGRpbmc6MTJweCI+RmFpbGVkIHRvIGxvYWQgc3dpdGNoZ2FtZXMueG1sIOKAlCBjaGVjayBwYXRoL0NPUlM8L2Rpdj4nOyB9DQp9DQoNCi8vIHJlbmRlciBsZWZ0IGxpc3QgYW5kIHByZXNlcnZlIHNlbGVjdGlvbiBoaWdobGlnaHRzDQpmdW5jdGlvbiByZW5kZXJMaXN0KGxpc3QpeyBsZWZ0UGFuZS5pbm5lckhUTUwgPSAnJzsgaWYoIWxpc3R8fCFsaXN0Lmxlbmd0aCl7IGxlZnRQYW5lLmlubmVySFRNTCA9ICc8ZGl2IGNsYXNzPSJtZXRhIj5ObyBpdGVtcyBmb3VuZDwvZGl2Pic7IHJldHVybjsgfQ0KICBsaXN0LmZvckVhY2goaXRlbT0+ew0KICAgIGNvbnN0IHJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOyByb3cuY2xhc3NOYW1lPSdpdGVtJzsgcm93LmRhdGFzZXQubmFtZSA9IGl0ZW0ubmFtZTsgcm93LmRhdGFzZXQuc2l6ZSA9IGl0ZW0uc2l6ZTsNCiAgICByb3cuaW5uZXJIVE1MID0gYCAgPGRpdj4NCiAgICA8YnV0dG9uIGNsYXNzPSJidG4gZ2hvc3QiIHN0eWxlPSJwYWRkaW5nOjJweCA2cHg7Zm9udC1zaXplOjExcHgiDQogICAgICBvbmNsaWNrPSJhbGVydCgnY2xpY2tlZCcpOyBldmVudC5zdG9wUHJvcGFnYXRpb24oKTsgc2hvd0ZpbGVzKCcke2VzYyhpdGVtLm5hbWUpfScsICR7SlNPTi5zdHJpbmdpZnkoaXRlbS5maWxlcyl9LCAnJHtlc2MoaXRlbS5zaXplKX0nKSI+PzwvYnV0dG9uPg0KICAgIDxzdHJvbmc+JHtlc2MoaXRlbS5uYW1lKX08L3N0cm9uZz4NCiAgICA8ZGl2IGNsYXNzPSdtZXRhJz4ke2l0ZW0uc2NvcmUgPyAnU2NvcmU6ICcrZXNjKGl0ZW0uc2NvcmUpIDogJyd9IDsgJHtpdGVtLmRhdGUgPyAnTW9kaWZpZWQ6ICcrZXNjKGl0ZW0uZGF0ZSkgOiAnJ308L2Rpdj4NCiAgPC9kaXY+DQogIDxkaXYgY2xhc3M9J21ldGEnPiR7ZXNjKGl0ZW0uc2l6ZSl9PC9kaXY+YDsNCg0KICAgIGlmKHN0YXRlLnNlbGVjdGVkLnNvbWUocz0+cy5uYW1lPT09aXRlbS5uYW1lKSkgcm93LmNsYXNzTGlzdC5hZGQoJ3NlbGVjdGVkJyk7DQogICAgLy8gYWx0LWNsaWNrIHNob3dzIGZpbGVzDQogICAgcm93LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2KT0+eyBpZihldi5hbHRLZXkpeyBzaG93RmlsZXMoaXRlbS5uYW1lLCBpdGVtLmZpbGVzIHx8IFtdLCBpdGVtLnNpemUpOyByZXR1cm47IH0gdG9nZ2xlU2VsZWN0KGl0ZW0sIHJvdyk7IH0pOw0KICAgIHJvdy5hZGRFdmVudExpc3RlbmVyKCdkYmxjbGljaycsICgpPT4gc2hvd0ZpbGVzKGl0ZW0ubmFtZSwgaXRlbS5maWxlc3x8W10sIGl0ZW0uc2l6ZSkpOw0KICAgIGxlZnRQYW5lLmFwcGVuZENoaWxkKHJvdyk7DQogIH0pOw0KfQ0KDQpmdW5jdGlvbiB0b2dnbGVTZWxlY3QoaXRlbSwgcm93RWwpeyBjb25zdCBpZHggPSBzdGF0ZS5zZWxlY3RlZC5maW5kSW5kZXgocz0+cy5uYW1lPT09aXRlbS5uYW1lKTsgaWYoaWR4Pj0wKXsgc3RhdGUuc2VsZWN0ZWQuc3BsaWNlKGlkeCwxKTsgaWYocm93RWwpIHJvd0VsLmNsYXNzTGlzdC5yZW1vdmUoJ3NlbGVjdGVkJyk7IGVsc2UgeyBjb25zdCByID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuaXRlbScpKS5maW5kKHg9PnguZGF0YXNldC5uYW1lPT09aXRlbS5uYW1lKTsgaWYocikgci5jbGFzc0xpc3QucmVtb3ZlKCdzZWxlY3RlZCcpOyB9IH0gZWxzZSB7IHN0YXRlLnNlbGVjdGVkLnB1c2goeyBuYW1lOml0ZW0ubmFtZSwgc2l6ZTppdGVtLnNpemUgfSk7IGlmKHJvd0VsKSByb3dFbC5jbGFzc0xpc3QuYWRkKCdzZWxlY3RlZCcpOyB9DQogIHVwZGF0ZVRvdGFscygpOyByZW5kZXJPdmVybGF5KCk7IH0NCg0KZnVuY3Rpb24gcmVuZGVyT3ZlcmxheSgpIHsNCiAgb3ZlcmxheUJvZHkuaW5uZXJIVE1MID0gJyc7DQogIHN0YXRlLnNlbGVjdGVkLmZvckVhY2goKHMsaSk9PnsNCiAgICBjb25zdCByb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsNCiAgICByb3cuY2xhc3NOYW1lPSdyb3cnOw0KICAgIHJvdy5pbm5lckhUTUwgPSBgDQogICAgICA8ZGl2Pg0KICAgICAgICA8c3Ryb25nPiR7aSsxfS4gJHtlc2Mocy5uYW1lKX08L3N0cm9uZz4NCiAgICAgICAgPGRpdiBjbGFzcz0nbWV0YSc+JHtlc2Mocy5zaXplKX08L2Rpdj4NCiAgICAgIDwvZGl2Pg0KICAgICAgPGRpdj4NCiAgICAgICAgPGJ1dHRvbiBjbGFzcz0naWNvbiB1cCc+dTwvYnV0dG9uPg0KICAgICAgICA8YnV0dG9uIGNsYXNzPSdpY29uIGRvd24nPmQ8L2J1dHRvbj4NCiAgICAgICAgPGJ1dHRvbiBjbGFzcz0naWNvbiByZW1vdmUnPng8L2J1dHRvbj4NCiAgICAgIDwvZGl2PmA7DQoNCiAgICAvLyBVcA0KICAgIHJvdy5xdWVyeVNlbGVjdG9yKCcudXAnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpPT57DQogICAgICBpZihpPjApew0KICAgICAgICBbc3RhdGUuc2VsZWN0ZWRbaS0xXSwgc3RhdGUuc2VsZWN0ZWRbaV1dID0gW3N0YXRlLnNlbGVjdGVkW2ldLCBzdGF0ZS5zZWxlY3RlZFtpLTFdXTsNCiAgICAgICAgcmVuZGVyT3ZlcmxheSgpOw0KICAgICAgICByZW5kZXJMaXN0KHN0YXRlLml0ZW1zKTsNCiAgICAgICAgdXBkYXRlVG90YWxzKCk7DQogICAgICAgIC8vIGhpZ2hsaWdodCBuZXcgcG9zaXRpb24NCiAgICAgICAgb3ZlcmxheUJvZHkuY2hpbGRyZW5baS0xXS5jbGFzc0xpc3QuYWRkKCdoaWdobGlnaHQnKTsNCiAgICAgIH0NCiAgICB9KTsNCg0KICAgIC8vIERvd24NCiAgICByb3cucXVlcnlTZWxlY3RvcignLmRvd24nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpPT57DQogICAgICBpZihpPHN0YXRlLnNlbGVjdGVkLmxlbmd0aC0xKXsNCiAgICAgICAgW3N0YXRlLnNlbGVjdGVkW2krMV0sIHN0YXRlLnNlbGVjdGVkW2ldXSA9IFtzdGF0ZS5zZWxlY3RlZFtpXSwgc3RhdGUuc2VsZWN0ZWRbaSsxXV07DQogICAgICAgIHJlbmRlck92ZXJsYXkoKTsNCiAgICAgICAgcmVuZGVyTGlzdChzdGF0ZS5pdGVtcyk7DQogICAgICAgIHVwZGF0ZVRvdGFscygpOw0KICAgICAgICAvLyBoaWdobGlnaHQgbmV3IHBvc2l0aW9uDQogICAgICAgIG92ZXJsYXlCb2R5LmNoaWxkcmVuW2krMV0uY2xhc3NMaXN0LmFkZCgnaGlnaGxpZ2h0Jyk7DQogICAgICB9DQogICAgfSk7DQoNCiAgICAvLyBSZW1vdmUNCiAgICByb3cucXVlcnlTZWxlY3RvcignLnJlbW92ZScpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCk9PnsNCiAgICAgIGNvbnN0IHJlbW92ZWQgPSBzdGF0ZS5zZWxlY3RlZC5zcGxpY2UoaSwxKVswXTsNCiAgICAgIGNvbnN0IGxlZnRSb3cgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5pdGVtJykpDQogICAgICAgIC5maW5kKHg9PnguZGF0YXNldC5uYW1lPT09cmVtb3ZlZC5uYW1lKTsNCiAgICAgIGlmKGxlZnRSb3cpIGxlZnRSb3cuY2xhc3NMaXN0LnJlbW92ZSgnc2VsZWN0ZWQnKTsNCiAgICAgIHJlbmRlck92ZXJsYXkoKTsNCiAgICAgIHJlbmRlckxpc3Qoc3RhdGUuaXRlbXMpOw0KICAgICAgdXBkYXRlVG90YWxzKCk7DQogICAgfSk7DQoNCiAgICBvdmVybGF5Qm9keS5hcHBlbmRDaGlsZChyb3cpOw0KICB9KTsNCiAgJCgnb3ZlcmxheUNvdW50JykudGV4dENvbnRlbnQgPSBzdGF0ZS5zZWxlY3RlZC5sZW5ndGg7DQoNCnJlbmRlclNlbGVjdGVkUGFuZWwoKTsNCg0KfQ0KDQoNCi8vIHNob3cvaGlkZSBvdmVybGF5DQokKCdzaG93U2VsZWN0ZWQnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpPT57IG92ZXJsYXkuc3R5bGUuZGlzcGxheSA9ICdmbGV4JzsgcmVuZGVyT3ZlcmxheSgpOyB9KTsNCiQoJ2Nsb3NlT3ZlcmxheScpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCk9PiBvdmVybGF5LnN0eWxlLmRpc3BsYXkgPSAnbm9uZScpOw0KDQovLyBmaWxlcyBtb2RhbA0KbGV0IGN1cnJlbnRNb2RhbCA9IG51bGw7IC8vIHRyYWNrIG9wZW4gbW9kYWwNCmZ1bmN0aW9uIHNob3dGaWxlcyhuYW1lLCBmaWxlcywgc2l6ZSkgew0KICBpZiAoIWZpbGVzIHx8ICFmaWxlcy5sZW5ndGgpIHsNCiAgICBhbGVydChgTm8gZmlsZXMgZm9yICR7bmFtZX1gKTsNCiAgICByZXR1cm47DQogIH0NCg0KDQogIC8vIGNsb3NlIGV4aXN0aW5nIG1vZGFsIGlmIGFueQ0KICBjb25zdCBtb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmaWxlc01vZGFsJyk7DQogIG1vZGFsLmlubmVySFRNTCA9ICcnOyANCiAgbW9kYWwuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogIA0KICAvLyBoZWFkZXINCiAgY29uc3QgaGVhZGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7DQogIGhlYWRlci5pbm5lckhUTUwgPSBgPHN0cm9uZz4ke2VzYyhuYW1lKX08L3N0cm9uZz48YnI+PHNwYW4gY2xhc3M9Im1ldGEiPlNpemU6ICR7ZXNjKHNpemUpfSDigJQgJHtmaWxlcy5sZW5ndGh9IGZpbGVzPC9zcGFuPmA7DQogIG1vZGFsLmFwcGVuZENoaWxkKGhlYWRlcik7DQoNCiAgLy8gZmlsZSBsaXN0IHdpdGggcGFnaW5nDQogIGNvbnN0IGxpc3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsNCiAgbGlzdC5zdHlsZS5tYXJnaW5Ub3AgPSAnOHB4JzsNCiAgbW9kYWwuYXBwZW5kQ2hpbGQobGlzdCk7DQoNCiAgbGV0IGluZGV4ID0gMDsNCiAgY29uc3QgYmF0Y2ggPSAyMDsgLy8gc2hvdyAyMCBhdCBhIHRpbWUNCiAgZnVuY3Rpb24gbG9hZE1vcmUoKSB7DQogICAgY29uc3QgbmV4dCA9IGZpbGVzLnNsaWNlKGluZGV4LCBpbmRleCtiYXRjaCk7DQogICAgbGlzdC5pbm5lckhUTUwgKz0gbmV4dC5tYXAoZj0+ZXNjKGYpKS5qb2luKCc8YnI+Jyk7DQogICAgaW5kZXggKz0gYmF0Y2g7DQogICAgaWYgKGluZGV4ID49IGZpbGVzLmxlbmd0aCkgew0KICAgICAgbW9yZUJ0bi5yZW1vdmUoKTsNCiAgICB9DQogIH0NCiAgDQoNCiAgLy8gTW9yZSBidXR0b24NCiAgY29uc3QgbW9yZUJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpOw0KICBtb3JlQnRuLnRleHRDb250ZW50ID0gJ01vcmUnOw0KICBtb3JlQnRuLmNsYXNzTmFtZSA9ICdidG4gZ2hvc3QnOw0KICBtb3JlQnRuLnN0eWxlLm1hcmdpblRvcCA9ICcxMHB4JzsNCiAgbW9yZUJ0bi5vbmNsaWNrID0gbG9hZE1vcmU7DQogIG1vZGFsLmFwcGVuZENoaWxkKG1vcmVCdG4pOw0KDQogIC8vIENsb3NlIGJ1dHRvbg0KICBjb25zdCBjbG9zZUJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpOw0KICBjbG9zZUJ0bi50ZXh0Q29udGVudCA9ICdDbG9zZSc7DQogIGNsb3NlQnRuLmNsYXNzTmFtZSA9ICdidG4nOw0KICBjbG9zZUJ0bi5zdHlsZS5tYXJnaW5Ub3AgPSAnMTBweCc7DQogIGNsb3NlQnRuLm9uY2xpY2sgPSAoKT0+eyBtb2RhbC5zdHlsZS5kaXNwbGF5PSdub25lJzsgbW9kYWwuaW5uZXJIVE1MPScnOyB9Ow0KICBtb2RhbC5hcHBlbmRDaGlsZChjbG9zZUJ0bik7DQpsb2FkTW9yZSgpOw0KfQ0KDQoNCi8vIHRvdGFscywgaW5zdGFsbCBlc3RpbWF0ZSwgZmlsZW5hbWUgcHJldmlldw0KZnVuY3Rpb24gdXBkYXRlVG90YWxzKCkgew0KICBjb25zdCB0b3RhbEJ5dGVzID0gc3RhdGUuc2VsZWN0ZWQucmVkdWNlKChzdW0sIHMpID0+IHN1bSArIHBhcnNlU2l6ZVRleHQocy5zaXplKSwgMCk7DQogIGNvbnN0IGdiID0gYnl0ZXNUb0dCKHRvdGFsQnl0ZXMpOw0KICAkKCdzZWxlY3RlZFNpemUnKS50ZXh0Q29udGVudCA9IGdiLnRvRml4ZWQoMik7DQoNCiAgY29uc3QgYmxvYXRlZCA9IHRvdGFsQnl0ZXMgKiAxLjI7DQogIGNvbnN0IHNwZWVkID0gMTQgKiAxMDI0ICogMTAyNDsNCiAgY29uc3Qgc2VjcyA9IE1hdGguY2VpbChibG9hdGVkIC8gc3BlZWQpOw0KICAkKCdpbnN0YWxsRXN0aW1hdGUnKS50ZXh0Q29udGVudCA9IGAke01hdGguZmxvb3Ioc2Vjcy8zNjAwKX1oICR7TWF0aC5mbG9vcigoc2VjcyUzNjAwKS82MCl9bWA7DQoNCiAgJCgnY291bnQnKS50ZXh0Q29udGVudCA9IHN0YXRlLnNlbGVjdGVkLmxlbmd0aDsNCg0KICAvLyBzcGFjZSBjYWxjdWxhdGlvbg0KICBjb25zdCBjb25zb2xlVmFsID0gJCgnY29uc29sZScpLnZhbHVlOw0KICBjb25zdCBzZFZhbCA9IE51bWJlcigkKCdzZCcpLnZhbHVlKTsNCiAgY29uc3QgYW5kcm9pZCA9IE51bWJlcigkKCdhbmRyb2lkJykudmFsdWUpOw0KICBjb25zdCBsaW51eCA9IE51bWJlcigkKCdsaW51eCcpLnZhbHVlKTsNCiAgY29uc3QganZmaWxlID0gMTsNCiAgY29uc3QgZW11ID0gY29uc29sZVZhbCA9PT0gJ29sZWQnID8gNjQgOiAzMjsNCiAgY29uc3QgYnVmZmEgPSBNYXRoLmZsb29yKGVtdSAvIDMpOw0KICBjb25zdCB0b3RhbFJlc2VydmVkID0gZW11ICsgYW5kcm9pZCArIGxpbnV4ICsganZmaWxlICsgYnVmZmE7DQogIGNvbnN0IGV4dHJhID0gTWF0aC5mbG9vcihlbXUgLyAyKTsNCiAgY29uc3Qgc3BhY2VGb3JHYW1lcyA9IChzZFZhbCAtIHRvdGFsUmVzZXJ2ZWQpICsgZXh0cmE7DQoNCiAgJCgnc3BhY2UnKS50ZXh0Q29udGVudCA9IGlzRmluaXRlKHNwYWNlRm9yR2FtZXMpID8gc3BhY2VGb3JHYW1lcyA6IDA7DQoNCiAgLy8gaGlnaGxpZ2h0IHdhcm5pbmcgaWYgZXhjZWVkZWQNCiAgaWYgKGdiID4gc3BhY2VGb3JHYW1lcykgew0KICAgICQoJ3NlbGVjdGVkU2l6ZScpLnN0eWxlLmNvbG9yID0gJyNjMDAnOw0KICAgICQoJ3NlbGVjdGVkU2l6ZScpLnN0eWxlLmZvbnRXZWlnaHQgPSAnYm9sZCc7DQogIH0gZWxzZSB7DQogICAgJCgnc2VsZWN0ZWRTaXplJykuc3R5bGUuY29sb3IgPSAnJzsNCiAgICAkKCdzZWxlY3RlZFNpemUnKS5zdHlsZS5mb250V2VpZ2h0ID0gJyc7DQogIH0NCg0KICAvLyBmaWxlbmFtZSBwcmV2aWV3DQogIHVwZGF0ZUZpbGVuYW1lUHJldmlldygpOw0KfQ0KDQoNCg0KDQoNCmZ1bmN0aW9uIHVwZGF0ZUZpbGVuYW1lUHJldmlldygpeyBjb25zdCBjdXN0b21lciA9ICggJCgnY3VzdG9tZXInKS52YWx1ZSB8fCAnY3VzdG9tZXInKS50cmltKCkucmVwbGFjZSgvW15hLXpBLVowLTldL2csJ18nKS50b0xvd2VyQ2FzZSgpOyBjb25zdCBjb25zb2xlVG9rZW4gPSAkKCdjb25zb2xlJykudmFsdWUgfHwgJ3YxJzsgY29uc3Qgc2RUb2tlbiA9ICdzZCcgKyAoJCgnc2QnKS52YWx1ZSB8fCAnMCcpOyBjb25zdCBkcm9pZCA9ICdkcm9pZCcgKyAoJCgnYW5kcm9pZCcpLnZhbHVlIHx8ICcwJyk7IGNvbnN0IGxpbiA9ICdsaW4nICsgKCQoJ2xpbnV4JykudmFsdWUgfHwgJzAnKTsgY29uc3Qgbm93ID0gbmV3IERhdGUoKTsgY29uc3Qgc3RhbXAgPSBub3cuZ2V0RnVsbFllYXIoKS50b1N0cmluZygpICsgU3RyaW5nKG5vdy5nZXRNb250aCgpKzEpLnBhZFN0YXJ0KDIsJzAnKSArIFN0cmluZyhub3cuZ2V0RGF0ZSgpKS5wYWRTdGFydCgyLCcwJykgKyBTdHJpbmcobm93LmdldEhvdXJzKCkpLnBhZFN0YXJ0KDIsJzAnKSArIFN0cmluZyhub3cuZ2V0TWludXRlcygpKS5wYWRTdGFydCgyLCcwJykgKyBTdHJpbmcobm93LmdldFNlY29uZHMoKSkucGFkU3RhcnQoMiwnMCcpOyAkKCdmaWxlbmFtZVByZXZpZXcnKS50ZXh0Q29udGVudCA9IGAke2N1c3RvbWVyfV8ke2NvbnNvbGVUb2tlbn1fJHtzZFRva2VufV8ke2Ryb2lkfV8ke2xpbn1fJHtzdGFtcH0uQ0xJX1BSTVpgOyB9DQoNCi8vIHBhcnNlIHNpemUgc3RyaW5ncyB1c2VkIGJ5IG9yaWdpbmFsIHhtbCAoZS5nLiAiMS4yIEdpQiIgb3IgIjYyMCBNQiIpDQpmdW5jdGlvbiBwYXJzZVNpemVUZXh0KHR4dCl7IGlmKCF0eHQpIHJldHVybiAwOyBjb25zdCBtID0gKCcnK3R4dCkubWF0Y2goLyhbXGRcLl0rKVxzKihHaUJ8TWlCfEtpQnxHQnxNQnxLQnxCKS9pKTsgaWYoIW0pIHJldHVybiAwOyBjb25zdCB2ID0gcGFyc2VGbG9hdChtWzFdKTsgY29uc3QgdSA9IG1bMl0udG9VcHBlckNhc2UoKTsgaWYodT09PSdCJykgcmV0dXJuIHY7IGlmKHU9PT0nS0InfHx1PT09J0tJQicpIHJldHVybiB2KjEwMjQ7IGlmKHU9PT0nTUInfHx1PT09J01JQicpIHJldHVybiB2KjEwMjQqMTAyNDsgcmV0dXJuIHYqMTAyNCoxMDI0KjEwMjQ7IH0NCg0KLy8gd2lyZSBjb250cm9scw0KJCgnc2VhcmNoJykuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBkZWJvdW5jZSgoZSk9PnsgY29uc3QgcT0oZS50YXJnZXQudmFsdWV8fCcnKS50b0xvd2VyQ2FzZSgpOyByZW5kZXJMaXN0KHN0YXRlLml0ZW1zLmZpbHRlcihpdD0+IChpdC5uYW1lfHwnJykudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhxKSkpOyB9LDE4MCkpOw0KJCgnY2xlYXJTZWFyY2gnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpPT57ICQoJ3NlYXJjaCcpLnZhbHVlPScnOyByZW5kZXJMaXN0KHN0YXRlLml0ZW1zKTsgJCgnc2VhcmNoJykuZm9jdXMoKTsgfSk7DQpbJ2N1c3RvbWVyJywnY29uc29sZScsJ3NkJywnYW5kcm9pZCcsJ2xpbnV4J10uZm9yRWFjaChpZD0+eyBjb25zdCBlbD0kKGlkKTsgaWYoZWwpeyBlbC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsICgpPT4gdXBkYXRlRmlsZW5hbWVQcmV2aWV3KCkpOyBlbC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoKT0+IHVwZGF0ZVRvdGFscygpKTsgfX0pOw0KDQovLyBpbXBvcnQgLkNMSV9QUk1aIChyZXN0b3JlIHNlbGVjdGlvbnMgKyBwYXJzZSBmaWxlbmFtZSkNCiQoJ2ZpbGVJbicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIChldik9PnsNCiAgY29uc3QgZiA9IGV2LnRhcmdldC5maWxlc1swXTsgaWYoIWYpIHJldHVybjsgY29uc3QgY2ZnID0gcGFyc2VGaWxlbmFtZVRvQ29uZmlnKGYubmFtZSk7IGlmKGNmZyl7ICQoJ2N1c3RvbWVyJykudmFsdWUgPSBjZmcuY3VzdG9tZXI7IC8vIHNldCBjb25zb2xlIGlmIGF2YWlsYWJsZQ0KICAgIEFycmF5LmZyb20oJCgnY29uc29sZScpLm9wdGlvbnMpLmZvckVhY2gobz0+eyBpZihvLnZhbHVlLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoY2ZnLmNvbnNvbGVUb2tlbikpIG8uc2VsZWN0ZWQgPSB0cnVlOyB9KTsgaWYoL15zZFxkKyQvLnRlc3QoY2ZnLnNkVG9rZW4pKSAkKCdzZCcpLnZhbHVlID0gTnVtYmVyKGNmZy5zZFRva2VuLnJlcGxhY2UoL1xEL2csJycpKTsgaWYoL15kcm9pZFxkKyQvLnRlc3QoY2ZnLmRyb2lkVG9rZW4pKSAkKCdhbmRyb2lkJykudmFsdWUgPSBOdW1iZXIoY2ZnLmRyb2lkVG9rZW4ucmVwbGFjZSgvXEQvZywnJykpOyBpZigvXmxpblxkKyQvLnRlc3QoY2ZnLmxpblRva2VuKSkgJCgnbGludXgnKS52YWx1ZSA9IE51bWJlcihjZmcubGluVG9rZW4ucmVwbGFjZSgvXEQvZywnJykpOyB1cGRhdGVGaWxlbmFtZVByZXZpZXcoKTsgdXBkYXRlVG90YWxzKCk7IH0NCiAgY29uc3QgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsgcmVhZGVyLm9ubG9hZCA9IChlKT0+eyBjb25zdCBsaW5lcyA9IGUudGFyZ2V0LnJlc3VsdC5zcGxpdCgnXG4nKS5tYXAocz0+cy50cmltKCkpLmZpbHRlcihCb29sZWFuKTsgLy8gY2xlYXIgZXhpc3Rpbmcgc2VsZWN0aW9uDQogICAgc3RhdGUuc2VsZWN0ZWQ9W107IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5pdGVtJykuZm9yRWFjaChpPT5pLmNsYXNzTGlzdC5yZW1vdmUoJ3NlbGVjdGVkJykpOw0KICAgIGxpbmVzLmZvckVhY2godGl0bGU9PnsgY29uc3QgbGVmdCA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLml0ZW0nKSkuZmluZChpPT5pLmRhdGFzZXQubmFtZT09PXRpdGxlKTsgaWYobGVmdCl7IGxlZnQuY2xhc3NMaXN0LmFkZCgnc2VsZWN0ZWQnKTsgc3RhdGUuc2VsZWN0ZWQucHVzaCh7IG5hbWU6bGVmdC5kYXRhc2V0Lm5hbWUsIHNpemU6bGVmdC5kYXRhc2V0LnNpemUgfSk7IH0gZWxzZSB7IGNvbnN0IG1heWJlID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuaXRlbScpKS5maW5kKGk9PmkuZGF0YXNldC5uYW1lICYmIGkuZGF0YXNldC5uYW1lLnRvTG93ZXJDYXNlKCk9PT10aXRsZS50b0xvd2VyQ2FzZSgpKTsgaWYobWF5YmUpeyBtYXliZS5jbGFzc0xpc3QuYWRkKCdzZWxlY3RlZCcpOyBzdGF0ZS5zZWxlY3RlZC5wdXNoKHsgbmFtZTptYXliZS5kYXRhc2V0Lm5hbWUsIHNpemU6bWF5YmUuZGF0YXNldC5zaXplIH0pOyB9IH0gfSk7IHVwZGF0ZVRvdGFscygpOyByZW5kZXJPdmVybGF5KCk7IH07DQogIHJlYWRlci5yZWFkQXNUZXh0KGYpOw0KfSk7DQoNCi8vIGV4cG9ydCBjbGllbnQgKGRvd25sb2FkIGxpc3QpDQokKCdzYXZlQnRuJyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCk9PnsNCg0KICBub3cgPSBEYXRlLm5vdygpOw0KICBpZiAobm93IC0gbGFzdEV4cG9ydFRpbWUgPCBNSU5fREVMQVkpIHsNCiAgICB0b2FzdCgnUGxlYXNlIHdhaXQgYmVmb3JlIGV4cG9ydGluZyBhZ2FpbicpOw0KICAgIGFsZXJ0KCdQbGVhc2Ugd2FpdCBiZWZvcmUgZXhwb3J0aW5nIGFnYWluJyk7DQogICAgcmV0dXJuOw0KICB9DQogIGxhc3RFeHBvcnRUaW1lID0gbm93Ow0KDQogIGlmKHN0YXRlLnNlbGVjdGVkLmxlbmd0aD09PTApeyBhbGVydCgnTm8gaXRlbXMgc2VsZWN0ZWQnKTsgcmV0dXJuOyB9DQogIGNvbnN0IGN1c3QgPSAoJCgnY3VzdG9tZXInKS52YWx1ZXx8JycpLnRyaW0oKTsgaWYoIWN1c3QpeyBhbGVydCgnQ3VzdG9tZXIgbmFtZSByZXF1aXJlZCcpOyByZXR1cm47IH0NCiAgY29uc3QgZmlsZW5hbWUgPSAkKCdmaWxlbmFtZVByZXZpZXcnKS50ZXh0Q29udGVudCB8fCAnbGlzdC5DTElfUFJNWic7DQogIGNvbnN0IGJsb2IgPSBuZXcgQmxvYihbc3RhdGUuc2VsZWN0ZWQubWFwKHM9PnMubmFtZSkuam9pbignXG4nKV0sIHsgdHlwZTondGV4dC9wbGFpbicgfSk7IGNvbnN0IGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7IGEuaHJlZiA9IFVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYik7IGEuZG93bmxvYWQgPSBmaWxlbmFtZTsgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChhKTsgYS5jbGljaygpOyBhLnJlbW92ZSgpOyBVUkwucmV2b2tlT2JqZWN0VVJMKGEuaHJlZik7IHRvYXN0KCdTYXZlZCBjbGllbnQgZmlsZScpOw0KfSk7DQoNCi8vIGFkbWluIGV4cG9ydCAoZnVsbCBwYXRocykNCiQoJ2FkbWluRXhwb3J0Jyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgKCk9PnsNCg0KICBub3cgPSBEYXRlLm5vdygpOw0KICBpZiAobm93IC0gbGFzdEV4cG9ydFRpbWUgPCBNSU5fREVMQVkpIHsNCiAgICB0b2FzdCgnUGxlYXNlIHdhaXQgYmVmb3JlIGV4cG9ydGluZyBhZ2FpbicpOw0KICAgIGFsZXJ0KCdQbGVhc2Ugd2FpdCBiZWZvcmUgZXhwb3J0aW5nIGFnYWluJyk7DQogICAgcmV0dXJuOw0KICB9DQogIGxhc3RFeHBvcnRUaW1lID0gbm93Ow0KDQogIGlmKHN0YXRlLnNlbGVjdGVkLmxlbmd0aD09PTApeyBhbGVydCgnTm8gaXRlbXMgc2VsZWN0ZWQnKTsgcmV0dXJuOyB9DQogIGNvbnN0IGN1c3QgPSAoJCgnY3VzdG9tZXInKS52YWx1ZXx8JycpLnRyaW0oKTsgaWYoIWN1c3QpeyBhbGVydCgnQycpOyByZXR1cm47IH0NCiAgdHJ5eyBjb25zdCB4bWx0eHQgPSBhd2FpdCBmZXRjaCgnc3dpdGNoZ2FtZXMueG1sJykudGhlbihyPT5yLnRleHQoKSk7IGNvbnN0IHhtbCA9IG5ldyBET01QYXJzZXIoKS5wYXJzZUZyb21TdHJpbmcoeG1sdHh0LCdhcHBsaWNhdGlvbi94bWwnKTsgbGV0IGNvbnRlbnQ9Jyc7IHN0YXRlLnNlbGVjdGVkLmZvckVhY2goc2VsPT57IGNvbnN0IGZvbGRlciA9IEFycmF5LmZyb20oeG1sLnF1ZXJ5U2VsZWN0b3JBbGwoJ2ZvbGRlcicpKS5maW5kKGY9PmYuZ2V0QXR0cmlidXRlKCduYW1lJyk9PT1zZWwubmFtZSk7IGlmKGZvbGRlcil7IGNvbnN0IGJhc2UgPSAnSzpcXE5TUCAyMDIxXFwnOyBmb2xkZXIucXVlcnlTZWxlY3RvckFsbCgnZmlsZScpLmZvckVhY2goZmlsZT0+IGNvbnRlbnQgKz0gYCR7YmFzZX0ke2ZvbGRlci5nZXRBdHRyaWJ1dGUoJ25hbWUnKX1cXCR7ZmlsZS5nZXRBdHRyaWJ1dGUoJ25hbWUnKX1cbmApOyB9IH0pOyBjb25zdCBub3cgPSBuZXcgRGF0ZSgpOyBjb25zdCBzdGFtcCA9IGAke25vdy5nZXRGdWxsWWVhcigpfSR7U3RyaW5nKG5vdy5nZXRNb250aCgpKzEpLnBhZFN0YXJ0KDIsJzAnKX0ke1N0cmluZyhub3cuZ2V0RGF0ZSgpKS5wYWRTdGFydCgyLCcwJyl9XyR7U3RyaW5nKG5vdy5nZXRIb3VycygpKS5wYWRTdGFydCgyLCcwJyl9JHtTdHJpbmcobm93LmdldE1pbnV0ZXMoKSkucGFkU3RhcnQoMiwnMCcpfWA7IGNvbnN0IGZuYW1lID0gYCR7KGN1c3R8fCdjdXN0b21lcicpLnJlcGxhY2UoL1teYS16QS1aMC05XS9nLCdfJyl9XyR7c3RhbXB9LlBSTVpgOyBjb25zdCBibG9iID0gbmV3IEJsb2IoW2NvbnRlbnRdLCB7IHR5cGU6J3RleHQvcGxhaW4nIH0pOyBjb25zdCBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpOyBhLmhyZWYgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpOyBhLmRvd25sb2FkID0gZm5hbWU7IGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoYSk7IGEuY2xpY2soKTsgYS5yZW1vdmUoKTsgVVJMLnJldm9rZU9iamVjdFVSTChhLmhyZWYpOyB0b2FzdCgnQWRtaW4gZXhwb3J0IHJlYWR5Jyk7IH1jYXRjaChlKXsgY29uc29sZS5lcnJvcihlKTsgdG9hc3QoJ0FkbWluIGV4cG9ydCBmYWlsZWQnKTsgfQ0KfSk7DQoNCi8vIHVwbG9hZCBsb2dpYyAoZmlsZWJpbiB0aGVuIGdvZmlsZSkNCiQoJ3VwbG9hZEJ0bicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgKCk9PnsNCg0KICBpZihzdGF0ZS5zZWxlY3RlZC5sZW5ndGg9PT0wKXsgYWxlcnQoJ05vIGl0ZW1zIHNlbGVjdGVkJyk7IHJldHVybjsgfQ0KICBjb25zdCBjdXN0ID0gKCQoJ2N1c3RvbWVyJykudmFsdWV8fCcnKS50cmltKCk7IGlmKCFjdXN0KXsgYWxlcnQoJ0N1c3RvbWVyIHJlcXVpcmVkJyk7IHJldHVybjsgfQ0KICBpZighY29uZmlybShgVXBsb2FkIGxpc3QgZm9yICR7Y3VzdH0/YCkpIHJldHVybjsgY29uc3QgZmlsZW5hbWUgPSAkKCdmaWxlbmFtZVByZXZpZXcnKS50ZXh0Q29udGVudCB8fCAnbGlzdC5DTElfUFJNWic7IGNvbnN0IGJsb2IgPSBuZXcgQmxvYihbc3RhdGUuc2VsZWN0ZWQubWFwKHM9PnMubmFtZSkuam9pbignXG4nKV0sIHsgdHlwZTondGV4dC9wbGFpbicgfSk7IGNvbnN0IG5vdyA9IERhdGUubm93KCk7IGlmKG5vdyAtIHN0YXRlLmxhc3RVcGxvYWQgPCAxNTAwMCl7IGFsZXJ0KCdQbGVhc2Ugd2FpdCAxNSBzZWNvbmRzIGJldHdlZW4gdXBsb2FkcycpOyByZXR1cm47IH0NCiAgdHJ5eyBjb25zdCBiaW4gPSAneGxnNGtnZ296YmRnc253NCc7IGNvbnN0IHVybCA9IGBodHRwczovL2ZpbGViaW4ubmV0LyR7YmlufS8ke2ZpbGVuYW1lfWA7IGNvbnN0IHIgPSBhd2FpdCBmZXRjaCh1cmwseyBtZXRob2Q6J1BPU1QnLCBoZWFkZXJzOnsgJ0NvbnRlbnQtVHlwZSc6J3RleHQvcGxhaW4nIH0sIGJvZHk6IGJsb2IgfSk7IA0KDQppZihyLm9rIHx8IHIuc3RhdHVzPT09MjAxKXsgc3RhdGUubGFzdFVwbG9hZCA9IG5vdzsgJCgnc2hhcmVhYmxlJykudmFsdWUgPSBgaHR0cHM6Ly9maWxlYmluLm5ldC8ke2Jpbn0vJHtmaWxlbmFtZX1gOyANCnRvYXN0KCdVcGxvYWRlZCB0byBmaWxlYmluJyk7IA0Kc2hvd0Jhbm5lcigiVXBsb2FkIENvbXBsZXRlIC0gUHJlc3MgQ29weSBMaW5rIGFuZCBzZW5kIGl0IHRvIG91ciBjaGF0Iik7DQogICAgICAvLyAgQXV0by1oaWRlIGNvbmZpZyBhZnRlciBzdWNjZXNzDQogICAgICBpZiAoY29uZmlnU2VjdGlvbiAmJiB0b2dnbGVCdG4gJiYgY29uZmlnU2VjdGlvbi5jbGFzc0xpc3QuY29udGFpbnMoJ2FjdGl2ZScpKSB7DQogICAgICAgIGNvbmZpZ1NlY3Rpb24uY2xhc3NMaXN0LnJlbW92ZSgnYWN0aXZlJyk7DQogICAgICAgIHRvZ2dsZUJ0bi50ZXh0Q29udGVudCA9ICdTaG93IENvbmZpZ3VyYXRpb24nOw0KICAgICAgfQ0KcmV0dXJuOyANCn0gfWNhdGNoKGUpeyBjb25zb2xlLndhcm4oJ2ZpbGViaW4gZXJyb3InLCBlKTsgfQ0KICB0cnl7IGNvbnN0IGZvcm0gPSBuZXcgRm9ybURhdGEoKTsgZm9ybS5hcHBlbmQoJ2ZpbGUnLCBibG9iLCBmaWxlbmFtZSk7IGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoKCdodHRwczovL3VwbG9hZC5nb2ZpbGUuaW8vdXBsb2FkRmlsZScsIHsgbWV0aG9kOidQT1NUJywgYm9keTogZm9ybSB9KTsgY29uc3QgaiA9IGF3YWl0IHJlcy5qc29uKCk7IGlmKGouc3RhdHVzID09PSAnb2snKXsgc3RhdGUubGFzdFVwbG9hZCA9IG5vdzsgJCgnc2hhcmVhYmxlJykudmFsdWUgPSBqLmRhdGEuZG93bmxvYWRQYWdlOyB0b2FzdCgnVXBsb2FkZWQgdG8gR29GaWxlJyk7IHJldHVybjsgfSB0b2FzdCgnVXBsb2FkIGZhaWxlZCcpOyB9Y2F0Y2goZSl7IGNvbnNvbGUuZXJyb3IoZSk7IHRvYXN0KCdVcGxvYWQgZXJyb3InKTsgfQ0KfSk7DQoNCi8vIGJpbiBsaXN0DQokKCdiaW5MaXN0Jyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgKCkgPT4gew0KICB0cnkgew0KICAgIGNvbnN0IGJpbiA9ICd4bGc0a2dnb3piZGdzbnc0JzsNCiAgICBjb25zdCByID0gYXdhaXQgZmV0Y2goYGh0dHBzOi8vZmlsZWJpbi5uZXQvJHtiaW59P2pzb25gLCB7DQogICAgICBoZWFkZXJzOiB7ICJBY2NlcHQiOiAiYXBwbGljYXRpb24vanNvbiIgfQ0KICAgIH0pOw0KICAgIGlmICghci5vaykgeyB0b2FzdChgRmFpbGVkIHRvIGZldGNoIHVwbG9hZHM6ICR7ci5zdGF0dXNUZXh0fWApOyByZXR1cm47IH0NCg0KICAgIGxldCBqOw0KICAgIHRyeSB7DQogICAgICBqID0gYXdhaXQgci5qc29uKCk7DQogICAgfSBjYXRjaCAoZXJyKSB7DQogICAgICB0b2FzdCgiRmFpbGVkIHRvIHBhcnNlIHNlcnZlciByZXNwb25zZSIpOw0KICAgICAgY29uc29sZS5lcnJvcihlcnIpOw0KICAgICAgcmV0dXJuOw0KICAgIH0NCg0KICAgIGlmICghai5maWxlcyB8fCAhai5maWxlcy5sZW5ndGgpIHsgdG9hc3QoJ05vIGZpbGVzIGZvdW5kJyk7IHJldHVybjsgfQ0KDQogICAgLy8gc29ydCBhbmQgdHJpbQ0KICAgIGNvbnN0IHNvcnRlZCA9IGouZmlsZXMuc29ydCgoYSxiKT0+IG5ldyBEYXRlKGIudXBkYXRlZF9hdCkgLSBuZXcgRGF0ZShhLnVwZGF0ZWRfYXQpKTsNCiAgICBjb25zdCByZWNlbnQgPSBzb3J0ZWQuc2xpY2UoMCwxMCk7DQoNCiAgICBsZXQgaHRtbCA9ICc8YnV0dG9uIGlkPSJjbG9zZUJpbiI+Q2xvc2U8L2J1dHRvbj48dWw+JzsNCiAgICByZWNlbnQuZm9yRWFjaChmaWxlID0+IHsNCiAgICAgIGNvbnN0IGZpbGVVcmwgPSBgaHR0cHM6Ly9maWxlYmluLm5ldC8ke2Jpbn0vJHtlbmNvZGVVUklDb21wb25lbnQoZmlsZS5maWxlbmFtZSl9YDsNCiAgICAgIGNvbnN0IGFkZGVkRGF0ZSA9IG5ldyBEYXRlKGZpbGUudXBkYXRlZF9hdCk7DQogICAgICBjb25zdCBmb3JtYXR0ZWREYXRlID0gYWRkZWREYXRlLnRvSVNPU3RyaW5nKCkuc2xpY2UoMCwxMCkucmVwbGFjZSgvLS9nLCcnKTsNCiAgICAgIGNvbnN0IGhvdXJzID0gYWRkZWREYXRlLmdldEhvdXJzKCk7DQogICAgICBjb25zdCBtaW51dGVzID0gYWRkZWREYXRlLmdldE1pbnV0ZXMoKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsJzAnKTsNCiAgICAgIGNvbnN0IGFtcG0gPSBob3VycyA+PSAxMiA/ICdQTSc6J0FNJzsNCiAgICAgIGNvbnN0IGZvcm1hdHRlZFRpbWUgPSBgJHtob3VycyAlIDEyIHx8IDEyfToke21pbnV0ZXN9ICR7YW1wbX1gOw0KICAgICAgY29uc3Qgc3RyaXBwZWROYW1lID0gZmlsZS5maWxlbmFtZS5zcGxpdCgnLicpLnNsaWNlKDAsLTEpLmpvaW4oJy4nKTsNCiAgICAgIGNvbnN0IGZpbGVTaXplID0gZmlsZS5ieXRlc19yZWFkYWJsZSB8fCAnJzsNCiAgICAgIGh0bWwgKz0gYDxsaT48YSBocmVmPSIke2ZpbGVVcmx9IiB0YXJnZXQ9Il9ibGFuayI+JHtmb3JtYXR0ZWREYXRlfSAke2Zvcm1hdHRlZFRpbWV9IHwgJHtzdHJpcHBlZE5hbWV9IHwgJHtmaWxlU2l6ZX08L2E+PC9saT5gOw0KICAgIH0pOw0KICAgIGh0bWwgKz0gJzwvdWw+JzsNCg0KICAgIGNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmaWxlTGlzdENvbnRhaW5lcicpOw0KICAgIGNvbnRhaW5lci5pbm5lckhUTUwgPSBodG1sOw0KICAgIGNvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsNCg0KICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjbG9zZUJpbicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gY29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZScpOw0KICB9IGNhdGNoIChlKSB7DQogICAgY29uc29sZS5lcnJvcihlKTsNCiAgICB0b2FzdCgnRXJyb3IgZmV0Y2hpbmcgdXBsb2FkcycpOw0KICB9DQp9KTsNCg0KDQovLyBCdWxrIHNlbGVjdCBhbGwgdmlzaWJsZSBzZWFyY2ggcmVzdWx0cyB3aGVuIHByZXNzaW5nIEVudGVyIGluIHNlYXJjaA0KJCgnc2VhcmNoJykuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIChldikgPT4gew0KICBpZiAoZXYua2V5ID09PSAnRW50ZXInKSB7DQogICAgZXYucHJldmVudERlZmF1bHQoKTsNCiAgICBjb25zdCB2aXNpYmxlSXRlbXMgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5pdGVtJykpDQogICAgICAuZmlsdGVyKGVsID0+IGVsLnN0eWxlLmRpc3BsYXkgIT09ICdub25lJyk7DQogICAgbGV0IGFkZGVkID0gMDsNCiAgICB2aXNpYmxlSXRlbXMuZm9yRWFjaChlbCA9PiB7DQogICAgICBjb25zdCBuYW1lID0gZWwuZGF0YXNldC5uYW1lOw0KICAgICAgY29uc3Qgc2l6ZSA9IGVsLmRhdGFzZXQuc2l6ZTsNCiAgICAgIGlmICghc3RhdGUuc2VsZWN0ZWQuc29tZShzID0+IHMubmFtZSA9PT0gbmFtZSkpIHsNCiAgICAgICAgc3RhdGUuc2VsZWN0ZWQucHVzaCh7IG5hbWUsIHNpemUgfSk7DQogICAgICAgIGVsLmNsYXNzTGlzdC5hZGQoJ3NlbGVjdGVkJyk7DQogICAgICAgIGFkZGVkKys7DQogICAgICB9DQogICAgfSk7DQogICAgaWYgKGFkZGVkID4gMCkgew0KICAgICAgdXBkYXRlVG90YWxzKCk7DQogICAgICByZW5kZXJPdmVybGF5KCk7DQogICAgICB0b2FzdChgQWRkZWQgJHthZGRlZH0gaXRlbXMgZnJvbSBzZWFyY2ggcmVzdWx0c2ApOw0KICAgIH0gZWxzZSB7DQogICAgICB0b2FzdCgnTm8gbmV3IGl0ZW1zIHRvIGFkZCcpOw0KICAgIH0NCiAgfQ0KfSk7DQoNCi8qIGxpbmsgb25seQ0KJCgnY29weUxpbmsnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsNCiAgY29uc3QgbGluayA9ICQoJ3NoYXJlYWJsZScpLnZhbHVlOw0KICBpZiAoIWxpbmspIHsNCiAgICB0b2FzdCgnTm90aGluZyB0byBjb3B5Jyk7DQogICAgcmV0dXJuOw0KICB9DQogIG5hdmlnYXRvci5jbGlwYm9hcmQud3JpdGVUZXh0KGxpbmspLnRoZW4oKCkgPT4gew0KICAgIHRvYXN0KCdMaW5rIGNvcGllZCB0byBjbGlwYm9hcmQnKTsNCiAgfSkuY2F0Y2goKCkgPT4gew0KICAgIGFsZXJ0KCdDb3B5IGZhaWxlZCwgcGxlYXNlIGNvcHkgbWFudWFsbHknKTsNCiAgfSk7DQp9KTsqLw0KJCgnY29weUxpbmsnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsNCmNvbnN0IGN1c3QgPSAoJCgnY3VzdG9tZXInKS52YWx1ZXx8JycpLnRyaW0oKTsgaWYoIWN1c3QpeyBhbGVydCgnQ3VzdG9tZXIgbmFtZSByZXF1aXJlZCcpOyByZXR1cm47IH0NCiAgY29uc3QgbGluayA9ICQoJ3NoYXJlYWJsZScpLnZhbHVlLnRyaW0oKTsNCiAgY29uc3QgdGl0bGVzQXJyID0gc3RhdGUuc2VsZWN0ZWQubWFwKHMgPT4gcy5uYW1lKTsNCg0KICBpZiAodGl0bGVzQXJyLmxlbmd0aCA9PT0gMCkgew0KICAgIHRvYXN0KCdObyBzZWxlY3RlZCBsaXN0IHRvIGNvcHknKTsNCiAgICBhbGVydCgnTm8gc2VsZWN0ZWQgbGlzdCB0byBjb3B5Jyk7DQogICAgcmV0dXJuOw0KICB9DQoNCiAgLy8gY29tcHV0ZSBzaXplDQogIGNvbnN0IHRvdGFsQnl0ZXMgPSBzdGF0ZS5zZWxlY3RlZC5yZWR1Y2UoKHN1bSwgcykgPT4gc3VtICsgcGFyc2VTaXplVGV4dChzLnNpemUpLCAwKTsNCiAgY29uc3QgdG90YWxHQiA9ICh0b3RhbEJ5dGVzIC8gKDEwMjQgKiogMykpLnRvRml4ZWQoMik7DQogIGNvbnN0IGNvdW50ID0gdGl0bGVzQXJyLmxlbmd0aDsNCg0KICBjb25zdCBjdXN0b21lciA9ICgkKCdjdXN0b21lcicpLnZhbHVlIHx8ICcnKS50cmltKCkgfHwgJ1Vua25vd24gY3VzdG9tZXInOw0KICBjb25zdCBmaWxlbmFtZSA9ICQoJ2ZpbGVuYW1lUHJldmlldycpLnRleHRDb250ZW50IHx8ICdsaXN0LkNMSV9QUk1aJzsNCg0KICAvLyB0aW1lc3RhbXANCiAgY29uc3Qgbm93ID0gbmV3IERhdGUoKTsNCiAgY29uc3Qgc3RhbXAgPSBub3cudG9Mb2NhbGVTdHJpbmcoJ2VuLVVTJywgew0KICAgIHllYXI6ICdudW1lcmljJywgbW9udGg6ICcyLWRpZ2l0JywgZGF5OiAnMi1kaWdpdCcsDQogICAgaG91cjogJzItZGlnaXQnLCBtaW51dGU6ICcyLWRpZ2l0Jywgc2Vjb25kOiAnMi1kaWdpdCcNCiAgfSk7DQoNCiAgbGV0IGxpbmtUb1VzZSA9IGxpbms7DQoNCiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLSBOTyBMSU5LIC0tLS0tLS0tLS0tLS0tLS0tLS0NCiAgaWYgKCFsaW5rKSB7DQogICAgY29uc3QgYXNrID0gY29uZmlybSgNCiAgICAgIGBObyBsaW5rIGZvdW5kLlxuXG5gICsNCiAgICAgIGBMaXN0IGNvbnRhaW5zICR7Y291bnR9IGl0ZW1zIHRvdGFsaW5nICR7dG90YWxHQn0gR0IuXG5cbmAgKw0KICAgICAgYFdvdWxkIHlvdSBsaWtlIHRvIHVwbG9hZCBub3c/YA0KICAgICk7DQoNCiAgICBpZiAoYXNrKSB7DQogICAgICAkKCd1cGxvYWRCdG4nKS5jbGljaygpOw0KDQoJc2hvd0Jhbm5lcigiVXBsb2FkaW5n4oCmXG5cblBsZWFzZSB3YWl0IGZvciB0aGUgbGluayB0byBhcHBlYXIsIHRoZW4gcHJlc3MgQ29weSBhZ2Fpbi4iKTsNCiAgICAgIHRvYXN0KCJVcGxvYWRpbmfigKYgd2FpdCBmb3IgbGluaywgdGhlbiBwcmVzcyBDb3B5IGFnYWluIik7DQoNCiAgICAgIHJldHVybjsgLy8gU1RPUCDigJQgZG8gTk9UIGNvbnRpbnVlIGNvcHlpbmcNCiAgICB9DQoNCiAgICBsaW5rVG9Vc2UgPSAnKE5vIGxpbmsgdXBsb2FkZWQpJzsNCiAgfQ0KDQogIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0gU1VNTUFSWSAtLS0tLS0tLS0tLS0tLS0tLS0tDQogIGNvbnN0IHN1bW1hcnkgPQ0KICAgIGBDdXN0b21lcjogJHtjdXN0b21lcn1cbmAgKw0KICAgIGBGaWxlbmFtZTogJHtmaWxlbmFtZX1cbmAgKw0KICAgIGBRdWFudGl0eTogJHtjb3VudH0gaXRlbXNcbmAgKw0KICAgIGBUb3RhbCBTaXplOiAke3RvdGFsR0J9IEdCXG5gICsNCiAgICBgR2VuZXJhdGVkOiAke3N0YW1wfVxuXG5gICsNCiAgICBgJHtsaW5rVG9Vc2V9XG5cbmA7DQoNCiAgY29uc3QgZmluYWxUZXh0ID0gc3VtbWFyeSArIHRpdGxlc0Fyci5qb2luKCdcbicpOw0KDQogIGxldCBtZXNzYWdlID0gbGluaw0KICAgID8gYExpc3QgJiBsaW5rIGNvcGllZC4gKCR7Y291bnR9IGl0ZW1zLCAke3RvdGFsR0J9IEdCKWANCiAgICA6IGBMaXN0IGNvcGllZCAobm8gbGluaykuICgke2NvdW50fSBpdGVtcywgJHt0b3RhbEdCfSBHQilgOw0KDQogIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0gQ09QWSAtLS0tLS0tLS0tLS0tLS0tLS0tDQogIG5hdmlnYXRvci5jbGlwYm9hcmQud3JpdGVUZXh0KGZpbmFsVGV4dCkudGhlbigoKSA9PiB7DQogICAgdG9hc3QobWVzc2FnZS5yZXBsYWNlKC9cbi9nLCAnICcpKTsNCiAgICBhbGVydChtZXNzYWdlKTsNCiAgfSkuY2F0Y2goKCkgPT4gew0KICAgIGFsZXJ0KCdDb3B5IGZhaWxlZCwgcGxlYXNlIGNvcHkgbWFudWFsbHknKTsNCiAgfSk7DQp9KTsNCg0KDQoNCi8qJCgncmVsb2FkQnRuJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7DQogIGlmIChjb25maXJtKCdSZWxvYWQgdGhlIHBhZ2U/IEFsbCB1bnNhdmVkIHNlbGVjdGlvbnMgd2lsbCBiZSBsb3N0LicpKSB7DQogICAgbG9jYXRpb24ucmVsb2FkKCk7DQogIH0NCn0pOyovDQoNCi8vIGZpbGVuYW1lIHBhcnNlIHVzZWQgaW4gaW1wb3J0DQpmdW5jdGlvbiBwYXJzZUZpbGVuYW1lVG9Db25maWcoZm4peyBjb25zdCBiYXNlID0gZm4ucmVwbGFjZSgvXC4oQ0xJX1BSTVp8UFJNWnx0eHQpJC9pLCcnKTsgY29uc3QgcGFydHMgPSBiYXNlLnNwbGl0KCdfJyk7IGlmKHBhcnRzLmxlbmd0aCA8IDUpIHJldHVybiBudWxsOyBjb25zdCB0b2tlbnMgPSBwYXJ0cy5zbGljZSgwLC0xKTsgbGV0IGNvbnNvbGVUb2tlbj0ndjEnLCBzZFRva2VuPSdzZDAnLCBkcm9pZFRva2VuPSdkcm9pZDAnLCBsaW5Ub2tlbj0nbGluMCc7IGZvcihsZXQgaT10b2tlbnMubGVuZ3RoLTE7aT49MDtpLS0peyBjb25zdCB0ID0gdG9rZW5zW2ldLnRvTG93ZXJDYXNlKCk7IGlmKC9ebGluXGQrJC8udGVzdCh0KSAmJiBsaW5Ub2tlbj09PSdsaW4wJyl7IGxpblRva2VuID0gdDsgdG9rZW5zLnNwbGljZShpLDEpOyB9IGVsc2UgaWYoL15kcm9pZFxkKyQvLnRlc3QodCkgJiYgZHJvaWRUb2tlbj09PSdkcm9pZDAnKXsgZHJvaWRUb2tlbiA9IHQ7IHRva2Vucy5zcGxpY2UoaSwxKTsgfSBlbHNlIGlmKC9ec2RcZCskLy50ZXN0KHQpICYmIHNkVG9rZW49PT0nc2QwJyl7IHNkVG9rZW4gPSB0OyB0b2tlbnMuc3BsaWNlKGksMSk7IH0gZWxzZSBpZigvXih2MXx2MnxsaXRlfG9sZWQpJC8udGVzdCh0KSAmJiBjb25zb2xlVG9rZW49PT0ndjEnKXsgY29uc29sZVRva2VuID0gdDsgdG9rZW5zLnNwbGljZShpLDEpOyB9IH0gY29uc3QgY3VzdG9tZXIgPSB0b2tlbnMuam9pbignXycpfHwnY3VzdG9tZXInOyByZXR1cm4geyBjdXN0b21lciwgY29uc29sZVRva2VuLCBzZFRva2VuLCBkcm9pZFRva2VuLCBsaW5Ub2tlbiB9IH0NCg0KLy8gd2lyZSBmaWxlIGlucHV0IGZvciBpbXBvcnQNCiQoJ2ZpbGVJbicpPy5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoZXYpPT57IGNvbnN0IGYgPSBldi50YXJnZXQuZmlsZXNbMF07IGlmKCFmKSByZXR1cm47IGNvbnN0IGNmZyA9IHBhcnNlRmlsZW5hbWVUb0NvbmZpZyhmLm5hbWUpOyBpZihjZmcpeyAkKCdjdXN0b21lcicpLnZhbHVlID0gY2ZnLmN1c3RvbWVyOyBBcnJheS5mcm9tKCQoJ2NvbnNvbGUnKS5vcHRpb25zKS5mb3JFYWNoKG89PnsgaWYoby52YWx1ZT09PWNmZy5jb25zb2xlVG9rZW4pIG8uc2VsZWN0ZWQ9dHJ1ZTsgfSk7IGlmKC9ec2RcZCskLy50ZXN0KGNmZy5zZFRva2VuKSkgJCgnc2QnKS52YWx1ZSA9IE51bWJlcihjZmcuc2RUb2tlbi5yZXBsYWNlKC9cRC9nLCcnKSk7IGlmKC9eZHJvaWRcZCskLy50ZXN0KGNmZy5kcm9pZFRva2VuKSkgJCgnYW5kcm9pZCcpLnZhbHVlID0gTnVtYmVyKGNmZy5kcm9pZFRva2VuLnJlcGxhY2UoL1xEL2csJycpKTsgaWYoL15saW5cZCskLy50ZXN0KGNmZy5saW5Ub2tlbikpICQoJ2xpbnV4JykudmFsdWUgPSBOdW1iZXIoY2ZnLmxpblRva2VuLnJlcGxhY2UoL1xEL2csJycpKTsgdXBkYXRlRmlsZW5hbWVQcmV2aWV3KCk7IHVwZGF0ZVRvdGFscygpOyB9DQogIGNvbnN0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7IHJlYWRlci5vbmxvYWQgPSAoZSk9PnsgY29uc3QgbGluZXMgPSBlLnRhcmdldC5yZXN1bHQuc3BsaXQoJ1xuJykubWFwKHM9PnMudHJpbSgpKS5maWx0ZXIoQm9vbGVhbik7IHN0YXRlLnNlbGVjdGVkPVtdOyBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuaXRlbScpLmZvckVhY2goaT0+aS5jbGFzc0xpc3QucmVtb3ZlKCdzZWxlY3RlZCcpKTsgbGluZXMuZm9yRWFjaCh0aXRsZT0+eyBjb25zdCByb3cgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5pdGVtJykpLmZpbmQoaXQ9PiBpdC5kYXRhc2V0Lm5hbWU9PT10aXRsZSk7IGlmKHJvdyl7IHJvdy5jbGFzc0xpc3QuYWRkKCdzZWxlY3RlZCcpOyBzdGF0ZS5zZWxlY3RlZC5wdXNoKHsgbmFtZTogcm93LmRhdGFzZXQubmFtZSwgc2l6ZTogcm93LmRhdGFzZXQuc2l6ZSB9KTsgfSBlbHNlIHsgY29uc3QgbWF5YmUgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5pdGVtJykpLmZpbmQoaXQ9PiBpdC5kYXRhc2V0Lm5hbWUgJiYgaXQuZGF0YXNldC5uYW1lLnRvTG93ZXJDYXNlKCk9PT10aXRsZS50b0xvd2VyQ2FzZSgpKTsgaWYobWF5YmUpeyBtYXliZS5jbGFzc0xpc3QuYWRkKCdzZWxlY3RlZCcpOyBzdGF0ZS5zZWxlY3RlZC5wdXNoKHsgbmFtZTptYXliZS5kYXRhc2V0Lm5hbWUsIHNpemU6bWF5YmUuZGF0YXNldC5zaXplIH0pOyB9IH0gfSk7IHVwZGF0ZVRvdGFscygpOyByZW5kZXJPdmVybGF5KCk7IH07IHJlYWRlci5yZWFkQXNUZXh0KGYpOyB9KTsNCg0KLy8gaGVscGVycw0KZnVuY3Rpb24gZGVib3VuY2UoZm4sbXM9MjAwKXsgbGV0IGg7IHJldHVybiAoLi4uYSk9PnsgY2xlYXJUaW1lb3V0KGgpOyBoPXNldFRpbWVvdXQoKCk9PmZuKC4uLmEpLG1zKTsgfTsgfQ0KDQovLyBpbml0aWFsIGxvYWQNCihhc3luYyBmdW5jdGlvbiBpbml0KCl7IGF3YWl0IGxvYWRYTUwoKTsgdXBkYXRlVG90YWxzKCk7IHVwZGF0ZUZpbGVuYW1lUHJldmlldygpOyB9KSgpOw0KDQoNCg0KDQpmdW5jdGlvbiByZW5kZXJTZWxlY3RlZFBhbmVsKCkgew0KICBjb25zdCBib2R5ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NlbGVjdGVkUGFuZWxCb2R5Jyk7DQogIC8vY29uc3QgY291bnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2VsZWN0ZWRQYW5lbENvdW50Jyk7DQogIGlmICghYm9keSB8fCAhY291bnQpIHJldHVybjsNCg0KICBib2R5LmlubmVySFRNTCA9ICcnOw0KICBzdGF0ZS5zZWxlY3RlZC5mb3JFYWNoKChzLCBpKSA9PiB7DQogICAgY29uc3Qgcm93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7DQogICAgcm93LmNsYXNzTmFtZSA9ICdyb3cnOw0KICAgIHJvdy5zdHlsZS5kaXNwbGF5ID0gJ2ZsZXgnOw0KICAgIHJvdy5zdHlsZS5qdXN0aWZ5Q29udGVudCA9ICdzcGFjZS1iZXR3ZWVuJzsNCiAgICByb3cuc3R5bGUuYWxpZ25JdGVtcyA9ICdjZW50ZXInOw0KICAgIHJvdy5zdHlsZS5wYWRkaW5nID0gJzZweCAwJzsNCiAgICByb3cuaW5uZXJIVE1MID0gYA0KICAgICAgPGRpdj4NCiAgICAgICAgPHN0cm9uZz4ke2kgKyAxfS4gJHtlc2Mocy5uYW1lKX08L3N0cm9uZz4NCiAgICAgICAgPGRpdiBjbGFzcz0ibWV0YSI+JHtlc2Mocy5zaXplKX08L2Rpdj4NCiAgICAgIDwvZGl2Pg0KICAgICAgPGRpdiBzdHlsZT0iZGlzcGxheTpmbGV4O2dhcDo0cHg7Ij4NCiAgICAgICAgPGJ1dHRvbiBjbGFzcz0iaWNvbiB1cCI+dTwvYnV0dG9uPg0KICAgICAgICA8YnV0dG9uIGNsYXNzPSJpY29uIGRvd24iPmQ8L2J1dHRvbj4NCiAgICAgICAgPGJ1dHRvbiBjbGFzcz0iaWNvbiByZW1vdmUiPng8L2J1dHRvbj4NCiAgICAgIDwvZGl2Pg0KICAgIGA7DQoNCiAgICAvLyBNb3ZlIHVwDQogICAgcm93LnF1ZXJ5U2VsZWN0b3IoJy51cCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gew0KICAgICAgaWYgKGkgPiAwKSB7DQogICAgICAgIFtzdGF0ZS5zZWxlY3RlZFtpIC0gMV0sIHN0YXRlLnNlbGVjdGVkW2ldXSA9IFtzdGF0ZS5zZWxlY3RlZFtpXSwgc3RhdGUuc2VsZWN0ZWRbaSAtIDFdXTsNCiAgICAgICAgcmVuZGVyT3ZlcmxheSgpOw0KICAgICAgICByZW5kZXJMaXN0KHN0YXRlLml0ZW1zKTsNCiAgICAgICAgdXBkYXRlVG90YWxzKCk7DQogICAgICB9DQogICAgfSk7DQoNCiAgICAvLyBNb3ZlIGRvd24NCiAgICByb3cucXVlcnlTZWxlY3RvcignLmRvd24nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsNCiAgICAgIGlmIChpIDwgc3RhdGUuc2VsZWN0ZWQubGVuZ3RoIC0gMSkgew0KICAgICAgICBbc3RhdGUuc2VsZWN0ZWRbaSArIDFdLCBzdGF0ZS5zZWxlY3RlZFtpXV0gPSBbc3RhdGUuc2VsZWN0ZWRbaV0sIHN0YXRlLnNlbGVjdGVkW2kgKyAxXV07DQogICAgICAgIHJlbmRlck92ZXJsYXkoKTsNCiAgICAgICAgcmVuZGVyTGlzdChzdGF0ZS5pdGVtcyk7DQogICAgICAgIHVwZGF0ZVRvdGFscygpOw0KICAgICAgfQ0KICAgIH0pOw0KDQogICAgLy8gUmVtb3ZlDQogICAgcm93LnF1ZXJ5U2VsZWN0b3IoJy5yZW1vdmUnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsNCiAgICAgIHN0YXRlLnNlbGVjdGVkLnNwbGljZShpLCAxKTsNCiAgICAgIHJlbmRlck92ZXJsYXkoKTsNCiAgICAgIHJlbmRlckxpc3Qoc3RhdGUuaXRlbXMpOw0KICAgICAgdXBkYXRlVG90YWxzKCk7DQogICAgfSk7DQoNCiAgICBib2R5LmFwcGVuZENoaWxkKHJvdyk7DQogIH0pOw0KDQogIGNvdW50LnRleHRDb250ZW50ID0gc3RhdGUuc2VsZWN0ZWQubGVuZ3RoOw0KfQ0KDQpjb25zdCB0b2dnbGVCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndG9nZ2xlQ29uZmlnJyk7DQpjb25zdCBjb25maWdTZWN0aW9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NvbmZpZ1NlY3Rpb24nKTsNCg0KDQppZiAoaXNNb2JpbGUgJiYgdG9nZ2xlQnRuICYmIGNvbmZpZ1NlY3Rpb24pIHsNCiAgLy8gU2hvdyBjb25maWcgb25jZSBvbiBmaXJzdCBsb2FkDQogIGNvbmZpZ1NlY3Rpb24uY2xhc3NMaXN0LmFkZCgnYWN0aXZlJyk7DQogIHRvZ2dsZUJ0bi50ZXh0Q29udGVudCA9ICdIaWRlIENvbmZpZ3VyYXRpb24nOw0KDQogIHRvZ2dsZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsNCiAgICBjb25zdCBpc1Zpc2libGUgPSBjb25maWdTZWN0aW9uLmNsYXNzTGlzdC50b2dnbGUoJ2FjdGl2ZScpOw0KICAgIHRvZ2dsZUJ0bi50ZXh0Q29udGVudCA9IGlzVmlzaWJsZSA/ICdIaWRlIENvbmZpZ3VyYXRpb24nIDogJ1Nob3cgQ29uZmlndXJhdGlvbic7DQogIH0pOw0KfQ0KDQovLyAtLS0tLS0tLS0tIFJvYnVzdCBMYXRlc3Qtc29ydCBwYXRjaCAtLS0tLS0tLS0tDQpmdW5jdGlvbiBwYXJzZURhdGVGbGV4aWJsZShzKSB7DQogIGlmICghcykgcmV0dXJuIG51bGw7DQogIC8vIFRyeSBkaXJlY3QgRGF0ZSBwYXJzZSAoSVNPICsgbWFueSBmb3JtYXRzKQ0KICBsZXQgZCA9IG5ldyBEYXRlKHMpOw0KICBpZiAoIWlzTmFOKGQuZ2V0VGltZSgpKSkgcmV0dXJuIGQ7DQoNCiAgLy8gVHJ5IGNvbW1vbiBZLU0tRCBvciBZTUQgKGxpa2UgMjAyNTEwMjAgb3IgMjAyNS0xMC0yMCkNCiAgY29uc3QgeW1kID0gKCcnK3MpLm1hdGNoKC8oXGR7NH0pXEQ/KFxkezEsMn0pXEQ/KFxkezEsMn0pLyk7DQogIGlmICh5bWQpIHsNCiAgICBkID0gbmV3IERhdGUoTnVtYmVyKHltZFsxXSksIE51bWJlcih5bWRbMl0pIC0gMSwgTnVtYmVyKHltZFszXSkpOw0KICAgIGlmICghaXNOYU4oZC5nZXRUaW1lKCkpKSByZXR1cm4gZDsNCiAgfQ0KDQogIC8vIFRyeSBEL00vWSBvciBELU0tWSAoZS5nLiwgMjAvMTAvMjAyNSkNCiAgY29uc3QgZG15ID0gKCcnK3MpLm1hdGNoKC8oXGR7MSwyfSlcRChcZHsxLDJ9KVxEKFxkezR9KS8pOw0KICBpZiAoZG15KSB7DQogICAgZCA9IG5ldyBEYXRlKE51bWJlcihkbXlbM10pLCBOdW1iZXIoZG15WzJdKSAtIDEsIE51bWJlcihkbXlbMV0pKTsNCiAgICBpZiAoIWlzTmFOKGQuZ2V0VGltZSgpKSkgcmV0dXJuIGQ7DQogIH0NCg0KICAvLyBBcyBsYXN0IHJlc29ydCwgdHJ5IGV4dHJhY3RpbmcgWVlZWU1NREQgaW5zaWRlIHN0cmluZw0KICBjb25zdCB5bWQyID0gKCcnK3MpLm1hdGNoKC8oMTl8MjApXGR7Mn1cZHsyfVxkezJ9Lyk7DQogIGlmICh5bWQyKSB7DQogICAgY29uc3Qgc3RyID0geW1kMlswXTsNCiAgICBkID0gbmV3IERhdGUoTnVtYmVyKHN0ci5zbGljZSgwLDQpKSwgTnVtYmVyKHN0ci5zbGljZSg0LDYpKSAtIDEsIE51bWJlcihzdHIuc2xpY2UoNiw4KSkpOw0KICAgIGlmICghaXNOYU4oZC5nZXRUaW1lKCkpKSByZXR1cm4gZDsNCiAgfQ0KDQogIHJldHVybiBudWxsOw0KfQ0KDQpmdW5jdGlvbiBzb3J0QnlMYXRlc3RBbmRSZW5kZXIoKSB7DQogIGlmICghc3RhdGUuaXRlbXMgfHwgc3RhdGUuaXRlbXMubGVuZ3RoID09PSAwKSB7DQogICAgdG9hc3QoJ05vIGxpc3QgbG9hZGVkIHlldCcpOw0KICAgICQoJ3N0YXR1cycpLnRleHRDb250ZW50ID0gJ05vIGxpc3QgbG9hZGVkIHlldCc7DQogICAgcmV0dXJuOw0KICB9DQoNCiAgLy8gYXR0YWNoIGEgbm9ybWFsaXplZCBwYXJzZWREYXRlIG9uIGVhY2ggaXRlbSBmb3Igc3RhYmxlIHNvcnRpbmcNCiAgc3RhdGUuaXRlbXMuZm9yRWFjaChpdCA9PiB7DQogICAgLy8gdHJ5IGl0ZW0uZGF0ZSBmaXJzdCwgZmFsbGJhY2sgdG8gb3RoZXIgcG9zc2libGUga2V5cw0KICAgIGNvbnN0IHJhdyA9IGl0LmRhdGUgfHwgaXQuZGF0ZU1vZGlmaWVkIHx8IGl0Lm1vZGlmaWVkIHx8IGl0Lmxhc3RNb2RpZmllZCB8fCAnJzsNCiAgICBjb25zdCBwZCA9IHBhcnNlRGF0ZUZsZXhpYmxlKHJhdyk7DQogICAgaXQuX3BhcnNlZERhdGUgPSBwZCA/IHBkLmdldFRpbWUoKSA6IDA7IC8vIDAgc29ydHMgdG8gdGhlIGVuZCAob2xkKQ0KICB9KTsNCg0KICAvLyBzb3J0IGluLXBsYWNlIGRlc2NlbmRpbmcgYnkgcGFyc2VkIHRpbWVzdGFtcA0KICBzdGF0ZS5pdGVtcy5zb3J0KChhLCBiKSA9PiBiLl9wYXJzZWREYXRlIC0gYS5fcGFyc2VkRGF0ZSk7DQoNCiAgLy8gcmUtcmVuZGVyIHVzaW5nIHRoZSBub3ctc29ydGVkIHN0YXRlLml0ZW1zDQogIHJlbmRlckxpc3Qoc3RhdGUuaXRlbXMpOw0KDQogIC8vIHZpc2libGUgZmVlZGJhY2sNCiAgdG9hc3QoJ1NvcnRlZCBieSBsYXRlc3QgbW9kaWZpZWQnKTsNCiAgJCgnc3RhdHVzJykudGV4dENvbnRlbnQgPSAnU29ydGVkIGJ5IGxhdGVzdCBtb2RpZmllZCc7DQp9DQpsZXQgc29ydE1vZGUgPSAnbm9ybWFsJzsgLy8gY3ljbGVzOiBub3JtYWwg4oaSIGxhdGVzdCDihpIgc2NvcmUNCg0KZnVuY3Rpb24gc29ydEN5Y2xlKCkgew0KICBpZiAoIXN0YXRlLml0ZW1zIHx8IHN0YXRlLml0ZW1zLmxlbmd0aCA9PT0gMCkgew0KICAgIHRvYXN0KCdObyBsaXN0IGxvYWRlZCB5ZXQnKTsNCiAgICByZXR1cm47DQogIH0NCg0KICBpZiAoc29ydE1vZGUgPT09ICdub3JtYWwnKSB7DQogICAgc29ydE1vZGUgPSAnbGF0ZXN0JzsNCiAgICAvLyBTb3J0IGJ5IGRhdGUNCiAgICBzdGF0ZS5pdGVtcy5mb3JFYWNoKGl0ID0+IHsNCiAgICAgIGNvbnN0IHJhdyA9IGl0LmRhdGUgfHwgaXQuZGF0ZU1vZGlmaWVkIHx8IGl0Lm1vZGlmaWVkIHx8ICcnOw0KICAgICAgY29uc3QgZCA9IHBhcnNlRGF0ZUZsZXhpYmxlKHJhdyk7DQogICAgICBpdC5fcGFyc2VkRGF0ZSA9IGQgPyBkLmdldFRpbWUoKSA6IDA7DQogICAgfSk7DQogICAgY29uc3Qgc29ydGVkID0gWy4uLnN0YXRlLml0ZW1zXS5zb3J0KChhLCBiKSA9PiBiLl9wYXJzZWREYXRlIC0gYS5fcGFyc2VkRGF0ZSk7DQogICAgcmVuZGVyTGlzdChzb3J0ZWQpOw0KICAgIHRvYXN0KCdTb3J0ZWQgYnkgTGF0ZXN0IE1vZGlmaWVkJyk7DQogICAgJCgnc29ydExhdGVzdCcpLnRleHRDb250ZW50ID0gJ0xhdGVzdCc7DQoNCiAgfSBlbHNlIGlmIChzb3J0TW9kZSA9PT0gJ2xhdGVzdCcpIHsNCiAgICBzb3J0TW9kZSA9ICdzY29yZSc7DQogICAgLy8gU29ydCBieSBzY29yZQ0KICAgIGNvbnN0IHNvcnRlZCA9IFsuLi5zdGF0ZS5pdGVtc10uc29ydCgoYSwgYikgPT4gKHBhcnNlSW50KGIuc2NvcmUgfHwgMCkgLSBwYXJzZUludChhLnNjb3JlIHx8IDApKSk7DQogICAgcmVuZGVyTGlzdChzb3J0ZWQpOw0KICAgIHRvYXN0KCdTb3J0ZWQgYnkgU2NvcmUnKTsNCiAgICAkKCdzb3J0TGF0ZXN0JykudGV4dENvbnRlbnQgPSAnVG9wJzsNCg0KICB9IGVsc2Ugew0KICAgIHNvcnRNb2RlID0gJ25vcm1hbCc7DQogICAgLy8gTm9ybWFsIG9yZGVyIChvcmlnaW5hbCBYTUwgb3JkZXIpDQogICAgcmVuZGVyTGlzdChzdGF0ZS5pdGVtcyk7DQogICAgdG9hc3QoJ1NvcnRlZCBieSBOYW1lIChOb3JtYWwpJyk7DQogICAgJCgnc29ydExhdGVzdCcpLnRleHRDb250ZW50ID0gJ1NvcnQnOw0KICB9DQp9DQoNCi8vIEJpbmQgKHNhZmUgZXZlbiBpZiBjYWxsZWQgYmVmb3JlIGxvYWQ7IHdpbGwgY2hlY2sgZm9yIGl0ZW1zIGluc2lkZSkNCmNvbnN0IHNvcnRCdG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc29ydExhdGVzdCcpOw0KaWYgKHNvcnRCdG4pIHsNCiAgc29ydEJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHNvcnRDeWNsZSk7DQp9DQoNCi8vIEFsc28gc3VwcG9ydCB0eXBpbmcgImxhdGVzdCIgaW4gc2VhcmNoDQpjb25zdCBvcmlnU2VhcmNoSGFuZGxlciA9IChlKSA9PiB7DQogIGNvbnN0IHEgPSAoZS50YXJnZXQudmFsdWUgfHwgJycpLnRvTG93ZXJDYXNlKCkudHJpbSgpOw0KICBpZiAocSA9PT0gJ2xhdGVzdCcpIHsNCiAgICBzb3J0QnlMYXRlc3RBbmRSZW5kZXIoKTsNCiAgICByZXR1cm47DQogIH0NCiAgcmVuZGVyTGlzdChzdGF0ZS5pdGVtcy5maWx0ZXIoaXQgPT4gKGl0Lm5hbWUgfHwgJycpLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMocSkpKTsNCn07DQokKCdzZWFyY2gnKS5yZW1vdmVFdmVudExpc3RlbmVyICYmICQoJ3NlYXJjaCcpLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2lucHV0Jywgb3JpZ1NlYXJjaEhhbmRsZXIpOyAvLyBzYWZlIGd1YXJkDQokKCdzZWFyY2gnKS5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIGRlYm91bmNlKG9yaWdTZWFyY2hIYW5kbGVyLCAxODApKTsNCg0KDQoNCmRldGVjdEVudmlyb25tZW50KCk7DQppZiAoIWlzTG9jYWwpIHsNCgkNCiAgY29uc3QgYWRtaW4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYWRtaW5FeHBvcnQnKTsNCiAgaWYgKGFkbWluKSBhZG1pbi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KDQogIGNvbnN0IGJpbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdiaW5MaXN0Jyk7DQogIGlmIChiaW4pIGJpbi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KDQogIC8vY29uc3QgdXBsb2FkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3VwbG9hZEJ0bicpOw0KICAvL2lmICh1cGxvYWQpIHVwbG9hZC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnOw0KDQp9DQoNCg0KPCEtLSBLZWVwIFNlYXJjaCBCYXIgRm9jdXNlZCAoRGVza3RvcCBPbmx5LCBTYWZlIGZvciBDdXN0b21lciBJbnB1dCkgLS0+DQoNCmNvbnN0IHNlYXJjaElucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NlYXJjaCcpOw0KDQoNCmlmICghaXNNb2JpbGUpIHsNCiAgZnVuY3Rpb24gcmVmb2N1c1NlYXJjaCgpIHsNCiAgICBjb25zdCBhY3RpdmUgPSBkb2N1bWVudC5hY3RpdmVFbGVtZW50Ow0KICAgIGlmICgNCiAgICAgIGFjdGl2ZSAmJg0KICAgICAgKGFjdGl2ZS5pZCA9PT0gJ2N1c3RvbWVyJyB8fA0KICAgICAgIGFjdGl2ZS50YWdOYW1lID09PSAnU0VMRUNUJyB8fA0KICAgICAgIGFjdGl2ZS50YWdOYW1lID09PSAnVEVYVEFSRUEnKQ0KICAgICkgcmV0dXJuOw0KICAgIHNlYXJjaElucHV0LmZvY3VzKCk7DQogICAgc2VhcmNoSW5wdXQuc2VsZWN0KCk7DQogIH0NCg0KICAvLyBGb2N1cyBhdCBsb2FkDQogIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgcmVmb2N1c1NlYXJjaCk7DQoNCiAgLy8gUmVmb2N1cyBhZnRlciBub3JtYWwgY2xpY2tzIChub3Qgd2hlbiBtb2RhbC9vdmVybGF5IG9yIHR5cGluZyBlbHNld2hlcmUpDQogIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHsNCiAgICBjb25zdCBtb2RhbE9wZW4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZmlsZXNNb2RhbCcpLnN0eWxlLmRpc3BsYXkgPT09ICdibG9jayc7DQogICAgDQogICAgY29uc3Qgb3ZlcmxheU9wZW4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3ZlcmxheScpLnN0eWxlLmRpc3BsYXkgPT09ICdmbGV4JzsNCiAgICBpZiAoDQogICAgICAhbW9kYWxPcGVuICYmDQogICAgICAhb3ZlcmxheU9wZW4gJiYNCiAgICAgIGUudGFyZ2V0LmlkICE9PSAnc2VhcmNoJyAmJg0KICAgICAgZS50YXJnZXQuaWQgIT09ICdjdXN0b21lcicgJiYNCiAgICAgICFlLnRhcmdldC5jbG9zZXN0KCdzZWxlY3QnKQ0KICAgICkgew0KICAgICAgcmVmb2N1c1NlYXJjaCgpOw0KICAgIH0NCiAgfSk7DQoNCiAgLy8gUmVmb2N1cyBhZnRlciBVSSBidXR0b24gYWN0aW9ucw0KICBbJ2NsZWFyU2VhcmNoJywgJ3Nob3dTZWxlY3RlZCcsICdzYXZlQnRuJywgJ3VwbG9hZEJ0biddLmZvckVhY2goaWQgPT4gew0KICAgIGNvbnN0IGJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTsNCiAgICBpZiAoYnRuKSBidG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCByZWZvY3VzU2VhcmNoKTsNCiAgfSk7DQoNCiAgLy8gUmVmb2N1cyBhZnRlciBzZWxlY3RpbmcgYW4gaXRlbQ0KICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7DQogICAgaWYgKGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnaXRlbScpKSB7DQogICAgICBzZXRUaW1lb3V0KHJlZm9jdXNTZWFyY2gsIDEyMCk7DQogICAgfQ0KICB9KTsNCg0KICAvLyBSZWZvY3VzIGFmdGVyIGNsb3Npbmcgb3ZlcmxheSBvciBmaWxlIG1vZGFsDQogIFsnY2xvc2VPdmVybGF5J10uZm9yRWFjaChpZCA9PiB7DQogICAgY29uc3QgYnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpOw0KICAgIGlmIChidG4pIGJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHNldFRpbWVvdXQocmVmb2N1c1NlYXJjaCwgMjAwKSk7DQogIH0pOw0KDQogIC8vIFJlZm9jdXMgYWZ0ZXIgcHJlc3NpbmcgRW50ZXIgaW4gc2VhcmNoIChhZGQtdG8tbGlzdCBldmVudCkNCiAgc2VhcmNoSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIChldikgPT4gew0KICAgIGlmIChldi5rZXkgPT09ICdFbnRlcicpIHsNCiAgICAgIC8vIFdhaXQgZm9yIHlvdXIgYWRkLXRvLWxpc3QgbG9naWMgdG8gZmluaXNoDQogICAgICBzZXRUaW1lb3V0KHJlZm9jdXNTZWFyY2gsIDE1MCk7DQogICAgfQ0KICB9KTsNCiAgLy9yb3cuYWRkRXZlbnRMaXN0ZW5lcignZGJsY2xpY2snLCAoKSA9PiBzaG93RmlsZXMoaXRlbS5uYW1lLCBpdGVtLmZpbGVzIHx8IFtdLCBpdGVtLnNpemUpKTsNCg0KfQ0KPC9zY3JpcHQ+DQoNCjwvYm9keT4NCjwvaHRtbD4NCg==`;
    const decoded = atob(base64html);
    const iframe = document.getElementById('viewer');
    const doc = iframe.contentWindow.document;
    doc.open();
    doc.write(decoded);
    doc.close();
  </script>
</body>
</html>