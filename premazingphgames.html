<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PremazingPH Games</title>
  <style>
    html, body {
      margin: 0; padding: 0;
      width: 100%; height: 100%;
      overflow: hidden;
    }
    iframe {
      width: 100vw; height: 100vh;
      border: none;
      display: block;
    }
  </style>
</head>
<body>
  <iframe id="viewer"></iframe>
  <script>
    const base64html = `PCFET0NUWVBFIGh0bWw+DQo8aHRtbCBsYW5nPSJlbiI+DQo8aGVhZD4NCjxtZXRhIGNoYXJzZXQ9InV0Zi04IiAvPg0KPG1ldGEgbmFtZT0idmlld3BvcnQiIGNvbnRlbnQ9IndpZHRoPWRldmljZS13aWR0aCxpbml0aWFsLXNjYWxlPTEiIC8+DQo8dGl0bGU+U3dpdGNoIEdhbWVzIOKAlCBSZXY2PC90aXRsZT4NCjxzdHlsZT4NCjpyb290ey0tYmc6I2Y0ZjZmODstLXBhbmVsOiNmZmY7LS1tdXRlZDojNmI3MjgwOy0tcHJpbWFyeTojMDM2NmQ2Oy0tYWNjZW50OiNmZjhhMDA7LS1kYW5nZXI6I2VmNDQ0NDstLXJhZGl1czoxMHB4fQ0KKntib3gtc2l6aW5nOmJvcmRlci1ib3h9DQpodG1sLGJvZHl7aGVpZ2h0OjEwMCU7bWFyZ2luOjA7Zm9udC1mYW1pbHk6SW50ZXIsU2Vnb2UgVUksQXJpYWwsc2Fucy1zZXJpZjtiYWNrZ3JvdW5kOnZhcigtLWJnKTtjb2xvcjojMTExfQ0KLmhlYWRlcntwb3NpdGlvbjpmaXhlZDt0b3A6MDtyaWdodDowO2xlZnQ6MDtoZWlnaHQ6NzZweDtiYWNrZ3JvdW5kOnZhcigtLXBhbmVsKTtkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2dhcDoxMnB4O3BhZGRpbmc6MTBweCAxNHB4O2JvcmRlci1ib3R0b206MXB4IHNvbGlkICNlNmVlZjY7ei1pbmRleDo2MH0NCi5oZWFkZXIgLnNlYXJjaHtmbGV4OjE7bWluLXdpZHRoOjE2MHB4fQ0KLmhlYWRlciBpbnB1dC5zZWFyY2gsIC5oZWFkZXIgYnV0dG9ue2hlaWdodDo0NHB4O2JvcmRlci1yYWRpdXM6MTBweDtib3JkZXI6MXB4IHNvbGlkICNlNmVlZjY7cGFkZGluZzowIDEycHh9DQouaGVhZGVyIC5hY3Rpb25ze2Rpc3BsYXk6ZmxleDtnYXA6OHB4O2FsaWduLWl0ZW1zOmNlbnRlcn0NCi5oZWFkZXIgLnVwbG9hZHtiYWNrZ3JvdW5kOnZhcigtLWFjY2VudCk7Y29sb3I6I2ZmZjtib3JkZXI6bm9uZTtwYWRkaW5nOjEwcHggMTZweDtib3JkZXItcmFkaXVzOjEwcHg7Zm9udC13ZWlnaHQ6NjAwfQ0KLmNvbnRhaW5lcntkaXNwbGF5OmdyaWQ7Z3JpZC10ZW1wbGF0ZS1jb2x1bW5zOjFmciAzODBweDtnYXA6MTJweDtwYWRkaW5nOmNhbGMoNzZweCArIDEycHgpIDEycHggMTZweDtoZWlnaHQ6Y2FsYygxMDB2aCl9DQoubGVmdFBhbmV7YmFja2dyb3VuZDp2YXIoLS1wYW5lbCk7Ym9yZGVyLXJhZGl1czoxMnB4O3BhZGRpbmc6MTJweDtvdmVyZmxvdzphdXRvO2JveC1zaGFkb3c6MCA2cHggMThweCByZ2JhKDEyLDE4LDMwLDAuMDQpfQ0KLnJpZ2h0UGFuZXtiYWNrZ3JvdW5kOnZhcigtLXBhbmVsKTtib3JkZXItcmFkaXVzOjEycHg7cGFkZGluZzoxMnB4O292ZXJmbG93OmhpZGRlbjtib3gtc2hhZG93OjAgNnB4IDE4cHggcmdiYSgxMiwxOCwzMCwwLjA0KTtkaXNwbGF5OmZsZXg7ZmxleC1kaXJlY3Rpb246Y29sdW1ufQ0KLml0ZW17ZGlzcGxheTpmbGV4O2p1c3RpZnktY29udGVudDpzcGFjZS1iZXR3ZWVuO2FsaWduLWl0ZW1zOmNlbnRlcjtwYWRkaW5nOjEwcHg7Ym9yZGVyLXJhZGl1czo4cHg7Ym9yZGVyOjFweCBzb2xpZCB0cmFuc3BhcmVudDtjdXJzb3I6cG9pbnRlcjttYXJnaW4tYm90dG9tOjhweH0NCi5pdGVtOmhvdmVye2JhY2tncm91bmQ6I2ZiZmRmZn0NCi5pdGVtLnNlbGVjdGVke2JhY2tncm91bmQ6IzBiM2I2Njtjb2xvcjojZmZmfQ0KDQoubWV0YXtmb250LXNpemU6MTJweDtjb2xvcjp2YXIoLS1tdXRlZCl9DQouY29udHJvbHN7ZGlzcGxheTpncmlkO2dyaWQtdGVtcGxhdGUtY29sdW1uczoxZnIgMWZyO2dhcDo4cHg7bWFyZ2luLWJvdHRvbTo4cHh9DQouY29udHJvbHMgLmZ1bGx7Z3JpZC1jb2x1bW46MSAvIC0xfQ0KLmZpbGVuYW1lLXByZXZpZXd7Z3JpZC1jb2x1bW46MSAvIC0xO3BhZGRpbmc6OHB4O2JhY2tncm91bmQ6I2Y5ZmFmYjtib3JkZXI6MXB4IHNvbGlkICNlNWU3ZWI7Ym9yZGVyLXJhZGl1czo4cHg7Zm9udC1mYW1pbHk6bW9ub3NwYWNlO292ZXJmbG93LXg6YXV0bzt3aGl0ZS1zcGFjZTpub3dyYXB9DQouaW5mb1Jvd3tkaXNwbGF5OmZsZXg7anVzdGlmeS1jb250ZW50OnNwYWNlLWJldHdlZW47YWxpZ24taXRlbXM6Y2VudGVyO3BhZGRpbmc6MTBweDtib3JkZXItcmFkaXVzOjhweDtiYWNrZ3JvdW5kOiNmZmY7bWFyZ2luLXRvcDo4cHg7Ym9yZGVyOjFweCBzb2xpZCAjZjFmNWY5fQ0KLmJ0bntwYWRkaW5nOjhweCAxMnB4O2JvcmRlci1yYWRpdXM6OHB4O2JvcmRlcjpub25lO2JhY2tncm91bmQ6dmFyKC0tcHJpbWFyeSk7Y29sb3I6I2ZmZjtjdXJzb3I6cG9pbnRlcn0NCi5idG4uZ2hvc3R7YmFja2dyb3VuZDp0cmFuc3BhcmVudDtjb2xvcjp2YXIoLS1wcmltYXJ5KTtib3JkZXI6MXB4IHNvbGlkICNlNmVlZjZ9DQouc21hbGx7Zm9udC1zaXplOjEzcHg7Y29sb3I6dmFyKC0tbXV0ZWQpfQ0KLm92ZXJsYXl7cG9zaXRpb246Zml4ZWQ7aW5zZXQ6MDtiYWNrZ3JvdW5kOnJnYmEoMjE1LDI0MCwyNTAsLjk1KTtkaXNwbGF5Om5vbmU7ZmxleC1kaXJlY3Rpb246Y29sdW1uO3otaW5kZXg6MTUwfQ0KLm92ZXJsYXkgLmhlYWR7ZGlzcGxheTpmbGV4O2p1c3RpZnktY29udGVudDpzcGFjZS1iZXR3ZWVuO3BhZGRpbmc6MTJweDtiYWNrZ3JvdW5kOnJnYmEoMCwwLDAsMC41NSk7YWxpZ24taXRlbXM6Y2VudGVyfQ0KLm92ZXJsYXkgLmJvZHl7cGFkZGluZzoxMnB4O292ZXJmbG93OmF1dG87ZmxleDoxfQ0KLm92ZXJsYXkgLnJvd3tkaXNwbGF5OmZsZXg7anVzdGlmeS1jb250ZW50OnNwYWNlLWJldHdlZW47YWxpZ24taXRlbXM6Y2VudGVyO3BhZGRpbmc6OHB4O2JvcmRlci1ib3R0b206MXB4IHNvbGlkIHJnYmEoMjU1LDI1NSwyNTUsMC4wNil9DQoNCi8qIEhpZ2hsaWdodCByZWNlbnRseSBtb3ZlZCBpdGVtICovDQoub3ZlcmxheSAucm93LmhpZ2hsaWdodCB7DQogIGJhY2tncm91bmQ6ICNmZmYzY2Q7ICAgLyogc29mdCB5ZWxsb3cgKi8NCiAgdHJhbnNpdGlvbjogYmFja2dyb3VuZCAwLjZzIGVhc2U7DQp9DQojZmlsZXNNb2RhbDo6YmFja2Ryb3Agew0KICBiYWNrZ3JvdW5kOiByZ2JhKDAsMCwwLDAuMyk7DQp9DQovKiBSZWQgd2FybmluZyBmb3Igb3ZlcmZsb3cgKi8NCiN0b3RhbHMuZXhjZWVkZWQgew0KICBjb2xvcjogI2MwMDsNCiAgZm9udC13ZWlnaHQ6IGJvbGQ7DQp9DQouYnRuLmRhbmdlciB7DQogIGJhY2tncm91bmQ6ICNjMDA7DQogIGNvbG9yOiAjZmZmOw0KfQ0KDQoNCi5vdmVybGF5IGJ1dHRvbi5pY29ue3BhZGRpbmc6NnB4IDhweDtib3JkZXItcmFkaXVzOjZweDtib3JkZXI6bm9uZTtjdXJzb3I6cG9pbnRlcjttYXJnaW4tbGVmdDo2cHh9DQoub3ZlcmxheSBidXR0b24udXAsIC5vdmVybGF5IGJ1dHRvbi5kb3due2JhY2tncm91bmQ6I2ZmZjtjb2xvcjojMTExfQ0KLm92ZXJsYXkgYnV0dG9uLnJlbW92ZXtiYWNrZ3JvdW5kOnZhcigtLWRhbmdlcik7Y29sb3I6I2ZmZn0NCi5mb290ZXJDb250cm9sc3tkaXNwbGF5OmZsZXg7Z2FwOjhweDtmbGV4LXdyYXA6d3JhcDthbGlnbi1pdGVtczpjZW50ZXJ9DQpAbWVkaWEgKG1heC13aWR0aDo5MDBweCl7DQogIC5jb250YWluZXJ7Z3JpZC10ZW1wbGF0ZS1jb2x1bW5zOjFmcjsgcGFkZGluZy10b3A6Y2FsYyg3NnB4ICsgOHB4KX0NCiAgLnJpZ2h0UGFuZXtvcmRlcjotMX0NCiAgLmhlYWRlcntwYWRkaW5nOjhweH0NCn0NCg0KLyogRGVza3RvcCBzaWRlLWJ5LXNpZGUgc2VsZWN0ZWQgcGFuZWwgKi8NCi5zZWxlY3RlZC1wYW5lbCB7DQogIG1hcmdpbi10b3A6IDEycHg7DQogIGJhY2tncm91bmQ6IHZhcigtLXBhbmVsKTsNCiAgYm9yZGVyOiAxcHggc29saWQgI2U2ZWVmNjsNCiAgYm9yZGVyLXJhZGl1czogMTBweDsNCiAgYm94LXNoYWRvdzogMCA0cHggMTJweCByZ2JhKDAsMCwwLDAuMDUpOw0KICBkaXNwbGF5OiBmbGV4Ow0KICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOw0KICBoZWlnaHQ6IDEwMCU7DQogIG92ZXJmbG93OiBoaWRkZW47DQp9DQoNCi5zZWxlY3RlZC1wYW5lbCAuaGVhZCB7DQogIGJhY2tncm91bmQ6ICNmOGZhZmM7DQogIHBhZGRpbmc6IDhweCAxMnB4Ow0KICBib3JkZXItYm90dG9tOiAxcHggc29saWQgI2U2ZWVmNjsNCiAgZm9udC13ZWlnaHQ6IDYwMDsNCiAgZm9udC1zaXplOiAxNHB4Ow0KfQ0KDQouc2VsZWN0ZWQtcGFuZWwgLmJvZHkgew0KICBmbGV4OiAxOw0KICBvdmVyZmxvdy15OiBhdXRvOw0KICBmb250LXNpemU6IDEzcHg7DQogIHBhZGRpbmc6IDhweCAxMnB4Ow0KfQ0KDQovKiBIaWRlIG9uIG1vYmlsZSAqLw0KQG1lZGlhIChtYXgtd2lkdGg6IDkwMHB4KSB7DQogIC5zZWxlY3RlZC1wYW5lbCB7DQogICAgZGlzcGxheTogbm9uZSAhaW1wb3J0YW50Ow0KICB9DQp9DQovKiAtLS0gQ29uZmlndXJhdGlvbiBzZWN0aW9uIHZpc2liaWxpdHkgLS0tICovDQouY29uZmlnLXNlY3Rpb24gew0KICB0cmFuc2l0aW9uOiBhbGwgMC4yNXMgZWFzZTsNCn0NCg0KLm1vYmlsZS1vbmx5IHsNCiAgZGlzcGxheTogbm9uZTsNCn0NCg0KLyogTW9iaWxlIGJlaGF2aW9yICovDQpAbWVkaWEgKG1heC13aWR0aDogOTAwcHgpIHsNCiAgLm1vYmlsZS1vbmx5IHsNCiAgICBkaXNwbGF5OiBibG9jazsNCiAgfQ0KDQogIC5jb25maWctc2VjdGlvbiB7DQogICAgZGlzcGxheTogbm9uZTsNCiAgfQ0KDQogIC5jb25maWctc2VjdGlvbi5hY3RpdmUgew0KICAgIGRpc3BsYXk6IGJsb2NrOw0KICB9DQp9DQoNCjwvc3R5bGU+DQo8L2hlYWQ+DQo8Ym9keT4NCiAgPGRpdiBjbGFzcz0iaGVhZGVyIj4NCiAgICA8IS0tPGJ1dHRvbiBpZD0icmVsb2FkQnRuIiBjbGFzcz0iYnRuIGRhbmdlciI+UmVsb2FkPC9idXR0b24+LS0+DQo8aW5wdXQgaWQ9InNlYXJjaCIgY2xhc3M9InNlYXJjaCIgdHlwZT0idGV4dCIgcGxhY2Vob2xkZXI9IlNlYXJjaCBnYW1lcy4uLiI+DQogICAgPGRpdiBjbGFzcz0iYWN0aW9ucyI+DQogICAgICA8YnV0dG9uIGlkPSJjbGVhclNlYXJjaCIgY2xhc3M9ImJ0biBnaG9zdCI+fjwvYnV0dG9uPg0KICAgICAgPGJ1dHRvbiBpZD0ic2hvd1NlbGVjdGVkIiBjbGFzcz0iYnRuIGdob3N0Ij5TaG93PC9idXR0b24+DQo8YnV0dG9uIGlkPSJzb3J0TGF0ZXN0IiBjbGFzcz0iYnRuIGdob3N0Ij5Tb3J0PC9idXR0b24+DQoNCiAgICAgIDxidXR0b24gaWQ9InVwbG9hZEJ0biIgY2xhc3M9ImJ0biBnaG9zdCI+VXBsb2FkPC9idXR0b24+DQoNCiAgICA8L2Rpdj4NCiAgPC9kaXY+DQoNCiAgPGRpdiBjbGFzcz0iY29udGFpbmVyIj4NCiAgICA8c2VjdGlvbiBjbGFzcz0ibGVmdFBhbmUiIGlkPSJsZWZ0UGFuZSIgYXJpYS1sYWJlbD0iR2FtZSBsaXN0Ij4NCiAgICAgIDwhLS0gbGlzdCBpbmplY3RlZCAtLT4NCiAgICA8L3NlY3Rpb24+DQoNCiAgICA8YXNpZGUgY2xhc3M9InJpZ2h0UGFuZSI+DQo8IS0tIENvbmZpZyBzZWN0aW9uIC0tPg0KPGJ1dHRvbiBpZD0idG9nZ2xlQ29uZmlnIiBjbGFzcz0iYnRuIGdob3N0IG1vYmlsZS1vbmx5IiBzdHlsZT0ibWFyZ2luLWJvdHRvbTo4cHg7Ij5IaWRlIENvbmZpZ3VyYXRpb248L2J1dHRvbj4NCg0KPGRpdiBpZD0iY29uZmlnU2VjdGlvbiIgY2xhc3M9ImNvbmZpZy1zZWN0aW9uIj4NCiAgICAgIDxkaXYgY2xhc3M9ImNvbnRyb2xzIj4NCiAgICAgICAgPGlucHV0IGlkPSJjdXN0b21lciIgY2xhc3M9ImZ1bGwiIHR5cGU9InRleHQiIHBsYWNlaG9sZGVyPSJDdXN0b21lciBuYW1lICh1c2UgdW5kZXJzY29yZXMpIj4NCiAgICAgICAgPGRpdiBjbGFzcz0iZmlsZW5hbWUtcHJldmlldyIgaWQ9ImZpbGVuYW1lUHJldmlldyI+RmlsZW5hbWUgcHJldmlldyB3aWxsIGFwcGVhciBoZXJl4oCmPC9kaXY+DQoJCQ0KICAgICAgICA8ZGl2Pg0KICAgICAgICAgIDxsYWJlbCBjbGFzcz0ic21hbGwiPkNvbnNvbGU8L2xhYmVsPg0KICAgICAgICAgIDxzZWxlY3QgaWQ9ImNvbnNvbGUiIGFyaWEtbGFiZWw9IkNvbnNvbGUgdHlwZSI+DQogICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSJ2MSI+djE8L29wdGlvbj4NCiAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9InYyIj52Mjwvb3B0aW9uPg0KICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0ibGl0ZSI+bGl0ZTwvb3B0aW9uPg0KICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0ib2xlZCI+b2xlZDwvb3B0aW9uPg0KICAgICAgICAgIDwvc2VsZWN0Pg0KICAgICAgICA8L2Rpdj4NCiAgICAgICAgPGRpdj4NCiAgICAgICAgICA8bGFiZWwgY2xhc3M9InNtYWxsIj5TRCBDYXJkIChHQik8L2xhYmVsPg0KICAgICAgICAgIDxzZWxlY3QgaWQ9InNkIiBhcmlhLWxhYmVsPSJTRCBjYXJkIj4NCiAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9IjEyOCI+MTI4PC9vcHRpb24+DQogICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSIyNTYiPjI1Njwvb3B0aW9uPg0KICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iNTEyIj41MTI8L29wdGlvbj4NCiAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9IjEwMjQiPjEwMjQ8L29wdGlvbj4NCiAgICAgICAgICA8L3NlbGVjdD4NCiAgICAgICAgPC9kaXY+DQoNCiAgICAgICAgPGRpdj4NCiAgICAgICAgICA8bGFiZWwgY2xhc3M9InNtYWxsIj5BbmRyb2lkIChHQik8L2xhYmVsPg0KICAgICAgICAgIDxzZWxlY3QgaWQ9ImFuZHJvaWQiIGFyaWEtbGFiZWw9ImFuZHJvaWQgc2l6ZSI+DQogICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSIwIj4wPC9vcHRpb24+DQogICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSIxNiI+MTY8L29wdGlvbj4NCiAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9IjMyIj4zMjwvb3B0aW9uPg0KICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iNjQiPjY0PC9vcHRpb24+DQogICAgICAgICAgPC9zZWxlY3Q+DQogICAgICAgIDwvZGl2Pg0KICAgICAgICA8ZGl2Pg0KICAgICAgICAgIDxsYWJlbCBjbGFzcz0ic21hbGwiPkxpbnV4IChHQik8L2xhYmVsPg0KICAgICAgICAgIDxzZWxlY3QgaWQ9ImxpbnV4IiBhcmlhLWxhYmVsPSJsaW51eCBzaXplIj4NCiAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9IjAiPjA8L29wdGlvbj4NCiAgICAgICAgICAgIDxvcHRpb24gdmFsdWU9IjE2Ij4xNjwvb3B0aW9uPg0KICAgICAgICAgICAgPG9wdGlvbiB2YWx1ZT0iMzIiPjMyPC9vcHRpb24+DQogICAgICAgICAgICA8b3B0aW9uIHZhbHVlPSI2NCI+NjQ8L29wdGlvbj4NCiAgICAgICAgICA8L3NlbGVjdD4NCiAgICAgICAgPC9kaXY+DQogICAgICA8L2Rpdj4NCg0KICAgICAgPGRpdiBjbGFzcz0iaW5mb1JvdyIgc3R5bGU9Im1hcmdpbi10b3A6OHB4OyI+DQogICAgICAgIDxkaXY+DQogICAgICAgICAgPGRpdiBjbGFzcz0ic21hbGwiPlNwYWNlIGZvciBnYW1lczwvZGl2Pg0KICAgICAgICAgIDxkaXY+PHN0cm9uZyBpZD0ic3BhY2UiPjA8L3N0cm9uZz4gR0I8L2Rpdj4NCiAgICAgICAgPC9kaXY+DQogICAgICAgIDxkaXY+DQogICAgICAgICAgPGRpdiBjbGFzcz0ic21hbGwiPlNlbGVjdGVkIHNpemU8L2Rpdj4NCiAgICAgICAgICA8ZGl2PjxzdHJvbmcgaWQ9InNlbGVjdGVkU2l6ZSI+MC4wMDwvc3Ryb25nPiBHQjwvZGl2Pg0KICAgICAgICA8L2Rpdj4NCiAgICAgIDwvZGl2Pg0KDQogICAgICA8ZGl2IGNsYXNzPSJpbmZvUm93IiBzdHlsZT0ibWFyZ2luLXRvcDo4cHg7Ij4NCiAgICAgICAgPGRpdj4NCiAgICAgICAgICA8ZGl2IGNsYXNzPSJzbWFsbCI+SW5zdGFsbCBlc3RpbWF0ZTwvZGl2Pg0KICAgICAgICAgIDxkaXY+PHNwYW4gaWQ9Imluc3RhbGxFc3RpbWF0ZSI+MGggMG08L3NwYW4+PC9kaXY+DQogICAgICAgIDwvZGl2Pg0KICAgICAgICA8ZGl2Pg0KICAgICAgICAgIDxkaXYgY2xhc3M9InNtYWxsIj5TZWxlY3RlZDwvZGl2Pg0KICAgICAgICAgIDxkaXY+PHNwYW4gaWQ9ImNvdW50Ij4wPC9zcGFuPiBnYW1lczwvZGl2Pg0KICAgICAgICA8L2Rpdj4NCiAgICAgIDwvZGl2Pg0KDQogIDwvZGl2Pg0KICAgICAgPGRpdiBzdHlsZT0ibWFyZ2luLXRvcDoxMnB4O2Rpc3BsYXk6ZmxleDtnYXA6OHB4O2FsaWduLWl0ZW1zOmNlbnRlcjsiPg0KICAgICAgICA8YnV0dG9uIGlkPSJjb3B5TGluayIgY2xhc3M9ImJ0biI+Q29weSBMaW5rPC9idXR0b24+DQoJCTxpbnB1dCBpZD0ic2hhcmVhYmxlIiB0eXBlPSJ0ZXh0IiBwbGFjZWhvbGRlcj0iVXBsb2FkZWQgZmlsZSBsaW5rIiBzdHlsZT0iZmxleDoxO3BhZGRpbmc6OHB4O2JvcmRlci1yYWRpdXM6OHB4O2JvcmRlcjoxcHggc29saWQgI2U2ZWVmNiIgcmVhZG9ubHk+DQogICAgICAgIDxidXR0b24gaWQ9InNhdmVCdG4iIGNsYXNzPSJidG4iPlNhdmU8L2J1dHRvbj48bGFiZWwgZm9yPSJmaWxlSW4iIHN0eWxlPSINCiAgYmFja2dyb3VuZDojM2E2ZGYwOw0KICBjb2xvcjojZmZmOw0KICBwYWRkaW5nOjVweCA1cHg7DQogIGJvcmRlci1yYWRpdXM6M3B4Ow0KICBmb250LXNpemU6MTJweDsNCiAgY3Vyc29yOnBvaW50ZXI7DQogIGZvbnQtZmFtaWx5OnNhbnMtc2VyaWY7DQogIGRpc3BsYXk6aW5saW5lLWJsb2NrOw0KIj4NCiAgT3Blbg0KPC9sYWJlbD4NCjxpbnB1dCBpZD0iZmlsZUluIiB0eXBlPSJmaWxlIiBhY2NlcHQ9Ii5DTElfUFJNWiIgc3R5bGU9ImRpc3BsYXk6bm9uZTsiPg0KICAgICAgPC9kaXY+DQoNCiAgICAgIDxkaXYgc3R5bGU9Im1hcmdpbi10b3A6MTJweDtkaXNwbGF5OmZsZXg7Z2FwOjhweDthbGlnbi1pdGVtczpjZW50ZXI7ZmxleC13cmFwOndyYXAiPg0KICAgICAgICANCg0KICAgICAgICA8YnV0dG9uIGlkPSJhZG1pbkV4cG9ydCIgY2xhc3M9ImJ0biBnaG9zdCI+RXhwb3J0IEFkbWluPC9idXR0b24+DQogICAgICAgIDxidXR0b24gaWQ9ImJpbkxpc3QiIGNsYXNzPSJidG4gZ2hvc3QiPlVwbG9hZHM8L2J1dHRvbj4NCgkJPGRpdiBpZD0iZmlsZUxpc3RDb250YWluZXIiIHN0eWxlPSJkaXNwbGF5Om5vbmU7Ij4NCgkJICA8ZGl2IGlkPSJiaW5GaWxlTGlzdCI+PC9kaXY+DQoJCTwvZGl2Pg0KICAgICAgPC9kaXY+DQoNCiAgICAgIDxkaXYgc3R5bGU9Im1hcmdpbi10b3A6MTJweDtmbGV4OjE7b3ZlcmZsb3c6YXV0bztmb250LXNpemU6MTNweDtjb2xvcjp2YXIoLS1tdXRlZCkiPg0KICAgICAgICA8IS0tIHNtYWxsIGhlbHAgLyBzdGF0dXMgYXJlYSAtLT4NCiAgICAgICAgPGRpdiBpZD0ic3RhdHVzIj5SZWFkeTwvZGl2Pg0KICAgICAgPC9kaXY+DQo8IS0tIEFsd2F5cy12aXNpYmxlIFNlbGVjdGVkIFBhbmVsIChkZXNrdG9wIG9ubHkpIC0tPg0KPGRpdiBpZD0ic2VsZWN0ZWRQYW5lbCIgY2xhc3M9InNlbGVjdGVkLXBhbmVsIj4NCiAgPCEtLTxkaXYgY2xhc3M9ImhlYWQiPg0KICAgIDxzdHJvbmc+U2VsZWN0ZWQgVGl0bGVzICg8c3BhbiBpZD0ic2VsZWN0ZWRQYW5lbENvdW50Ij4wPC9zcGFuPik8L3N0cm9uZz4NCiAgPC9kaXY+LS0+DQogIDxkaXYgY2xhc3M9ImJvZHkiIGlkPSJzZWxlY3RlZFBhbmVsQm9keSI+PC9kaXY+DQo8L2Rpdj4NCiAgICA8L2FzaWRlPg0KICA8L2Rpdj4NCg0KICA8IS0tIFNlbGVjdGVkIG92ZXJsYXkgLS0+DQogIDxkaXYgY2xhc3M9Im92ZXJsYXkiIGlkPSJvdmVybGF5Ij4NCiAgICA8ZGl2IGNsYXNzPSJoZWFkIj48ZGl2PjxzdHJvbmc+U2VsZWN0ZWQgVGl0bGVzPC9zdHJvbmc+IOKAlCA8c3BhbiBpZD0ib3ZlcmxheUNvdW50Ij4wPC9zcGFuPjwvZGl2PjxkaXY+PGJ1dHRvbiBpZD0iY2xvc2VPdmVybGF5IiBjbGFzcz0iYnRuIGdob3N0Ij5DbG9zZTwvYnV0dG9uPjwvZGl2PjwvZGl2Pg0KICAgIDxkaXYgY2xhc3M9ImJvZHkiIGlkPSJvdmVybGF5Qm9keSI+PC9kaXY+DQogIDwvZGl2Pg0KPGRpdiBpZD0iZmlsZXNNb2RhbCIgc3R5bGU9ImRpc3BsYXk6bm9uZTtwb3NpdGlvbjpmaXhlZDt0b3A6NTAlO2xlZnQ6NTAlO3RyYW5zZm9ybTp0cmFuc2xhdGUoLTUwJSwtNTAlKTsNCiAgYmFja2dyb3VuZDojZmZmO3BhZGRpbmc6MTZweDtib3JkZXItcmFkaXVzOjEwcHg7Ym94LXNoYWRvdzowIDZweCAxOHB4IHJnYmEoMCwwLDAsMC4yNSk7ei1pbmRleDoyMDA7DQogIG1heC13aWR0aDo0MjBweDt3aWR0aDo5MCU7bWF4LWhlaWdodDo3MHZoO292ZXJmbG93OmF1dG87Zm9udC1zaXplOjEzcHgiPg0KPC9kaXY+DQo8c2NyaXB0Pg0KLy8gUmV2NiDigJQgbWVyZ2VkIFVJICsgZnVsbCBmZWF0dXJlcw0KY29uc3Qgc3RhdGUgPSB7IGl0ZW1zOiBbXSwgc2VsZWN0ZWQ6IFtdLCB4bWw6IG51bGwsIGxhc3RVcGxvYWQ6MCB9Ow0KY29uc3QgbGVmdFBhbmUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbGVmdFBhbmUnKTsNCmNvbnN0IG92ZXJsYXkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3ZlcmxheScpOw0KY29uc3Qgb3ZlcmxheUJvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnb3ZlcmxheUJvZHknKTsNCmNvbnN0IGlzTW9iaWxlID0gL01vYml8QW5kcm9pZHxpUGhvbmV8aVBhZHxpUG9kL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KTsNCmNvbnN0IGlzTG9jYWwgPSBmYWxzZTsNCg0KZnVuY3Rpb24gZGV0ZWN0RW52aXJvbm1lbnQoKSB7DQogIGNvbnN0IHVhID0gbmF2aWdhdG9yLnVzZXJBZ2VudCB8fCBuYXZpZ2F0b3IudmVuZG9yIHx8IHdpbmRvdy5vcGVyYTsNCiAgY29uc3QgaXNNZXNzZW5nZXIgPSAvRkJBTnxGQkFWfEZCX0lBQnxNZXNzZW5nZXIvaS50ZXN0KHVhKTsNCiAgY29uc3QgaXNJbnN0YWdyYW0gPSAvSW5zdGFncmFtL2kudGVzdCh1YSk7DQogIGNvbnN0IGlzRmFjZWJvb2tBcHAgPSAvRkJBTnxGQkFWL2kudGVzdCh1YSkgJiYgIWlzTWVzc2VuZ2VyICYmICFpc0luc3RhZ3JhbTsNCiAgY29uc3QgaXNXZWJWaWV3ID0gL1xid3ZcYi8udGVzdCh1YSkgfHwgKHdpbmRvdy5uYXZpZ2F0b3Iuc3RhbmRhbG9uZSA9PT0gZmFsc2UpOw0KDQogIGNvbnN0IGVudiA9IHsNCiAgICBpc01lc3NlbmdlciwNCiAgICBpc0luc3RhZ3JhbSwNCiAgICBpc0ZhY2Vib29rQXBwLA0KICAgIGlzV2ViVmlldw0KICB9Ow0KDQogIGlmIChpc01lc3NlbmdlciB8fCBpc0luc3RhZ3JhbSB8fCBpc1dlYlZpZXcpIHsNCiAgICBzaG93QmFubmVyKCJNZXNzZW5nZXIgb3IgaW4tYXBwIHdlYnZpZXcgZGV0ZWN0ZWQuXG5UaGlzIHBhZ2UgaXMgYmVzdCB1c2VkIG9uIGEgZnVsbCBtb2JpbGUgYnJvd3NlciBvciBkZXNrdG9wIGJyb3dzZXIuIGJ1dCBpdCB3aWxsIHByb2JhYmx5IHdvcmsgYW55d2F5Iik7DQogIH0NCnNob3dCYW5uZXIoIkhvdyB0byB1c2U6IFxuXG4xLiBFbnRlciB5b3VyIG5hbWUsIFxuMi4gU2VsZWN0IHlvdXIgZGV2aWNlIG1vZGVsIFxuIE9sZWQsTGl0ZSxWMVxWMiwgXG5cbiAzLiBTZWxlY3QgeW91ciBTRENBUkQgU2l6ZVxuNC4gUHJlc3MgVXBsb2FkIFxuIDUuIENob29zZSB5b3VyIGdhbWVzXG5cbjYuIFByZXNzIHVwbG9hZCwgU2VuZCB0aGUgZ2VuZXJhdGVkIExpbmsgdG8gb3VyIGNoYXQgY29udmVyc2F0aW9uIik7DQogIHJldHVybiBlbnY7DQp9DQoNCmZ1bmN0aW9uIHNob3dCYW5uZXIobWVzc2FnZSkgew0KICBjb25zdCBiYW5uZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKTsNCiAgYmFubmVyLmlubmVyVGV4dCA9IG1lc3NhZ2U7DQogIGJhbm5lci5zdHlsZS5wb3NpdGlvbiA9ICJmaXhlZCI7DQogIGJhbm5lci5zdHlsZS50b3AgPSAiMzAlIjsNCiAgYmFubmVyLnN0eWxlLmxlZnQgPSAiNDAlIjsNCiAgYmFubmVyLnN0eWxlLnRyYW5zZm9ybSA9ICJ0cmFuc2xhdGVYKC01MCUpIjsNCiAgYmFubmVyLnN0eWxlLmJhY2tncm91bmQgPSAicmdiYSgwLDAsMCwwLjgpIjsNCiAgYmFubmVyLnN0eWxlLmNvbG9yID0gIiNmZmYiOw0KICBiYW5uZXIuc3R5bGUucGFkZGluZyA9ICIxOHB4IDE4cHgiOw0KICBiYW5uZXIuc3R5bGUuYm9yZGVyUmFkaXVzID0gIjE2cHgiOw0KICBiYW5uZXIuc3R5bGUuZm9udFNpemUgPSAiMjJweCI7DQogIGJhbm5lci5zdHlsZS56SW5kZXggPSAiOTk5OSI7DQogIGJhbm5lci5zdHlsZS5ib3hTaGFkb3cgPSAiMCAycHggNnB4IHJnYmEoMCwwLDAsMC4zKSI7DQogIGJhbm5lci5zdHlsZS50cmFuc2l0aW9uID0gIm9wYWNpdHkgMC41cyBlYXNlIjsNCiAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChiYW5uZXIpOw0KDQogIHNldFRpbWVvdXQoKCkgPT4gYmFubmVyLnN0eWxlLm9wYWNpdHkgPSAiMCIsIDQwMDApOw0KICBzZXRUaW1lb3V0KCgpID0+IGJhbm5lci5yZW1vdmUoKSwgMTAwMDApOw0KfQ0KDQpjb25zdCBNSU5fREVMQVkgPSAxMDAwOw0KbGV0IG5vdyA9IERhdGUubm93KCk7DQpsZXQgbGFzdEV4cG9ydFRpbWUgPSBEYXRlLm5vdygpOw0KLy8gdXRpbHMNCmNvbnN0ICQgPSBpZD0+ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpOw0KZnVuY3Rpb24gZXNjKHMpeyByZXR1cm4gKHN8fCcnKS5yZXBsYWNlKC8mL2csJyZhbXA7JykucmVwbGFjZSgvPC9nLCcmbHQ7JykucmVwbGFjZSgvPi9nLCcmZ3Q7Jyk7IH0NCmZ1bmN0aW9uIHRvYXN0KG1zZyl7ICQoJ3N0YXR1cycpLnRleHRDb250ZW50ID0gbXNnOyBzZXRUaW1lb3V0KCgpPT57IGlmKCQoJ3N0YXR1cycpLnRleHRDb250ZW50ID09PSBtc2cpICQoJ3N0YXR1cycpLnRleHRDb250ZW50ID0gJ1JlYWR5JzsgfSwgMjUwMCk7IH0NCg0KLy8gc2l6ZSBoZWxwZXJzDQpmdW5jdGlvbiBwYXJzZVNpemVUZXh0KHMpeyBpZighcykgcmV0dXJuIDA7IGNvbnN0IG0gPSAoJycrcykubWF0Y2goLyhbXGRcLl0rKVxzKihHaUJ8TWlCfEtpQnxHQnxNQnxLQnxCKS9pKTsgaWYoIW0pIHJldHVybiAwOyBjb25zdCB2PXBhcnNlRmxvYXQobVsxXSk7IGNvbnN0IHU9bVsyXS50b1VwcGVyQ2FzZSgpOyBpZih1PT09J0InKSByZXR1cm4gdjsgaWYodT09PSdLQid8fHU9PT0nS0lCJykgcmV0dXJuIHYqMTAyNDsgaWYodT09PSdNQid8fHU9PT0nTUlCJykgcmV0dXJuIHYqMTAyNCoxMDI0OyByZXR1cm4gdioxMDI0KjEwMjQqMTAyNDsgfQ0KZnVuY3Rpb24gYnl0ZXNUb0dCKGIpeyByZXR1cm4gYi8oMTAyNCoxMDI0KjEwMjQpOyB9DQoNCi8vIGxvYWQgWE1MIChzdXBwb3J0IDxmb2xkZXI+IGFuZCA8Z2FtZT4pDQphc3luYyBmdW5jdGlvbiBsb2FkWE1MKCl7DQogIHRyeXsNCiAgICBjb25zdCB0eHQgPSBhd2FpdCBmZXRjaCgnc3dpdGNoZ2FtZXMueG1sJykudGhlbihyPT5yLnRleHQoKSk7DQogICAgY29uc3QgeG1sID0gbmV3IERPTVBhcnNlcigpLnBhcnNlRnJvbVN0cmluZyh0eHQsJ2FwcGxpY2F0aW9uL3htbCcpOw0KICAgIHN0YXRlLnhtbCA9IHhtbDsNCiAgICAvLyBwcmVmZXIgZm9sZGVyDQpsZXQgaXRlbXMgPSBBcnJheS5mcm9tKHhtbC5xdWVyeVNlbGVjdG9yQWxsKCdmb2xkZXInKSkNCiAgLmZpbHRlcihmID0+IGYuZ2V0QXR0cmlidXRlKCduYW1lJykgIT09ICdOU1AgMjAyMScpICAvLyDwn5GIIHNraXANCiAgLm1hcChmID0+ICh7DQogICAgbmFtZTogZi5nZXRBdHRyaWJ1dGUoJ25hbWUnKSwNCiAgICBzY29yZTogZi5nZXRBdHRyaWJ1dGUoJ3Njb3JlJykgfHwgJzAnLA0KICAgIHNpemU6IGYuZ2V0QXR0cmlidXRlKCdzaXplJykgfHwgJzAgR2lCJywNCiAgICBkYXRlOiBmLmdldEF0dHJpYnV0ZSgnZGF0ZU1vZGlmaWVkJykgfHwgJycsDQogICAgZmlsZXM6IEFycmF5LmZyb20oZi5xdWVyeVNlbGVjdG9yQWxsKCdmaWxlJykpLm1hcCh4ID0+IHguZ2V0QXR0cmlidXRlKCduYW1lJykpDQogIH0pKTsNCg0KDQoNCiAgICBpZihpdGVtcy5sZW5ndGg9PT0wKXsgLy8gZmFsbGJhY2sgdG8gZ2FtZSBub2Rlcw0KICAgICAgY29uc3QgZ2FtZXMgPSBBcnJheS5mcm9tKHhtbC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnZ2FtZScpKTsNCiAgICAgIGl0ZW1zID0gZ2FtZXMubWFwKGc9Pih7IG5hbWU6IGcuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3RpdGxlJylbMF0/LnRleHRDb250ZW50IHx8ICdVbnRpdGxlZCcsIHNpemU6IGcuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJ3NpemUnKVswXT8udGV4dENvbnRlbnQgfHwgJzAgTUInLCBmaWxlczogW10gfSkpOw0KICAgIH0NCiAgICBzdGF0ZS5pdGVtcyA9IGl0ZW1zOw0KICAgIHJlbmRlckxpc3QoaXRlbXMpOw0KICB9Y2F0Y2goZSl7IGNvbnNvbGUuZXJyb3IoZSk7IGxlZnRQYW5lLmlubmVySFRNTCA9ICc8ZGl2IHN0eWxlPSJjb2xvcjojYjkxYzFjO3BhZGRpbmc6MTJweCI+RmFpbGVkIHRvIGxvYWQgc3dpdGNoZ2FtZXMueG1sIOKAlCBjaGVjayBwYXRoL0NPUlM8L2Rpdj4nOyB9DQp9DQoNCi8vIHJlbmRlciBsZWZ0IGxpc3QgYW5kIHByZXNlcnZlIHNlbGVjdGlvbiBoaWdobGlnaHRzDQpmdW5jdGlvbiByZW5kZXJMaXN0KGxpc3QpeyBsZWZ0UGFuZS5pbm5lckhUTUwgPSAnJzsgaWYoIWxpc3R8fCFsaXN0Lmxlbmd0aCl7IGxlZnRQYW5lLmlubmVySFRNTCA9ICc8ZGl2IGNsYXNzPSJtZXRhIj5ObyBpdGVtcyBmb3VuZDwvZGl2Pic7IHJldHVybjsgfQ0KICBsaXN0LmZvckVhY2goaXRlbT0+ew0KICAgIGNvbnN0IHJvdyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpOyByb3cuY2xhc3NOYW1lPSdpdGVtJzsgcm93LmRhdGFzZXQubmFtZSA9IGl0ZW0ubmFtZTsgcm93LmRhdGFzZXQuc2l6ZSA9IGl0ZW0uc2l6ZTsNCiAgICByb3cuaW5uZXJIVE1MID0gYCAgPGRpdj4NCiAgICA8YnV0dG9uIGNsYXNzPSJidG4gZ2hvc3QiIHN0eWxlPSJwYWRkaW5nOjJweCA2cHg7Zm9udC1zaXplOjExcHgiDQogICAgICBvbmNsaWNrPSJhbGVydCgnY2xpY2tlZCcpOyBldmVudC5zdG9wUHJvcGFnYXRpb24oKTsgc2hvd0ZpbGVzKCcke2VzYyhpdGVtLm5hbWUpfScsICR7SlNPTi5zdHJpbmdpZnkoaXRlbS5maWxlcyl9LCAnJHtlc2MoaXRlbS5zaXplKX0nKSI+PzwvYnV0dG9uPg0KICAgIDxzdHJvbmc+JHtlc2MoaXRlbS5uYW1lKX08L3N0cm9uZz4NCiAgICA8ZGl2IGNsYXNzPSdtZXRhJz4ke2l0ZW0uc2NvcmUgPyAnU2NvcmU6ICcrZXNjKGl0ZW0uc2NvcmUpIDogJyd9IDsgJHtpdGVtLmRhdGUgPyAnTW9kaWZpZWQ6ICcrZXNjKGl0ZW0uZGF0ZSkgOiAnJ308L2Rpdj4NCiAgPC9kaXY+DQogIDxkaXYgY2xhc3M9J21ldGEnPiR7ZXNjKGl0ZW0uc2l6ZSl9PC9kaXY+YDsNCg0KICAgIGlmKHN0YXRlLnNlbGVjdGVkLnNvbWUocz0+cy5uYW1lPT09aXRlbS5uYW1lKSkgcm93LmNsYXNzTGlzdC5hZGQoJ3NlbGVjdGVkJyk7DQogICAgLy8gYWx0LWNsaWNrIHNob3dzIGZpbGVzDQogICAgcm93LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2KT0+eyBpZihldi5hbHRLZXkpeyBzaG93RmlsZXMoaXRlbS5uYW1lLCBpdGVtLmZpbGVzIHx8IFtdLCBpdGVtLnNpemUpOyByZXR1cm47IH0gdG9nZ2xlU2VsZWN0KGl0ZW0sIHJvdyk7IH0pOw0KICAgIHJvdy5hZGRFdmVudExpc3RlbmVyKCdkYmxjbGljaycsICgpPT4gc2hvd0ZpbGVzKGl0ZW0ubmFtZSwgaXRlbS5maWxlc3x8W10sIGl0ZW0uc2l6ZSkpOw0KICAgIGxlZnRQYW5lLmFwcGVuZENoaWxkKHJvdyk7DQogIH0pOw0KfQ0KDQpmdW5jdGlvbiB0b2dnbGVTZWxlY3QoaXRlbSwgcm93RWwpeyBjb25zdCBpZHggPSBzdGF0ZS5zZWxlY3RlZC5maW5kSW5kZXgocz0+cy5uYW1lPT09aXRlbS5uYW1lKTsgaWYoaWR4Pj0wKXsgc3RhdGUuc2VsZWN0ZWQuc3BsaWNlKGlkeCwxKTsgaWYocm93RWwpIHJvd0VsLmNsYXNzTGlzdC5yZW1vdmUoJ3NlbGVjdGVkJyk7IGVsc2UgeyBjb25zdCByID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuaXRlbScpKS5maW5kKHg9PnguZGF0YXNldC5uYW1lPT09aXRlbS5uYW1lKTsgaWYocikgci5jbGFzc0xpc3QucmVtb3ZlKCdzZWxlY3RlZCcpOyB9IH0gZWxzZSB7IHN0YXRlLnNlbGVjdGVkLnB1c2goeyBuYW1lOml0ZW0ubmFtZSwgc2l6ZTppdGVtLnNpemUgfSk7IGlmKHJvd0VsKSByb3dFbC5jbGFzc0xpc3QuYWRkKCdzZWxlY3RlZCcpOyB9DQogIHVwZGF0ZVRvdGFscygpOyByZW5kZXJPdmVybGF5KCk7IH0NCg0KZnVuY3Rpb24gcmVuZGVyT3ZlcmxheSgpIHsNCiAgb3ZlcmxheUJvZHkuaW5uZXJIVE1MID0gJyc7DQogIHN0YXRlLnNlbGVjdGVkLmZvckVhY2goKHMsaSk9PnsNCiAgICBjb25zdCByb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsNCiAgICByb3cuY2xhc3NOYW1lPSdyb3cnOw0KICAgIHJvdy5pbm5lckhUTUwgPSBgDQogICAgICA8ZGl2Pg0KICAgICAgICA8c3Ryb25nPiR7aSsxfS4gJHtlc2Mocy5uYW1lKX08L3N0cm9uZz4NCiAgICAgICAgPGRpdiBjbGFzcz0nbWV0YSc+JHtlc2Mocy5zaXplKX08L2Rpdj4NCiAgICAgIDwvZGl2Pg0KICAgICAgPGRpdj4NCiAgICAgICAgPGJ1dHRvbiBjbGFzcz0naWNvbiB1cCc+dTwvYnV0dG9uPg0KICAgICAgICA8YnV0dG9uIGNsYXNzPSdpY29uIGRvd24nPmQ8L2J1dHRvbj4NCiAgICAgICAgPGJ1dHRvbiBjbGFzcz0naWNvbiByZW1vdmUnPng8L2J1dHRvbj4NCiAgICAgIDwvZGl2PmA7DQoNCiAgICAvLyBVcA0KICAgIHJvdy5xdWVyeVNlbGVjdG9yKCcudXAnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpPT57DQogICAgICBpZihpPjApew0KICAgICAgICBbc3RhdGUuc2VsZWN0ZWRbaS0xXSwgc3RhdGUuc2VsZWN0ZWRbaV1dID0gW3N0YXRlLnNlbGVjdGVkW2ldLCBzdGF0ZS5zZWxlY3RlZFtpLTFdXTsNCiAgICAgICAgcmVuZGVyT3ZlcmxheSgpOw0KICAgICAgICByZW5kZXJMaXN0KHN0YXRlLml0ZW1zKTsNCiAgICAgICAgdXBkYXRlVG90YWxzKCk7DQogICAgICAgIC8vIGhpZ2hsaWdodCBuZXcgcG9zaXRpb24NCiAgICAgICAgb3ZlcmxheUJvZHkuY2hpbGRyZW5baS0xXS5jbGFzc0xpc3QuYWRkKCdoaWdobGlnaHQnKTsNCiAgICAgIH0NCiAgICB9KTsNCg0KICAgIC8vIERvd24NCiAgICByb3cucXVlcnlTZWxlY3RvcignLmRvd24nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpPT57DQogICAgICBpZihpPHN0YXRlLnNlbGVjdGVkLmxlbmd0aC0xKXsNCiAgICAgICAgW3N0YXRlLnNlbGVjdGVkW2krMV0sIHN0YXRlLnNlbGVjdGVkW2ldXSA9IFtzdGF0ZS5zZWxlY3RlZFtpXSwgc3RhdGUuc2VsZWN0ZWRbaSsxXV07DQogICAgICAgIHJlbmRlck92ZXJsYXkoKTsNCiAgICAgICAgcmVuZGVyTGlzdChzdGF0ZS5pdGVtcyk7DQogICAgICAgIHVwZGF0ZVRvdGFscygpOw0KICAgICAgICAvLyBoaWdobGlnaHQgbmV3IHBvc2l0aW9uDQogICAgICAgIG92ZXJsYXlCb2R5LmNoaWxkcmVuW2krMV0uY2xhc3NMaXN0LmFkZCgnaGlnaGxpZ2h0Jyk7DQogICAgICB9DQogICAgfSk7DQoNCiAgICAvLyBSZW1vdmUNCiAgICByb3cucXVlcnlTZWxlY3RvcignLnJlbW92ZScpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCk9PnsNCiAgICAgIGNvbnN0IHJlbW92ZWQgPSBzdGF0ZS5zZWxlY3RlZC5zcGxpY2UoaSwxKVswXTsNCiAgICAgIGNvbnN0IGxlZnRSb3cgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5pdGVtJykpDQogICAgICAgIC5maW5kKHg9PnguZGF0YXNldC5uYW1lPT09cmVtb3ZlZC5uYW1lKTsNCiAgICAgIGlmKGxlZnRSb3cpIGxlZnRSb3cuY2xhc3NMaXN0LnJlbW92ZSgnc2VsZWN0ZWQnKTsNCiAgICAgIHJlbmRlck92ZXJsYXkoKTsNCiAgICAgIHJlbmRlckxpc3Qoc3RhdGUuaXRlbXMpOw0KICAgICAgdXBkYXRlVG90YWxzKCk7DQogICAgfSk7DQoNCiAgICBvdmVybGF5Qm9keS5hcHBlbmRDaGlsZChyb3cpOw0KICB9KTsNCiAgJCgnb3ZlcmxheUNvdW50JykudGV4dENvbnRlbnQgPSBzdGF0ZS5zZWxlY3RlZC5sZW5ndGg7DQoNCnJlbmRlclNlbGVjdGVkUGFuZWwoKTsNCg0KfQ0KDQoNCi8vIHNob3cvaGlkZSBvdmVybGF5DQokKCdzaG93U2VsZWN0ZWQnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpPT57IG92ZXJsYXkuc3R5bGUuZGlzcGxheSA9ICdmbGV4JzsgcmVuZGVyT3ZlcmxheSgpOyB9KTsNCiQoJ2Nsb3NlT3ZlcmxheScpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCk9PiBvdmVybGF5LnN0eWxlLmRpc3BsYXkgPSAnbm9uZScpOw0KDQovLyBmaWxlcyBtb2RhbA0KbGV0IGN1cnJlbnRNb2RhbCA9IG51bGw7IC8vIHRyYWNrIG9wZW4gbW9kYWwNCmZ1bmN0aW9uIHNob3dGaWxlcyhuYW1lLCBmaWxlcywgc2l6ZSkgew0KICBpZiAoIWZpbGVzIHx8ICFmaWxlcy5sZW5ndGgpIHsNCiAgICBhbGVydChgTm8gZmlsZXMgZm9yICR7bmFtZX1gKTsNCiAgICByZXR1cm47DQogIH0NCg0KDQogIC8vIGNsb3NlIGV4aXN0aW5nIG1vZGFsIGlmIGFueQ0KICBjb25zdCBtb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmaWxlc01vZGFsJyk7DQogIG1vZGFsLmlubmVySFRNTCA9ICcnOyANCiAgbW9kYWwuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7DQogIA0KICAvLyBoZWFkZXINCiAgY29uc3QgaGVhZGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7DQogIGhlYWRlci5pbm5lckhUTUwgPSBgPHN0cm9uZz4ke2VzYyhuYW1lKX08L3N0cm9uZz48YnI+PHNwYW4gY2xhc3M9Im1ldGEiPlNpemU6ICR7ZXNjKHNpemUpfSDigJQgJHtmaWxlcy5sZW5ndGh9IGZpbGVzPC9zcGFuPmA7DQogIG1vZGFsLmFwcGVuZENoaWxkKGhlYWRlcik7DQoNCiAgLy8gZmlsZSBsaXN0IHdpdGggcGFnaW5nDQogIGNvbnN0IGxpc3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsNCiAgbGlzdC5zdHlsZS5tYXJnaW5Ub3AgPSAnOHB4JzsNCiAgbW9kYWwuYXBwZW5kQ2hpbGQobGlzdCk7DQoNCiAgbGV0IGluZGV4ID0gMDsNCiAgY29uc3QgYmF0Y2ggPSAyMDsgLy8gc2hvdyAyMCBhdCBhIHRpbWUNCiAgZnVuY3Rpb24gbG9hZE1vcmUoKSB7DQogICAgY29uc3QgbmV4dCA9IGZpbGVzLnNsaWNlKGluZGV4LCBpbmRleCtiYXRjaCk7DQogICAgbGlzdC5pbm5lckhUTUwgKz0gbmV4dC5tYXAoZj0+ZXNjKGYpKS5qb2luKCc8YnI+Jyk7DQogICAgaW5kZXggKz0gYmF0Y2g7DQogICAgaWYgKGluZGV4ID49IGZpbGVzLmxlbmd0aCkgew0KICAgICAgbW9yZUJ0bi5yZW1vdmUoKTsNCiAgICB9DQogIH0NCiAgDQoNCiAgLy8gTW9yZSBidXR0b24NCiAgY29uc3QgbW9yZUJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpOw0KICBtb3JlQnRuLnRleHRDb250ZW50ID0gJ01vcmUnOw0KICBtb3JlQnRuLmNsYXNzTmFtZSA9ICdidG4gZ2hvc3QnOw0KICBtb3JlQnRuLnN0eWxlLm1hcmdpblRvcCA9ICcxMHB4JzsNCiAgbW9yZUJ0bi5vbmNsaWNrID0gbG9hZE1vcmU7DQogIG1vZGFsLmFwcGVuZENoaWxkKG1vcmVCdG4pOw0KDQogIC8vIENsb3NlIGJ1dHRvbg0KICBjb25zdCBjbG9zZUJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpOw0KICBjbG9zZUJ0bi50ZXh0Q29udGVudCA9ICdDbG9zZSc7DQogIGNsb3NlQnRuLmNsYXNzTmFtZSA9ICdidG4nOw0KICBjbG9zZUJ0bi5zdHlsZS5tYXJnaW5Ub3AgPSAnMTBweCc7DQogIGNsb3NlQnRuLm9uY2xpY2sgPSAoKT0+eyBtb2RhbC5zdHlsZS5kaXNwbGF5PSdub25lJzsgbW9kYWwuaW5uZXJIVE1MPScnOyB9Ow0KICBtb2RhbC5hcHBlbmRDaGlsZChjbG9zZUJ0bik7DQpsb2FkTW9yZSgpOw0KfQ0KDQoNCi8vIHRvdGFscywgaW5zdGFsbCBlc3RpbWF0ZSwgZmlsZW5hbWUgcHJldmlldw0KZnVuY3Rpb24gdXBkYXRlVG90YWxzKCkgew0KICBjb25zdCB0b3RhbEJ5dGVzID0gc3RhdGUuc2VsZWN0ZWQucmVkdWNlKChzdW0sIHMpID0+IHN1bSArIHBhcnNlU2l6ZVRleHQocy5zaXplKSwgMCk7DQogIGNvbnN0IGdiID0gYnl0ZXNUb0dCKHRvdGFsQnl0ZXMpOw0KICAkKCdzZWxlY3RlZFNpemUnKS50ZXh0Q29udGVudCA9IGdiLnRvRml4ZWQoMik7DQoNCiAgY29uc3QgYmxvYXRlZCA9IHRvdGFsQnl0ZXMgKiAxLjI7DQogIGNvbnN0IHNwZWVkID0gMTQgKiAxMDI0ICogMTAyNDsNCiAgY29uc3Qgc2VjcyA9IE1hdGguY2VpbChibG9hdGVkIC8gc3BlZWQpOw0KICAkKCdpbnN0YWxsRXN0aW1hdGUnKS50ZXh0Q29udGVudCA9IGAke01hdGguZmxvb3Ioc2Vjcy8zNjAwKX1oICR7TWF0aC5mbG9vcigoc2VjcyUzNjAwKS82MCl9bWA7DQoNCiAgJCgnY291bnQnKS50ZXh0Q29udGVudCA9IHN0YXRlLnNlbGVjdGVkLmxlbmd0aDsNCg0KICAvLyBzcGFjZSBjYWxjdWxhdGlvbg0KICBjb25zdCBjb25zb2xlVmFsID0gJCgnY29uc29sZScpLnZhbHVlOw0KICBjb25zdCBzZFZhbCA9IE51bWJlcigkKCdzZCcpLnZhbHVlKTsNCiAgY29uc3QgYW5kcm9pZCA9IE51bWJlcigkKCdhbmRyb2lkJykudmFsdWUpOw0KICBjb25zdCBsaW51eCA9IE51bWJlcigkKCdsaW51eCcpLnZhbHVlKTsNCiAgY29uc3QganZmaWxlID0gMTsNCiAgY29uc3QgZW11ID0gY29uc29sZVZhbCA9PT0gJ29sZWQnID8gNjQgOiAzMjsNCiAgY29uc3QgYnVmZmEgPSBNYXRoLmZsb29yKGVtdSAvIDMpOw0KICBjb25zdCB0b3RhbFJlc2VydmVkID0gZW11ICsgYW5kcm9pZCArIGxpbnV4ICsganZmaWxlICsgYnVmZmE7DQogIGNvbnN0IGV4dHJhID0gTWF0aC5mbG9vcihlbXUgLyAyKTsNCiAgY29uc3Qgc3BhY2VGb3JHYW1lcyA9IChzZFZhbCAtIHRvdGFsUmVzZXJ2ZWQpICsgZXh0cmE7DQoNCiAgJCgnc3BhY2UnKS50ZXh0Q29udGVudCA9IGlzRmluaXRlKHNwYWNlRm9yR2FtZXMpID8gc3BhY2VGb3JHYW1lcyA6IDA7DQoNCiAgLy8gaGlnaGxpZ2h0IHdhcm5pbmcgaWYgZXhjZWVkZWQNCiAgaWYgKGdiID4gc3BhY2VGb3JHYW1lcykgew0KICAgICQoJ3NlbGVjdGVkU2l6ZScpLnN0eWxlLmNvbG9yID0gJyNjMDAnOw0KICAgICQoJ3NlbGVjdGVkU2l6ZScpLnN0eWxlLmZvbnRXZWlnaHQgPSAnYm9sZCc7DQogIH0gZWxzZSB7DQogICAgJCgnc2VsZWN0ZWRTaXplJykuc3R5bGUuY29sb3IgPSAnJzsNCiAgICAkKCdzZWxlY3RlZFNpemUnKS5zdHlsZS5mb250V2VpZ2h0ID0gJyc7DQogIH0NCg0KICAvLyBmaWxlbmFtZSBwcmV2aWV3DQogIHVwZGF0ZUZpbGVuYW1lUHJldmlldygpOw0KfQ0KDQoNCg0KDQoNCmZ1bmN0aW9uIHVwZGF0ZUZpbGVuYW1lUHJldmlldygpeyBjb25zdCBjdXN0b21lciA9ICggJCgnY3VzdG9tZXInKS52YWx1ZSB8fCAnY3VzdG9tZXInKS50cmltKCkucmVwbGFjZSgvW15hLXpBLVowLTldL2csJ18nKS50b0xvd2VyQ2FzZSgpOyBjb25zdCBjb25zb2xlVG9rZW4gPSAkKCdjb25zb2xlJykudmFsdWUgfHwgJ3YxJzsgY29uc3Qgc2RUb2tlbiA9ICdzZCcgKyAoJCgnc2QnKS52YWx1ZSB8fCAnMCcpOyBjb25zdCBkcm9pZCA9ICdkcm9pZCcgKyAoJCgnYW5kcm9pZCcpLnZhbHVlIHx8ICcwJyk7IGNvbnN0IGxpbiA9ICdsaW4nICsgKCQoJ2xpbnV4JykudmFsdWUgfHwgJzAnKTsgY29uc3Qgbm93ID0gbmV3IERhdGUoKTsgY29uc3Qgc3RhbXAgPSBub3cuZ2V0RnVsbFllYXIoKS50b1N0cmluZygpICsgU3RyaW5nKG5vdy5nZXRNb250aCgpKzEpLnBhZFN0YXJ0KDIsJzAnKSArIFN0cmluZyhub3cuZ2V0RGF0ZSgpKS5wYWRTdGFydCgyLCcwJykgKyBTdHJpbmcobm93LmdldEhvdXJzKCkpLnBhZFN0YXJ0KDIsJzAnKSArIFN0cmluZyhub3cuZ2V0TWludXRlcygpKS5wYWRTdGFydCgyLCcwJykgKyBTdHJpbmcobm93LmdldFNlY29uZHMoKSkucGFkU3RhcnQoMiwnMCcpOyAkKCdmaWxlbmFtZVByZXZpZXcnKS50ZXh0Q29udGVudCA9IGAke2N1c3RvbWVyfV8ke2NvbnNvbGVUb2tlbn1fJHtzZFRva2VufV8ke2Ryb2lkfV8ke2xpbn1fJHtzdGFtcH0uQ0xJX1BSTVpgOyB9DQoNCi8vIHBhcnNlIHNpemUgc3RyaW5ncyB1c2VkIGJ5IG9yaWdpbmFsIHhtbCAoZS5nLiAiMS4yIEdpQiIgb3IgIjYyMCBNQiIpDQpmdW5jdGlvbiBwYXJzZVNpemVUZXh0KHR4dCl7IGlmKCF0eHQpIHJldHVybiAwOyBjb25zdCBtID0gKCcnK3R4dCkubWF0Y2goLyhbXGRcLl0rKVxzKihHaUJ8TWlCfEtpQnxHQnxNQnxLQnxCKS9pKTsgaWYoIW0pIHJldHVybiAwOyBjb25zdCB2ID0gcGFyc2VGbG9hdChtWzFdKTsgY29uc3QgdSA9IG1bMl0udG9VcHBlckNhc2UoKTsgaWYodT09PSdCJykgcmV0dXJuIHY7IGlmKHU9PT0nS0InfHx1PT09J0tJQicpIHJldHVybiB2KjEwMjQ7IGlmKHU9PT0nTUInfHx1PT09J01JQicpIHJldHVybiB2KjEwMjQqMTAyNDsgcmV0dXJuIHYqMTAyNCoxMDI0KjEwMjQ7IH0NCg0KLy8gd2lyZSBjb250cm9scw0KJCgnc2VhcmNoJykuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBkZWJvdW5jZSgoZSk9PnsgY29uc3QgcT0oZS50YXJnZXQudmFsdWV8fCcnKS50b0xvd2VyQ2FzZSgpOyByZW5kZXJMaXN0KHN0YXRlLml0ZW1zLmZpbHRlcihpdD0+IChpdC5uYW1lfHwnJykudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhxKSkpOyB9LDE4MCkpOw0KJCgnY2xlYXJTZWFyY2gnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpPT57ICQoJ3NlYXJjaCcpLnZhbHVlPScnOyByZW5kZXJMaXN0KHN0YXRlLml0ZW1zKTsgJCgnc2VhcmNoJykuZm9jdXMoKTsgfSk7DQpbJ2N1c3RvbWVyJywnY29uc29sZScsJ3NkJywnYW5kcm9pZCcsJ2xpbnV4J10uZm9yRWFjaChpZD0+eyBjb25zdCBlbD0kKGlkKTsgaWYoZWwpeyBlbC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsICgpPT4gdXBkYXRlRmlsZW5hbWVQcmV2aWV3KCkpOyBlbC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoKT0+IHVwZGF0ZVRvdGFscygpKTsgfX0pOw0KDQovLyBpbXBvcnQgLkNMSV9QUk1aIChyZXN0b3JlIHNlbGVjdGlvbnMgKyBwYXJzZSBmaWxlbmFtZSkNCiQoJ2ZpbGVJbicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIChldik9PnsNCiAgY29uc3QgZiA9IGV2LnRhcmdldC5maWxlc1swXTsgaWYoIWYpIHJldHVybjsgY29uc3QgY2ZnID0gcGFyc2VGaWxlbmFtZVRvQ29uZmlnKGYubmFtZSk7IGlmKGNmZyl7ICQoJ2N1c3RvbWVyJykudmFsdWUgPSBjZmcuY3VzdG9tZXI7IC8vIHNldCBjb25zb2xlIGlmIGF2YWlsYWJsZQ0KICAgIEFycmF5LmZyb20oJCgnY29uc29sZScpLm9wdGlvbnMpLmZvckVhY2gobz0+eyBpZihvLnZhbHVlLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoY2ZnLmNvbnNvbGVUb2tlbikpIG8uc2VsZWN0ZWQgPSB0cnVlOyB9KTsgaWYoL15zZFxkKyQvLnRlc3QoY2ZnLnNkVG9rZW4pKSAkKCdzZCcpLnZhbHVlID0gTnVtYmVyKGNmZy5zZFRva2VuLnJlcGxhY2UoL1xEL2csJycpKTsgaWYoL15kcm9pZFxkKyQvLnRlc3QoY2ZnLmRyb2lkVG9rZW4pKSAkKCdhbmRyb2lkJykudmFsdWUgPSBOdW1iZXIoY2ZnLmRyb2lkVG9rZW4ucmVwbGFjZSgvXEQvZywnJykpOyBpZigvXmxpblxkKyQvLnRlc3QoY2ZnLmxpblRva2VuKSkgJCgnbGludXgnKS52YWx1ZSA9IE51bWJlcihjZmcubGluVG9rZW4ucmVwbGFjZSgvXEQvZywnJykpOyB1cGRhdGVGaWxlbmFtZVByZXZpZXcoKTsgdXBkYXRlVG90YWxzKCk7IH0NCiAgY29uc3QgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsgcmVhZGVyLm9ubG9hZCA9IChlKT0+eyBjb25zdCBsaW5lcyA9IGUudGFyZ2V0LnJlc3VsdC5zcGxpdCgnXG4nKS5tYXAocz0+cy50cmltKCkpLmZpbHRlcihCb29sZWFuKTsgLy8gY2xlYXIgZXhpc3Rpbmcgc2VsZWN0aW9uDQogICAgc3RhdGUuc2VsZWN0ZWQ9W107IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5pdGVtJykuZm9yRWFjaChpPT5pLmNsYXNzTGlzdC5yZW1vdmUoJ3NlbGVjdGVkJykpOw0KICAgIGxpbmVzLmZvckVhY2godGl0bGU9PnsgY29uc3QgbGVmdCA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLml0ZW0nKSkuZmluZChpPT5pLmRhdGFzZXQubmFtZT09PXRpdGxlKTsgaWYobGVmdCl7IGxlZnQuY2xhc3NMaXN0LmFkZCgnc2VsZWN0ZWQnKTsgc3RhdGUuc2VsZWN0ZWQucHVzaCh7IG5hbWU6bGVmdC5kYXRhc2V0Lm5hbWUsIHNpemU6bGVmdC5kYXRhc2V0LnNpemUgfSk7IH0gZWxzZSB7IGNvbnN0IG1heWJlID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuaXRlbScpKS5maW5kKGk9PmkuZGF0YXNldC5uYW1lICYmIGkuZGF0YXNldC5uYW1lLnRvTG93ZXJDYXNlKCk9PT10aXRsZS50b0xvd2VyQ2FzZSgpKTsgaWYobWF5YmUpeyBtYXliZS5jbGFzc0xpc3QuYWRkKCdzZWxlY3RlZCcpOyBzdGF0ZS5zZWxlY3RlZC5wdXNoKHsgbmFtZTptYXliZS5kYXRhc2V0Lm5hbWUsIHNpemU6bWF5YmUuZGF0YXNldC5zaXplIH0pOyB9IH0gfSk7IHVwZGF0ZVRvdGFscygpOyByZW5kZXJPdmVybGF5KCk7IH07DQogIHJlYWRlci5yZWFkQXNUZXh0KGYpOw0KfSk7DQoNCi8vIGV4cG9ydCBjbGllbnQgKGRvd25sb2FkIGxpc3QpDQokKCdzYXZlQnRuJyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCk9PnsNCg0KICBub3cgPSBEYXRlLm5vdygpOw0KICBpZiAobm93IC0gbGFzdEV4cG9ydFRpbWUgPCBNSU5fREVMQVkpIHsNCiAgICB0b2FzdCgnUGxlYXNlIHdhaXQgYmVmb3JlIGV4cG9ydGluZyBhZ2FpbicpOw0KICAgIGFsZXJ0KCdQbGVhc2Ugd2FpdCBiZWZvcmUgZXhwb3J0aW5nIGFnYWluJyk7DQogICAgcmV0dXJuOw0KICB9DQogIGxhc3RFeHBvcnRUaW1lID0gbm93Ow0KDQogIGlmKHN0YXRlLnNlbGVjdGVkLmxlbmd0aD09PTApeyBhbGVydCgnTm8gaXRlbXMgc2VsZWN0ZWQnKTsgcmV0dXJuOyB9DQogIGNvbnN0IGN1c3QgPSAoJCgnY3VzdG9tZXInKS52YWx1ZXx8JycpLnRyaW0oKTsgaWYoIWN1c3QpeyBhbGVydCgnQ3VzdG9tZXIgbmFtZSByZXF1aXJlZCcpOyByZXR1cm47IH0NCiAgY29uc3QgZmlsZW5hbWUgPSAkKCdmaWxlbmFtZVByZXZpZXcnKS50ZXh0Q29udGVudCB8fCAnbGlzdC5DTElfUFJNWic7DQogIGNvbnN0IGJsb2IgPSBuZXcgQmxvYihbc3RhdGUuc2VsZWN0ZWQubWFwKHM9PnMubmFtZSkuam9pbignXG4nKV0sIHsgdHlwZTondGV4dC9wbGFpbicgfSk7IGNvbnN0IGEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7IGEuaHJlZiA9IFVSTC5jcmVhdGVPYmplY3RVUkwoYmxvYik7IGEuZG93bmxvYWQgPSBmaWxlbmFtZTsgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChhKTsgYS5jbGljaygpOyBhLnJlbW92ZSgpOyBVUkwucmV2b2tlT2JqZWN0VVJMKGEuaHJlZik7IHRvYXN0KCdTYXZlZCBjbGllbnQgZmlsZScpOw0KfSk7DQoNCi8vIGFkbWluIGV4cG9ydCAoZnVsbCBwYXRocykNCiQoJ2FkbWluRXhwb3J0Jyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgKCk9PnsNCg0KICBub3cgPSBEYXRlLm5vdygpOw0KICBpZiAobm93IC0gbGFzdEV4cG9ydFRpbWUgPCBNSU5fREVMQVkpIHsNCiAgICB0b2FzdCgnUGxlYXNlIHdhaXQgYmVmb3JlIGV4cG9ydGluZyBhZ2FpbicpOw0KICAgIGFsZXJ0KCdQbGVhc2Ugd2FpdCBiZWZvcmUgZXhwb3J0aW5nIGFnYWluJyk7DQogICAgcmV0dXJuOw0KICB9DQogIGxhc3RFeHBvcnRUaW1lID0gbm93Ow0KDQogIGlmKHN0YXRlLnNlbGVjdGVkLmxlbmd0aD09PTApeyBhbGVydCgnTm8gaXRlbXMgc2VsZWN0ZWQnKTsgcmV0dXJuOyB9DQogIGNvbnN0IGN1c3QgPSAoJCgnY3VzdG9tZXInKS52YWx1ZXx8JycpLnRyaW0oKTsgaWYoIWN1c3QpeyBhbGVydCgnQycpOyByZXR1cm47IH0NCiAgdHJ5eyBjb25zdCB4bWx0eHQgPSBhd2FpdCBmZXRjaCgnc3dpdGNoZ2FtZXMueG1sJykudGhlbihyPT5yLnRleHQoKSk7IGNvbnN0IHhtbCA9IG5ldyBET01QYXJzZXIoKS5wYXJzZUZyb21TdHJpbmcoeG1sdHh0LCdhcHBsaWNhdGlvbi94bWwnKTsgbGV0IGNvbnRlbnQ9Jyc7IHN0YXRlLnNlbGVjdGVkLmZvckVhY2goc2VsPT57IGNvbnN0IGZvbGRlciA9IEFycmF5LmZyb20oeG1sLnF1ZXJ5U2VsZWN0b3JBbGwoJ2ZvbGRlcicpKS5maW5kKGY9PmYuZ2V0QXR0cmlidXRlKCduYW1lJyk9PT1zZWwubmFtZSk7IGlmKGZvbGRlcil7IGNvbnN0IGJhc2UgPSAnSzpcXE5TUCAyMDIxXFwnOyBmb2xkZXIucXVlcnlTZWxlY3RvckFsbCgnZmlsZScpLmZvckVhY2goZmlsZT0+IGNvbnRlbnQgKz0gYCR7YmFzZX0ke2ZvbGRlci5nZXRBdHRyaWJ1dGUoJ25hbWUnKX1cXCR7ZmlsZS5nZXRBdHRyaWJ1dGUoJ25hbWUnKX1cbmApOyB9IH0pOyBjb25zdCBub3cgPSBuZXcgRGF0ZSgpOyBjb25zdCBzdGFtcCA9IGAke25vdy5nZXRGdWxsWWVhcigpfSR7U3RyaW5nKG5vdy5nZXRNb250aCgpKzEpLnBhZFN0YXJ0KDIsJzAnKX0ke1N0cmluZyhub3cuZ2V0RGF0ZSgpKS5wYWRTdGFydCgyLCcwJyl9XyR7U3RyaW5nKG5vdy5nZXRIb3VycygpKS5wYWRTdGFydCgyLCcwJyl9JHtTdHJpbmcobm93LmdldE1pbnV0ZXMoKSkucGFkU3RhcnQoMiwnMCcpfWA7IGNvbnN0IGZuYW1lID0gYCR7KGN1c3R8fCdjdXN0b21lcicpLnJlcGxhY2UoL1teYS16QS1aMC05XS9nLCdfJyl9XyR7c3RhbXB9LlBSTVpgOyBjb25zdCBibG9iID0gbmV3IEJsb2IoW2NvbnRlbnRdLCB7IHR5cGU6J3RleHQvcGxhaW4nIH0pOyBjb25zdCBhID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpOyBhLmhyZWYgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKGJsb2IpOyBhLmRvd25sb2FkID0gZm5hbWU7IGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoYSk7IGEuY2xpY2soKTsgYS5yZW1vdmUoKTsgVVJMLnJldm9rZU9iamVjdFVSTChhLmhyZWYpOyB0b2FzdCgnQWRtaW4gZXhwb3J0IHJlYWR5Jyk7IH1jYXRjaChlKXsgY29uc29sZS5lcnJvcihlKTsgdG9hc3QoJ0FkbWluIGV4cG9ydCBmYWlsZWQnKTsgfQ0KfSk7DQoNCi8vIHVwbG9hZCBsb2dpYyAoZmlsZWJpbiB0aGVuIGdvZmlsZSkNCiQoJ3VwbG9hZEJ0bicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgKCk9PnsNCg0KICBpZihzdGF0ZS5zZWxlY3RlZC5sZW5ndGg9PT0wKXsgYWxlcnQoJ05vIGl0ZW1zIHNlbGVjdGVkJyk7IHJldHVybjsgfQ0KICBjb25zdCBjdXN0ID0gKCQoJ2N1c3RvbWVyJykudmFsdWV8fCcnKS50cmltKCk7IGlmKCFjdXN0KXsgYWxlcnQoJ0N1c3RvbWVyIHJlcXVpcmVkJyk7IHJldHVybjsgfQ0KICBpZighY29uZmlybShgVXBsb2FkIGxpc3QgZm9yICR7Y3VzdH0/YCkpIHJldHVybjsgY29uc3QgZmlsZW5hbWUgPSAkKCdmaWxlbmFtZVByZXZpZXcnKS50ZXh0Q29udGVudCB8fCAnbGlzdC5DTElfUFJNWic7IGNvbnN0IGJsb2IgPSBuZXcgQmxvYihbc3RhdGUuc2VsZWN0ZWQubWFwKHM9PnMubmFtZSkuam9pbignXG4nKV0sIHsgdHlwZTondGV4dC9wbGFpbicgfSk7IGNvbnN0IG5vdyA9IERhdGUubm93KCk7IGlmKG5vdyAtIHN0YXRlLmxhc3RVcGxvYWQgPCAxNTAwMCl7IGFsZXJ0KCdQbGVhc2Ugd2FpdCAxNSBzZWNvbmRzIGJldHdlZW4gdXBsb2FkcycpOyByZXR1cm47IH0NCiAgdHJ5eyBjb25zdCBiaW4gPSAneGxnNGtnZ296YmRnc253NCc7IGNvbnN0IHVybCA9IGBodHRwczovL2ZpbGViaW4ubmV0LyR7YmlufS8ke2ZpbGVuYW1lfWA7IGNvbnN0IHIgPSBhd2FpdCBmZXRjaCh1cmwseyBtZXRob2Q6J1BPU1QnLCBoZWFkZXJzOnsgJ0NvbnRlbnQtVHlwZSc6J3RleHQvcGxhaW4nIH0sIGJvZHk6IGJsb2IgfSk7IA0KDQppZihyLm9rIHx8IHIuc3RhdHVzPT09MjAxKXsgc3RhdGUubGFzdFVwbG9hZCA9IG5vdzsgJCgnc2hhcmVhYmxlJykudmFsdWUgPSBgaHR0cHM6Ly9maWxlYmluLm5ldC8ke2Jpbn0vJHtmaWxlbmFtZX1gOyB0b2FzdCgnVXBsb2FkZWQgdG8gZmlsZWJpbicpOyANCiAgICAgIC8vICBBdXRvLWhpZGUgY29uZmlnIGFmdGVyIHN1Y2Nlc3MNCiAgICAgIGlmIChjb25maWdTZWN0aW9uICYmIHRvZ2dsZUJ0biAmJiBjb25maWdTZWN0aW9uLmNsYXNzTGlzdC5jb250YWlucygnYWN0aXZlJykpIHsNCiAgICAgICAgY29uZmlnU2VjdGlvbi5jbGFzc0xpc3QucmVtb3ZlKCdhY3RpdmUnKTsNCiAgICAgICAgdG9nZ2xlQnRuLnRleHRDb250ZW50ID0gJ1Nob3cgQ29uZmlndXJhdGlvbic7DQogICAgICB9DQpyZXR1cm47IA0KfSB9Y2F0Y2goZSl7IGNvbnNvbGUud2FybignZmlsZWJpbiBlcnJvcicsIGUpOyB9DQogIHRyeXsgY29uc3QgZm9ybSA9IG5ldyBGb3JtRGF0YSgpOyBmb3JtLmFwcGVuZCgnZmlsZScsIGJsb2IsIGZpbGVuYW1lKTsgY29uc3QgcmVzID0gYXdhaXQgZmV0Y2goJ2h0dHBzOi8vdXBsb2FkLmdvZmlsZS5pby91cGxvYWRGaWxlJywgeyBtZXRob2Q6J1BPU1QnLCBib2R5OiBmb3JtIH0pOyBjb25zdCBqID0gYXdhaXQgcmVzLmpzb24oKTsgaWYoai5zdGF0dXMgPT09ICdvaycpeyBzdGF0ZS5sYXN0VXBsb2FkID0gbm93OyAkKCdzaGFyZWFibGUnKS52YWx1ZSA9IGouZGF0YS5kb3dubG9hZFBhZ2U7IHRvYXN0KCdVcGxvYWRlZCB0byBHb0ZpbGUnKTsgcmV0dXJuOyB9IHRvYXN0KCdVcGxvYWQgZmFpbGVkJyk7IH1jYXRjaChlKXsgY29uc29sZS5lcnJvcihlKTsgdG9hc3QoJ1VwbG9hZCBlcnJvcicpOyB9DQp9KTsNCg0KLy8gYmluIGxpc3QNCiQoJ2Jpbkxpc3QnKT8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoKSA9PiB7DQogIHRyeSB7DQogICAgY29uc3QgYmluID0gJ3hsZzRrZ2dvemJkZ3NudzQnOw0KICAgIGNvbnN0IHIgPSBhd2FpdCBmZXRjaChgaHR0cHM6Ly9maWxlYmluLm5ldC8ke2Jpbn0/anNvbmAsIHsNCiAgICAgIGhlYWRlcnM6IHsgIkFjY2VwdCI6ICJhcHBsaWNhdGlvbi9qc29uIiB9DQogICAgfSk7DQogICAgaWYgKCFyLm9rKSB7IHRvYXN0KGBGYWlsZWQgdG8gZmV0Y2ggdXBsb2FkczogJHtyLnN0YXR1c1RleHR9YCk7IHJldHVybjsgfQ0KDQogICAgbGV0IGo7DQogICAgdHJ5IHsNCiAgICAgIGogPSBhd2FpdCByLmpzb24oKTsNCiAgICB9IGNhdGNoIChlcnIpIHsNCiAgICAgIHRvYXN0KCJGYWlsZWQgdG8gcGFyc2Ugc2VydmVyIHJlc3BvbnNlIik7DQogICAgICBjb25zb2xlLmVycm9yKGVycik7DQogICAgICByZXR1cm47DQogICAgfQ0KDQogICAgaWYgKCFqLmZpbGVzIHx8ICFqLmZpbGVzLmxlbmd0aCkgeyB0b2FzdCgnTm8gZmlsZXMgZm91bmQnKTsgcmV0dXJuOyB9DQoNCiAgICAvLyBzb3J0IGFuZCB0cmltDQogICAgY29uc3Qgc29ydGVkID0gai5maWxlcy5zb3J0KChhLGIpPT4gbmV3IERhdGUoYi51cGRhdGVkX2F0KSAtIG5ldyBEYXRlKGEudXBkYXRlZF9hdCkpOw0KICAgIGNvbnN0IHJlY2VudCA9IHNvcnRlZC5zbGljZSgwLDEwKTsNCg0KICAgIGxldCBodG1sID0gJzxidXR0b24gaWQ9ImNsb3NlQmluIj5DbG9zZTwvYnV0dG9uPjx1bD4nOw0KICAgIHJlY2VudC5mb3JFYWNoKGZpbGUgPT4gew0KICAgICAgY29uc3QgZmlsZVVybCA9IGBodHRwczovL2ZpbGViaW4ubmV0LyR7YmlufS8ke2VuY29kZVVSSUNvbXBvbmVudChmaWxlLmZpbGVuYW1lKX1gOw0KICAgICAgY29uc3QgYWRkZWREYXRlID0gbmV3IERhdGUoZmlsZS51cGRhdGVkX2F0KTsNCiAgICAgIGNvbnN0IGZvcm1hdHRlZERhdGUgPSBhZGRlZERhdGUudG9JU09TdHJpbmcoKS5zbGljZSgwLDEwKS5yZXBsYWNlKC8tL2csJycpOw0KICAgICAgY29uc3QgaG91cnMgPSBhZGRlZERhdGUuZ2V0SG91cnMoKTsNCiAgICAgIGNvbnN0IG1pbnV0ZXMgPSBhZGRlZERhdGUuZ2V0TWludXRlcygpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwnMCcpOw0KICAgICAgY29uc3QgYW1wbSA9IGhvdXJzID49IDEyID8gJ1BNJzonQU0nOw0KICAgICAgY29uc3QgZm9ybWF0dGVkVGltZSA9IGAke2hvdXJzICUgMTIgfHwgMTJ9OiR7bWludXRlc30gJHthbXBtfWA7DQogICAgICBjb25zdCBzdHJpcHBlZE5hbWUgPSBmaWxlLmZpbGVuYW1lLnNwbGl0KCcuJykuc2xpY2UoMCwtMSkuam9pbignLicpOw0KICAgICAgY29uc3QgZmlsZVNpemUgPSBmaWxlLmJ5dGVzX3JlYWRhYmxlIHx8ICcnOw0KICAgICAgaHRtbCArPSBgPGxpPjxhIGhyZWY9IiR7ZmlsZVVybH0iIHRhcmdldD0iX2JsYW5rIj4ke2Zvcm1hdHRlZERhdGV9ICR7Zm9ybWF0dGVkVGltZX0gfCAke3N0cmlwcGVkTmFtZX0gfCAke2ZpbGVTaXplfTwvYT48L2xpPmA7DQogICAgfSk7DQogICAgaHRtbCArPSAnPC91bD4nOw0KDQogICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2ZpbGVMaXN0Q29udGFpbmVyJyk7DQogICAgY29udGFpbmVyLmlubmVySFRNTCA9IGh0bWw7DQogICAgY29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snOw0KDQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Nsb3NlQmluJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiBjb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdub25lJyk7DQogIH0gY2F0Y2ggKGUpIHsNCiAgICBjb25zb2xlLmVycm9yKGUpOw0KICAgIHRvYXN0KCdFcnJvciBmZXRjaGluZyB1cGxvYWRzJyk7DQogIH0NCn0pOw0KDQoNCi8vIEJ1bGsgc2VsZWN0IGFsbCB2aXNpYmxlIHNlYXJjaCByZXN1bHRzIHdoZW4gcHJlc3NpbmcgRW50ZXIgaW4gc2VhcmNoDQokKCdzZWFyY2gnKS5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgKGV2KSA9PiB7DQogIGlmIChldi5rZXkgPT09ICdFbnRlcicpIHsNCiAgICBldi5wcmV2ZW50RGVmYXVsdCgpOw0KICAgIGNvbnN0IHZpc2libGVJdGVtcyA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLml0ZW0nKSkNCiAgICAgIC5maWx0ZXIoZWwgPT4gZWwuc3R5bGUuZGlzcGxheSAhPT0gJ25vbmUnKTsNCiAgICBsZXQgYWRkZWQgPSAwOw0KICAgIHZpc2libGVJdGVtcy5mb3JFYWNoKGVsID0+IHsNCiAgICAgIGNvbnN0IG5hbWUgPSBlbC5kYXRhc2V0Lm5hbWU7DQogICAgICBjb25zdCBzaXplID0gZWwuZGF0YXNldC5zaXplOw0KICAgICAgaWYgKCFzdGF0ZS5zZWxlY3RlZC5zb21lKHMgPT4gcy5uYW1lID09PSBuYW1lKSkgew0KICAgICAgICBzdGF0ZS5zZWxlY3RlZC5wdXNoKHsgbmFtZSwgc2l6ZSB9KTsNCiAgICAgICAgZWwuY2xhc3NMaXN0LmFkZCgnc2VsZWN0ZWQnKTsNCiAgICAgICAgYWRkZWQrKzsNCiAgICAgIH0NCiAgICB9KTsNCiAgICBpZiAoYWRkZWQgPiAwKSB7DQogICAgICB1cGRhdGVUb3RhbHMoKTsNCiAgICAgIHJlbmRlck92ZXJsYXkoKTsNCiAgICAgIHRvYXN0KGBBZGRlZCAke2FkZGVkfSBpdGVtcyBmcm9tIHNlYXJjaCByZXN1bHRzYCk7DQogICAgfSBlbHNlIHsNCiAgICAgIHRvYXN0KCdObyBuZXcgaXRlbXMgdG8gYWRkJyk7DQogICAgfQ0KICB9DQp9KTsNCg0KJCgnY29weUxpbmsnKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsNCiAgY29uc3QgbGluayA9ICQoJ3NoYXJlYWJsZScpLnZhbHVlOw0KICBpZiAoIWxpbmspIHsNCiAgICB0b2FzdCgnTm90aGluZyB0byBjb3B5Jyk7DQogICAgcmV0dXJuOw0KICB9DQogIG5hdmlnYXRvci5jbGlwYm9hcmQud3JpdGVUZXh0KGxpbmspLnRoZW4oKCkgPT4gew0KICAgIHRvYXN0KCdMaW5rIGNvcGllZCB0byBjbGlwYm9hcmQnKTsNCiAgfSkuY2F0Y2goKCkgPT4gew0KICAgIGFsZXJ0KCdDb3B5IGZhaWxlZCwgcGxlYXNlIGNvcHkgbWFudWFsbHknKTsNCiAgfSk7DQp9KTsNCg0KLyokKCdyZWxvYWRCdG4nKS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHsNCiAgaWYgKGNvbmZpcm0oJ1JlbG9hZCB0aGUgcGFnZT8gQWxsIHVuc2F2ZWQgc2VsZWN0aW9ucyB3aWxsIGJlIGxvc3QuJykpIHsNCiAgICBsb2NhdGlvbi5yZWxvYWQoKTsNCiAgfQ0KfSk7Ki8NCg0KLy8gZmlsZW5hbWUgcGFyc2UgdXNlZCBpbiBpbXBvcnQNCmZ1bmN0aW9uIHBhcnNlRmlsZW5hbWVUb0NvbmZpZyhmbil7IGNvbnN0IGJhc2UgPSBmbi5yZXBsYWNlKC9cLihDTElfUFJNWnxQUk1afHR4dCkkL2ksJycpOyBjb25zdCBwYXJ0cyA9IGJhc2Uuc3BsaXQoJ18nKTsgaWYocGFydHMubGVuZ3RoIDwgNSkgcmV0dXJuIG51bGw7IGNvbnN0IHRva2VucyA9IHBhcnRzLnNsaWNlKDAsLTEpOyBsZXQgY29uc29sZVRva2VuPSd2MScsIHNkVG9rZW49J3NkMCcsIGRyb2lkVG9rZW49J2Ryb2lkMCcsIGxpblRva2VuPSdsaW4wJzsgZm9yKGxldCBpPXRva2Vucy5sZW5ndGgtMTtpPj0wO2ktLSl7IGNvbnN0IHQgPSB0b2tlbnNbaV0udG9Mb3dlckNhc2UoKTsgaWYoL15saW5cZCskLy50ZXN0KHQpICYmIGxpblRva2VuPT09J2xpbjAnKXsgbGluVG9rZW4gPSB0OyB0b2tlbnMuc3BsaWNlKGksMSk7IH0gZWxzZSBpZigvXmRyb2lkXGQrJC8udGVzdCh0KSAmJiBkcm9pZFRva2VuPT09J2Ryb2lkMCcpeyBkcm9pZFRva2VuID0gdDsgdG9rZW5zLnNwbGljZShpLDEpOyB9IGVsc2UgaWYoL15zZFxkKyQvLnRlc3QodCkgJiYgc2RUb2tlbj09PSdzZDAnKXsgc2RUb2tlbiA9IHQ7IHRva2Vucy5zcGxpY2UoaSwxKTsgfSBlbHNlIGlmKC9eKHYxfHYyfGxpdGV8b2xlZCkkLy50ZXN0KHQpICYmIGNvbnNvbGVUb2tlbj09PSd2MScpeyBjb25zb2xlVG9rZW4gPSB0OyB0b2tlbnMuc3BsaWNlKGksMSk7IH0gfSBjb25zdCBjdXN0b21lciA9IHRva2Vucy5qb2luKCdfJyl8fCdjdXN0b21lcic7IHJldHVybiB7IGN1c3RvbWVyLCBjb25zb2xlVG9rZW4sIHNkVG9rZW4sIGRyb2lkVG9rZW4sIGxpblRva2VuIH0gfQ0KDQovLyB3aXJlIGZpbGUgaW5wdXQgZm9yIGltcG9ydA0KJCgnZmlsZUluJyk/LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIChldik9PnsgY29uc3QgZiA9IGV2LnRhcmdldC5maWxlc1swXTsgaWYoIWYpIHJldHVybjsgY29uc3QgY2ZnID0gcGFyc2VGaWxlbmFtZVRvQ29uZmlnKGYubmFtZSk7IGlmKGNmZyl7ICQoJ2N1c3RvbWVyJykudmFsdWUgPSBjZmcuY3VzdG9tZXI7IEFycmF5LmZyb20oJCgnY29uc29sZScpLm9wdGlvbnMpLmZvckVhY2gobz0+eyBpZihvLnZhbHVlPT09Y2ZnLmNvbnNvbGVUb2tlbikgby5zZWxlY3RlZD10cnVlOyB9KTsgaWYoL15zZFxkKyQvLnRlc3QoY2ZnLnNkVG9rZW4pKSAkKCdzZCcpLnZhbHVlID0gTnVtYmVyKGNmZy5zZFRva2VuLnJlcGxhY2UoL1xEL2csJycpKTsgaWYoL15kcm9pZFxkKyQvLnRlc3QoY2ZnLmRyb2lkVG9rZW4pKSAkKCdhbmRyb2lkJykudmFsdWUgPSBOdW1iZXIoY2ZnLmRyb2lkVG9rZW4ucmVwbGFjZSgvXEQvZywnJykpOyBpZigvXmxpblxkKyQvLnRlc3QoY2ZnLmxpblRva2VuKSkgJCgnbGludXgnKS52YWx1ZSA9IE51bWJlcihjZmcubGluVG9rZW4ucmVwbGFjZSgvXEQvZywnJykpOyB1cGRhdGVGaWxlbmFtZVByZXZpZXcoKTsgdXBkYXRlVG90YWxzKCk7IH0NCiAgY29uc3QgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTsgcmVhZGVyLm9ubG9hZCA9IChlKT0+eyBjb25zdCBsaW5lcyA9IGUudGFyZ2V0LnJlc3VsdC5zcGxpdCgnXG4nKS5tYXAocz0+cy50cmltKCkpLmZpbHRlcihCb29sZWFuKTsgc3RhdGUuc2VsZWN0ZWQ9W107IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5pdGVtJykuZm9yRWFjaChpPT5pLmNsYXNzTGlzdC5yZW1vdmUoJ3NlbGVjdGVkJykpOyBsaW5lcy5mb3JFYWNoKHRpdGxlPT57IGNvbnN0IHJvdyA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLml0ZW0nKSkuZmluZChpdD0+IGl0LmRhdGFzZXQubmFtZT09PXRpdGxlKTsgaWYocm93KXsgcm93LmNsYXNzTGlzdC5hZGQoJ3NlbGVjdGVkJyk7IHN0YXRlLnNlbGVjdGVkLnB1c2goeyBuYW1lOiByb3cuZGF0YXNldC5uYW1lLCBzaXplOiByb3cuZGF0YXNldC5zaXplIH0pOyB9IGVsc2UgeyBjb25zdCBtYXliZSA9IEFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLml0ZW0nKSkuZmluZChpdD0+IGl0LmRhdGFzZXQubmFtZSAmJiBpdC5kYXRhc2V0Lm5hbWUudG9Mb3dlckNhc2UoKT09PXRpdGxlLnRvTG93ZXJDYXNlKCkpOyBpZihtYXliZSl7IG1heWJlLmNsYXNzTGlzdC5hZGQoJ3NlbGVjdGVkJyk7IHN0YXRlLnNlbGVjdGVkLnB1c2goeyBuYW1lOm1heWJlLmRhdGFzZXQubmFtZSwgc2l6ZTptYXliZS5kYXRhc2V0LnNpemUgfSk7IH0gfSB9KTsgdXBkYXRlVG90YWxzKCk7IHJlbmRlck92ZXJsYXkoKTsgfTsgcmVhZGVyLnJlYWRBc1RleHQoZik7IH0pOw0KDQovLyBoZWxwZXJzDQpmdW5jdGlvbiBkZWJvdW5jZShmbixtcz0yMDApeyBsZXQgaDsgcmV0dXJuICguLi5hKT0+eyBjbGVhclRpbWVvdXQoaCk7IGg9c2V0VGltZW91dCgoKT0+Zm4oLi4uYSksbXMpOyB9OyB9DQoNCi8vIGluaXRpYWwgbG9hZA0KKGFzeW5jIGZ1bmN0aW9uIGluaXQoKXsgYXdhaXQgbG9hZFhNTCgpOyB1cGRhdGVUb3RhbHMoKTsgdXBkYXRlRmlsZW5hbWVQcmV2aWV3KCk7IH0pKCk7DQoNCg0KDQoNCmZ1bmN0aW9uIHJlbmRlclNlbGVjdGVkUGFuZWwoKSB7DQogIGNvbnN0IGJvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2VsZWN0ZWRQYW5lbEJvZHknKTsNCiAgLy9jb25zdCBjb3VudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZWxlY3RlZFBhbmVsQ291bnQnKTsNCiAgaWYgKCFib2R5IHx8ICFjb3VudCkgcmV0dXJuOw0KDQogIGJvZHkuaW5uZXJIVE1MID0gJyc7DQogIHN0YXRlLnNlbGVjdGVkLmZvckVhY2goKHMsIGkpID0+IHsNCiAgICBjb25zdCByb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsNCiAgICByb3cuY2xhc3NOYW1lID0gJ3Jvdyc7DQogICAgcm93LnN0eWxlLmRpc3BsYXkgPSAnZmxleCc7DQogICAgcm93LnN0eWxlLmp1c3RpZnlDb250ZW50ID0gJ3NwYWNlLWJldHdlZW4nOw0KICAgIHJvdy5zdHlsZS5hbGlnbkl0ZW1zID0gJ2NlbnRlcic7DQogICAgcm93LnN0eWxlLnBhZGRpbmcgPSAnNnB4IDAnOw0KICAgIHJvdy5pbm5lckhUTUwgPSBgDQogICAgICA8ZGl2Pg0KICAgICAgICA8c3Ryb25nPiR7aSArIDF9LiAke2VzYyhzLm5hbWUpfTwvc3Ryb25nPg0KICAgICAgICA8ZGl2IGNsYXNzPSJtZXRhIj4ke2VzYyhzLnNpemUpfTwvZGl2Pg0KICAgICAgPC9kaXY+DQogICAgICA8ZGl2IHN0eWxlPSJkaXNwbGF5OmZsZXg7Z2FwOjRweDsiPg0KICAgICAgICA8YnV0dG9uIGNsYXNzPSJpY29uIHVwIj51PC9idXR0b24+DQogICAgICAgIDxidXR0b24gY2xhc3M9Imljb24gZG93biI+ZDwvYnV0dG9uPg0KICAgICAgICA8YnV0dG9uIGNsYXNzPSJpY29uIHJlbW92ZSI+eDwvYnV0dG9uPg0KICAgICAgPC9kaXY+DQogICAgYDsNCg0KICAgIC8vIE1vdmUgdXANCiAgICByb3cucXVlcnlTZWxlY3RvcignLnVwJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7DQogICAgICBpZiAoaSA+IDApIHsNCiAgICAgICAgW3N0YXRlLnNlbGVjdGVkW2kgLSAxXSwgc3RhdGUuc2VsZWN0ZWRbaV1dID0gW3N0YXRlLnNlbGVjdGVkW2ldLCBzdGF0ZS5zZWxlY3RlZFtpIC0gMV1dOw0KICAgICAgICByZW5kZXJPdmVybGF5KCk7DQogICAgICAgIHJlbmRlckxpc3Qoc3RhdGUuaXRlbXMpOw0KICAgICAgICB1cGRhdGVUb3RhbHMoKTsNCiAgICAgIH0NCiAgICB9KTsNCg0KICAgIC8vIE1vdmUgZG93bg0KICAgIHJvdy5xdWVyeVNlbGVjdG9yKCcuZG93bicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gew0KICAgICAgaWYgKGkgPCBzdGF0ZS5zZWxlY3RlZC5sZW5ndGggLSAxKSB7DQogICAgICAgIFtzdGF0ZS5zZWxlY3RlZFtpICsgMV0sIHN0YXRlLnNlbGVjdGVkW2ldXSA9IFtzdGF0ZS5zZWxlY3RlZFtpXSwgc3RhdGUuc2VsZWN0ZWRbaSArIDFdXTsNCiAgICAgICAgcmVuZGVyT3ZlcmxheSgpOw0KICAgICAgICByZW5kZXJMaXN0KHN0YXRlLml0ZW1zKTsNCiAgICAgICAgdXBkYXRlVG90YWxzKCk7DQogICAgICB9DQogICAgfSk7DQoNCiAgICAvLyBSZW1vdmUNCiAgICByb3cucXVlcnlTZWxlY3RvcignLnJlbW92ZScpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gew0KICAgICAgc3RhdGUuc2VsZWN0ZWQuc3BsaWNlKGksIDEpOw0KICAgICAgcmVuZGVyT3ZlcmxheSgpOw0KICAgICAgcmVuZGVyTGlzdChzdGF0ZS5pdGVtcyk7DQogICAgICB1cGRhdGVUb3RhbHMoKTsNCiAgICB9KTsNCg0KICAgIGJvZHkuYXBwZW5kQ2hpbGQocm93KTsNCiAgfSk7DQoNCiAgY291bnQudGV4dENvbnRlbnQgPSBzdGF0ZS5zZWxlY3RlZC5sZW5ndGg7DQp9DQoNCmNvbnN0IHRvZ2dsZUJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0b2dnbGVDb25maWcnKTsNCmNvbnN0IGNvbmZpZ1NlY3Rpb24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29uZmlnU2VjdGlvbicpOw0KDQoNCmlmIChpc01vYmlsZSAmJiB0b2dnbGVCdG4gJiYgY29uZmlnU2VjdGlvbikgew0KICAvLyBTaG93IGNvbmZpZyBvbmNlIG9uIGZpcnN0IGxvYWQNCiAgY29uZmlnU2VjdGlvbi5jbGFzc0xpc3QuYWRkKCdhY3RpdmUnKTsNCiAgdG9nZ2xlQnRuLnRleHRDb250ZW50ID0gJ0hpZGUgQ29uZmlndXJhdGlvbic7DQoNCiAgdG9nZ2xlQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gew0KICAgIGNvbnN0IGlzVmlzaWJsZSA9IGNvbmZpZ1NlY3Rpb24uY2xhc3NMaXN0LnRvZ2dsZSgnYWN0aXZlJyk7DQogICAgdG9nZ2xlQnRuLnRleHRDb250ZW50ID0gaXNWaXNpYmxlID8gJ0hpZGUgQ29uZmlndXJhdGlvbicgOiAnU2hvdyBDb25maWd1cmF0aW9uJzsNCiAgfSk7DQp9DQoNCi8vIC0tLS0tLS0tLS0gUm9idXN0IExhdGVzdC1zb3J0IHBhdGNoIC0tLS0tLS0tLS0NCmZ1bmN0aW9uIHBhcnNlRGF0ZUZsZXhpYmxlKHMpIHsNCiAgaWYgKCFzKSByZXR1cm4gbnVsbDsNCiAgLy8gVHJ5IGRpcmVjdCBEYXRlIHBhcnNlIChJU08gKyBtYW55IGZvcm1hdHMpDQogIGxldCBkID0gbmV3IERhdGUocyk7DQogIGlmICghaXNOYU4oZC5nZXRUaW1lKCkpKSByZXR1cm4gZDsNCg0KICAvLyBUcnkgY29tbW9uIFktTS1EIG9yIFlNRCAobGlrZSAyMDI1MTAyMCBvciAyMDI1LTEwLTIwKQ0KICBjb25zdCB5bWQgPSAoJycrcykubWF0Y2goLyhcZHs0fSlcRD8oXGR7MSwyfSlcRD8oXGR7MSwyfSkvKTsNCiAgaWYgKHltZCkgew0KICAgIGQgPSBuZXcgRGF0ZShOdW1iZXIoeW1kWzFdKSwgTnVtYmVyKHltZFsyXSkgLSAxLCBOdW1iZXIoeW1kWzNdKSk7DQogICAgaWYgKCFpc05hTihkLmdldFRpbWUoKSkpIHJldHVybiBkOw0KICB9DQoNCiAgLy8gVHJ5IEQvTS9ZIG9yIEQtTS1ZIChlLmcuLCAyMC8xMC8yMDI1KQ0KICBjb25zdCBkbXkgPSAoJycrcykubWF0Y2goLyhcZHsxLDJ9KVxEKFxkezEsMn0pXEQoXGR7NH0pLyk7DQogIGlmIChkbXkpIHsNCiAgICBkID0gbmV3IERhdGUoTnVtYmVyKGRteVszXSksIE51bWJlcihkbXlbMl0pIC0gMSwgTnVtYmVyKGRteVsxXSkpOw0KICAgIGlmICghaXNOYU4oZC5nZXRUaW1lKCkpKSByZXR1cm4gZDsNCiAgfQ0KDQogIC8vIEFzIGxhc3QgcmVzb3J0LCB0cnkgZXh0cmFjdGluZyBZWVlZTU1ERCBpbnNpZGUgc3RyaW5nDQogIGNvbnN0IHltZDIgPSAoJycrcykubWF0Y2goLygxOXwyMClcZHsyfVxkezJ9XGR7Mn0vKTsNCiAgaWYgKHltZDIpIHsNCiAgICBjb25zdCBzdHIgPSB5bWQyWzBdOw0KICAgIGQgPSBuZXcgRGF0ZShOdW1iZXIoc3RyLnNsaWNlKDAsNCkpLCBOdW1iZXIoc3RyLnNsaWNlKDQsNikpIC0gMSwgTnVtYmVyKHN0ci5zbGljZSg2LDgpKSk7DQogICAgaWYgKCFpc05hTihkLmdldFRpbWUoKSkpIHJldHVybiBkOw0KICB9DQoNCiAgcmV0dXJuIG51bGw7DQp9DQoNCmZ1bmN0aW9uIHNvcnRCeUxhdGVzdEFuZFJlbmRlcigpIHsNCiAgaWYgKCFzdGF0ZS5pdGVtcyB8fCBzdGF0ZS5pdGVtcy5sZW5ndGggPT09IDApIHsNCiAgICB0b2FzdCgnTm8gbGlzdCBsb2FkZWQgeWV0Jyk7DQogICAgJCgnc3RhdHVzJykudGV4dENvbnRlbnQgPSAnTm8gbGlzdCBsb2FkZWQgeWV0JzsNCiAgICByZXR1cm47DQogIH0NCg0KICAvLyBhdHRhY2ggYSBub3JtYWxpemVkIHBhcnNlZERhdGUgb24gZWFjaCBpdGVtIGZvciBzdGFibGUgc29ydGluZw0KICBzdGF0ZS5pdGVtcy5mb3JFYWNoKGl0ID0+IHsNCiAgICAvLyB0cnkgaXRlbS5kYXRlIGZpcnN0LCBmYWxsYmFjayB0byBvdGhlciBwb3NzaWJsZSBrZXlzDQogICAgY29uc3QgcmF3ID0gaXQuZGF0ZSB8fCBpdC5kYXRlTW9kaWZpZWQgfHwgaXQubW9kaWZpZWQgfHwgaXQubGFzdE1vZGlmaWVkIHx8ICcnOw0KICAgIGNvbnN0IHBkID0gcGFyc2VEYXRlRmxleGlibGUocmF3KTsNCiAgICBpdC5fcGFyc2VkRGF0ZSA9IHBkID8gcGQuZ2V0VGltZSgpIDogMDsgLy8gMCBzb3J0cyB0byB0aGUgZW5kIChvbGQpDQogIH0pOw0KDQogIC8vIHNvcnQgaW4tcGxhY2UgZGVzY2VuZGluZyBieSBwYXJzZWQgdGltZXN0YW1wDQogIHN0YXRlLml0ZW1zLnNvcnQoKGEsIGIpID0+IGIuX3BhcnNlZERhdGUgLSBhLl9wYXJzZWREYXRlKTsNCg0KICAvLyByZS1yZW5kZXIgdXNpbmcgdGhlIG5vdy1zb3J0ZWQgc3RhdGUuaXRlbXMNCiAgcmVuZGVyTGlzdChzdGF0ZS5pdGVtcyk7DQoNCiAgLy8gdmlzaWJsZSBmZWVkYmFjaw0KICB0b2FzdCgnU29ydGVkIGJ5IGxhdGVzdCBtb2RpZmllZCcpOw0KICAkKCdzdGF0dXMnKS50ZXh0Q29udGVudCA9ICdTb3J0ZWQgYnkgbGF0ZXN0IG1vZGlmaWVkJzsNCn0NCmxldCBzb3J0TW9kZSA9ICdub3JtYWwnOyAvLyBjeWNsZXM6IG5vcm1hbCDihpIgbGF0ZXN0IOKGkiBzY29yZQ0KDQpmdW5jdGlvbiBzb3J0Q3ljbGUoKSB7DQogIGlmICghc3RhdGUuaXRlbXMgfHwgc3RhdGUuaXRlbXMubGVuZ3RoID09PSAwKSB7DQogICAgdG9hc3QoJ05vIGxpc3QgbG9hZGVkIHlldCcpOw0KICAgIHJldHVybjsNCiAgfQ0KDQogIGlmIChzb3J0TW9kZSA9PT0gJ25vcm1hbCcpIHsNCiAgICBzb3J0TW9kZSA9ICdsYXRlc3QnOw0KICAgIC8vIFNvcnQgYnkgZGF0ZQ0KICAgIHN0YXRlLml0ZW1zLmZvckVhY2goaXQgPT4gew0KICAgICAgY29uc3QgcmF3ID0gaXQuZGF0ZSB8fCBpdC5kYXRlTW9kaWZpZWQgfHwgaXQubW9kaWZpZWQgfHwgJyc7DQogICAgICBjb25zdCBkID0gcGFyc2VEYXRlRmxleGlibGUocmF3KTsNCiAgICAgIGl0Ll9wYXJzZWREYXRlID0gZCA/IGQuZ2V0VGltZSgpIDogMDsNCiAgICB9KTsNCiAgICBjb25zdCBzb3J0ZWQgPSBbLi4uc3RhdGUuaXRlbXNdLnNvcnQoKGEsIGIpID0+IGIuX3BhcnNlZERhdGUgLSBhLl9wYXJzZWREYXRlKTsNCiAgICByZW5kZXJMaXN0KHNvcnRlZCk7DQogICAgdG9hc3QoJ1NvcnRlZCBieSBMYXRlc3QgTW9kaWZpZWQnKTsNCiAgICAkKCdzb3J0TGF0ZXN0JykudGV4dENvbnRlbnQgPSAnTGF0ZXN0JzsNCg0KICB9IGVsc2UgaWYgKHNvcnRNb2RlID09PSAnbGF0ZXN0Jykgew0KICAgIHNvcnRNb2RlID0gJ3Njb3JlJzsNCiAgICAvLyBTb3J0IGJ5IHNjb3JlDQogICAgY29uc3Qgc29ydGVkID0gWy4uLnN0YXRlLml0ZW1zXS5zb3J0KChhLCBiKSA9PiAocGFyc2VJbnQoYi5zY29yZSB8fCAwKSAtIHBhcnNlSW50KGEuc2NvcmUgfHwgMCkpKTsNCiAgICByZW5kZXJMaXN0KHNvcnRlZCk7DQogICAgdG9hc3QoJ1NvcnRlZCBieSBTY29yZScpOw0KICAgICQoJ3NvcnRMYXRlc3QnKS50ZXh0Q29udGVudCA9ICdUb3AnOw0KDQogIH0gZWxzZSB7DQogICAgc29ydE1vZGUgPSAnbm9ybWFsJzsNCiAgICAvLyBOb3JtYWwgb3JkZXIgKG9yaWdpbmFsIFhNTCBvcmRlcikNCiAgICByZW5kZXJMaXN0KHN0YXRlLml0ZW1zKTsNCiAgICB0b2FzdCgnU29ydGVkIGJ5IE5hbWUgKE5vcm1hbCknKTsNCiAgICAkKCdzb3J0TGF0ZXN0JykudGV4dENvbnRlbnQgPSAnU29ydCc7DQogIH0NCn0NCg0KLy8gQmluZCAoc2FmZSBldmVuIGlmIGNhbGxlZCBiZWZvcmUgbG9hZDsgd2lsbCBjaGVjayBmb3IgaXRlbXMgaW5zaWRlKQ0KY29uc3Qgc29ydEJ0biA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzb3J0TGF0ZXN0Jyk7DQppZiAoc29ydEJ0bikgew0KICBzb3J0QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgc29ydEN5Y2xlKTsNCn0NCg0KLy8gQWxzbyBzdXBwb3J0IHR5cGluZyAibGF0ZXN0IiBpbiBzZWFyY2gNCmNvbnN0IG9yaWdTZWFyY2hIYW5kbGVyID0gKGUpID0+IHsNCiAgY29uc3QgcSA9IChlLnRhcmdldC52YWx1ZSB8fCAnJykudG9Mb3dlckNhc2UoKS50cmltKCk7DQogIGlmIChxID09PSAnbGF0ZXN0Jykgew0KICAgIHNvcnRCeUxhdGVzdEFuZFJlbmRlcigpOw0KICAgIHJldHVybjsNCiAgfQ0KICByZW5kZXJMaXN0KHN0YXRlLml0ZW1zLmZpbHRlcihpdCA9PiAoaXQubmFtZSB8fCAnJykudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhxKSkpOw0KfTsNCiQoJ3NlYXJjaCcpLnJlbW92ZUV2ZW50TGlzdGVuZXIgJiYgJCgnc2VhcmNoJykucmVtb3ZlRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBvcmlnU2VhcmNoSGFuZGxlcik7IC8vIHNhZmUgZ3VhcmQNCiQoJ3NlYXJjaCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0JywgZGVib3VuY2Uob3JpZ1NlYXJjaEhhbmRsZXIsIDE4MCkpOw0KDQoNCg0KZGV0ZWN0RW52aXJvbm1lbnQoKTsNCmlmICghaXNMb2NhbCkgew0KCQ0KICBjb25zdCBhZG1pbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhZG1pbkV4cG9ydCcpOw0KICBpZiAoYWRtaW4pIGFkbWluLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQoNCiAgY29uc3QgYmluID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Jpbkxpc3QnKTsNCiAgaWYgKGJpbikgYmluLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQoNCiAgLy9jb25zdCB1cGxvYWQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndXBsb2FkQnRuJyk7DQogIC8vaWYgKHVwbG9hZCkgdXBsb2FkLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7DQoNCn0NCg0KDQo8IS0tIEtlZXAgU2VhcmNoIEJhciBGb2N1c2VkIChEZXNrdG9wIE9ubHksIFNhZmUgZm9yIEN1c3RvbWVyIElucHV0KSAtLT4NCg0KY29uc3Qgc2VhcmNoSW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2VhcmNoJyk7DQoNCg0KaWYgKCFpc01vYmlsZSkgew0KICBmdW5jdGlvbiByZWZvY3VzU2VhcmNoKCkgew0KICAgIGNvbnN0IGFjdGl2ZSA9IGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQ7DQogICAgaWYgKA0KICAgICAgYWN0aXZlICYmDQogICAgICAoYWN0aXZlLmlkID09PSAnY3VzdG9tZXInIHx8DQogICAgICAgYWN0aXZlLnRhZ05hbWUgPT09ICdTRUxFQ1QnIHx8DQogICAgICAgYWN0aXZlLnRhZ05hbWUgPT09ICdURVhUQVJFQScpDQogICAgKSByZXR1cm47DQogICAgc2VhcmNoSW5wdXQuZm9jdXMoKTsNCiAgICBzZWFyY2hJbnB1dC5zZWxlY3QoKTsNCiAgfQ0KDQogIC8vIEZvY3VzIGF0IGxvYWQNCiAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWQnLCByZWZvY3VzU2VhcmNoKTsNCg0KICAvLyBSZWZvY3VzIGFmdGVyIG5vcm1hbCBjbGlja3MgKG5vdCB3aGVuIG1vZGFsL292ZXJsYXkgb3IgdHlwaW5nIGVsc2V3aGVyZSkNCiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4gew0KICAgIGNvbnN0IG1vZGFsT3BlbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdmaWxlc01vZGFsJykuc3R5bGUuZGlzcGxheSA9PT0gJ2Jsb2NrJzsNCiAgICANCiAgICBjb25zdCBvdmVybGF5T3BlbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdvdmVybGF5Jykuc3R5bGUuZGlzcGxheSA9PT0gJ2ZsZXgnOw0KICAgIGlmICgNCiAgICAgICFtb2RhbE9wZW4gJiYNCiAgICAgICFvdmVybGF5T3BlbiAmJg0KICAgICAgZS50YXJnZXQuaWQgIT09ICdzZWFyY2gnICYmDQogICAgICBlLnRhcmdldC5pZCAhPT0gJ2N1c3RvbWVyJyAmJg0KICAgICAgIWUudGFyZ2V0LmNsb3Nlc3QoJ3NlbGVjdCcpDQogICAgKSB7DQogICAgICByZWZvY3VzU2VhcmNoKCk7DQogICAgfQ0KICB9KTsNCg0KICAvLyBSZWZvY3VzIGFmdGVyIFVJIGJ1dHRvbiBhY3Rpb25zDQogIFsnY2xlYXJTZWFyY2gnLCAnc2hvd1NlbGVjdGVkJywgJ3NhdmVCdG4nLCAndXBsb2FkQnRuJ10uZm9yRWFjaChpZCA9PiB7DQogICAgY29uc3QgYnRuID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpOw0KICAgIGlmIChidG4pIGJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHJlZm9jdXNTZWFyY2gpOw0KICB9KTsNCg0KICAvLyBSZWZvY3VzIGFmdGVyIHNlbGVjdGluZyBhbiBpdGVtDQogIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHsNCiAgICBpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdpdGVtJykpIHsNCiAgICAgIHNldFRpbWVvdXQocmVmb2N1c1NlYXJjaCwgMTIwKTsNCiAgICB9DQogIH0pOw0KDQogIC8vIFJlZm9jdXMgYWZ0ZXIgY2xvc2luZyBvdmVybGF5IG9yIGZpbGUgbW9kYWwNCiAgWydjbG9zZU92ZXJsYXknXS5mb3JFYWNoKGlkID0+IHsNCiAgICBjb25zdCBidG4gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7DQogICAgaWYgKGJ0bikgYnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gc2V0VGltZW91dChyZWZvY3VzU2VhcmNoLCAyMDApKTsNCiAgfSk7DQoNCiAgLy8gUmVmb2N1cyBhZnRlciBwcmVzc2luZyBFbnRlciBpbiBzZWFyY2ggKGFkZC10by1saXN0IGV2ZW50KQ0KICBzZWFyY2hJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgKGV2KSA9PiB7DQogICAgaWYgKGV2LmtleSA9PT0gJ0VudGVyJykgew0KICAgICAgLy8gV2FpdCBmb3IgeW91ciBhZGQtdG8tbGlzdCBsb2dpYyB0byBmaW5pc2gNCiAgICAgIHNldFRpbWVvdXQocmVmb2N1c1NlYXJjaCwgMTUwKTsNCiAgICB9DQogIH0pOw0KICAvL3Jvdy5hZGRFdmVudExpc3RlbmVyKCdkYmxjbGljaycsICgpID0+IHNob3dGaWxlcyhpdGVtLm5hbWUsIGl0ZW0uZmlsZXMgfHwgW10sIGl0ZW0uc2l6ZSkpOw0KDQp9DQo8L3NjcmlwdD4NCg0KPC9ib2R5Pg0KPC9odG1sPg0K`;
    const decoded = atob(base64html);
    const iframe = document.getElementById('viewer');
    const doc = iframe.contentWindow.document;
    doc.open();
    doc.write(decoded);
    doc.close();
  </script>
</body>
</html>